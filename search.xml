<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>leecodeä¹ é¢˜ï¼ˆ1ï¼‰</title>
      <link href="/2022/05/04/leecode%E4%B9%A0%E9%A2%98%EF%BC%881%EF%BC%89/"/>
      <url>/2022/05/04/leecode%E4%B9%A0%E9%A2%98%EF%BC%881%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç§»åŠ¨é›¶"><a href="#ç§»åŠ¨é›¶" class="headerlink" title="ç§»åŠ¨é›¶"></a>ç§»åŠ¨é›¶</h2><p>2022-05-04</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <code>nums</code>ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ‰€æœ‰ <code>0</code> ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼ŒåŒæ—¶ä¿æŒéé›¶å…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚<br><strong>è¯·æ³¨æ„</strong> ï¼Œå¿…é¡»åœ¨ä¸å¤åˆ¶æ•°ç»„çš„æƒ…å†µä¸‹åŸåœ°å¯¹æ•°ç»„è¿›è¡Œæ“ä½œã€‚<br><strong>ç¤ºä¾‹ 1:</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums=[0,1,2,3,12]</span><br><span class="line">è¾“å‡ºï¼š[1,3,12,0,0]</span><br></pre></td></tr></table></figure></p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span>Â <span class="title class_">Solution</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">moveZeroes</span>(<span class="params">self,Â nums:Â <span class="type">List</span>[<span class="built_in">int</span>]</span>)Â -&gt;Â <span class="literal">None</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â DoÂ notÂ returnÂ anything,Â modifyÂ numsÂ in-placeÂ instead.</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â &quot;&quot;&quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#my version 156ms</span></span><br><span class="line">Â Â Â Â Â Â Â Â indexÂ =Â []</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â i,valueÂ <span class="keyword">in</span>Â <span class="built_in">enumerate</span>(nums):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â value==<span class="number">0</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â index.append(i)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â index[::-<span class="number">1</span>]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â nums.pop(i)</span><br><span class="line">Â Â Â Â Â Â Â Â nums.extend([<span class="number">0</span>]*<span class="built_in">len</span>(index))</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#first version 580ms</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(nums.count(<span class="number">0</span>)):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â nums.remove(<span class="number">0</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â nums.append(<span class="number">0</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#second versionåŒæŒ‡é’ˆ48ms</span></span><br><span class="line">Â Â Â Â Â Â Â Â left,right=<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â nums:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â i!=<span class="number">0</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nums[left],nums[right]=nums[right],nums[left]</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â left+=<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â right+=<span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>ä½¿ç”¨åŒæŒ‡é’ˆï¼Œå·¦æŒ‡é’ˆæŒ‡å‘å½“å‰å·²ç»å¤„ç†å¥½çš„åºåˆ—çš„å°¾éƒ¨ï¼Œå³æŒ‡é’ˆæŒ‡å‘å¾…å¤„ç†åºåˆ—çš„å¤´éƒ¨ã€‚å³æŒ‡é’ˆä¸æ–­å‘å³ç§»åŠ¨ï¼Œæ¯æ¬¡å³æŒ‡é’ˆæŒ‡å‘éé›¶æ•°ï¼Œåˆ™å°†å·¦å³æŒ‡é’ˆå¯¹åº”çš„æ•°äº¤æ¢ï¼ŒåŒæ—¶å·¦æŒ‡é’ˆå³ç§»ã€‚<a href="https://leetcode-cn.com/problems/move-zeroes/solution/c-dong-hua-yan-shi-283-yi-dong-ling-by-w-4fpg/">è§£æ</a></li><li>second versionä¸­ä¼šå¯¹åˆ—è¡¨è¿›è¡Œnums.count(0)æ¬¡å¾ªç¯å› æ­¤è¿è¡Œæ—¶é—´è¾ƒé•¿ï¼Œæ³¨æ„åˆ é™¤numsåç´¢å¼•ä½ç½®çš„å˜åŒ–ã€‚<h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/move-zeroes/solution/shi-pin-tu-jie-bao-ni-gao-dong-by-huinuo/">source</a></li></ul><h2 id="å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡"><a href="#å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡" class="headerlink" title="å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡"></a>å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡</h2><p>2022-05-05</p><h4 id="ğŸ™ˆIntroduction-1"><a href="#ğŸ™ˆIntroduction-1" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·è®¡ç®—æ•°ç»„çš„ ä¸­å¿ƒä¸‹æ ‡ ã€‚<br>æ•°ç»„ ä¸­å¿ƒä¸‹æ ‡ æ˜¯æ•°ç»„çš„ä¸€ä¸ªä¸‹æ ‡ï¼Œå…¶å·¦ä¾§æ‰€æœ‰å…ƒç´ ç›¸åŠ çš„å’Œç­‰äºå³ä¾§æ‰€æœ‰å…ƒç´ ç›¸åŠ çš„å’Œã€‚<br>å¦‚æœä¸­å¿ƒä¸‹æ ‡ä½äºæ•°ç»„æœ€å·¦ç«¯ï¼Œé‚£ä¹ˆå·¦ä¾§æ•°ä¹‹å’Œè§†ä¸º 0 ï¼Œå› ä¸ºåœ¨ä¸‹æ ‡çš„å·¦ä¾§ä¸å­˜åœ¨å…ƒç´ ã€‚è¿™ä¸€ç‚¹å¯¹äºä¸­å¿ƒä¸‹æ ‡ä½äºæ•°ç»„æœ€å³ç«¯åŒæ ·é€‚ç”¨ã€‚<br>å¦‚æœæ•°ç»„æœ‰å¤šä¸ªä¸­å¿ƒä¸‹æ ‡ï¼Œåº”è¯¥è¿”å› æœ€é è¿‘å·¦è¾¹ çš„é‚£ä¸€ä¸ªã€‚å¦‚æœæ•°ç»„ä¸å­˜åœ¨ä¸­å¿ƒä¸‹æ ‡ï¼Œè¿”å› -1 ã€‚</p><h4 id="ğŸ¤”code-1"><a href="#ğŸ¤”code-1" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#my version 7720ms</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pivotIndex</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">sum</span>(nums[:i])==<span class="built_in">sum</span>(nums[i+<span class="number">1</span>:]):</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"><span class="comment">#æ»‘çª—æ”¹è¿› 48ms</span></span><br><span class="line">a=<span class="built_in">sum</span>(nums[:<span class="number">0</span>])</span><br><span class="line">        b=<span class="built_in">sum</span>(nums[<span class="number">1</span>:])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(nums)-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> a==b:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">            a+=nums[i]</span><br><span class="line">            b-=nums[i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> a==b:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">len</span>(nums)-<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"><span class="comment">#å‰ç¼€å’Œ 36ms</span></span><br><span class="line">sum_=<span class="built_in">sum</span>(nums)</span><br><span class="line">len_=<span class="built_in">len</span>(nums)</span><br><span class="line">pre_=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(len_):</span><br><span class="line"><span class="keyword">if</span>Â pre_==sum_-nums[i]-pre_:</span><br><span class="line"><span class="keyword">return</span>Â i</span><br><span class="line">pre_+=nums[i]</span><br><span class="line"><span class="keyword">return</span>Â -<span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-1"><a href="#ğŸ’ªget-1" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ol><li>éå†ä¸€éæ±‚å‡ºæ€»å’Œsum</li><li>éå†ç¬¬äºŒéæ±‚ä¸­å¿ƒç´¢å¼•å·¦åŠå’Œ<code>leftSum</code><ul><li>åŒæ—¶æ ¹æ®<code>sum</code>å’Œ<code>leftSum</code> è®¡ç®—ä¸­å¿ƒç´¢å¼•å³åŠå’Œ<code>rightSum</code></li><li>åˆ¤æ–­<code>leftSum</code>å’Œ<code>rightSum</code>æ˜¯å¦ç›¸åŒ</li></ul></li></ol><h4 id="ğŸ™ƒsource-1"><a href="#ğŸ™ƒsource-1" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/find-pivot-index/">source</a></p><h2 id="åˆå¹¶åŒºé—´"><a href="#åˆå¹¶åŒºé—´" class="headerlink" title="åˆå¹¶åŒºé—´"></a>åˆå¹¶åŒºé—´</h2><p>2022-05-09</p><h4 id="ğŸ™ˆIntroduction-2"><a href="#ğŸ™ˆIntroduction-2" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ä»¥æ•°ç»„ intervals è¡¨ç¤ºè‹¥å¹²ä¸ªåŒºé—´çš„é›†åˆï¼Œå…¶ä¸­å•ä¸ªåŒºé—´ä¸º intervals[i] = [starti, endi] ã€‚è¯·ä½ åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ï¼Œå¹¶è¿”å› ä¸€ä¸ªä¸é‡å çš„åŒºé—´æ•°ç»„ï¼Œè¯¥æ•°ç»„éœ€æ°å¥½è¦†ç›–è¾“å…¥ä¸­çš„æ‰€æœ‰åŒºé—´ ã€‚</p><h4 id="ğŸ¤”code-2"><a href="#ğŸ¤”code-2" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span>Â <span class="title function_">merge</span>(<span class="params">self,Â intervals:Â <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>)Â -&gt;Â <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">Â Â Â Â Â Â Â Â intervals.sort(keyÂ =Â <span class="keyword">lambda</span>Â xÂ :Â x[<span class="number">0</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â mergesÂ =Â <span class="built_in">list</span>()</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â intervalÂ <span class="keyword">in</span>Â intervals:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="keyword">not</span>Â mergesÂ <span class="keyword">or</span>Â merges[-<span class="number">1</span>][-<span class="number">1</span>]Â &lt;Â interval[<span class="number">0</span>]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â merges.append(interval)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â merges[-<span class="number">1</span>][-<span class="number">1</span>]Â =Â <span class="built_in">max</span>(merges[-<span class="number">1</span>][-<span class="number">1</span>],Â interval[<span class="number">1</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment"># merges[-1][-1] = interval[1] if interval[1]&gt;merges[-1][-1] else merges[-1][-1] ä¸‰å…ƒè¿ç®—ç¬¦</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â merges</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#########2#########</span></span><br><span class="line">Â Â Â Â Â Â Â Â ret = []</span><br><span class="line">        intervals.sort()</span><br><span class="line">        start,end = intervals[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> intervals:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] &gt; end:</span><br><span class="line">                ret.append([start,end])</span><br><span class="line">                start = i[<span class="number">0</span>]</span><br><span class="line">            end = <span class="built_in">max</span>(end, i[<span class="number">1</span>])</span><br><span class="line">        ret.append([start,end])</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-2"><a href="#ğŸ’ªget-2" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>sortå®ç°æ’åºï¼š<code>intervals.sort(key=lambda x:x[0])</code></li><li>æ€è·¯<br>![[1637046449-hQRPlJ-file_1637046447028.png]]<h4 id="ğŸ™ƒsource-2"><a href="#ğŸ™ƒsource-2" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/problems/merge-intervals/solution/si-wei-dao-tu-zheng-li-xiang-jie-lambada-tnel/">source</a></li></ul><h2 id="æœç´¢æ’å…¥ä½ç½®"><a href="#æœç´¢æ’å…¥ä½ç½®" class="headerlink" title="æœç´¢æ’å…¥ä½ç½®"></a>æœç´¢æ’å…¥ä½ç½®</h2><p>2022-05-09</p><h4 id="ğŸ™ˆIntroduction-3"><a href="#ğŸ™ˆIntroduction-3" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚</p><p>è¯·å¿…é¡»ä½¿ç”¨æ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•ã€‚</p><h4 id="ğŸ¤”code-3"><a href="#ğŸ¤”code-3" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">searchInsert</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        l , r = <span class="number">0</span>, <span class="built_in">len</span>(nums)-<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">            mid = (l + r) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> nums[mid] == target:</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">if</span> nums[mid] &lt; target:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> l</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-3"><a href="#ğŸ’ªget-3" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><p>![[1628933645-lfjMLm-image.png]]</p><h4 id="ğŸ™ƒsource-3"><a href="#ğŸ™ƒsource-3" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode.cn/problems/search-insert-position/solution/shu-zu-zong-jie-liao-er-fen-cha-zhao-de-w61pe/">source</a></p><h2 id="æ—‹è½¬çŸ©é˜µ"><a href="#æ—‹è½¬çŸ©é˜µ" class="headerlink" title="æ—‹è½¬çŸ©é˜µ"></a>æ—‹è½¬çŸ©é˜µ</h2><p>2022-05-09</p><h4 id="ğŸ™ˆIntroduction-4"><a href="#ğŸ™ˆIntroduction-4" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™ä½ ä¸€å¹…ç”± <code>N Ã— N</code> çŸ©é˜µè¡¨ç¤ºçš„å›¾åƒï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ çš„å¤§å°ä¸º 4 å­—èŠ‚ã€‚è¯·ä½ è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œå°†å›¾åƒæ—‹è½¬ 90 åº¦ã€‚<br>ä¸å ç”¨é¢å¤–å†…å­˜ç©ºé—´èƒ½å¦åšåˆ°ï¼Ÿ</p><h4 id="ğŸ¤”code-4"><a href="#ğŸ¤”code-4" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>Â <span class="title class_">Solution</span>:</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">rotate</span>(<span class="params">self,Â matrix:Â <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>)Â -&gt;Â <span class="literal">None</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â DoÂ notÂ returnÂ anything,Â modifyÂ matrixÂ in-placeÂ instead.</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â &quot;&quot;&quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â matrix[:]=<span class="built_in">zip</span>(*matrix[::-<span class="number">1</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">########2#######</span></span><br><span class="line">Â Â Â Â Â Â Â Â lenghÂ =Â <span class="built_in">len</span>(matrix)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(lengh):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(i):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][j],matrix[j][i]=matrix[j][i],matrix[i][j]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(lengh):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(lengh):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][lengh-j-<span class="number">1</span>],matrix[i][j]=matrix[i][j],matrix[i][lengh-j-<span class="number">1</span>]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">########3######</span></span><br><span class="line">Â Â Â Â Â Â Â Â nÂ =Â <span class="built_in">len</span>(matrix)</span><br><span class="line">Â Â Â Â Â Â Â Â tmpÂ =Â copy.deepcopy(matrix)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[j][n-i-<span class="number">1</span>]=tmp[i][j]</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-4"><a href="#ğŸ’ªget-4" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>zipä¸zip(*interbl)</code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zipped = <span class="built_in">zip</span>(a,b) Â  Â  <span class="comment"># è¿”å›ä¸€ä¸ªå¯¹è±¡  </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zipped  </span><br><span class="line">&lt;<span class="built_in">zip</span> <span class="built_in">object</span> at <span class="number">0x103abc288</span>&gt;  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(zipped) Â <span class="comment"># list() è½¬æ¢ä¸ºåˆ—è¡¨  </span></span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">zip</span>(a,c)) Â  Â  Â  Â  Â  Â  Â <span class="comment"># å…ƒç´ ä¸ªæ•°ä¸æœ€çŸ­çš„åˆ—è¡¨ä¸€è‡´  </span></span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]  </span><br><span class="line">  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1, a2 = <span class="built_in">zip</span>(*<span class="built_in">zip</span>(a,b)) Â  Â  Â  Â  Â <span class="comment"># ä¸ zip ç›¸åï¼Œzip(*) å¯ç†è§£ä¸ºè§£å‹ï¼Œè¿”å›äºŒç»´çŸ©é˜µå¼  </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(a1)  </span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(a2)  </span><br><span class="line">[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure></li><li>å¦‚æœæ˜¯é¡ºæ—¶é’ˆæ—‹è½¬90Â°  ä¸€å®šæ˜¯å…ˆå¯¹è§’çº¿ç¿»è½¬ï¼Œå†æ°´å¹³ç¿»è½¬ ;å¦‚æœæ˜¯é€†æ—¶é’ˆæ—‹è½¬90Â° ,ä¸€å®šæ˜¯å…ˆæ°´å¹³ç¿»è½¬ï¼Œå†å¯¹è§’çº¿ç¿»è½¬<h4 id="ğŸ™ƒsource-4"><a href="#ğŸ™ƒsource-4" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/problems/rotate-matrix-lcci/solution/">source</a></li></ul><h2 id="å¯¹è§’çº¿éå†"><a href="#å¯¹è§’çº¿éå†" class="headerlink" title="å¯¹è§’çº¿éå†"></a>å¯¹è§’çº¿éå†</h2><p>2022-05-10</p><h4 id="ğŸ™ˆIntroduction-5"><a href="#ğŸ™ˆIntroduction-5" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™ä½ ä¸€ä¸ªå¤§å°ä¸º <code>m x n</code> çš„çŸ©é˜µ <code>mat</code> ï¼Œè¯·ä»¥å¯¹è§’çº¿éå†çš„é¡ºåºï¼Œç”¨ä¸€ä¸ªæ•°ç»„è¿”å›è¿™ä¸ªçŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚</p><h4 id="ğŸ¤”code-5"><a href="#ğŸ¤”code-5" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>Â <span class="title class_">Solution</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">findDiagonalOrder</span>(<span class="params">self,Â mat:Â <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>)Â -&gt;Â <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="keyword">not</span>Â matÂ <span class="keyword">or</span>Â <span class="keyword">not</span>Â mat[<span class="number">0</span>]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â []</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#åˆå§‹åŒ–çŸ©é˜µ</span></span><br><span class="line">Â Â Â Â Â Â Â Â N,MÂ =Â <span class="built_in">len</span>(mat),<span class="built_in">len</span>(mat[<span class="number">0</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â row,Â column=<span class="number">0</span>,Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#è§„å®šæ–¹å‘,1å‘ä¸Š</span></span><br><span class="line">Â Â Â Â Â Â Â Â directionÂ =Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â result=[]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â row&lt;NÂ <span class="keyword">and</span>Â column&lt;M:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â result.append(mat[row][column])</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">#new_row</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â new_rowÂ =Â rowÂ +Â (-<span class="number">1</span>Â <span class="keyword">if</span>Â directionÂ ==Â <span class="number">1</span>Â <span class="keyword">else</span>Â <span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â new_columnÂ =Â columnÂ +Â (<span class="number">1</span>Â <span class="keyword">if</span>Â directionÂ ==Â <span class="number">1</span>Â <span class="keyword">else</span>Â -<span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â new_rowÂ &lt;Â <span class="number">0</span>Â <span class="keyword">or</span>Â new_rowÂ ==Â NÂ <span class="keyword">or</span>Â new_columnÂ &lt;Â <span class="number">0</span>Â <span class="keyword">or</span>Â new_columnÂ ==Â M:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â direction:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rowÂ +=Â (columnÂ ==Â M-<span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â columnÂ +=Â (column&lt;M-<span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â column+=(row==N-<span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â row+=(row&lt;N-<span class="number">1</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â directionÂ =Â <span class="number">1</span>-direction</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â row=new_row</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â column=new_column</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â result</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">###########</span></span><br><span class="line">Â Â Â Â Â Â Â Â res= [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)+<span class="built_in">len</span>(mat[<span class="number">0</span>])-<span class="number">1</span>)]</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mat[<span class="number">0</span>])):</span><br><span class="line">            <span class="keyword">if</span> (i+j)%<span class="number">2</span>!=<span class="number">0</span>:</span><br><span class="line">                res[i+j].append(mat[i][j])</span><br><span class="line">                <span class="comment">#æ’å€¼åœ¨æœ€å</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                res[i+j].insert(<span class="number">0</span>,mat[i][j])</span><br><span class="line">                <span class="comment">#ä¼šå¾€å‰æ’</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        result+=i</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-5"><a href="#ğŸ’ªget-5" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>æ€æƒ³ï¼šåˆ©ç”¨æ¯å±‚çš„ç´¢å¼•å’Œç›¸ç­‰<ul><li>å‡è®¾çŸ©é˜µæ— é™å¤§</li><li>ç´¢å¼•å’Œä¸ºå¶æ•°ï¼Œå‘ä¸Šéå†ï¼Œæ¨ªç´¢å¼•å€¼é€’å‡ï¼Œéå†å€¼ä¾æ¬¡ä¸º(x,0),(x-1,1),(x-2,2)â€¦(0,x)</li><li>ç´¢å¼•å’Œä¸ºå¥‡æ•°ï¼Œå‘ä¸‹éå†ï¼Œçºµç´¢å¼•å€¼é€’å‡ï¼Œéå†å€¼ä¾æ¬¡ä¸º(0,y),(1,y-1),(2,y-2)â€¦(y,0)<h4 id="ğŸ™ƒsource-5"><a href="#ğŸ™ƒsource-5" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/leetbook/read/array-and-string/cuxq3/">source</a></li></ul></li></ul><h2 id="é›¶çŸ©é˜µ"><a href="#é›¶çŸ©é˜µ" class="headerlink" title="é›¶çŸ©é˜µ"></a>é›¶çŸ©é˜µ</h2><p>2022-05-10</p><h4 id="ğŸ™ˆIntroduction-6"><a href="#ğŸ™ˆIntroduction-6" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç¼–å†™ä¸€ç§ç®—æ³•ï¼Œè‹¥M Ã— NçŸ©é˜µä¸­æŸä¸ªå…ƒç´ ä¸º0ï¼Œåˆ™å°†å…¶æ‰€åœ¨çš„è¡Œä¸åˆ—æ¸…é›¶ã€‚</p><h4 id="ğŸ¤”code-6"><a href="#ğŸ¤”code-6" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setZeroes</span>(<span class="params">self, matrix: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Do not return anything, modify matrix in-place instead.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment">#############my_version################</span></span><br><span class="line">        row_len = <span class="built_in">len</span>(matrix)</span><br><span class="line">        colu_len = <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">        zero_row = []</span><br><span class="line">        zero_colu = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_len):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(colu_len):</span><br><span class="line">                <span class="keyword">if</span> matrix[i][j] == <span class="number">0</span>:</span><br><span class="line">                    zero_row.append(i)</span><br><span class="line">                    zero_colu.append(j)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> zero_row:</span><br><span class="line">            matrix[i] = [<span class="number">0</span>]*colu_len</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_len):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> zero_colu:</span><br><span class="line">                matrix[i][j] = <span class="number">0</span></span><br><span class="line"><span class="comment">##############second_version#################</span></span><br><span class="line">m,Â nÂ =Â <span class="built_in">len</span>(matrix),Â <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â row,colÂ =Â [<span class="literal">False</span>]*m,Â [<span class="literal">False</span>]*n</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(m):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â matrix[i][j]==<span class="number">0</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â row[i]=col[j]=<span class="literal">True</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(m):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â row[i]Â <span class="keyword">or</span>Â col[j]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][j]=<span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">##############third_version##################</span></span><br><span class="line">Â Â Â Â Â Â Â Â m,Â nÂ =Â <span class="built_in">len</span>(matrix),Â <span class="built_in">len</span>(matrix[<span class="number">0</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â flag_col0Â =Â <span class="built_in">any</span>(matrix[i][<span class="number">0</span>]Â ==Â <span class="number">0</span>Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(m))</span><br><span class="line">Â Â Â Â Â Â Â Â flag_row0Â =Â <span class="built_in">any</span>(matrix[<span class="number">0</span>][j]Â ==Â <span class="number">0</span>Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n))</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#å°†ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—ç½®é›¶ä½œä¸ºæ ‡å¿—</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">1</span>,Â m):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">1</span>,Â n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â matrix[i][j]Â ==Â <span class="number">0</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][<span class="number">0</span>]Â =Â matrix[<span class="number">0</span>][j]Â =Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#åˆ©ç”¨æ ‡å¿—å°†éé¦–è¡Œé¦–åˆ—æ‰€åœ¨è¡Œå’Œåˆ—ç½®é›¶</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">1</span>,Â m):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">1</span>,Â n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â matrix[i][<span class="number">0</span>]Â ==Â <span class="number">0</span>Â <span class="keyword">or</span>Â matrix[<span class="number">0</span>][j]Â ==Â <span class="number">0</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][j]Â =Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#å°†é¦–è¡Œé¦–åˆ—ç½®é›¶</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â flag_col0:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(m):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[i][<span class="number">0</span>]Â =Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â flag_row0:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(n):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matrix[<span class="number">0</span>][j]Â =Â <span class="number">0</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-6"><a href="#ğŸ’ªget-6" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>ä¸èƒ½ç›´æ¥å¯¹çŸ©é˜µè¿›è¡Œæ“ä½œï¼Œå¦åˆ™ä¼šå¹²æ¶‰å…¶ä»–è¡Œåˆ—çš„å–å€¼ã€‚å€Ÿç”¨é¦–è¡Œé¦–åˆ—ä½œä¸ºæ ‡å¿—ä½ï¼Œå¯¹å…¶ä»–è¡Œåˆ—è¿›è¡Œæ“ä½œï¼Œæœ€åå¯¹é¦–è¡Œé¦–åˆ—è¿›è¡Œæ“ä½œã€‚</li><li>å€Ÿç”¨ä¸€ä¸ªçŸ©é˜µå¯¹åŸæœ‰çŸ©é˜µè¡Œåˆ—è¿›è¡Œå­˜å‚¨ã€‚<h4 id="ğŸ™ƒsource-6"><a href="#ğŸ™ƒsource-6" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/problems/zero-matrix-lcci/submissions/">source</a></li></ul><h2 id="æœ€é•¿å…¬å…±å‰ç¼€"><a href="#æœ€é•¿å…¬å…±å‰ç¼€" class="headerlink" title="æœ€é•¿å…¬å…±å‰ç¼€"></a>æœ€é•¿å…¬å…±å‰ç¼€</h2><p>2022-05-11</p><h4 id="ğŸ™ˆIntroduction-7"><a href="#ğŸ™ˆIntroduction-7" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚<br>å¦‚æœä¸å­˜åœ¨å…¬å…±å‰ç¼€ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code>ã€‚</p><h4 id="ğŸ¤”code-7"><a href="#ğŸ¤”code-7" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>Â <span class="title class_">Solution</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">longestCommonPrefix</span>(<span class="params">self,Â strs:Â <span class="type">List</span>[<span class="built_in">str</span>]</span>)Â -&gt;Â <span class="built_in">str</span>:</span><br><span class="line">Â Â Â Â <span class="comment"># my version</span></span><br><span class="line">lengh_ = <span class="built_in">len</span>(strs)</span><br><span class="line">        num_ = <span class="built_in">len</span>(strs[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_+<span class="number">1</span>):</span><br><span class="line">            common_ = strs[<span class="number">0</span>][:i]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,lengh_):</span><br><span class="line">                <span class="keyword">if</span> strs[j][:i]!=common_:</span><br><span class="line">                    <span class="keyword">return</span> common_[:i-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> common_</span><br><span class="line"></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#ä½¿ç”¨zip+set</span></span><br><span class="line">Â Â Â Â Â Â Â Â retÂ =Â <span class="string">&#x27;&#x27;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">zip</span>(*strs):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="built_in">len</span>(<span class="built_in">set</span>(i))==<span class="number">1</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ret+=i[<span class="number">0</span>]</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â ret</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â ret</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment"># ä½¿ç”¨max()å’Œmin()</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="keyword">not</span>Â strs:Â <span class="keyword">return</span>Â <span class="string">&quot;&quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â s1Â =Â <span class="built_in">min</span>(strs)</span><br><span class="line">Â Â Â Â Â Â Â Â s2Â =Â <span class="built_in">max</span>(strs)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â i,xÂ <span class="keyword">in</span>Â <span class="built_in">enumerate</span>(s1):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â xÂ !=Â s2[i]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â s2[:i]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â s1</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-7"><a href="#ğŸ’ªget-7" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>ä½¿ç”¨<code>zip</code>è·å¾—å‰ç¼€çš„é›†åˆï¼Œä½¿ç”¨<code>set</code>çš„ä¸é‡å¤çš„æ€§è´¨è·å¾—é›†åˆçš„é•¿åº¦ï¼Œæ»¡è¶³é•¿åº¦è¦æ±‚å³æ·»åŠ åˆ°å­—ç¬¦ä¸²åã€‚</li><li>åˆ©ç”¨pythonçš„<code>max()</code>å’Œ<code>min()</code>å‡½æ•°ï¼Œåœ¨pythonä¸­å­—ç¬¦å¯ä»¥è¿›è¡Œæ¯”è¾ƒï¼ŒæŒ‰ç…§asciiå€¼è¿›è¡Œæ’åºï¼Œå¦‚ï¼šabbï¼Œabaï¼Œabacï¼Œæœ€å¤§ä¸ºabbï¼Œæœ€å°ä¸ºabaï¼Œå› æ­¤åªéœ€è¦æ¯”è¾ƒæœ€å¤§æœ€å°å€¼å¾—å…¬å…±æœ€é•¿éƒ¨åˆ†å³å¯ä»¥å¾—å‡ºæ•´ä¸ªæ•°ç»„çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚<h4 id="ğŸ™ƒsource-7"><a href="#ğŸ™ƒsource-7" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/problems/longest-common-prefix/">source</a></li></ul><h2 id="æœ€é•¿å›æ–‡å­ä¸²"><a href="#æœ€é•¿å›æ–‡å­ä¸²" class="headerlink" title="æœ€é•¿å›æ–‡å­ä¸²"></a>æœ€é•¿å›æ–‡å­ä¸²</h2><p>2022-05-11</p><h4 id="ğŸ™ˆIntroduction-8"><a href="#ğŸ™ˆIntroduction-8" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code>ï¼Œæ‰¾åˆ° <code>s</code> ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚<br>ç¤ºä¾‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = <span class="string">&quot;babad&quot;</span></span><br><span class="line">è¾“å‡ºï¼š<span class="string">&quot;bab&quot;</span></span><br><span class="line">è§£é‡Šï¼š<span class="string">&quot;aba&quot;</span> åŒæ ·æ˜¯ç¬¦åˆé¢˜æ„çš„ç­”æ¡ˆã€‚</span><br></pre></td></tr></table></figure></p><h4 id="ğŸ¤”code-8"><a href="#ğŸ¤”code-8" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>Â <span class="title class_">Solution</span>:</span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">longestPalindrome</span>(<span class="params">self,Â s:Â <span class="built_in">str</span></span>)Â -&gt;Â <span class="built_in">str</span>:</span><br><span class="line">Â Â Â Â <span class="comment">#ä¸­å¿ƒæ‰©æ•£</span></span><br><span class="line">Â Â Â Â Â Â Â Â lensÂ =Â <span class="built_in">len</span>(s)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â lens&lt;<span class="number">2</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â s</span><br><span class="line">Â Â Â Â Â Â Â Â resÂ =Â <span class="string">&#x27;&#x27;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#å›æ–‡å­—ç¬¦ä¸²ä¸ºå¶æ•°</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(lens):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â left,right=i,i+<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â left&gt;=<span class="number">0</span>Â <span class="keyword">and</span>Â right&lt;lens:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â s[left]!=s[right]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â leftÂ -=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rightÂ +=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="built_in">len</span>(res)Â &lt;Â right-left-<span class="number">1</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â res=s[left+<span class="number">1</span>:right]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#å›æ–‡å­—ç¬¦ä¸²ä¸ºå¥‡æ•°</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(lens):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â left,right=i,i</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â left&gt;=<span class="number">0</span>Â <span class="keyword">and</span>Â right&lt;lens:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â s[left]Â !=Â s[right]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â leftÂ -=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rightÂ +=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="built_in">len</span>(res)Â &lt;Â right-left-<span class="number">1</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resÂ =Â s[left+<span class="number">1</span>:right]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â res</span><br><span class="line"><span class="comment">#########åŠ¨æ€è§„åˆ’###########</span></span><br><span class="line">sizeÂ =Â <span class="built_in">len</span>(s)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â size&lt;<span class="number">2</span>:Â <span class="keyword">return</span>Â s</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#åˆ›å»ºåŠ¨æ€è§„åˆ’è¡¨</span></span><br><span class="line">Â Â Â Â Â Â Â Â dpÂ =Â [[<span class="literal">False</span>Â <span class="keyword">for</span>Â _Â <span class="keyword">in</span>Â <span class="built_in">range</span>(size)]Â <span class="keyword">for</span>Â _Â <span class="keyword">in</span>Â <span class="built_in">range</span>(size)]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#åˆå§‹é•¿åº¦ä¸º1ï¼Œè‹¥ä¸å­˜åœ¨å›æ–‡åˆ™è¿”å›ç¬¬ä¸€ä¸ªå€¼</span></span><br><span class="line">Â Â Â Â Â Â Â Â max_lenÂ =Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â startÂ =Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#æ–œå¯¹è§’çº¿ç½®ä¸ºTrue</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â jÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">1</span>,size):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(j):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â j-iÂ &lt;=<span class="number">2</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â s[i]==s[j]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â dp[i][j]Â =Â <span class="literal">True</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cur_lenÂ =Â j-i+<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="comment">#å¡«è¡¨</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â s[i]==s[j]Â <span class="keyword">and</span>Â dp[i+<span class="number">1</span>][j-<span class="number">1</span>]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â dp[i][j]Â =Â <span class="literal">True</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cur_lenÂ =Â j-i+<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â dp[i][j]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â cur_lenÂ &gt;Â max_len:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â max_lenÂ =Â cur_len</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â start=i</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â s[start:start+max_len]</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">#######Manacherç®—æ³•</span></span><br><span class="line"><span class="keyword">def</span>Â <span class="title function_">expand</span>(<span class="params">self,Â s,Â left,Â right</span>):</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">while</span>Â leftÂ &gt;=Â <span class="number">0</span>Â <span class="keyword">and</span>Â rightÂ &lt;Â <span class="built_in">len</span>(s)Â <span class="keyword">and</span>Â s[left]Â ==Â s[right]:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â leftÂ -=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â rightÂ +=Â <span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â (rightÂ -Â leftÂ -Â <span class="number">2</span>)Â //Â <span class="number">2</span></span><br><span class="line">Â Â Â Â <span class="keyword">def</span>Â <span class="title function_">longestPalindrome</span>(<span class="params">self,Â s:Â <span class="built_in">str</span></span>)Â -&gt;Â <span class="built_in">str</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â end,Â startÂ =Â -<span class="number">1</span>,Â <span class="number">0</span></span><br><span class="line">Â Â Â Â Â Â Â Â sÂ =Â <span class="string">&#x27;#&#x27;</span>Â +Â <span class="string">&#x27;#&#x27;</span>.join(<span class="built_in">list</span>(s))Â +Â <span class="string">&#x27;#&#x27;</span></span><br><span class="line">Â Â Â Â Â Â Â Â arm_lenÂ =Â []</span><br><span class="line">Â Â Â Â Â Â Â Â rightÂ =Â -<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â jÂ =Â -<span class="number">1</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â rightÂ &gt;=Â i:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â i_symÂ =Â <span class="number">2</span>Â *Â jÂ -Â i</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â min_arm_lenÂ =Â <span class="built_in">min</span>(arm_len[i_sym],Â rightÂ -Â i)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cur_arm_lenÂ =Â self.expand(s,Â iÂ -Â min_arm_len,Â iÂ +Â min_arm_len)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">else</span>:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cur_arm_lenÂ =Â self.expand(s,Â i,Â i)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â arm_len.append(cur_arm_len)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â iÂ +Â cur_arm_lenÂ &gt;Â right:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â jÂ =Â i</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rightÂ =Â iÂ +Â cur_arm_len</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â <span class="number">2</span>Â *Â cur_arm_lenÂ +Â <span class="number">1</span>Â &gt;Â endÂ -Â start:</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â startÂ =Â iÂ -Â cur_arm_len</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â endÂ =Â iÂ +Â cur_arm_len</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â s[start+<span class="number">1</span>:end+<span class="number">1</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-8"><a href="#ğŸ’ªget-8" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>ä¸­å¿ƒæ‰©æ•£</li><li>åŠ¨æ€è§„åˆ’</li><li>ManACher<h4 id="ğŸ™ƒsource-8"><a href="#ğŸ™ƒsource-8" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode.cn/problems/longest-palindromic-substring/solution/zui-chang-hui-wen-zi-chuan-by-leetcode-solution/">source</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> Python </tag>
            
            <tag> Leecode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLé¢˜ç›®è®°å½•(ä¸€)</title>
      <link href="/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/"/>
      <url>/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"><a href="#åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±" class="headerlink" title="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"></a>åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> email       <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">idæ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶ã€‚ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL <strong>åˆ é™¤è¯­å¥</strong>æ¥ <strong>åˆ é™¤</strong> æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªidæœ€å°çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span>Â p1Â <span class="keyword">from</span>Â PersonÂ p1,PersonÂ p2</span><br><span class="line"><span class="keyword">where</span>Â p1.email<span class="operator">=</span>p2.emailÂ <span class="keyword">and</span>Â p1.id<span class="operator">&gt;</span>p2.id;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>deleteå¯ä»¥å†™æˆ<code>delete table1 from table1,table2 where â€¦â€¦</code>![[SQLåŸºç¡€#DELETE|delete]]</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/delete-duplicate-emails/">source</a></p><h2 id="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"><a href="#è®¡ç®—ç‰¹æ®Šå¥–é‡‘" class="headerlink" title="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"></a>è®¡ç®—ç‰¹æ®Šå¥–é‡‘</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction-1"><a href="#ğŸ™ˆIntroduction-1" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| åˆ—å        | ç±»å‹     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| employee_id | int     |</span><br><span class="line">| name        | varchar |</span><br><span class="line">| salary      | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œç»™å‡ºäº†é›‡å‘˜id ï¼Œåå­—å’Œè–ªæ°´ã€‚</span><br></pre></td></tr></table></figure><p>å†™å‡ºä¸€ä¸ªSQL æŸ¥è¯¢è¯­å¥ï¼Œè®¡ç®—æ¯ä¸ªé›‡å‘˜çš„å¥–é‡‘ã€‚å¦‚æœä¸€ä¸ªé›‡å‘˜çš„idæ˜¯å¥‡æ•°å¹¶ä¸”ä»–çš„åå­—ä¸æ˜¯ä»¥â€™Mâ€™å¼€å¤´ï¼Œé‚£ä¹ˆä»–çš„å¥–é‡‘æ˜¯ä»–å·¥èµ„çš„100%ï¼Œå¦åˆ™å¥–é‡‘ä¸º0ã€‚</p><h4 id="ğŸ¤”code-1"><a href="#ğŸ¤”code-1" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#######<span class="number">1</span>########<span class="number">611</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">ifÂ (employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>,salary,<span class="number">0</span>)Â bonusÂ </span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line"></span><br><span class="line">#######<span class="number">2</span>#######<span class="number">570</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>Â <span class="keyword">then</span>Â salaryÂ <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line">#########<span class="number">3</span>########<span class="number">619</span>ms</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">=</span><span class="number">1</span>Â <span class="keyword">and</span>Â <span class="keyword">left</span>(name,<span class="number">1</span>)<span class="operator">!=</span><span class="string">&#x27;M&#x27;</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">then</span>Â salaryÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-1"><a href="#ğŸ’ªget-1" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>if:å¯ä»¥æ”¾åœ¨selectä¹‹åä½œä¸ºè¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸ºï¼š<code>if(æ¡ä»¶,Ture:è¾“å‡º1,FALSE:è¾“å‡º2) as name</code>ã€‚</li><li>caseï¼šä½œä¸ºselectçš„è¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸º:<code>case when æ¡ä»¶ then True:è¾“å‡º1 else FALSEï¼šè¾“å‡º2 end name</code>ã€‚</li><li>é™¤äº†å¯ä»¥ç”¨like â€˜M%â€™åˆ¤æ–­å­—ç¬¦ä¸²ä»¥Må¼€å¤´ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>left(å­—ç¬¦ä¸²ï¼Œlocation)</code>åˆ¤æ–­å¯¹åº”ä½ç½®ä¸Šçš„å­—æ¯ï¼Œä¾‹å¦‚<code>left(&#39;Mike&#39;,1)</code>ã€‚</li><li>åŒç†å¯ä»¥ç”¨äºå…¶ä»–æƒ…å†µå¦‚<code>updateâ€¦â€¦set()</code>ç­‰</li></ul><h4 id="ğŸ™ƒsource-1"><a href="#ğŸ™ƒsource-1" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/calculate-special-bonus/">source</a></p><h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction-2"><a href="#ğŸ™ˆIntroduction-2" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p><p>å¼ ä¸‰æœ€è¿‘å¯¹ <code>MySQL</code> æ•°æ®åº“æ„Ÿå…´è¶£ï¼Œå†³å®šè¦å¥½å¥½å­¦ä¹ æ•°æ®åº“ï¼Œä½†â€¦å­¦ä¹ çš„é“è·¯æ€»æ˜¯å……æ»¡è‰°è¾›çš„ã€‚å¼ ä¸‰ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼Œä»–å·¦æ€å³æƒ³ã€è‹¦æ€å†¥æƒ³ã€èŒ¶ä¸æ€é¥­ä¸æƒ³ä¹Ÿæ²¡èƒ½æƒ³å‡ºè§£å†³åŠæ³•ã€‚æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œç°æœ‰ <code>teachers</code> è¡¨ä¸­è®°å½•ç€ç¦»èŒçš„æ•™å¸ˆä¿¡æ¯ï¼Œ<code>id</code> çš„å€¼å³æ˜¯æ•™å¸ˆç¦»èŒçš„é¡ºåºï¼Œåœ¨ <code>courses</code> è¡¨ä¸­è®°å½•ç€æ¯ä¸ªæ•™å¸ˆæ•™æˆçš„è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” id ä¸º <code>teacher_id</code>ã€‚<strong>ç°åœ¨çŸ¥é“æ•™å¸ˆæ˜¯ä»¥å›½ç±æ¥åˆ†å›¢é˜Ÿçš„ï¼Œä¸”æ¯ä¸ªå›¢é˜Ÿçš„æˆç«‹è‡³å°‘æœ‰ <code>3</code> ä¸ªæ•™å¸ˆï¼Œè‹¥æ˜¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒï¼Œåˆ™åœ¨ <code>teachers</code> è¡¨ä¸­ä¿¡æ¯è®°å½•ä¸ºè¿ç»­ä¸”å›½ç±ç›¸åŒï¼Œç°åœ¨éœ€è¦ç»Ÿè®¡æ¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒä¼šæœ‰å¤šå°‘å­¦ç”Ÿéœ€è¦ç­‰å¾…æ–°çš„æ•™å¸ˆï¼Œç»“æœæŒ‰å›¢é˜Ÿå›½ç±æ’åº</strong>ã€‚ä»–éœ€è¦åˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v_courses_teachers</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒå­¦ä»¬å¿«æ¥å¸®å¸®å¼ ä¸‰å°ä¼™å­å§ ~</p><h4 id="ğŸ¤”code-2"><a href="#ğŸ¤”code-2" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_courses_teachers <span class="keyword">as</span> (</span><br><span class="line">Â  Â  <span class="keyword">select</span> tt.country,<span class="built_in">sum</span>(tt.student_count) student_count</span><br><span class="line">Â  Â  <span class="keyword">from</span> (</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">select</span> <span class="keyword">distinct</span> t1.id,t1.country,c.student_count</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">from</span> teachers t1 <span class="keyword">left</span> <span class="keyword">join</span> teachers t2</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">on</span> t1.id<span class="operator">=</span>t2.id<span class="number">-1</span> <span class="keyword">or</span> t1.id<span class="operator">=</span>t2.id<span class="operator">+</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> courses c <span class="keyword">on</span> t1.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">where</span> t1.country<span class="operator">=</span>t2.country</span><br><span class="line">Â  Â  ) tt</span><br><span class="line">Â  Â  <span class="keyword">group</span> <span class="keyword">by</span> tt.country</span><br><span class="line">Â  Â  <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-2"><a href="#ğŸ’ªget-2" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>joinæ˜¯å°†è¡¨é“¾æ¥åœ¨æºè¡¨åï¼Œ<code>t1.id=t2.id-1 or t1.id=t2.id+1</code>ä¼šå‡ºç°æœ€å¤šä¸‰è¡Œ</li><li>groupé™¤äº†åˆ†ç»„åˆ—ï¼Œå…¶ä»–åˆ—å¯èƒ½åŒ…å«å¤šä¸ªå€¼ï¼Œå®¹æ˜“BUG</li></ul><h4 id="ğŸ™ƒsource-2"><a href="#ğŸ™ƒsource-2" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/learn/130/664">source</a></p><h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction-3"><a href="#ğŸ™ˆIntroduction-3" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>å¼ ä¸‰æ›¾ç»æœ‰ä¸€ä¸ªæ¢¦æƒ³ï¼Œæƒ³è¦å¬éå­¦æ ¡é‡Œçš„æ¯ä¸€ä½æ•™å¸ˆçš„è¯¾ç¨‹ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè§†å›¾ <code>v_mydream</code> å±•ç¤ºäº†æ‰€æœ‰çš„è¯¾ç¨‹ä¸æˆè¯¾æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå¹¶æŒ‰æ•™å¸ˆå§“åå‡åºå»å®ç°ï¼Œä½†æ˜¯å¼ ä¸‰å‘ç°è¯¾ç¨‹å®åœ¨æ˜¯å¤ªå¤šå¤ªå¤šï¼Œæ¢¦æƒ³éœ€è¦æ”¹ä¸€æ”¹ï¼Œäºæ˜¯ä»–æŠŠæ¢¦æƒ³æ”¹æˆäº†å»å¬<strong>æ¯ä¸€ä½æ•™å¸ˆæœ€å—æ¬¢è¿çš„è¯¾ç¨‹ï¼ˆå¬è¯¾å­¦ç”Ÿè¶Šå¤šè¶Šå—æ¬¢è¿ï¼Œå¦‚æœè¯¥æ•™å¸ˆæ²¡æœ‰æ•™æˆè¯¾ç¨‹åˆ™è¯¾ç¨‹ä¸å­¦ç”Ÿæ•°æ˜¾ç¤ºä¸º <code>NULL</code>ï¼‰</strong>ï¼Œå­¦æ ¡ä¹Ÿéå¸¸æ”¯æŒä»–ï¼Œå¬è¯´ä»–æœ€è¿‘åœ¨å­¦ <code>MySQL</code>ï¼Œå°±ç»™äº†ä»– <code>2</code> å¼ è¡¨çš„æ•°æ®è®©ä»–è‡ªå·±å»æ‰¾ï¼Œ<code>teachers</code> è¡¨ä¸­è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œ<code>courses</code> è¡¨ä¸­è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ã€‚å¼ ä¸‰ä¸€çœ‹ï¼Œâ€œ å“‡~ è¿™ä¹Ÿå¤ªç®€å•äº†ï¼Œæ„Ÿè°¢å­¦æ ¡å¤§å¤§æä¾›çš„æ•°æ® â€ï¼Œå¯æ˜¯ä»–æ­£è¦æŠŠåŸæ¥çš„æ¢¦æƒ³è§†å›¾æ”¹å†™ï¼Œå°±å‘ç°æå››ä»æ—è¾¹è¿‡ã€‚æå››è‚šå­é¥¿çš„å‘±å‘±å«ï¼Œçœ‹åˆ°å¼ ä¸‰å°±é—®è¦ä¸è¦ä¸€èµ·å»åƒé¥­ï¼Œå¼ ä¸‰çµå…‰ä¸€é—ªï¼Œâ€œ è¿™ä¹ˆå·§~ æˆ‘ä¹Ÿæ‰“ç®—å»åƒé¥­ï¼Œä½†æ˜¯ç°åœ¨æˆ‘è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œä½ å¸®æˆ‘è§£å†³äº†æˆ‘å°±è¯·ä½ åƒé¥­ â€ï¼Œæå››ä¸€å¬è¿˜æœ‰è¿™ç­‰å¥½äº‹ï¼Œç«‹é©¬ç­”åº”ä¸‹æ¥äº†ï¼Œç»“æœå‘ç°ä¸ä¼šã€‚ä¸ºäº†ä¸æ‰é¢å­å¹¶ä¸”èƒ½åƒä¸Šä¸€é¡¿ï¼Œå°±å·å·è”ç³»äº†ä½ ï¼Œè¯·æ±‚ä½ å¸®ä»–è§£å†³ã€‚</p><h4 id="ğŸ¤”code-3"><a href="#ğŸ¤”code-3" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_mydream <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> teacher_name,course_name,student_count</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">select</span> t.name teacher_name,c.name course_name,student_count,</span><br><span class="line">Â  Â  Â <span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> t.id <span class="keyword">order</span> <span class="keyword">by</span> student_count <span class="keyword">desc</span>) num</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â <span class="keyword">left</span> <span class="keyword">join</span> courses c</span><br><span class="line">Â  Â  Â <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">) tt</span><br><span class="line"><span class="keyword">where</span> tt.num<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> teacher_name;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-3"><a href="#ğŸ’ªget-3" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ol><li><code>DENSE_RANK()</code> å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span>[&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], [&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</li></ol><ul><li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥å°†<code>FROM</code>å­å¥ç”Ÿæˆçš„ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºæ¯ä¸ªåˆ†åŒºã€‚</li><li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>  å­å¥æŒ‡å®š<code>DENSE_RANK()</code>å‡½æ•°æ“ä½œçš„æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œé¡ºåºã€‚<br>å¦‚æœåˆ†åŒºå…·æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šå…·æœ‰ç›¸åŒæ’åå€¼çš„è¡Œï¼Œåˆ™å°†ä¸ºè¿™äº›è¡Œä¸­çš„æ¯ä¸€è¡Œåˆ†é…ç›¸åŒçš„æ’åã€‚<br>ä¸<a href="https://zhuanlan.zhihu.com/p/133469603#:~:text=%E5%85%88%E4%B8%8A%E7%BB%93%E8%AE%BA%EF%BC%8C%E4%B8%89%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB%E5%A6%82%E4%B8%8B%EF%BC%9A%20rank,%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%B8%8D%E5%8F%98%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%813%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B%20dense_rank%20%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%BC%9A%E5%87%8F%E5%B0%91%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%812%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B">Rank</a><code>å‡½æ•°ä¸åŒï¼Œ</code>DENSE_RANK()`å‡½æ•°å§‹ç»ˆè¿”å›è¿ç»­çš„æ’åå€¼ã€‚<br>eee<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sales;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    sales_employee,</span><br><span class="line">    fiscal_year,</span><br><span class="line">    sale,</span><br><span class="line">    <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span></span><br><span class="line">                     fiscal_year</span><br><span class="line">                 <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">                     sale <span class="keyword">DESC</span></span><br><span class="line">                ) sales_rank</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    sales;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span> sales_rank <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥ä½¿ç”¨ä¼šè®¡å¹´åº¦å°†ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚</li><li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>æ¡æ¬¾æŒ‰é”€å”®é¢çš„é™åºæŒ‡å®šäº†é”€å”®å‘˜å·¥çš„é¡ºåºã€‚</li><li>ç¬¬ä¸‰ï¼Œ<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºå…·æœ‰<code>ORDER BY</code>å­å¥æŒ‡å®šçš„è¡Œé¡ºåºçš„æ¯ä¸ªåˆ†åŒºã€‚</li></ul><p><code>rank()/dense_rank()/row_number()çš„åŒºåˆ«ï¼š</code></p><ul><li>rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¸å˜ï¼Œå³ä¼šå‡ºç°1ã€1ã€3è¿™æ ·çš„æ’åºç»“æœï¼›</li><li>dense_rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¼šå‡å°‘ï¼Œå³ä¼šå‡ºç°1ã€1ã€2è¿™æ ·çš„æ’åºç»“æœï¼›</li><li>row_number()æ’åºç›¸åŒæ—¶ä¸ä¼šé‡å¤ï¼Œä¼šæ ¹æ®é¡ºåºæ’åºã€‚<h4 id="ğŸ™ƒsource-3"><a href="#ğŸ™ƒsource-3" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/learn/132/668">source</a><br><a href="https://www.begtut.com/mysql/mysql-dense_rank-function.html">DENSE_RANK</a><br><a href="https://blog.csdn.net/qq_44690947/article/details/109133592">max()ä¸group by()</a></li></ul><h2 id="ä¿®å¤è¡¨ä¸­çš„åå­—"><a href="#ä¿®å¤è¡¨ä¸­çš„åå­—" class="headerlink" title="ä¿®å¤è¡¨ä¸­çš„åå­—"></a>ä¿®å¤è¡¨ä¸­çš„åå­—</h2><p>2022-04-24</p><h4 id="ğŸ™ˆIntroduction-4"><a href="#ğŸ™ˆIntroduction-4" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> user_id        <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name           <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">user_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«ç”¨æˆ·çš„ ID å’Œåå­—ã€‚åå­—ä»…ç”±å°å†™å’Œå¤§å†™å­—ç¬¦ç»„æˆã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥ä¿®å¤åå­—ï¼Œä½¿å¾—åªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¤§å†™çš„ï¼Œå…¶ä½™éƒ½æ˜¯å°å†™çš„ã€‚</p><p>è¿”å›æŒ‰ <code>user_id</code> æ’åºçš„ç»“æœè¡¨ã€‚</p><h4 id="ğŸ¤”code-4"><a href="#ğŸ¤”code-4" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â user_id,concat(<span class="built_in">upper</span>(<span class="keyword">left</span>(name,<span class="number">1</span>)),<span class="built_in">lower</span>(substr(name,<span class="number">2</span>)))Â name</span><br><span class="line"><span class="keyword">from</span>Â Users</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â user_id;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-4"><a href="#ğŸ’ªget-4" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>å­—ç¬¦ä¸²å¤„ç†å‡½æ•°<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;My&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;QL&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;MySQL&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;foobarbar&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;fooba&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;QUADRATICALLY&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;quadratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;Quadratically&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;ratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;Hej&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;HEJ&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ™ƒsource-4"><a href="#ğŸ™ƒsource-4" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/fix-names-in-a-table/">source</a><h2 id="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"><a href="#æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…" class="headerlink" title="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"></a>æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</h2>2022-04-24</li></ul><h4 id="ğŸ™ˆIntroduction-5"><a href="#ğŸ™ˆIntroduction-5" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> patient_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> patient_name <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> conditions   <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line">patient_id ï¼ˆæ‚£è€… IDï¼‰æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line"><span class="string">&#x27;conditions&#x27;</span> ï¼ˆç–¾ç—…ï¼‰åŒ…å« <span class="number">0</span> ä¸ªæˆ–ä»¥ä¸Šçš„ç–¾ç—…ä»£ç ï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚</span><br><span class="line">è¿™ä¸ªè¡¨åŒ…å«åŒ»é™¢ä¸­æ‚£è€…çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>å†™ä¸€æ¡ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ‚£æœ‰ I ç±»ç³–å°¿ç—…çš„æ‚£è€… ID ï¼ˆpatient_idï¼‰ã€æ‚£è€…å§“åï¼ˆpatient_nameï¼‰ä»¥åŠå…¶æ‚£æœ‰çš„æ‰€æœ‰ç–¾ç—…ä»£ç ï¼ˆconditionsï¼‰ã€‚I ç±»ç³–å°¿ç—…çš„ä»£ç æ€»æ˜¯åŒ…å«å‰ç¼€ DIAB1 ã€‚</p><p>æŒ‰ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p><h4 id="ğŸ¤”code-5"><a href="#ğŸ¤”code-5" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â patient_id,patient_name,conditions</span><br><span class="line"><span class="keyword">from</span>Â Patients</span><br><span class="line"><span class="keyword">where</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;DIAB1%&#x27;</span>Â <span class="keyword">or</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;%Â DIAB1%&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-5"><a href="#ğŸ’ªget-5" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>å¤šæ¡ä»¶[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨LIKEæ¨¡ç³ŠæŸ¥è¯¢|like]]:<code>where conditions like &#39;condition1&#39; or/and conditions like &#39;condition2&#39;</code></li><li><code>%</code>åŒ¹é…ï¼š<code>%con</code>ä»¥conå¼€å¤´ï¼Œ<code>% con</code>ä»¥ conå¼€å¤´<h4 id="ğŸ™ƒsource-5"><a href="#ğŸ™ƒsource-5" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/patients-with-a-condition/">source</a><h2 id="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"><a href="#æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“" class="headerlink" title="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"></a>æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</h2>2022-04-24</li></ul><h4 id="ğŸ™ˆIntroduction-6"><a href="#ğŸ™ˆIntroduction-6" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> åˆ—å         <span class="operator">|</span> ç±»å‹    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> sell_date   <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product     <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">æ­¤è¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«äº§å“åç§°å’Œåœ¨å¸‚åœºä¸Šé”€å”®çš„æ—¥æœŸã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥æŸ¥æ‰¾æ¯ä¸ªæ—¥æœŸã€é”€å”®çš„ä¸åŒäº§å“çš„æ•°é‡åŠå…¶åç§°ã€‚<br>æ¯ä¸ªæ—¥æœŸçš„é”€å”®äº§å“åç§°åº”æŒ‰è¯å…¸åºæ’åˆ—ã€‚<br>è¿”å›æŒ‰ sell_date æ’åºçš„ç»“æœè¡¨ã€‚<br>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p><h4 id="ğŸ¤”code-6"><a href="#ğŸ¤”code-6" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â sell_date,<span class="built_in">count</span>(<span class="keyword">distinct</span>Â product)Â num_sold,group_concat(<span class="keyword">distinct</span>Â product)Â products</span><br><span class="line"><span class="keyword">from</span>Â Activities</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â sell_date</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â sell_dateÂ <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-6"><a href="#ğŸ’ªget-6" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>[[å‡½æ•°#ä½¿ç”¨ COUNT å‡½æ•°è®¡æ•°|count()]]èšåˆå‡½æ•°æ­é…<code>group</code>ä½¿ç”¨ï¼Œå®ç°åˆ†ç»„è®¡æ•°ã€‚</li><li><code>group_concat</code>å¯¹åˆ†ç»„å†…å®¹è¿›è¡Œæ‹¼æ¥ï¼Œè‹¥ä¸æ‹¼æ¥ç›´æ¥è¾“å‡ºä¸ºç¬¬ä¸€ä¸ªå€¼ã€‚<br>concatå’Œgroup_concatçš„åŒºåˆ«ï¼š</li></ul><ol><li>concatæ˜¯é’ˆå¯¹ä»¥è¡Œæ•°æ®åšçš„æ‹¼æ¥ï¼Œè€Œgroup_concatæ˜¯é’ˆå¯¹åˆ—åšçš„æ•°æ®æ‹¼æ¥ï¼Œä¸”group_concatè‡ªåŠ¨ç”Ÿæˆé€—å·ã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--concat</span></span><br><span class="line"><span class="keyword">select</span> concat(id, &quot;,&quot;, classId) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="comment">--group_concat</span></span><br><span class="line"><span class="comment">--ä¸€èˆ¬ä¸group byç»“åˆä½¿ç”¨</span></span><br><span class="line"><span class="keyword">select</span> group_concat(username) <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">group</span> <span class="keyword">by</span> classId;</span><br></pre></td></tr></table></figure><h4 id="ğŸ™ƒsource-6"><a href="#ğŸ™ƒsource-6" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/group-sold-products-by-the-date/">source</a><h2 id="å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››"><a href="#å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››" class="headerlink" title="å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››"></a>å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››</h2>2022-04-24</li></ol><h4 id="ğŸ™ˆIntroduction-7"><a href="#ğŸ™ˆIntroduction-7" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>â€œä»Šæ™šçš„æœˆè‰²çœŸç¾å•Š~ â€ï¼Œå¼ ä¸‰ä¸€ä¸ªäººåœ¨èµæœˆï¼Œè¿™ç¾å¦™çš„æ—¶åˆ»ä¹Ÿåªæœ‰åœ¨å­¦ä¹ ç»“æŸåæ‰èƒ½æ„Ÿå—åˆ°ï¼Œä»Šå¤©å¼ ä¸‰åˆšå¼€å§‹å­¦å­˜å‚¨è¿‡ç¨‹ï¼Œä»–å‘ç°è¿™æ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿å•Šï¼Œå­¦å®Œä¹‹åå†èµä¸ªæœˆçœŸæ˜¯ç¾æ»‹æ»‹ã€‚è¿™æ—¶å€™ï¼ŒæŸæ•™å¸ˆç»™ä»–æ‰“äº†ä¸€ä¸ªç”µè¯ï¼Œç›´æ¥å°±æ¯äº†ä»–è¿™ä¸ªç¾å¦™çš„å¤œæ™šã€‚æŸæ•™å¸ˆè¯´å¸®ä»–æ•´ä¸ªæ´»ï¼Œç³»é‡Œç°åœ¨å‡†å¤‡å¹´è½»åŒ–ã€æ´»åŠ›åŒ–æ•™å¸ˆå›¢é˜Ÿï¼Œ<strong>ä¸Šå¤šé—¨è¯¾ï¼ˆè‡³å°‘ 2 é—¨è¯¾ï¼‰çš„æ•™å¸ˆå°±æ˜¯æ´»è·ƒæ•™å¸ˆ</strong>ï¼Œä½†æ˜¯ç°åœ¨æ•™å¸ˆä¸­æœ‰äº›å¹´è½»äººå•Šå–œæ¬¢å·æ‡’ï¼Œåªä¸Š 1 é—¨è¯¾æˆ–æ˜¯ä¸ä¸Šè¯¾ï¼Œäºæ˜¯è¦<strong>å°†æ´»è·ƒæ•™å¸ˆä¸­å¹´é¾„æœ€å¤§çš„æ•™å¸ˆæ‰€æ•™æˆçš„è¯¾ç¨‹å…¨éƒ¨äº¤ç»™ä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„æ•™å¸ˆï¼ˆå¦‚æœå¹´é¾„ç›¸åŒå°±æŒ‰å§“åé¡ºåºï¼‰ï¼Œç›´åˆ°æ•´ä¸ªæ•™å¸ˆå›¢é˜Ÿæ˜¾å¾—æ›´å¹´è½»åŒ–ã€æ´»åŠ›åŒ–ï¼Œè€Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„è¦æ±‚ä¸èƒ½å¤§äºå…¨ä½“æ•™å¸ˆçš„å¹³å‡å¹´é¾„</strong>ï¼Œè€Œä¸”è¿™ä¸ªå·¥ä½œä¼šå®šæœŸåšçš„ï¼Œç”±äºä¸šåŠ¡ç¹å¿™ï¼Œç„¶åä¸¢ç»™å¼ ä¸‰ 2 å¼ è¡¨è®©å¼ ä¸‰å¸®ä»–åšï¼Œ<code>teachers</code> è¡¨è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå’Œ <code>courses</code> è¡¨è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” <code>id</code> ä¸º <code>teacher_id</code>ã€‚å¼ ä¸‰æœ¬ä¸æƒ³æ¥è¿™ä¸ªæ´»ï¼Œä½†æ˜¯çªç„¶çµå…‰ä¸€é—ªå°±ç­”åº”äº†ï¼Œè°ˆå¦¥æ¡ä»¶ä»¥åï¼Œå¼ ä¸‰å›å¤´å°±ç”¨å­˜å‚¨è¿‡ç¨‹ç»™ä»–å†™å‡ºæ¥äº†å¹¶ä¸”ä¸å‘Šè¯‰æŸæ•™å¸ˆã€‚æ•™å¸ˆå¬è¯´å¼ ä¸‰å¹¶ä¸æ˜¯æ‰‹åŠ¨ç»™ä»–åšçš„ï¼Œäºæ˜¯æƒ³è¦æŒ–å‡ºå¼ ä¸‰æ˜¯æ€ä¹ˆåšçš„ï¼Œé€šè¿‡æ‰“å¬åªçŸ¥é“æ˜¯ç”¨äº†å­˜å‚¨è¿‡ç¨‹ï¼Œä½œä¸ºæ•™å¸ˆï¼Œæˆ‘å½“ç„¶è¦è‡ªå·±å†™äº†ï¼Œæ€ä¹ˆèƒ½è®©å¼ ä¸‰é‚£å°å­æ‹¿å¥½å¤„ï¼Ÿå°ä¼™å­ï¼Œå¿«æ¥å¤ç°ä¸€ä¸‹è¿™ä¸ªå­˜å‚¨è¿‡ç¨‹å§</p><h4 id="ğŸ¤”code-7"><a href="#ğŸ¤”code-7" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> youngTeachers ()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> oldt <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æœ€å¤§å¹´é¾„æ•™å¸ˆ</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> tid <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--ä¸æ´»è·ƒä¸”æœ€å¹´è½»</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> actnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æ´»è·ƒçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> notactnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â loop1:loop</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> actnum <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰€æœ‰è€å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> notactnum <span class="keyword">from</span> teachers;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--åˆ¤æ–­å¹´é¾„æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">Â  Â  Â  Â  Â  if actnum<span class="operator">&lt;=</span>notactnum <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â leave loop1;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">end</span> if;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºå¹´é¾„æœ€å¤§çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> oldt <span class="keyword">from</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> t.age <span class="keyword">desc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> tid</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&lt;=</span><span class="number">1</span> <span class="keyword">or</span> c.num <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>,t.name <span class="keyword">asc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ›´æ–°æ•°æ®</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">update</span> courses</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> teacher_id<span class="operator">=</span>tid <span class="keyword">where</span> teacher_id<span class="operator">=</span>oldt;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> youngTeachers();</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-7"><a href="#ğŸ’ªget-7" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>[[å­˜å‚¨è¿‡ç¨‹]]</li><li>sqlå¾ªç¯è¿‡ç¨‹![[å­˜å‚¨è¿‡ç¨‹#å¾ªç¯è¯­å¥]]</li></ul><h4 id="ğŸ™ƒsource-7"><a href="#ğŸ™ƒsource-7" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/2800/description">source</a></p><h2 id="ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜"><a href="#ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜" class="headerlink" title="ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜"></a>ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction-8"><a href="#ğŸ™ˆIntroduction-8" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨: <code>Employees</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> employee_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name        <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ¯ä¸€è¡Œè¡¨ç¤ºé›‡å‘˜çš„id å’Œä»–çš„å§“åã€‚</span><br></pre></td></tr></table></figure><br>è¡¨: <code>Salaries</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> employee_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">employee_id <span class="keyword">is</span> è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ¯ä¸€è¡Œè¡¨ç¤ºé›‡å‘˜çš„id å’Œä»–çš„è–ªæ°´ã€‚</span><br></pre></td></tr></table></figure></p><p>å†™å‡ºä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œæ‰¾åˆ°æ‰€æœ‰ ä¸¢å¤±ä¿¡æ¯ çš„é›‡å‘˜idã€‚å½“æ»¡è¶³ä¸‹é¢ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œå°±è¢«è®¤ä¸ºæ˜¯é›‡å‘˜çš„ä¿¡æ¯ä¸¢å¤±ï¼š</p><pre><code>é›‡å‘˜çš„ å§“å ä¸¢å¤±äº†ï¼Œæˆ–è€…é›‡å‘˜çš„ è–ªæ°´ä¿¡æ¯ ä¸¢å¤±äº†ï¼Œæˆ–è€…</code></pre><p>è¿”å›è¿™äº›é›‡å‘˜çš„id  employee_id ï¼Œ ä»å°åˆ°å¤§æ’åº ã€‚</p><h4 id="ğŸ¤”code-8"><a href="#ğŸ¤”code-8" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â ee.employee_idÂ <span class="keyword">from</span>(</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â e.employee_idÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">from</span>Â EmployeesÂ eÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â SalariesÂ sÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">on</span>Â e.employee_id<span class="operator">=</span>s.employee_id</span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â s.employee_idÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">from</span>Â EmployeesÂ eÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">right</span>Â <span class="keyword">join</span>Â SalariesÂ sÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">on</span>Â e.employee_id<span class="operator">=</span>s.employee_id</span><br><span class="line"></span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">where</span>Â ee.employee_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>(<span class="keyword">select</span>Â employee_idÂ <span class="keyword">from</span>Â Employees)Â <span class="keyword">or</span>Â ee.employee_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (<span class="keyword">select</span>Â employee_idÂ <span class="keyword">from</span>Â Salaries)Â </span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â ee.employee_id;</span><br><span class="line"><span class="comment">------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> employee_id <span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> employee_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> employee_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> employee_id <span class="keyword">from</span> employees)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> employee_id</span><br><span class="line"></span><br><span class="line"><span class="comment">--second version</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    employee_id </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    (</span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> employees</span><br><span class="line">    <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">    employee_id</span><br><span class="line"><span class="keyword">having</span> </span><br><span class="line">    <span class="built_in">count</span>(employee_id) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">    employee_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> employees </span><br><span class="line">    <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">employee_id</span><br><span class="line"><span class="keyword">from</span> tmp t <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">having</span> <span class="built_in">count</span>(<span class="number">1</span>)<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-8"><a href="#ğŸ’ªget-8" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>unionå’Œunion all</code>:<blockquote><p><strong>Union:å¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œä¸åŒ…æ‹¬é‡å¤è¡Œï¼ŒåŒæ—¶è¿›è¡Œé»˜è®¤è§„åˆ™çš„æ’åºï¼›</strong><br> UNIONåœ¨è¿›è¡Œè¡¨é“¾æ¥åä¼š<code>ç­›é€‰æ‰é‡å¤çš„è®°å½•</code>ï¼Œæ‰€ä»¥åœ¨è¡¨é“¾æ¥åä¼šå¯¹æ‰€äº§ç”Ÿçš„ç»“æœé›†è¿›è¡Œæ’åºè¿ç®—ï¼Œåˆ é™¤é‡å¤çš„è®°å½•å†è¿”å›ç»“æœã€‚<br> <strong>Union Allï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œ<code>åŒ…æ‹¬é‡å¤è¡Œï¼Œä¸è¿›è¡Œæ’åº</code>ï¼›</strong></p></blockquote></li><li>[[è”ç»“#å¤–è¿æ¥ OUTER JOIN|å…¨å¤–è¿æ¥]]ï¼š<code>a left join b union a right join b on â€¦â€¦</code>ã€‚å·¦ä¾§ä¸ºaè¡¨ï¼Œå³ä¾§ä¸ºbè¡¨ï¼Œbä¸­æœ‰aä¸­æ²¡æœ‰çš„å¡«å……nullã€‚<h4 id="ğŸ™ƒsource-8"><a href="#ğŸ™ƒsource-8" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="">source</a><br><a href="https://blog.csdn.net/u010931123/article/details/82425580">union/union all</a><h2 id="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"><a href="#æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼" class="headerlink" title="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"></a>æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</h2>2022-04-25</li></ul><h4 id="ğŸ™ˆIntroduction-9"><a href="#ğŸ™ˆIntroduction-9" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Products</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> product_id  <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store1      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store2      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store3      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">è¿™å¼ è¡¨çš„ä¸»é”®æ˜¯product_idï¼ˆäº§å“Idï¼‰ã€‚</span><br><span class="line">æ¯è¡Œå­˜å‚¨äº†è¿™ä¸€äº§å“åœ¨ä¸åŒå•†åº—store1, store2, store3çš„ä»·æ ¼ã€‚</span><br><span class="line">å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™å€¼å°†ä¸º<span class="keyword">null</span>ã€‚</span><br></pre></td></tr></table></figure><br>è¯·ä½ é‡æ„ Products è¡¨ï¼ŒæŸ¥è¯¢æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼ï¼Œä½¿å¾—è¾“å‡ºçš„æ ¼å¼å˜ä¸º(product_id, store, price) ã€‚å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™ä¸è¾“å‡ºè¿™ä¸€è¡Œã€‚</p><p>è¾“å‡ºç»“æœè¡¨ä¸­çš„ é¡ºåºä¸ä½œè¦æ±‚ ã€‚</p><h4 id="ğŸ¤”code-9"><a href="#ğŸ¤”code-9" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â product_id,store,priceÂ <span class="keyword">from</span>(</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store1&#x27;</span>Â store,store1Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store1 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store2&#x27;</span>Â store,store2Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store2 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store3&#x27;</span>Â store,store3Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store3 is not null</span></span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">where</span>Â priceÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-9"><a href="#ğŸ’ªget-9" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>è®¾ç½®å¸¸é‡åˆ—<code>select &#39;a&#39; coloum</code></li><li>è¡Œè½¬åˆ—å¸¸ç”¨<code>case when</code>å’Œ<code>union all</code><br><img src="https://pic.leetcode-cn.com/1627441221-KvsJUP-%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87.png" alt="object"></li></ul><p><strong>è¡Œè½¬åˆ—â€”â€”MAX/SUM+CASE WHEN+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è¯­æ–‡&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;æ•°å­¦&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è‹±è¯­&quot;</span><br><span class="line"><span class="keyword">FROM</span> student1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name</span><br></pre></td></tr></table></figure></p><p><strong>åˆ—è½¬è¡Œâ€”â€”MAX+UNION+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è¯­æ–‡&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;æ•°å­¦&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è‹±è¯­&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br></pre></td></tr></table></figure></p><h4 id="ğŸ™ƒsource-9"><a href="#ğŸ™ƒsource-9" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p><h2 id="æ ‘èŠ‚ç‚¹"><a href="#æ ‘èŠ‚ç‚¹" class="headerlink" title="æ ‘èŠ‚ç‚¹"></a>æ ‘èŠ‚ç‚¹</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction-10"><a href="#ğŸ™ˆIntroduction-10" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™å®šä¸€ä¸ªè¡¨ <code>tree</code>ï¼Œ<strong>id</strong> æ˜¯æ ‘èŠ‚ç‚¹çš„ç¼–å·ï¼Œ <strong>p_id</strong> æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„ <strong>id ã€‚</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> p_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> <span class="keyword">null</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure><br>æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å±äºä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š</p><pre><code>å¶å­ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä»»ä½•å­©å­èŠ‚ç‚¹ã€‚æ ¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯æ•´æ£µæ ‘çš„æ ¹ï¼Œå³æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚å†…éƒ¨èŠ‚ç‚¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ—¢ä¸æ˜¯å¶å­èŠ‚ç‚¹ä¹Ÿä¸æ˜¯æ ¹èŠ‚ç‚¹ã€‚</code></pre><p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¾“å‡ºæ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·å’ŒèŠ‚ç‚¹çš„ç±»å‹ï¼Œå¹¶å°†ç»“æœæŒ‰ç…§èŠ‚ç‚¹ç¼–å·æ’åºã€‚ä¸Šé¢æ ·ä¾‹çš„ç»“æœä¸ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> Root <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="keyword">Inner</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure></p><h4 id="ğŸ¤”code-10"><a href="#ğŸ¤”code-10" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â id,TypeÂ <span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Root&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Inner&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>Â <span class="keyword">and</span>Â p_id<span class="operator">!=</span>(<span class="keyword">select</span>Â idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span>))</span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Leaf&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>)</span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â id;</span><br><span class="line"><span class="comment">--answer</span></span><br><span class="line"># æ ¹ç»“ç‚¹: æ²¡æœ‰çˆ¶èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Root&#x27;</span> <span class="keyword">AS</span> TYPE </span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># ä¸­é—´èŠ‚ç‚¹: æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># å¶å­ç»“ç‚¹: ä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"># æ³¨æ„:è¿™é‡Œè¿˜éœ€é™åˆ¶â€œä¸æ˜¯æ ¹èŠ‚ç‚¹â€ æ˜¯å› ä¸ºå½“æ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ æ ¹èŠ‚ç‚¹ä¹Ÿä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ </span><br><span class="line"># æ³¨æ„:ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)é‡Œé¢è¦é™åˆ¶P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"># å¦åˆ™<span class="keyword">SELECT</span>å‡ºæ¥çš„ç»“æœé‡Œé¢æœ‰<span class="keyword">NULL</span> è¿™å¥è¯è¿”å›ç©ºåˆ—è¡¨ (æˆ‘ä¹Ÿä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆ)</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">id,</span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> p_id <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;Root&#x27;</span></span><br><span class="line"> <span class="keyword">WHEN</span> id <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> p_id <span class="keyword">from</span> tree) <span class="keyword">then</span> <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">end</span> <span class="keyword">as</span> type</span><br><span class="line"><span class="keyword">from</span> tree;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-10"><a href="#ğŸ’ªget-10" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource-10"><a href="#ğŸ™ƒsource-10" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p><h2 id="ç¬¬äºŒé«˜çš„è–ªæ°´"><a href="#ç¬¬äºŒé«˜çš„è–ªæ°´" class="headerlink" title="ç¬¬äºŒé«˜çš„è–ªæ°´"></a>ç¬¬äºŒé«˜çš„è–ªæ°´</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction-11"><a href="#ğŸ™ˆIntroduction-11" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p><code>Employee</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary      <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line">id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å‘˜å·¥çš„å·¥èµ„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å–å¹¶è¿”å› <code>Employee</code> è¡¨ä¸­ç¬¬äºŒé«˜çš„è–ªæ°´ ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ŒæŸ¥è¯¢åº”è¯¥è¿”å› <code>null</code> ã€‚</p><h4 id="ğŸ¤”code-11"><a href="#ğŸ¤”code-11" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">SELECT</span>Â <span class="built_in">max</span>(Salary)Â SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span>Â EmployeeÂ Â </span><br><span class="line"><span class="keyword">where</span>Â SalaryÂ <span class="operator">!=</span>Â (<span class="keyword">select</span>Â <span class="built_in">max</span>(Salary)Â <span class="keyword">from</span>Â EmployeeÂ );</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="comment">--ä½¿ç”¨selectè¾“å‡ºï¼Œå¦åˆ™å½“ä¸å­˜åœ¨ç¬¬äºŒé«˜æ—¶å€™è¾“å‡ºä¸ºç©ºè€Œä¸æ˜¯null</span></span><br><span class="line"><span class="keyword">SELECT</span> (</span><br><span class="line">       <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">       <span class="keyword">FROM</span> Employee</span><br><span class="line">       <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">       LIMIT <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">) SecondHighestSalary;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-11"><a href="#ğŸ’ªget-11" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>limit m,n</code>ï¼šmä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè¦å–çš„æ•°æ®æ•°é‡ã€‚</li><li><code>limit m</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡</li><li><code>limit m offset n</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡<br>[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨ LIMIT é™åˆ¶è¾“å‡ºè¡Œæ•°|limitåŸºç¡€]]<h4 id="ğŸ™ƒsource-11"><a href="#ğŸ™ƒsource-11" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/second-highest-salary/">source</a></li></ul><h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction-12"><a href="#ğŸ™ˆIntroduction-12" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p><p>å¼ ä¸‰åœ¨å®¿èˆé‡Œæ‰“æ¸¸æˆï¼Œä»Šå¤©è¿æ°”ä¸å¤ªå¥½ï¼Œæ€»æ˜¯è¢«åŒ¹é…çš„é˜Ÿå‹å‘ï¼Œæ°”å¾—å¼ ä¸‰ç›´æ¥å°±æŠŠæ¸¸æˆç»™å¸è½½äº†ã€‚æ²¡å¿ƒæƒ…å»åƒé¥­çš„å¼ ä¸‰æ‰“å¼€ QQï¼Œå‘ç°æœ‰ 999+ çš„ä¿¡æ¯ï¼ŒåŸæ¥æ˜¯å­¦æ ¡çš„è€å¸ˆç»™ä»–å‘æ¥çš„æ¶ˆæ¯ï¼Œæƒ³è¦ä»–å¸®å¿™åˆ›å»ºä¸€ä¸ª SQL è§†å›¾ <code>v_best_teachers</code>ï¼Œè¦ä»–èµ¶ç´§å†™å¥½å‘è¿‡å»ã€‚å¼ ä¸‰çœ‹äº†çœ‹éœ€æ±‚ï¼Œè¾¹çœ‹è¦æ±‚è¾¹å†™ SQLï¼Œç»“æœå‘ç°â€¦ä¸å¯¹ï¼<strong>å­¦æ ¡çš„è¦æ±‚æ˜¯æŸ¥å‡ºæ¯ä¸ªå›½å®¶æœ€å—æ¬¢è¿çš„è€å¸ˆä¿¡æ¯ï¼ˆå¬è¯¾å­¦ç”Ÿæ•°è¶Šå¤šè¶Šå—æ¬¢è¿ï¼‰ï¼Œå¹¶æŒ‰å›½ç±å‡åºæ’åº</strong>ã€‚ç°åœ¨å¼ ä¸‰åœ¨çŸ¥è¯†åˆ†äº«è¿‡ç¨‹ä¸­ï¼Œæ‹¿è¿™é“é¢˜æ¥è€ƒä½ ï¼Œå¹¶å˜²è®½ä½ ä¸èƒ½åšå‡ºæ¥â€¦â€¦å°ä¼™å­ï¼Œæ‰“è„¸å¼ ä¸‰çš„æ—¶å€™åˆ°äº†ï¼Œè¿˜åœ¨ç­‰ä»€ä¹ˆ ï¼Ÿå†²</p><h4 id="ğŸ¤”code-12"><a href="#ğŸ¤”code-12" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> teacher_id, student_count, country, email</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">    <span class="keyword">from</span> courses c </span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">    <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) a</span><br><span class="line"><span class="keyword">where</span> (student_count, country) <span class="keyword">in</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(student_count), country</span><br><span class="line">    <span class="keyword">from</span>(</span><br><span class="line">        <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">        <span class="keyword">from</span> courses c </span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">        <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">        <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) aa</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> country)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> if <span class="keyword">exists</span> v_best_teachers;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_best_teachers  <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> teacher_id,student_count,country,email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> id <span class="keyword">as</span> teacher_id,<span class="built_in">max</span>(student_count) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country ) <span class="keyword">as</span> student_count_1,country,email</span><br><span class="line">    ,student_count</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> a.id, email,country,<span class="built_in">sum</span>(student_count)</span><br><span class="line">        <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a.id,country) <span class="keyword">as</span> student_count</span><br><span class="line">        <span class="keyword">from</span> teachers a</span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> courses b </span><br><span class="line">        <span class="keyword">on</span> a.id <span class="operator">=</span> b.teacher_id </span><br><span class="line">        ) t </span><br><span class="line">    ) tt </span><br><span class="line"><span class="keyword">where</span> tt.student_count_1 <span class="operator">=</span>tt.student_count</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> ct.teacher_id <span class="keyword">as</span> teacher_id,</span><br><span class="line">ct.s_student_count <span class="keyword">as</span> student_count,</span><br><span class="line">ct.country <span class="keyword">as</span> country,</span><br><span class="line">ct.email <span class="keyword">as</span> email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> c.teacher_id,c.s_student_count,t.country,t.email,</span><br><span class="line"><span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country <span class="keyword">order</span> <span class="keyword">by</span> s_student_count <span class="keyword">desc</span>) <span class="keyword">as</span> orde</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> teacher_id,<span class="built_in">sum</span>(student_count) <span class="keyword">as</span> s_student_count <span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> teacher_id</span><br><span class="line">) <span class="keyword">as</span> c</span><br><span class="line"><span class="keyword">join</span> teachers t </span><br><span class="line"><span class="keyword">on</span> c.teacher_id<span class="operator">=</span>t.id) <span class="keyword">as</span> ct</span><br><span class="line"><span class="keyword">where</span> ct.orde<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-12"><a href="#ğŸ’ªget-12" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>æ³¨æ„<code>join</code>ä¸­æ•°æ®çš„é‡å¤æ¬¡æ•°ï¼Œä¼šé€ æˆæ•°æ®å‡ºç°é‡å¤ã€‚</li><li>èšåˆå‡½æ•°è¦å’Œ<code>group by</code>è”ç”¨ï¼Œmysqlè¦å»byåé¢ä¸ºå…¨selectå…³é”®è¯ï¼Œå³é™¤äº†èšåˆå‡½æ•°ã€‚</li></ul><h4 id="ğŸ™ƒsource-12"><a href="#ğŸ™ƒsource-12" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/learn/153/683">source</a></p><h2 id="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II"><a href="#æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II" class="headerlink" title="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II"></a>æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction-13"><a href="#ğŸ™ˆIntroduction-13" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br><code>exams</code> è¡¨ä¸­å­˜æ”¾ç€åŒå­¦ä»¬çš„è€ƒè¯•è®°å½•<br>è¯·ç”¨ SQL è¯­å¥ï¼Œæ‰¾åˆ°æŒ‚ç§‘æ•°æœ€å¤šçš„åŒå­¦æ‰€å¯¹åº”çš„ <code>student_id</code></p><h4 id="ğŸ¤”code-13"><a href="#ğŸ¤”code-13" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> student_id</span><br><span class="line"><span class="keyword">FROM</span> exams</span><br><span class="line"><span class="keyword">WHERE</span> is_pass <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(bb.a)</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> (</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> a</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">FROM</span> exams <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span> <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) <span class="keyword">as</span> bb</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">SELECT</span> student_id <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">) t</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> num<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(num) <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) tt</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-13"><a href="#ğŸ’ªget-13" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>whereåä¸å¯ä»¥è·Ÿ[[å‡½æ•°#ç®—æ•°å‡½æ•°|èšåˆå‡½æ•°]]</li></ul><h4 id="ğŸ™ƒsource-13"><a href="#ğŸ™ƒsource-13" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/1933/solution/45386">source</a></p><h2 id="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"><a href="#è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢" class="headerlink" title="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"></a>è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢</h2><p>2022-04-26</p><h4 id="ğŸ™ˆIntroduction-14"><a href="#ğŸ™ˆIntroduction-14" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Visits</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> visit_id    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> customer_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">visit_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«æœ‰å…³å…‰ä¸´è¿‡è´­ç‰©ä¸­å¿ƒçš„é¡¾å®¢çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>è¡¨ï¼š<code>Transactions</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> transaction_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> visit_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> amount         <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">transaction_id æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨åŒ…å« visit_id æœŸé—´è¿›è¡Œçš„äº¤æ˜“çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>æœ‰ä¸€äº›é¡¾å®¢å¯èƒ½å…‰é¡¾äº†è´­ç‰©ä¸­å¿ƒä½†æ²¡æœ‰è¿›è¡Œäº¤æ˜“ã€‚è¯·ä½ ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾è¿™äº›é¡¾å®¢çš„ ID ï¼Œä»¥åŠä»–ä»¬åªå…‰é¡¾ä¸äº¤æ˜“çš„æ¬¡æ•°ã€‚</p><h4 id="ğŸ¤”code-14"><a href="#ğŸ¤”code-14" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(visit_id)Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â v.visit_id,v.customer_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â VisitsÂ v</span><br><span class="line">Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ t</span><br><span class="line">Â Â Â Â <span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â t.transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">)Â tt</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_transÂ <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">--second version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(v.visit_id)Â <span class="keyword">as</span>Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â VisitsÂ <span class="keyword">as</span>Â v</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ <span class="keyword">as</span>Â t</span><br><span class="line"><span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line"><span class="keyword">where</span>Â t.Transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_trans;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-14"><a href="#ğŸ’ªget-14" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource-14"><a href="#ğŸ™ƒsource-14" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/customer-who-visited-but-did-not-make-any-transactions/submissions/">source</a></p><h2 id="ä¸Šå‡æ¸©åº¦"><a href="#ä¸Šå‡æ¸©åº¦" class="headerlink" title="ä¸Šå‡æ¸©åº¦"></a>ä¸Šå‡æ¸©åº¦</h2><p>2022-04-27</p><h4 id="ğŸ™ˆIntroduction-15"><a href="#ğŸ™ˆIntroduction-15" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š <code>Weather</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> recordDate    <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> temperature   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®</span><br><span class="line">è¯¥è¡¨åŒ…å«ç‰¹å®šæ—¥æœŸçš„æ¸©åº¦ä¿¡æ¯</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾ä¸ä¹‹å‰ï¼ˆæ˜¨å¤©çš„ï¼‰æ—¥æœŸç›¸æ¯”æ¸©åº¦æ›´é«˜çš„æ‰€æœ‰æ—¥æœŸçš„ <code>id</code> ã€‚</p><h4 id="ğŸ¤”code-15"><a href="#ğŸ¤”code-15" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â w1.idÂ <span class="keyword">from</span>Â WeatherÂ w1</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â WeatherÂ w2</span><br><span class="line"><span class="keyword">on</span>Â w1.recordDate<span class="operator">=</span>date_add(w2.recordDate,<span class="type">interval</span>Â <span class="number">1</span>Â <span class="keyword">day</span>)</span><br><span class="line"><span class="keyword">where</span>Â w1.Temperature<span class="operator">&gt;</span>w2.Temperature;</span><br><span class="line"><span class="comment">--sencond version</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    b.Id </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    weather a </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> </span><br><span class="line">    weather b </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    DATEDIFF(b.recordDate,a.recordDate)<span class="operator">=</span><span class="number">1</span> </span><br><span class="line"><span class="keyword">and</span> b.Temperature <span class="operator">&gt;</span> a.Temperature;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-15"><a href="#ğŸ’ªget-15" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>inner join()</code>å½“ä¸å­˜åœ¨onæ—¶ç›¸å½“äºç¬›å¡å°”ç§¯</li><li><code>DATEDIFF(date1,date2)</code>:è¿”å›ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°</li></ul><h4 id="ğŸ™ƒsource-15"><a href="#ğŸ™ƒsource-15" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/rising-temperature/solution/by-jam007-658v/">source</a></p><h2 id="è®¢å•æœ€å¤šçš„å®¢æˆ·"><a href="#è®¢å•æœ€å¤šçš„å®¢æˆ·" class="headerlink" title="è®¢å•æœ€å¤šçš„å®¢æˆ·"></a>è®¢å•æœ€å¤šçš„å®¢æˆ·</h2><p>2022-04-29</p><h4 id="ğŸ™ˆIntroduction-16"><a href="#ğŸ™ˆIntroduction-16" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨: <code>Orders</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name     <span class="operator">|</span> Type     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line"><span class="operator">|</span> order_number    <span class="operator">|</span> <span class="type">int</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> customer_number <span class="operator">|</span> <span class="type">int</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line">Order_numberæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨åŒ…å«å…³äºè®¢å•IDå’Œå®¢æˆ·IDçš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢ï¼Œä¸ºä¸‹äº† <strong>æœ€å¤šè®¢å•</strong> çš„å®¢æˆ·æŸ¥æ‰¾ <code>customer_number</code> ã€‚<br>æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆåï¼Œ <strong>æ°å¥½æœ‰ä¸€ä¸ªå®¢æˆ·</strong> æ¯”ä»»ä½•å…¶ä»–å®¢æˆ·ä¸‹äº†æ›´å¤šçš„è®¢å•ã€‚</p><h4 id="ğŸ¤”code-16"><a href="#ğŸ¤”code-16" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version 482ms</span></span><br><span class="line"><span class="keyword">select</span>Â customer_number</span><br><span class="line"><span class="keyword">from</span>Â Orders</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_number</span><br><span class="line"><span class="keyword">having</span>Â <span class="built_in">count</span>(customer_number)<span class="operator">=</span>(</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â <span class="built_in">count</span>(customer_number)Â <span class="keyword">as</span>Â countÂ </span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â OrdersÂ </span><br><span class="line">Â Â Â Â <span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_numberÂ </span><br><span class="line">Â Â Â Â <span class="keyword">order</span>Â <span class="keyword">by</span>Â countÂ <span class="keyword">desc</span></span><br><span class="line">Â Â Â Â limitÂ <span class="number">1</span>);</span><br><span class="line"><span class="comment">--other version</span></span><br><span class="line"><span class="keyword">select</span> customer_number</span><br><span class="line"><span class="keyword">from</span> orders</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(order_number)<span class="operator">&gt;=</span><span class="keyword">all</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(order_number)</span><br><span class="line">    <span class="keyword">from</span> orders</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line">)</span><br><span class="line"><span class="comment">--order 479msä¸ä¸¥è°¨</span></span><br><span class="line"><span class="keyword">select</span> customer_number</span><br><span class="line"><span class="keyword">from</span> orders </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">count</span>(order_number)  <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">1</span></span><br><span class="line"><span class="comment">--rank() 503ms</span></span><br><span class="line"><span class="keyword">select</span> t.customer_number</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> customer_number, <span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">count</span>(order_number) <span class="keyword">desc</span>) <span class="keyword">as</span> ranking</span><br><span class="line"><span class="keyword">from</span> orders</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number) t</span><br><span class="line"><span class="keyword">where</span> t.ranking <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-16"><a href="#ğŸ’ªget-16" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>order by()</code>ï¼šå¯ç”¨èšåˆå‡½æ•°è¿›è¡Œæ’åº</li><li><code>ALL</code>è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªé€»è¾‘è¿ç®—ç¬¦ï¼Œå®ƒå°†å•ä¸ªå€¼ä¸å­æŸ¥è¯¢è¿”å›çš„å•åˆ—å€¼é›†è¿›è¡Œæ¯”è¾ƒã€‚SQL <code>ALL</code>è¿ç®—ç¬¦å¿…é¡»ä»¥æ¯”è¾ƒè¿ç®—ç¬¦å¼€å¤´ï¼Œä¾‹å¦‚ï¼š<code>&gt;</code>ï¼Œ<code>&gt;=</code>ï¼Œ<code>&lt;</code>ï¼Œ<code>&lt;=</code>ï¼Œ<code>&lt;&gt;</code>ï¼Œ<code>=</code>ï¼Œåè·Ÿå­æŸ¥è¯¢ã€‚ æŸäº›æ•°æ®åº“ç³»ç»Ÿ(å¦‚Oracle)å…è®¸ä½¿ç”¨æ–‡å­—å€¼åˆ—è¡¨è€Œä¸æ˜¯å­æŸ¥è¯¢ã€‚<h4 id="ğŸ™ƒsource-16"><a href="#ğŸ™ƒsource-16" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/customer-placing-the-largest-number-of-orders/">source</a><h2 id="æ’åé å‰çš„æ—…è¡Œè€…"><a href="#æ’åé å‰çš„æ—…è¡Œè€…" class="headerlink" title="æ’åé å‰çš„æ—…è¡Œè€…"></a>æ’åé å‰çš„æ—…è¡Œè€…</h2>2022-04-30</li></ul><h4 id="ğŸ™ˆIntroduction-17"><a href="#ğŸ™ˆIntroduction-17" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Users</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name          <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¯¥è¡¨å•ä¸»é”®ã€‚</span><br><span class="line">name æ˜¯ç”¨æˆ·åå­—ã€‚</span><br></pre></td></tr></table></figure><br>è¡¨ï¼š<code>Rides</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> user_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> distance      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¯¥è¡¨å•ä¸»é”®ã€‚</span><br><span class="line">user_id æ˜¯æœ¬æ¬¡è¡Œç¨‹çš„ç”¨æˆ·çš„ id, è€Œè¯¥ç”¨æˆ·æ­¤æ¬¡è¡Œç¨‹è·ç¦»ä¸º distance ã€‚</span><br></pre></td></tr></table></figure><br>å†™ä¸€æ®µ SQL , æŠ¥å‘Šæ¯ä¸ªç”¨æˆ·çš„æ—…è¡Œè·ç¦»ã€‚</p><p>è¿”å›çš„ç»“æœè¡¨å•ï¼Œä»¥ travelled_distance é™åºæ’åˆ— ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæˆ–è€…æ›´å¤šçš„ç”¨æˆ·æ—…è¡Œäº†ç›¸åŒçš„è·ç¦», é‚£ä¹ˆå†ä»¥ name å‡åºæ’åˆ— ã€‚</p><h4 id="ğŸ¤”code-17"><a href="#ğŸ¤”code-17" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">select</span>Â u.name,if(<span class="built_in">sum</span>(r.distance)Â <span class="keyword">is</span>Â <span class="keyword">null</span>,Â <span class="number">0</span>,<span class="built_in">sum</span>(r.distance))Â <span class="keyword">as</span>Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â UsersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â RidesÂ r</span><br><span class="line"><span class="keyword">on</span>Â r.user_id<span class="operator">=</span>u.id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â r.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,nameÂ <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">--ifnull</span></span><br><span class="line"><span class="keyword">select</span>Â u.name,ifnull(<span class="built_in">sum</span>(r.distance),Â <span class="number">0</span>)Â <span class="keyword">as</span>Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â UsersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â RidesÂ r</span><br><span class="line"><span class="keyword">on</span>Â r.user_id<span class="operator">=</span>u.id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â r.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,nameÂ <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">--coalesce  </span></span><br><span class="line"><span class="keyword">select</span>Â </span><br><span class="line">Â Â Â Â name,Â <span class="built_in">coalesce</span>(<span class="built_in">sum</span>(distance),Â <span class="number">0</span>)Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â </span><br><span class="line">Â Â Â Â usersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â ridesÂ rÂ <span class="keyword">on</span>Â u.id<span class="operator">=</span>r.user_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â name</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,Â name;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-17"><a href="#ğŸ’ªget-17" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>ifnulll</code>:MySQL <code>IFNULL(expression_1,expression_2)</code>å‡½æ•°æ˜¯MySQLæ§åˆ¶æµå‡½æ•°ä¹‹ä¸€ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯<code>NULL</code>ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ å¦åˆ™ï¼Œ<code>IFNULL</code>å‡½æ•°è¿”å›ç¬¬äºŒä¸ªå‚æ•°ã€‚ä¸¤ä¸ªå‚æ•°å¯ä»¥æ˜¯æ–‡å­—å€¼æˆ–è¡¨è¾¾å¼ã€‚</li><li><code>COALESCE</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ <code>(expression_1, expression_2, ...,expression_n)</code>ä¾æ¬¡å‚è€ƒå„å‚æ•°è¡¨è¾¾å¼ï¼Œé‡åˆ°énullå€¼å³åœæ­¢å¹¶è¿”å›è¯¥å€¼ã€‚å¦‚æœæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½æ˜¯ç©ºå€¼ï¼Œæœ€ç»ˆå°†è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚ä½¿ç”¨COALESCEåœ¨äºå¤§éƒ¨åˆ†åŒ…å«ç©ºå€¼çš„è¡¨è¾¾å¼æœ€ç»ˆå°†è¿”å›ç©ºå€¼ã€‚</li></ul><h4 id="ğŸ™ƒsource-17"><a href="#ğŸ™ƒsource-17" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/top-travellers/">source</a><br><a href="https://www.yiibai.com/mysql/ifnull.html">ifnull</a><br><a href="https://blog.csdn.net/yilulvxing/article/details/86595725">coalesce</a></p><h2 id="å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰"><a href="#å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰" class="headerlink" title="å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰"></a>å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰</h2><p>2022-04-30</p><h4 id="ğŸ™ˆIntroduction-18"><a href="#ğŸ™ˆIntroduction-18" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>Table: <code>Users</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> user_id        <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> join_date      <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> favorite_brand <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ user_idã€‚</span><br><span class="line">è¡¨ä¸­æè¿°äº†è´­ç‰©ç½‘ç«™çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤ç½‘ç«™ä¸Šè¿›è¡Œå•†å“ä¹°å–ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Orders</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> order_id      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> order_date    <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> item_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> buyer_id      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> seller_id     <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ order_idã€‚</span><br><span class="line">å¤–é”®æ˜¯ item_id å’Œï¼ˆbuyer_idï¼Œseller_idï¼‰ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Items</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> item_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> item_brand    <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ item_idã€‚</span><br></pre></td></tr></table></figure><br>è¯·å†™å‡ºä¸€æ¡SQLè¯­å¥ä»¥æŸ¥è¯¢æ¯ä¸ªç”¨æˆ·çš„æ³¨å†Œæ—¥æœŸå’Œåœ¨ <strong><code>2019</code></strong> å¹´ä½œä¸ºä¹°å®¶çš„è®¢å•æ€»æ•°ã€‚<br>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p><h4 id="ğŸ¤”code-18"><a href="#ğŸ¤”code-18" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">select</span>Â u.user_idÂ <span class="keyword">as</span>Â buyer_id,u.join_date,<span class="built_in">count</span>(ee.order_date)Â <span class="keyword">as</span>Â <span class="string">&#x27;orders_in_2019&#x27;</span></span><br><span class="line"><span class="keyword">from</span>Â UsersÂ <span class="keyword">as</span>Â u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â order_date,buyer_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â Orders</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â <span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="number">2019</span></span><br><span class="line">)Â <span class="keyword">as</span>Â eeÂ </span><br><span class="line"><span class="keyword">on</span>Â ee.buyer_id<span class="operator">=</span>u.user_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â u.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â buyer_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å°†æ—¶é—´åˆ¤æ–­æ”¾åœ¨onä¸­é¿å…whereç›´æ¥ç­›é€‰æ‰IDä¸º3å’Œ4çš„æƒ…å†µï¼Œæ”¾åœ¨onè¿˜ä¼šä¿ç•™IDä¸º3å’Œ4çš„æƒ…å†µä¸”å€¼ä¸ºnull</span></span><br><span class="line"><span class="keyword">select</span>Â user_idÂ buyer_id,Â join_date,Â <span class="built_in">count</span>(order_id)Â orders_in_2019</span><br><span class="line"><span class="keyword">from</span>Â usersÂ <span class="keyword">left</span>Â <span class="keyword">join</span>Â orders</span><br><span class="line"><span class="keyword">on</span>Â user_idÂ <span class="operator">=</span>Â buyer_idÂ <span class="keyword">and</span>Â <span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="string">&#x27;2019&#x27;</span></span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â user_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å…ˆç»™é2019çš„èµ‹å€¼ï¼Œä½¿ç”¨sum()è®¡ç®—</span></span><br><span class="line"><span class="keyword">select</span>Â user_idÂ buyer_id,Â join_date,</span><br><span class="line"><span class="built_in">sum</span>(if(<span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="string">&#x27;2019&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>))Â orders_in_2019</span><br><span class="line"><span class="keyword">from</span>Â usersÂ <span class="keyword">left</span>Â <span class="keyword">join</span>Â orders</span><br><span class="line"><span class="keyword">on</span>Â user_idÂ <span class="operator">=</span>Â buyer_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â user_id</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-18"><a href="#ğŸ’ªget-18" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>onåé¢å¯ä»¥æ¥ç­›é€‰æ¡ä»¶ï¼Œä¸whereåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œä»…åœ¨outer joinå­˜åœ¨åŒºåˆ«ã€‚outer joinæ­¥éª¤å¦‚ä¸‹ï¼š</li></ul><ol><li>å¯¹ä¸¤ä¸ªè¡¨è¿›è¡Œç¬›å¡å°”ç§¯</li><li>åº”ç”¨onç­›é€‰æ¡ä»¶</li><li><code>æ·»åŠ å¤–éƒ¨è¡Œ</code>(è¿™ä¸€æ­¥ä¼šæ·»åŠ ä¾èµ–åˆ—è¡¨åœ¨ç­›é€‰åä¸å­˜åœ¨çš„è¡Œ)</li><li>åº”ç”¨whereç­›é€‰å™¨<h4 id="ğŸ™ƒsource-18"><a href="#ğŸ™ƒsource-18" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/market-analysis-i/comments/">source</a><br><a href="https://blog.csdn.net/qq_42434318/article/details/112819267">onä¸whereç­›é€‰çš„åŒºåˆ«</a></li></ol><h2 id="é”€å”®åˆ†æ"><a href="#é”€å”®åˆ†æ" class="headerlink" title="é”€å”®åˆ†æ"></a>é”€å”®åˆ†æ</h2><p>2022-05-01</p><h4 id="ğŸ™ˆIntroduction-19"><a href="#ğŸ™ˆIntroduction-19" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>Table: <code>Product</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> product_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product_name <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> unit_price   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line">Product_idæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡Œæ˜¾ç¤ºæ¯ä¸ªäº§å“çš„åç§°å’Œä»·æ ¼ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Sales</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> seller_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product_id  <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> buyer_id    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sale_date   <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> quantity    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> price       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------ ------+---------+</span></span><br><span class="line">è¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯ä»¥æœ‰é‡å¤çš„è¡Œã€‚</span><br><span class="line">product_id æ˜¯ Product è¡¨çš„å¤–é”®ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å…³äºä¸€ä¸ªé”€å”®çš„ä¸€äº›ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢ï¼ŒæŠ¥å‘Š<code>2019å¹´æ˜¥å­£</code>æ‰å”®å‡ºçš„äº§å“ã€‚å³<strong>ä»…</strong>åœ¨<code>**2019-01-01**</code>è‡³<code>**2019-03-31**</code>ï¼ˆå«ï¼‰ä¹‹é—´å‡ºå”®çš„å•†å“ã€‚</p><h4 id="ğŸ¤”code-19"><a href="#ğŸ¤”code-19" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version 622ms</span></span><br><span class="line"><span class="keyword">select</span>Â product_id,product_name</span><br><span class="line"><span class="keyword">from</span>Â Product</span><br><span class="line"><span class="keyword">where</span>Â product_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â p.product_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â ProductÂ <span class="keyword">as</span>Â p</span><br><span class="line">Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â SalesÂ <span class="keyword">as</span>Â s</span><br><span class="line">Â Â Â Â <span class="keyword">on</span>Â p.product_id<span class="operator">=</span>s.product_id</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â s.sale_dateÂ <span class="keyword">not</span>Â <span class="keyword">between</span>Â <span class="string">&#x27;2019-01-01&#x27;</span>Â <span class="keyword">and</span>Â <span class="string">&#x27;2019-03-31&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--sumè®¡æ•°æ’é™¤ 634ms</span></span><br><span class="line"><span class="keyword">SELECT</span>Â p.product_id,product_nameÂ <span class="keyword">FROM</span>Â salesÂ s,productÂ pÂ </span><br><span class="line"><span class="keyword">WHERE</span>Â s.product_id<span class="operator">=</span>p.product_id</span><br><span class="line"><span class="keyword">GROUP</span>Â <span class="keyword">BY</span>Â p.product_id</span><br><span class="line"><span class="keyword">HAVING</span>Â <span class="built_in">SUM</span>(sale_dateÂ <span class="operator">&lt;</span>Â <span class="string">&#x27;2019-01-01&#x27;</span>)<span class="operator">=</span><span class="number">0</span></span><br><span class="line"><span class="keyword">AND</span>Â <span class="built_in">SUM</span>(sale_date<span class="operator">&gt;</span><span class="string">&#x27;2019-03-31&#x27;</span>)<span class="operator">=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-19"><a href="#ğŸ’ªget-19" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>é‡‡ç”¨èšåˆå‡½æ•°è¿›è¡Œè®¡æ•°ï¼Œå®ç°è¦æ±‚ï¼Œä½†æ•ˆç‡ä¸é«˜ã€‚<h4 id="ğŸ™ƒsource-19"><a href="#ğŸ™ƒsource-19" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/sales-analysis-iii/">source</a></li></ul><h2 id="ç¬¬äºŒèº«é«˜çš„çƒå‘˜"><a href="#ç¬¬äºŒèº«é«˜çš„çƒå‘˜" class="headerlink" title="ç¬¬äºŒèº«é«˜çš„çƒå‘˜"></a>ç¬¬äºŒèº«é«˜çš„çƒå‘˜</h2><p>2022-05-01</p><h4 id="ğŸ™ˆIntroduction-20"><a href="#ğŸ™ˆIntroduction-20" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p><strong>æè¿°</strong><br>ç¼–å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œè·å–çƒå‘˜ (<code>players</code>) è¡¨ä¸­ç¬¬äºŒé«˜çš„èº«é«˜ (<code>height</code>)<br>è¡¨å®šä¹‰: <code>players</code> (çƒå‘˜è¡¨)<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int unsigned|ä¸»é”®|<br>|height|int|çƒå‘˜èº«é«˜|</p><h4 id="ğŸ¤”code-20"><a href="#ğŸ¤”code-20" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">SELECT</span> ifnull(</span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">distinct</span> height <span class="keyword">FROM</span> players</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> height <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">1</span>,<span class="number">1</span>),<span class="keyword">null</span>) <span class="keyword">as</span> second_height;</span><br><span class="line"><span class="comment">--other version</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">max</span>(height) <span class="keyword">as</span> second_height</span><br><span class="line"><span class="keyword">FROM</span> players</span><br><span class="line"><span class="keyword">WHERE</span> height<span class="operator">&lt;</span>(<span class="keyword">SELECT</span> <span class="built_in">max</span>(height) <span class="keyword">FROM</span> players);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-20"><a href="#ğŸ’ªget-20" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>ä¸ç­‰äºæœ€å¤§çš„æœ€å¤§å€¼<h4 id="ğŸ™ƒsource-20"><a href="#ğŸ™ƒsource-20" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/problem/1918/description">source</a></li></ul><h2 id="åˆ é™¤é‡å¤çš„åå­—"><a href="#åˆ é™¤é‡å¤çš„åå­—" class="headerlink" title="åˆ é™¤é‡å¤çš„åå­—"></a>åˆ é™¤é‡å¤çš„åå­—</h2><p>2022-05-01</p><h4 id="ğŸ™ˆIntroduction-21"><a href="#ğŸ™ˆIntroduction-21" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p><strong>æè¿°</strong><br>ç¼–å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œæ¥åˆ é™¤ <code>contacts</code> è¡¨ä¸­æ‰€æœ‰é‡å¤çš„å§“åï¼Œé‡å¤çš„å§“åé‡Œåªä¿ç•™ <code>id</code> æœ€å°çš„é‚£ä¸ªã€‚</p><h4 id="ğŸ¤”code-21"><a href="#ğŸ¤”code-21" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">FROM</span> contacts</span><br><span class="line"><span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">SELECT</span> <span class="built_in">min</span>(id) <span class="keyword">from</span> contacts <span class="keyword">group</span> <span class="keyword">by</span> name) <span class="keyword">as</span> ee);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-21"><a href="#ğŸ’ªget-21" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>åœ¨åŒä¸€è¯­å¥ä¸­ï¼Œä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨ å°†selectå‡ºçš„ç»“æœå†é€šè¿‡ä¸­é—´è¡¨selectä¸€éï¼Œå¯ä»¥è§„é¿è¿™ä¸ªé”™è¯¯</li><li>[[åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±|æ–¹æ³•äºŒ]]<code>æäº¤é€Ÿåº¦å¤ªæ…¢</code><h4 id="ğŸ™ƒsource-21"><a href="#ğŸ™ƒsource-21" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/problem/1922/solution/33244">source</a></li></ul><h4 id="ğŸ™ˆIntroduction-22"><a href="#ğŸ™ˆIntroduction-22" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p><p>æŸå¤„æ–°ç§æ¤æœ‰ä¸€äº›è·ç¦»ä¸ç­‰çš„æ ‘è‹—ï¼Œå·²çŸ¥è¿™äº›æ ‘è‹—å’Œä¸€ä¸ªå¤§çš„æµ‡æ°´æ¡¶éƒ½åœ¨ä¸€æ¡ç›´çº¿ä¸Š<br><code>sapling_distances</code> è¡¨å­˜å‚¨äº†ä¸€äº›æ ‘è‹—åˆ°æµ‡æ°´æ¡¶çš„è·ç¦» (<code>distance</code>)<br>è¯·ç¼–å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œæ‰¾åˆ°è·ç¦»æœ€è¿‘çš„ä¸¤æ£µæ ‘è‹—é—´çš„è·ç¦» (<code>shortest_distance</code>)ã€‚</p><p>è¡¨å®šä¹‰: <code>sapling_distances</code> (æ ‘è‹—è·ç¦»è¡¨)<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int unsigned|ä¸»é”®|<br>|distance|int|æ ‘è‹—åˆ°æ°´æ¡¶çš„è·ç¦»|</p><h4 id="ğŸ¤”code-22"><a href="#ğŸ¤”code-22" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">min</span>(<span class="built_in">abs</span>(a.distance<span class="operator">-</span>b.distance)) <span class="keyword">as</span> shortest_distance</span><br><span class="line"><span class="keyword">from</span> sapling_distances <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">join</span> sapling_distances <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> a.id<span class="operator">!=</span>b.id</span><br><span class="line"><span class="keyword">having</span> shortest_distance <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(<span class="built_in">ABS</span>(a.distance <span class="operator">-</span> b.distance)) <span class="keyword">AS</span> shortest_distance</span><br><span class="line"><span class="keyword">FROM</span> sapling_distances <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> sapling_distances b</span><br><span class="line"><span class="keyword">ON</span> a.id <span class="operator">!=</span> b.id</span><br><span class="line"><span class="keyword">HAVING</span> shortest_distance <span class="operator">!=</span> <span class="string">&#x27;None&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-22"><a href="#ğŸ’ªget-22" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>å¦‚ç›´æ¥ä½¿ç”¨whereåˆ™è¿”å›å€¼ä¸ºnullï¼Œä½¿ç”¨onèƒ½ä¿ç•™ç­›é€‰åçš„åˆ—[[å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰]]</li><li><strong>whereåæ— æ³•ä½¿ç”¨èšåˆå‡½æ•°</strong><h4 id="ğŸ™ƒsource-22"><a href="#ğŸ™ƒsource-22" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/problem/1942/description">source</a></li></ul><h2 id="ç½‘è¯¾ä¸Šè¯¾æƒ…å†µ"><a href="#ç½‘è¯¾ä¸Šè¯¾æƒ…å†µ" class="headerlink" title="ç½‘è¯¾ä¸Šè¯¾æƒ…å†µ"></a>ç½‘è¯¾ä¸Šè¯¾æƒ…å†µ</h2><p>2022-05-04</p><h4 id="ğŸ™ˆIntroduction-23"><a href="#ğŸ™ˆIntroduction-23" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br><code>online_class_situations</code> è¡¨å±•ç¤ºäº†ä¸€äº›åŒå­¦ä¸Šç½‘è¯¾çš„è¡Œä¸ºæ´»åŠ¨ã€‚<br>æ¯è¡Œæ•°æ®è®°å½•äº†ä¸€ååŒå­¦åœ¨é€€å‡ºç½‘è¯¾ä¹‹å‰ï¼Œå½“å¤©ä½¿ç”¨åŒä¸€å°è®¾å¤‡ç™»å½•è¯¾ç¨‹åå¬è¿‡çš„è¯¾ç¨‹æ•°ç›®ï¼ˆå¯èƒ½æ˜¯0ä¸ªï¼‰ã€‚<br>å†™ä¸€æ¡ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ¯ä½åŒå­¦<strong>ç¬¬ä¸€æ¬¡ç™»å½•å¹³å°å¬è¯¾çš„è®¾å¤‡ID (device_id)</strong>ã€‚</p><h4 id="ğŸ¤”code-23"><a href="#ğŸ¤”code-23" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> o.student_id, device_id</span><br><span class="line"><span class="keyword">from</span> online_class_situations o <span class="keyword">inner</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> student_id, <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> dt <span class="keyword">from</span> online_class_situations</span><br><span class="line"><span class="keyword">where</span> course_number <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> student_id) temp</span><br><span class="line"><span class="keyword">on</span> o.student_id <span class="operator">=</span> temp.student_id <span class="keyword">and</span> o.date <span class="operator">=</span> temp.dt</span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">select</span> student_id,device_id</span><br><span class="line">Â  Â  <span class="keyword">from</span> online_class_situations</span><br><span class="line">Â  Â  <span class="keyword">where</span> (student_id,<span class="type">date</span>) <span class="keyword">in</span></span><br><span class="line">Â  Â  Â  Â  Â  (<span class="keyword">select</span> student_id,<span class="built_in">min</span>(<span class="type">date</span>)</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> online_class_situations</span><br><span class="line">Â  Â  <span class="keyword">where</span> course_number <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">Â  Â  <span class="keyword">group</span> <span class="keyword">by</span> student_id);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-23"><a href="#ğŸ’ªget-23" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>group by</code>åˆ†ç»„åä½¿ç”¨havingè¿›è¡Œåˆ¤æ–­ä¾‹å¦‚ï¼š<code>group by ... having degree&gt;=max(degree)</code>è¿™é‡Œmaxä¼šé€‰å‡ºæ¯ç»„æœ€å¤§çš„ï¼Œä½†å·¦ä¾§çš„<code>degree</code>å¹¶ä¸çŸ¥é“æ˜¯å“ªç»„æ•°æ®<br><a href="https://blog.csdn.net/lxn1214/article/details/107911773?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3&amp;utm_relevant_index=2">å‚è€ƒ</a><br><a href="https://blog.csdn.net/liu_feng_zi_/article/details/106881586?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_default&amp;utm_relevant_index=2">å‚è€ƒ2</a><h4 id="ğŸ™ƒsource-23"><a href="#ğŸ™ƒsource-23" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/problem/1929/description">source</a></li></ul><h2 id="æŸ¥è¯¢ä»¥å­—æ¯â€˜Dâ€™åˆ°â€˜Oâ€™å¼€å¤´çš„è¯¾ç¨‹"><a href="#æŸ¥è¯¢ä»¥å­—æ¯â€˜Dâ€™åˆ°â€˜Oâ€™å¼€å¤´çš„è¯¾ç¨‹" class="headerlink" title="æŸ¥è¯¢ä»¥å­—æ¯â€˜Dâ€™åˆ°â€˜Oâ€™å¼€å¤´çš„è¯¾ç¨‹"></a>æŸ¥è¯¢ä»¥å­—æ¯â€˜Dâ€™åˆ°â€˜Oâ€™å¼€å¤´çš„è¯¾ç¨‹</h2><p>2022-05-05</p><h4 id="ğŸ™ˆIntroduction-24"><a href="#ğŸ™ˆIntroduction-24" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¯·ç¼–å†™ SQL è¯­å¥ï¼ŒæŸ¥è¯¢è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­è¯¾ç¨‹åç§°ä»¥å¤§å†™å­—æ¯ â€˜Dâ€™ åˆ° â€˜Oâ€™ ï¼ˆåŒ…å«å•ä¸ªå­—ç¬¦ â€˜Dâ€™ã€â€™Oâ€™ï¼‰å¼€å¤´çš„è¯¾ç¨‹çš„è¯¾ç¨‹åç§°ã€‚</p><h4 id="ğŸ¤”code-24"><a href="#ğŸ¤”code-24" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">from</span> courses <span class="keyword">WHERE</span> <span class="keyword">left</span>(name,<span class="number">1</span>) <span class="keyword">between</span> <span class="string">&#x27;D&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;O&#x27;</span>;</span><br><span class="line"><span class="comment">--version 2</span></span><br><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">from</span> courses <span class="keyword">WHERE</span> name regexp <span class="string">&#x27;^[D-O]&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-24"><a href="#ğŸ’ªget-24" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>regexp</code>æ­£åˆ™è¡¨è¾¾å¼æŸ¥è¯¢<a href="http://c.biancheng.net/view/2572.html">å‚è€ƒ</a></li></ul><h4 id="ğŸ™ƒsource-24"><a href="#ğŸ™ƒsource-24" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/1967/description">source</a></p><h2 id="è¿ç»­å‡ºç°çš„çƒå‘˜èº«é«˜"><a href="#è¿ç»­å‡ºç°çš„çƒå‘˜èº«é«˜" class="headerlink" title="è¿ç»­å‡ºç°çš„çƒå‘˜èº«é«˜"></a>è¿ç»­å‡ºç°çš„çƒå‘˜èº«é«˜</h2><p>2022-05-08</p><h4 id="ğŸ™ˆIntroduction-25"><a href="#ğŸ™ˆIntroduction-25" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¯·ç¼–å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œåœ¨çƒå‘˜è¡¨ï¼ˆ<code>players</code>ï¼‰ä¸­æ‰¾å‡ºè‡³å°‘æœ‰ä¸‰ä¸ª id è¿ç»­çš„çƒå‘˜è¾¾åˆ°æ­¤é«˜åº¦çš„çƒå‘˜èº«é«˜ï¼Œè¿”å›çš„ç»“æœå¯ä»¥æŒ‰ä»»æ„é¡ºåºæ’åˆ—ã€‚</p><h4 id="ğŸ¤”code-25"><a href="#ğŸ¤”code-25" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my  version</span></span><br><span class="line"><span class="keyword">SELECT</span> a.height</span><br><span class="line"><span class="keyword">FROM</span> players <span class="keyword">as</span> a,players <span class="keyword">as</span> b,players <span class="keyword">as</span> c</span><br><span class="line"><span class="keyword">WHERE</span> a.id<span class="operator">=</span>b.id<span class="number">-1</span> <span class="keyword">and</span> a.id<span class="operator">=</span>c.id<span class="operator">+</span><span class="number">1</span> <span class="keyword">and</span> a.height<span class="operator">=</span>b.height <span class="keyword">and</span> a.height<span class="operator">=</span>c.height;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"><span class="comment">--other_version_1</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@rownuma</span>:<span class="operator">=</span><span class="number">0</span>;<span class="keyword">set</span> <span class="variable">@rownumb</span>:<span class="operator">=</span><span class="number">0</span>;<span class="keyword">set</span> <span class="variable">@rownumc</span>:<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">select</span> a.height</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> <span class="variable">@rownuma</span>:<span class="operator">=</span><span class="variable">@rownuma</span><span class="operator">+</span><span class="number">1</span> rownuma, height <span class="keyword">from</span> players) a,</span><br><span class="line">(<span class="keyword">select</span> <span class="variable">@rownumb</span>:<span class="operator">=</span><span class="variable">@rownumb</span><span class="operator">+</span><span class="number">1</span> rownumb, height <span class="keyword">from</span> players) b,</span><br><span class="line">(<span class="keyword">select</span> <span class="variable">@rownumc</span>:<span class="operator">=</span><span class="variable">@rownumc</span><span class="operator">+</span><span class="number">1</span> rownumc, height <span class="keyword">from</span> players) c</span><br><span class="line"><span class="keyword">where</span> a.rownuma <span class="operator">=</span> b.rownumb <span class="operator">-</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> b.rownumb <span class="operator">=</span> c.rownumc <span class="operator">-</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> (a.height <span class="operator">=</span> b.height <span class="keyword">and</span> b.height <span class="operator">=</span> c.height)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--other version_2</span></span><br><span class="line"><span class="keyword">SELECT</span> height <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="operator">*</span>,<span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> height <span class="keyword">ORDER</span> <span class="keyword">BY</span> id) rn <span class="keyword">FROM</span> players</span><br><span class="line">)p1</span><br><span class="line"><span class="keyword">WHERE</span> p1.rn <span class="operator">&gt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget-25"><a href="#ğŸ’ªget-25" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>åœ¨mysqlæ•°æ®åº“ä¸­æ²¡æœ‰ROWNUM()è¿™ä¸ªå‡½æ•°,åªèƒ½é€šè¿‡å˜é‡çš„æ–¹å¼æ¥å®ç°<a href="https://www.jianshu.com/p/e7288f7020b8#:~:text=%E5%9C%A8mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%B2%A1%E6%9C%89ROWNUM%20%28%29%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%2C%E5%8F%AA%E8%83%BD%E9%80%9A%E8%BF%87%E5%8F%98%E9%87%8F%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9D%A5%E5%AE%9E%E7%8E%B0.%20rownum%E6%98%AF%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%EF%BC%8C%E8%A1%A8%E7%A4%BA%E8%A1%8C%E5%8F%B7%E3%80%82.%20SELECT%20%28%40rownum%20%3A%3D%40rownum%20%2B%201%29,0%29%20b%20ORDER%20BY%20%20t.%20CODE%20ASC.">rownumber</a></li><li><code>ROW_NUMVER()</code>æ˜¯ä¸€ä¸ªçª—å£å‡½æ•°ï¼Œå®ƒä¸ºç»“æœé›†çš„åˆ†åŒºä¸­çš„æ¯ä¸€è¡Œåˆ†é…ä¸€ä¸ªè¿ç»­çš„æ•´æ•°ã€‚è¡Œå·ä»¥æ¯ä¸€ä¸ªåˆ†åŒºä¸­çš„ç¬¬ä¸€è¡Œçš„è¡Œå·ä¸ºå¼€å¤´ã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> ( </span><br><span class="line">[<span class="keyword">PARTITION</span> <span class="keyword">BY</span> partition_expression, ... ] </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sort_expression [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>], ... </span><br><span class="line">)</span><br></pre></td></tr></table></figure>åœ¨ä¸Šé¢è¯­æ³•ä¸­ï¼Œ</li><li><code>PARTITION BY</code>å­å¥å°†ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚ <code>ROW_NUMBER()</code>å‡½æ•°åˆ†åˆ«åº”ç”¨äºæ¯ä¸ªåˆ†åŒºï¼Œå¹¶é‡æ–°åˆå§‹åŒ–æ¯ä¸ªåˆ†åŒºçš„è¡Œå·ã€‚<code>PARTITION BY</code>å­å¥æ˜¯å¯é€‰çš„ã€‚å¦‚æœæœªæŒ‡å®šï¼Œ<code>ROW_NUMBER()</code>å‡½æ•°ä¼šå°†æ•´ä¸ªç»“æœé›†è§†ä¸ºå•ä¸ªåˆ†åŒºã€‚</li><li><code>ORDER BY</code>å­å¥å®šä¹‰ç»“æœé›†çš„æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œçš„é€»è¾‘é¡ºåºã€‚ <code>ORDER BY</code>å­å¥æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º<code>ROW_NUMBER()</code>å‡½æ•°å¯¹é¡ºåºæ•æ„Ÿã€‚</li></ul><h4 id="ğŸ™ƒsource-25"><a href="#ğŸ™ƒsource-25" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/2499/description">source</a><br><a href="https://www.yiibai.com/sqlserver/sql-server-row_number-function.html">ROW_NUMBER</a></p>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> LeetCode </tag>
            
            <tag> LintCode </tag>
            
            <tag> è®°å½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python_è£…é¥°å™¨</title>
      <link href="/2022/04/29/python-%E8%A3%85%E9%A5%B0%E5%99%A8/"/>
      <url>/2022/04/29/python-%E8%A3%85%E9%A5%B0%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h1><blockquote><p>example_helloworld</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">fn</span>):</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wrapper</span>():</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello, %s&quot;</span> % fn.__name__)</span><br><span class="line">fn()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;goodby, %s&quot;</span> % fn.__name__)</span><br><span class="line"><span class="keyword">return</span> wrapper</span><br><span class="line"><span class="meta">@hello</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i am foo&quot;</span>)</span><br><span class="line">foo()</span><br></pre></td></tr></table></figure><blockquote><p>output</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[chenaho@chenhao-air]$ python hello.py</span><br><span class="line">hello, foo</span><br><span class="line">i am foo</span><br><span class="line">goodby, foo</span><br></pre></td></tr></table></figure><h3 id="Decoratorçš„æœ¬è´¨"><a href="#Decoratorçš„æœ¬è´¨" class="headerlink" title="Decoratorçš„æœ¬è´¨"></a>Decoratorçš„æœ¬è´¨</h3><blockquote><p>å¯¹äºPythonçš„è¿™ä¸ª@æ³¨è§£è¯­æ³•ç³–- Syntactic Sugar æ¥è¯´ï¼Œå½“ä½ åœ¨ç”¨æŸä¸ª@decoratoræ¥ä¿®é¥°æŸä¸ªå‡½æ•°funcæ—¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line"><span class="keyword">pass</span></span><br></pre></td></tr></table></figure><blockquote><p>è¢«è§£é‡Šæˆä¸º<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func = decorate(func)</span><br></pre></td></tr></table></figure></p></blockquote><p><code>æ³¨æ„</code></p><blockquote><p>è¿˜æœ‰ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼ŒæŠŠdecoratorè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼èµ‹å€¼å›äº†åŸæ¥çš„funcã€‚æ ¹æ®ã€Šå‡½æ•°å¼ç¼–ç¨‹ã€‹ä¸­çš„first class functionsä¸­çš„å®šä¹‰çš„ï¼Œä½ å¯ä»¥æŠŠå‡½æ•°å½“æˆå˜é‡æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥ï¼Œ<code>decoratorå¿…é¡»å¾—è¿”å›äº†ä¸€ä¸ªå‡½æ•°å‡ºæ¥ç»™func</code>ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„higher order function é«˜é˜¶å‡½æ•°ï¼Œä¸ç„¶ï¼Œåé¢å½“func()è°ƒç”¨çš„æ—¶å€™å°±ä¼šå‡ºé”™ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fuck</span>(<span class="params">fn</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;fuck %s!&quot;</span> % fn.__name__[::-<span class="number">1</span>].upper())</span><br><span class="line"></span><br><span class="line"><span class="meta">@fuck</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wfg</span>():</span><br><span class="line"><span class="keyword">pass</span></span><br></pre></td></tr></table></figure><blockquote><p>æ²¡æœ‰è°ƒç”¨wfg()è¯­å¥ï¼Œä»£ç å¯ä»¥ç›´æ¥æ‰§è¡Œï¼Œå¸¦æœ‰<code>wrapperå‡½æ•°çš„åœ¨å‡½æ•°è°ƒç”¨æ—¶ç”Ÿæ•ˆ</code>ã€‚<br>å¯¹äºç¬¬ä¸€ä¸ªä¾‹å­ï¼Œhello(foo)è¿”å›äº†wrapper()å‡½æ•°ï¼Œæ‰€ä»¥ï¼Œ<code>fooå…¶å®å˜æˆäº†wrapperçš„ä¸€ä¸ªå˜é‡</code>ï¼Œè€Œåé¢çš„foo()æ‰§è¡Œå…¶å®å˜æˆäº†wrapper()ã€‚</p></blockquote><h2 id="å¯¹äºå¤šä¸ªå‚æ•°çš„decorator"><a href="#å¯¹äºå¤šä¸ªå‚æ•°çš„decorator" class="headerlink" title="å¯¹äºå¤šä¸ªå‚æ•°çš„decorator"></a>å¯¹äºå¤šä¸ªå‚æ•°çš„decorator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@decorator_one</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator_two</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line"><span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><strong>ç›¸å½“äº</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func = decorator(arg1,arg2)(func)</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ„å‘³ç€decorator(arg1, arg2)`è¿™ä¸ªå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªâ€œçœŸæ­£çš„decoratorâ€ã€‚</p></blockquote><h2 id="å¸¦æœ‰å‚æ•°åŠå¤šä¸ªdecrorator"><a href="#å¸¦æœ‰å‚æ•°åŠå¤šä¸ªdecrorator" class="headerlink" title="å¸¦æœ‰å‚æ•°åŠå¤šä¸ªdecrorator"></a>å¸¦æœ‰å‚æ•°åŠå¤šä¸ªdecrorator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">makeHtmlTag</span>(<span class="params">tag, *args, **kwds</span>):</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">real_decorator</span>(<span class="params">fn</span>):</span><br><span class="line"></span><br><span class="line">css_class = <span class="string">&quot; class=&#x27;&#123;0&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(kwds[<span class="string">&quot;css_class&quot;</span>]) <span class="keyword">if</span> <span class="string">&quot;css_class&quot;</span> <span class="keyword">in</span> kwds <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wrapped</span>(<span class="params">*args, **kwds</span>):</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&lt;&quot;</span>+tag+css_class+<span class="string">&quot;&gt;&quot;</span> + fn(*args, **kwds) + <span class="string">&quot;&lt;/&quot;</span>+tag+<span class="string">&quot;&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> wrapped</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> real_decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@makeHtmlTag(<span class="params">tag=<span class="string">&quot;b&quot;</span>, css_class=<span class="string">&quot;bold_css&quot;</span></span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@makeHtmlTag(<span class="params">tag=<span class="string">&quot;i&quot;</span>, css_class=<span class="string">&quot;italic_css&quot;</span></span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hello())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;b class=&#x27;bold_css&#x27;&gt;&lt;i class=&#x27;italic_css&#x27;&gt;hello world&lt;/i&gt;&lt;/b&gt;`</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šmakeHtmlTagæœ‰ä¸¤ä¸ªå‚æ•°ã€‚æ‰€ä»¥ï¼Œä¸ºäº†è®© hello = makeHtmlTag(arg1, arg2)(hello) æˆåŠŸï¼Œ<code>makeHtmlTag å¿…éœ€è¿”å›ä¸€ä¸ªdecorator</code> ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥åˆ° decorator çš„é€»è¾‘ä¸­å»äº†â€”â€” decoratorå¾—è¿”å›ä¸€ä¸ªwrapperï¼Œwrapperé‡Œå›è°ƒhelloã€‚</p></blockquote><h2 id="classå¼çš„Decorator"><a href="#classå¼çš„Decorator" class="headerlink" title="classå¼çš„Decorator"></a>classå¼çš„Decorator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">myDecorator</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, fn</span>):</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;inside myDecorator.__init__()&quot;</span></span><br><span class="line">self.fn = fn</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">self.fn()</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;inside myDecorator.__call__()&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@myDecorator</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aFunction</span>():</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;inside aFunction()&quot;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Finished decorating aFunction()&quot;</span></span><br><span class="line"></span><br><span class="line">aFunction()</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"># inside myDecorator.__init__()</span></span><br><span class="line"><span class="comment"># Finished decorating aFunction()</span></span><br><span class="line"><span class="comment"># inside aFunction()</span></span><br><span class="line"><span class="comment"># inside myDecorator.__call__()</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†ï¼Œç”¨ç±»çš„æ–¹å¼å£°æ˜ä¸€ä¸ªdecoratorã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªç±»ä¸­æœ‰ä¸¤ä¸ªæˆå‘˜ï¼š  </p><ul><li>ä¸€ä¸ªæ˜¯<strong>init</strong>()ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æˆ‘ä»¬ç»™æŸä¸ªå‡½æ•°decoratoræ—¶è¢«è°ƒç”¨ï¼Œæ‰€ä»¥ï¼Œéœ€è¦æœ‰ä¸€ä¸ªfnçš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¢«decoratorçš„å‡½æ•°ã€‚</li><li>ä¸€ä¸ªæ˜¯<strong>call</strong>()ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨è¢«decoratorå‡½æ•°æ—¶è¢«è°ƒç”¨çš„ã€‚<br><code>æ³¨æ„</code></li><li>å¦‚æœdecoratoræœ‰å‚æ•°çš„è¯ï¼Œ<strong>init</strong>() æˆå‘˜å°±ä¸èƒ½ä¼ å…¥fnäº†ï¼Œè€Œfnæ˜¯åœ¨<strong>call</strong>çš„æ—¶å€™ä¼ å…¥çš„ã€‚</li><li>wrapped(<em>args, </em>*kwargs) è¿™ç§æ–¹å¼æ¥ä¼ é€’è¢«decoratorå‡½æ•°çš„å‚æ•°ã€‚ï¼ˆå…¶ä¸­ï¼šargsæ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼Œkwargsæ˜¯å‚æ•°dictï¼‰</li></ul></blockquote><h2 id="Decoratorçš„å‰¯ä½œç”¨"><a href="#Decoratorçš„å‰¯ä½œç”¨" class="headerlink" title="Decoratorçš„å‰¯ä½œç”¨"></a>Decoratorçš„å‰¯ä½œç”¨</h2><blockquote><p>==<strong>ä¼šæ©ç›–åŸæœ‰å‡½æ•°</strong>==ï¼Œ å¯¹äºæœ€å‰é¢é‚£ä¸ªhello.pyçš„ä¾‹å­æ¥è¯´ï¼Œå¦‚æœä½ æŸ¥è¯¢ä¸€ä¸‹foo.<strong>name</strong>çš„è¯ï¼Œä½ ä¼šå‘ç°å…¶è¾“å‡ºçš„æ˜¯â€œwrapperâ€ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„â€œfooâ€ï¼Œè¿™ä¼šç»™æˆ‘ä»¬çš„ç¨‹åºåŸ‹ä¸€äº›å‘ã€‚æ‰€ä»¥ï¼ŒPythonçš„functoolåŒ…ä¸­æä¾›äº†ä¸€ä¸ªå«wrapçš„decoratoræ¥æ¶ˆé™¤è¿™æ ·çš„å‰¯ä½œç”¨ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">fn</span>):</span><br><span class="line"></span><br><span class="line"><span class="meta">@wraps(<span class="params">fn</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wrapper</span>():</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello, %s&quot;</span>)% fn.__name__</span><br><span class="line">fn()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;goodby, %s&quot;</span>)% fn.__name__</span><br><span class="line"><span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@hello</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;foo help doc&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i am foo&quot;</span>)</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line"><span class="built_in">print</span>(foo.__name__) <span class="comment">#è¾“å‡º foo</span></span><br><span class="line"><span class="built_in">print</span>(foo.__doc__) <span class="comment">#è¾“å‡º foo help doc</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½†åœ¨<code>getargspec</code>æ—¶å‰¯ä½œç”¨ä¸èƒ½å®Œå…¨æ¶ˆé™¤ã€‚</p></blockquote><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="https://www.cnblogs.com/zh605929205/p/7704902.html">è£…é¥°å™¨å‚è€ƒ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> è£…é¥°å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python_å¯¹è±¡</title>
      <link href="/2022/04/29/python-%E5%AF%B9%E8%B1%A1/"/>
      <url>/2022/04/29/python-%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="python-é¢å‘å¯¹è±¡"><a href="#python-é¢å‘å¯¹è±¡" class="headerlink" title="python é¢å‘å¯¹è±¡"></a>python é¢å‘å¯¹è±¡</h1><h2 id="é¢å‘å¯¹è±¡åŸºç¡€"><a href="#é¢å‘å¯¹è±¡åŸºç¡€" class="headerlink" title="é¢å‘å¯¹è±¡åŸºç¡€"></a>é¢å‘å¯¹è±¡åŸºç¡€</h2><h3 id="åŸºæœ¬ç‰¹å¾"><a href="#åŸºæœ¬ç‰¹å¾" class="headerlink" title="åŸºæœ¬ç‰¹å¾"></a>åŸºæœ¬ç‰¹å¾</h3><ul><li>ç±»ï¼šæè¿°å…·æœ‰==ç›¸åŒå±æ€§å’Œæ–¹æ³•==çš„é›†åˆã€‚</li><li>ç±»å˜é‡ï¼šå®šä¹‰åœ¨å‡½æ•°ä½“ä¹‹å¤–ï¼Œåœ¨å®ä¾‹åŒ–å¯¹è±¡ä¸­æ˜¯==å…¬ç”¨==çš„ã€‚</li><li>æ•°æ®æˆå‘˜ï¼š==ç±»å˜é‡==æˆ–è€…==å®ä¾‹å˜é‡==ã€‚</li><li>æ–¹æ³•é‡å†™ï¼šä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•ä¸èƒ½æ»¡è¶³å­ç±»çš„éœ€æ±‚ã€‚å¯¹å…¶è¿›è¡Œæ”¹å†™ã€‚</li><li>å±€éƒ¨å˜é‡ï¼šå®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å˜é‡ï¼Œ<strong>åªç”¨äºå½“å‰å®ä¾‹çš„ç±»</strong>ã€‚</li><li>å®ä¾‹å˜é‡ï¼šåœ¨ç±»çš„å£°æ˜å†…éƒ¨ä½†æ˜¯åœ¨ç±»çš„å…¶ä»–æˆå‘˜æ–¹æ³•ä¹‹å¤–å£°æ˜ã€‚</li><li>ç»§æ‰¿ï¼š1.æ´¾ç”Ÿç±» 2.ç»§æ‰¿åŸºç±»</li><li>å®ä¾‹åŒ–ï¼šåˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œç±»çš„å…·ä½“å¯¹è±¡ã€‚</li><li>æ–¹æ³•ï¼šç±»ä¸­<strong>å®šä¹‰çš„å‡½æ•°</strong>ã€‚</li><li>å¯¹è±¡ï¼šé€šè¿‡ç±»å®šä¹‰çš„<strong>æ•°æ®ç»“æ„å®ä¾‹</strong>ã€‚åŒ…æ‹¬ç±»å˜é‡å’Œå®ä¾‹å˜é‡ã€‚</li></ul><hr><h3 id="åˆ›å»ºç±»"><a href="#åˆ›å»ºç±»" class="headerlink" title="åˆ›å»ºç±»"></a>åˆ›å»ºç±»</h3><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span>:</span><br><span class="line">    <span class="string">&#x27;æ‰€æœ‰å‘˜å·¥çš„åŸºç±»&#x27;</span></span><br><span class="line">    emCount = <span class="number">0</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, salary</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.salary = salary</span><br><span class="line">        Employee.empCount += <span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">displayCount</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Total Employee <span class="subst">&#123;Employee.empCount&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">displayEmployee</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Name:<span class="subst">&#123;self.name&#125;</span> Salary:<span class="subst">&#123;self.salary&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>empCount å˜é‡æ˜¯ä¸€ä¸ªç±»å˜é‡ï¼Œå¯ä»¥åœ¨è¿™ä¸ªç±»çš„æ‰€æœ‰å®ä¾‹ä¹‹é—´å…±äº«ã€‚</li><li>__init__()æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œæ˜¯ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚</li><li>selfä»£è¡¨==ç±»çš„å®ä¾‹==ã€‚selfåœ¨å®šä¹‰ç±»çš„æ–¹æ³•æ—¶<strong>å¿…é¡»å­˜åœ¨</strong>ï¼Œä½†æ˜¯åœ¨==è°ƒç”¨æ—¶ä¸å¿…ä¼ å…¥ç›¸åº”çš„å‚æ•°==ã€‚<h4 id="self"><a href="#self" class="headerlink" title="self"></a>self</h4>ç±»çš„æ–¹æ³•å’Œæ™®é€šå‡½æ•°åªæœ‰ä¸€ä¸ªç‰¹åˆ«çš„åŒºåˆ«â€”â€”<strong>å¿…é¡»æœ‰ä¸€ä¸ªé¢å¤–çš„ç¬¬ä¸€ä¸ªå‚æ•°åç§°</strong>ï¼Œå³selfã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">prt</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(self)</span><br><span class="line">        <span class="built_in">print</span>(self.__class__)</span><br><span class="line"> </span><br><span class="line">t = Test()</span><br><span class="line">t.prt()</span><br></pre></td></tr></table></figure>selfä»£è¡¨çš„æ˜¯ç±»çš„å®ä¾‹ï¼Œæ˜¯<strong>å½“å‰å¯¹è±¡çš„åœ°å€</strong>ã€‚è€Œ==self.<strong>class</strong>==åˆ™æŒ‡å‘ç±»ã€‚selfépythonä¸­çš„å…³é”®å­—ï¼Œå¯ä»¥è¿›è¡Œæ›¿æ¢ã€‚<h4 id="åˆ›å»ºå®ä¾‹å¯¹è±¡"><a href="#åˆ›å»ºå®ä¾‹å¯¹è±¡" class="headerlink" title="åˆ›å»ºå®ä¾‹å¯¹è±¡"></a>åˆ›å»ºå®ä¾‹å¯¹è±¡</h4>pythonä¸­ç±»çš„å®ä¾‹åŒ–ç±»ä¼¼å‡½æ•°è°ƒç”¨æ–¹å¼ï¼Œä»¥ä¸‹ä½¿ç”¨ç±»çš„åç§°Employeeæ¥å®ä¾‹åŒ–ï¼Œ==é€šè¿‡<strong>init</strong>æ–¹æ³•æ¥æ¥æ”¶å‚æ•°==ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&quot;åˆ›å»º Employee ç±»çš„ç¬¬ä¸€ä¸ªå¯¹è±¡&quot;</span></span><br><span class="line">emp1 = Employee(<span class="string">&quot;Zara&quot;</span>, <span class="number">2000</span>)</span><br><span class="line"><span class="comment">#&quot;åˆ›å»º Employee ç±»çš„ç¬¬äºŒä¸ªå¯¹è±¡&quot;</span></span><br><span class="line">emp2 = Employee(<span class="string">&quot;Manni&quot;</span>, <span class="number">5000</span>)</span><br></pre></td></tr></table></figure></li></ul><hr><h3 id="è®¿é—®å±æ€§"><a href="#è®¿é—®å±æ€§" class="headerlink" title="è®¿é—®å±æ€§"></a>è®¿é—®å±æ€§</h3><p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ç±»çš„åç§°è®¿é—®ç±»å˜é‡ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">emp1.displayEmployee()</span><br><span class="line">emp2.displayEmployee()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Total Employee &#123;Employee.empCount&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><br>å®Œæ•´å®ä¾‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span>:</span><br><span class="line">   <span class="string">&#x27;æ‰€æœ‰å‘˜å·¥çš„åŸºç±»&#x27;</span></span><br><span class="line">   empCount = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, salary</span>):</span><br><span class="line">      self.name = name</span><br><span class="line">      self.salary = salary</span><br><span class="line">      Employee.empCount += <span class="number">1</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">displayCount</span>(<span class="params">self</span>):</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">f&quot;Total Employee: <span class="subst">&#123;Employee.empCount&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">displayEmployee</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&quot;Name : <span class="subst">&#123;self.name&#125;</span> Salary : <span class="subst">&#123;self.salary&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#&quot;åˆ›å»º Employee ç±»çš„ç¬¬ä¸€ä¸ªå¯¹è±¡&quot;</span></span><br><span class="line">emp1 = Employee(<span class="string">&quot;Zara&quot;</span>, <span class="number">2000</span>)</span><br><span class="line"><span class="comment">#&quot;åˆ›å»º Employee ç±»çš„ç¬¬äºŒä¸ªå¯¹è±¡&quot;</span></span><br><span class="line">emp2 = Employee(<span class="string">&quot;Manni&quot;</span>, <span class="number">5000</span>)</span><br><span class="line">emp1.displayEmployee()</span><br><span class="line">emp2.displayEmployee()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Total Employee: <span class="subst">&#123;Employee.empCount&#125;</span>&quot;</span>) </span><br></pre></td></tr></table></figure><br>ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Name :  Zara ,Salary:  <span class="number">2000</span></span><br><span class="line">Name :  Manni ,Salary:  <span class="number">5000</span></span><br><span class="line">Total Employee <span class="number">2</span></span><br></pre></td></tr></table></figure><br>æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ç±»çš„å±æ€§ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">emp1.age = <span class="number">7</span>  <span class="comment"># æ·»åŠ ä¸€ä¸ª &#x27;age&#x27; å±æ€§</span></span><br><span class="line">emp1.age = <span class="number">8</span>  <span class="comment"># ä¿®æ”¹ &#x27;age&#x27; å±æ€§</span></span><br><span class="line"><span class="keyword">del</span> emp1.age  <span class="comment"># åˆ é™¤ &#x27;age&#x27; å±æ€§</span></span><br></pre></td></tr></table></figure><br>å‡½æ•°è®¿é—®å±æ€§</p><ul><li>getattr(obj, name[,default]):è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚</li><li>hasattr(obj, name):æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå±æ€§ã€‚</li><li>setattr(obj,name,value):è®¾ç½®ä¸€ä¸ªå±æ€§ã€‚è‹¥å±æ€§ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å±æ€§ã€‚</li><li>delattr(obj, name):åˆ é™¤å±æ€§<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">hasattr</span>(emp1, <span class="string">&#x27;age&#x27;</span>)    <span class="comment"># å¦‚æœå­˜åœ¨ &#x27;age&#x27; å±æ€§è¿”å› Trueã€‚</span></span><br><span class="line"><span class="built_in">getattr</span>(emp1, <span class="string">&#x27;age&#x27;</span>)    <span class="comment"># è¿”å› &#x27;age&#x27; å±æ€§çš„å€¼</span></span><br><span class="line"><span class="built_in">setattr</span>(emp1, <span class="string">&#x27;age&#x27;</span>, <span class="number">8</span>) <span class="comment"># æ·»åŠ å±æ€§ &#x27;age&#x27; å€¼ä¸º 8</span></span><br><span class="line"><span class="built_in">delattr</span>(emp1, <span class="string">&#x27;age&#x27;</span>)    <span class="comment"># åˆ é™¤å±æ€§ &#x27;age&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="pythonå†…ç½®ç±»å±æ€§"><a href="#pythonå†…ç½®ç±»å±æ€§" class="headerlink" title="pythonå†…ç½®ç±»å±æ€§"></a>pythonå†…ç½®ç±»å±æ€§</h2></li><li><strong>dict</strong> : ç±»çš„å±æ€§ï¼ˆåŒ…å«ä¸€ä¸ªå­—å…¸ï¼Œç”±ç±»çš„æ•°æ®å±æ€§ç»„æˆï¼‰</li><li><strong>doc</strong> :ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²</li><li><strong>name</strong>: ç±»å</li><li><strong>module</strong>: ç±»å®šä¹‰æ‰€åœ¨çš„æ¨¡å—</li><li><strong>bases</strong> : ç±»çš„æ‰€æœ‰çˆ¶ç±»æ„æˆå…ƒç´ <br>å®ä¾‹å¦‚ä¸‹ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span>:</span><br><span class="line">   <span class="string">&#x27;æ‰€æœ‰å‘˜å·¥çš„åŸºç±»&#x27;</span></span><br><span class="line">   empCount = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, salary</span>):</span><br><span class="line">      self.name = name</span><br><span class="line">      self.salary = salary</span><br><span class="line">      Employee.empCount += <span class="number">1</span></span><br><span class="line">   </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">displayCount</span>(<span class="params">self</span>):</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">f&quot;Total Employee <span class="subst">&#123;Employee.empCount&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">displayEmployee</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&quot;Name : <span class="subst">&#123;self.name&#125;</span> Salary : <span class="subst">&#123;self.salary&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Employee.__doc__:&#123;Employee.__doc__&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Employee.__name__:&#123;Employee.__name__&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Employee.__module__:&#123;Employee.__module__&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Employee.__bases__:&#123;Employee.__bases__&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Employee.__dict__:&#123;Employee.__dict__&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>ç»“æœå¦‚ä¸‹<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Employee.__doc__: æ‰€æœ‰å‘˜å·¥çš„åŸºç±»</span><br><span class="line">Employee.__name__: Employee</span><br><span class="line">Employee.__module__: __main__</span><br><span class="line">Employee.__bases__: ()</span><br><span class="line">Employee.__dict__: &#123;<span class="string">&#x27;__module__&#x27;</span>: <span class="string">&#x27;__main__&#x27;</span>, <span class="string">&#x27;displayCount&#x27;</span>: &lt;function displayCount at <span class="number">0x10a939c80</span>&gt;, <span class="string">&#x27;empCount&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;displayEmployee&#x27;</span>: &lt;function displayEmployee at <span class="number">0x10a93caa0</span>&gt;, <span class="string">&#x27;__doc__&#x27;</span>: <span class="string">&#x27;\xe6\x89\x80\xe6\x9c\x89\xe5\x91\x98\xe5\xb7\xa5\xe7\x9a\x84\xe5\x9f\xba\xe7\xb1\xbb&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>: &lt;function __init__ at <span class="number">0x10a939578</span>&gt;&#125;</span><br></pre></td></tr></table></figure><h3 id="pythonå¯¹è±¡é”€æ¯"><a href="#pythonå¯¹è±¡é”€æ¯" class="headerlink" title="pythonå¯¹è±¡é”€æ¯"></a>pythonå¯¹è±¡é”€æ¯</h3>åœ¨ Python å†…éƒ¨<strong>è®°å½•ç€æ‰€æœ‰ä½¿ç”¨ä¸­çš„å¯¹è±¡å„æœ‰å¤šå°‘å¼•ç”¨</strong>ã€‚==ä¸€ä¸ªå†…éƒ¨è·Ÿè¸ªå˜é‡ï¼Œç§°ä¸ºä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨==<br>å½“å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œ å°±åˆ›å»ºäº†ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œ å½“è¿™ä¸ªå¯¹è±¡ä¸å†éœ€è¦æ—¶ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œ è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å˜ä¸º0 æ—¶ï¼Œ å®ƒè¢«åƒåœ¾å›æ”¶ã€‚ä½†æ˜¯<strong>å›æ”¶ä¸æ˜¯â€ç«‹å³â€çš„</strong>ï¼Œ ç”±è§£é‡Šå™¨åœ¨é€‚å½“çš„æ—¶æœºï¼Œå°†åƒåœ¾å¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´å›æ”¶ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">40</span>      <span class="comment"># åˆ›å»ºå¯¹è±¡  &lt;40&gt;</span></span><br><span class="line">b = a       <span class="comment"># å¢åŠ å¼•ç”¨ï¼Œ &lt;40&gt; çš„è®¡æ•°</span></span><br><span class="line">c = [b]     <span class="comment"># å¢åŠ å¼•ç”¨.  &lt;40&gt; çš„è®¡æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> a       <span class="comment"># å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°</span></span><br><span class="line">b = <span class="number">100</span>     <span class="comment"># å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°</span></span><br><span class="line">c[<span class="number">0</span>] = -<span class="number">1</span>   <span class="comment"># å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°</span></span><br></pre></td></tr></table></figure><strong>å®ä¾‹</strong><br>ææ„å‡½æ•° <strong>del</strong> ï¼Œ<strong>del</strong>åœ¨å¯¹è±¡é”€æ¯çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå½“å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶ï¼Œ<strong>del</strong>æ–¹æ³•è¿è¡Œï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span>:</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"> self, x=<span class="number">0</span>, y=<span class="number">0</span></span>):</span><br><span class="line">      self.x = x</span><br><span class="line">      self.y = y</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">      class_name = self.__class__.__name__</span><br><span class="line">      <span class="built_in">print</span>(class_name, <span class="string">&quot;é”€æ¯&quot;</span>)</span><br><span class="line"> </span><br><span class="line">pt1 = Point()</span><br><span class="line">pt2 = pt1</span><br><span class="line">pt3 = pt1</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(pt1), <span class="built_in">id</span>(pt2), <span class="built_in">id</span>(pt3)) <span class="comment"># æ‰“å°å¯¹è±¡çš„id</span></span><br><span class="line"><span class="keyword">del</span> pt1</span><br><span class="line"><span class="keyword">del</span> pt2</span><br><span class="line"><span class="keyword">del</span> pt3</span><br></pre></td></tr></table></figure>ç»“æœå¦‚ä¸‹<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3083401324</span> <span class="number">3083401324</span> <span class="number">3083401324</span></span><br><span class="line">Point é”€æ¯</span><br></pre></td></tr></table></figure><h3 id="ç±»çš„ç»§æ‰¿"><a href="#ç±»çš„ç»§æ‰¿" class="headerlink" title="ç±»çš„ç»§æ‰¿"></a>ç±»çš„ç»§æ‰¿</h3>é¢å‘å¯¹è±¡çš„ç¼–ç¨‹å¸¦æ¥çš„ä¸»è¦å¥½å¤„ä¹‹ä¸€æ˜¯ä»£ç çš„<strong>é‡ç”¨</strong>ï¼Œå®ç°è¿™ç§é‡ç”¨çš„æ–¹æ³•ä¹‹ä¸€æ˜¯é€šè¿‡==ç»§æ‰¿æœºåˆ¶==ã€‚<br>é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„æ–°ç±»ç§°ä¸º<strong>å­ç±»</strong>æˆ–<strong>æ´¾ç”Ÿç±»</strong>ï¼Œè¢«ç»§æ‰¿çš„ç±»ç§°ä¸º<strong>åŸºç±»ã€çˆ¶ç±»</strong>æˆ–<strong>è¶…ç±»</strong>ã€‚<br><strong>è¯­æ³•</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">æ´¾ç”Ÿç±»å</span>(<span class="title class_ inherited__">åŸºç±»å</span>)</span><br><span class="line">    â€¦â€¦</span><br></pre></td></tr></table></figure>å¦‚æœåœ¨ç»§æ‰¿å…ƒç»„ä¸­åˆ—äº†ä¸€ä¸ªä»¥ä¸Šçš„ç±»ï¼Œé‚£ä¹ˆå®ƒå°±è¢«ç§°ä¸º==å¤šé‡ç»§æ‰¿==ã€‚<br><strong>è¯­æ³•ï¼š</strong><br>æ´¾ç”Ÿç±»çš„å£°æ˜ï¼Œä¸ä»–ä»¬çš„çˆ¶ç±»ç±»ä¼¼ï¼Œç»§æ‰¿çš„åŸºç±»åˆ—è¡¨è·Ÿåœ¨ç±»åä¹‹åï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SubClassName</span>(ParentClass1[,ParentClass2, ...])</span><br></pre></td></tr></table></figure><strong>å®ä¾‹</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span>:        <span class="comment"># å®šä¹‰çˆ¶ç±»</span></span><br><span class="line">   parentAttr = <span class="number">100</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&quot;è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°&quot;</span></span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">parentMethod</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&#x27;è°ƒç”¨çˆ¶ç±»æ–¹æ³•&#x27;</span></span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">setAttr</span>(<span class="params">self, attr</span>):</span><br><span class="line">      Parent.parentAttr = attr</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">getAttr</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&quot;çˆ¶ç±»å±æ€§ :&quot;</span>, Parent.parentAttr</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span>(<span class="title class_ inherited__">Parent</span>): <span class="comment"># å®šä¹‰å­ç±»</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&quot;è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•&quot;</span></span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">childMethod</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&#x27;è°ƒç”¨å­ç±»æ–¹æ³•&#x27;</span></span><br><span class="line"> </span><br><span class="line">c = Child()          <span class="comment"># å®ä¾‹åŒ–å­ç±»</span></span><br><span class="line">c.childMethod()      <span class="comment"># è°ƒç”¨å­ç±»çš„æ–¹æ³•</span></span><br><span class="line">c.parentMethod()     <span class="comment"># è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span></span><br><span class="line">c.setAttr(<span class="number">200</span>)       <span class="comment"># å†æ¬¡è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• - è®¾ç½®å±æ€§å€¼</span></span><br><span class="line">c.getAttr()          <span class="comment"># å†æ¬¡è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• - è·å–å±æ€§å€¼</span></span><br></pre></td></tr></table></figure>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•</span><br><span class="line">è°ƒç”¨å­ç±»æ–¹æ³•</span><br><span class="line">è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span><br><span class="line">çˆ¶ç±»å±æ€§ : <span class="number">200</span></span><br></pre></td></tr></table></figure><strong>å¤šç±»ç»§æ‰¿</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:        <span class="comment"># å®šä¹‰ç±» A</span></span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>:         <span class="comment"># å®šä¹‰ç±» B</span></span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(A, B):   <span class="comment"># ç»§æ‰¿ç±» A å’Œ B</span></span><br><span class="line">.....</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•é‡å†™"><a href="#æ–¹æ³•é‡å†™" class="headerlink" title="æ–¹æ³•é‡å†™"></a>æ–¹æ³•é‡å†™</h3>==å½“çˆ¶ç±»æ–¹æ³•çš„åŠŸèƒ½ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥åœ¨å­ç±»ä¸­é‡å†™çˆ¶ç±»==<br><strong>å®ä¾‹</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span>:        <span class="comment"># å®šä¹‰çˆ¶ç±»</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">myMethod</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&#x27;è°ƒç”¨çˆ¶ç±»æ–¹æ³•&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span>(<span class="title class_ inherited__">Parent</span>): <span class="comment"># å®šä¹‰å­ç±»</span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">myMethod</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&#x27;è°ƒç”¨å­ç±»æ–¹æ³•&#x27;</span></span><br><span class="line"> </span><br><span class="line">c = Child()          <span class="comment"># å­ç±»å®ä¾‹</span></span><br><span class="line">c.myMethod()         <span class="comment"># å­ç±»è°ƒç”¨é‡å†™æ–¹æ³•</span></span><br></pre></td></tr></table></figure>ç»“æœå¦‚ä¸‹ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨å­ç±»æ–¹æ³•</span><br></pre></td></tr></table></figure><h2 id="åŸºç¡€é‡è½½æ–¹æ³•"><a href="#åŸºç¡€é‡è½½æ–¹æ³•" class="headerlink" title="åŸºç¡€é‡è½½æ–¹æ³•"></a>åŸºç¡€é‡è½½æ–¹æ³•</h2><a href="https://www.runoob.com/python/python-object.html">èœé¸Ÿæ•™ç¨‹</a><h3 id="è¿ç®—ç¬¦é‡è½½"><a href="#è¿ç®—ç¬¦é‡è½½" class="headerlink" title="è¿ç®—ç¬¦é‡è½½"></a>è¿ç®—ç¬¦é‡è½½</h3><strong>å®ä¾‹</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vector</span>:</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b</span>):</span><br><span class="line">      self.a = a</span><br><span class="line">      self.b = b</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Vector (%d, %d)&#x27;</span> % (self.a, self.b)</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self,other</span>):</span><br><span class="line">      <span class="keyword">return</span> Vector(self.a + other.a, self.b + other.b)</span><br><span class="line"> </span><br><span class="line">v1 = Vector(<span class="number">2</span>,<span class="number">10</span>)</span><br><span class="line">v2 = Vector(<span class="number">5</span>,-<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span> v1 + v2</span><br></pre></td></tr></table></figure>ç»“æœå¦‚ä¸‹<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vector(<span class="number">7</span>,<span class="number">8</span>)</span><br></pre></td></tr></table></figure><h3 id="ç±»çš„ç§æœ‰å±æ€§"><a href="#ç±»çš„ç§æœ‰å±æ€§" class="headerlink" title="ç±»çš„ç§æœ‰å±æ€§"></a>ç±»çš„ç§æœ‰å±æ€§</h3><strong>__private_attrs</strong>:ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜è¯¥å±æ€§ä¸ºç§æœ‰ã€‚ç±»å¤–éƒ¨ä¸èƒ½ä½¿ç”¨æˆ–ç›´æ¥è®¿é—®ã€‚ç±»å†…éƒ¨çš„æ–¹æ³•ä¸­ä½¿ç”¨<strong>self.__private_attrs</strong>ã€‚<h3 id="ç±»çš„æ–¹æ³•"><a href="#ç±»çš„æ–¹æ³•" class="headerlink" title="ç±»çš„æ–¹æ³•"></a>ç±»çš„æ–¹æ³•</h3>åœ¨ç±»çš„å†…éƒ¨ï¼Œä½¿ç”¨==def==å…³é”®å­—å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œä¸ä¸€èˆ¬å‡½æ•°ä¸åŒçš„æ˜¯ç±»æ–¹æ³•å¿…é¡»åŒ…å«å‚æ•°selfï¼Œä¸”ä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚<h2 id="ç±»çš„ç§æœ‰æ–¹æ³•"><a href="#ç±»çš„ç§æœ‰æ–¹æ³•" class="headerlink" title="ç±»çš„ç§æœ‰æ–¹æ³•"></a>ç±»çš„ç§æœ‰æ–¹æ³•</h2><strong>__private_method</strong>:å®šä¹‰è¯¥æ–¹æ³•ä¸ºç±»çš„ç§æœ‰æ–¹æ³•ï¼Œä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨è°ƒç”¨ã€‚åœ¨ç±»çš„å†…éƒ¨è°ƒç”¨ä½¿ç”¨<strong>self.__private_methods</strong><br>å®ä¾‹ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">JustCounter</span>:</span><br><span class="line">    __secretCount = <span class="number">0</span>  <span class="comment"># ç§æœ‰å˜é‡</span></span><br><span class="line">    publicCount = <span class="number">0</span>    <span class="comment"># å…¬å¼€å˜é‡</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">count</span>(<span class="params">self</span>):</span><br><span class="line">        self.__secretCount += <span class="number">1</span></span><br><span class="line">        self.publicCount += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span> self.__secretCount</span><br><span class="line"> </span><br><span class="line">counter = JustCounter()</span><br><span class="line">counter.count()</span><br><span class="line">counter.count()</span><br><span class="line"><span class="built_in">print</span> counter.publicCount</span><br><span class="line"><span class="built_in">print</span> counter.__secretCount  <span class="comment"># æŠ¥é”™ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®ç§æœ‰å˜é‡</span></span><br></pre></td></tr></table></figure>å¯ä»¥ä½¿ç”¨==object._className__attrName==è®¿é—®å±æ€§ï¼Œå®ä¾‹å¦‚ä¸‹<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Runoob</span>:</span><br><span class="line">    __site = <span class="string">&quot;www.runoob.com&quot;</span></span><br><span class="line"></span><br><span class="line">runoob = Runoob()</span><br><span class="line"><span class="built_in">print</span> runoob._Runoob__site</span><br></pre></td></tr></table></figure>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š<blockquote><p>www.runoob.com</p></blockquote></li></ul><h2 id="å•ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜"><a href="#å•ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜" class="headerlink" title="==å•ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜=="></a>==å•ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜==</h2><ul><li><strong>__foo__</strong>:å®šä¹‰ç‰¹æ®Šæ–¹æ³•ï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿå®šä¹‰åå­—ï¼Œç±»ä¼¼ <strong>__init__()</strong></li><li>_foo:ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´çš„è¡¨ç¤ºçš„æ˜¯ protected ç±»å‹çš„å˜é‡ï¼Œå³ä¿æŠ¤ç±»å‹åªèƒ½å…è®¸å…¶æœ¬èº«ä¸å­ç±»è¿›è¡Œè®¿é—®ï¼Œä¸èƒ½ç”¨äº ==from module import *==</li><li>__foo:åŒä¸‹åˆ’çº¿è¡¨ç¤ºç§æœ‰ç±»å‹å˜é‡ï¼Œåªèƒ½å…è®¸è¿™ä¸ªç±»æœ¬èº«è¿›è¡Œè®¿é—®ã€‚</li></ul><hr><h2 id="é¢å‘å¯¹è±¡è¿›é˜¶"><a href="#é¢å‘å¯¹è±¡è¿›é˜¶" class="headerlink" title="é¢å‘å¯¹è±¡è¿›é˜¶"></a>é¢å‘å¯¹è±¡è¿›é˜¶</h2><h3 id="propertyè£…é¥°å™¨"><a href="#propertyè£…é¥°å™¨" class="headerlink" title="propertyè£…é¥°å™¨"></a>propertyè£…é¥°å™¨</h3><p>åœ¨pythonä¸­==ä¸å»ºè®®å°†å±æ€§è®¾ç½®ä¸ºç§æœ‰==ï¼Œä½†æ˜¯å¦‚æœç›´æ¥å°†å±æ€§æš´éœ²ç»™å¤–ç•Œä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æ²¡æœ‰åŠæ³•æ£€æŸ¥èµ‹ç»™å±æ€§çš„å€¼æ˜¯å¦æœ‰æ•ˆã€‚å¯ä»¥é€šè¿‡å±æ€§çš„getter(è®¿é—®å™¨)å’Œsetter(ä¿®æ”¹å™¨)æ–¹æ³•è¿›è¡Œå¯¹åº”çš„æ“ä½œã€‚<strong>å¯ä»¥è€ƒè™‘ä½¿ç”¨@propertyåŒ…è£…å™¨æ¥åŒ…è£…getterå’Œsetteræ–¹æ³•</strong>ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self._name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¿é—®å™¨ - getteræ–¹æ³•</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¿é—®å™¨ - getteræ–¹æ³•</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿®æ”¹å™¨ - setteræ–¹æ³•</span></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self, age</span>):</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self._age &lt;= <span class="number">16</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨ç©é£è¡Œæ£‹.&#x27;</span> % self._name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨ç©æ–—åœ°ä¸».&#x27;</span> % self._name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    person = Person(<span class="string">&#x27;ç‹å¤§é”¤&#x27;</span>, <span class="number">12</span>)</span><br><span class="line">    person.play()</span><br><span class="line">    person.age = <span class="number">22</span></span><br><span class="line">    person.play()</span><br><span class="line">    <span class="comment"># person.name = &#x27;ç™½å…ƒèŠ³&#x27;  # AttributeError: can&#x27;t set attribute</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p><h3 id="slotdé­”æ³•"><a href="#slotdé­”æ³•" class="headerlink" title="slotdé­”æ³•"></a><strong>slotd</strong>é­”æ³•</h3><p>pythonæ˜¯ä¸€é—¨==åŠ¨æ€è¯­è¨€==ã€‚åŠ¨æ€è¯­è¨€å…è®¸æˆ‘ä»¬åœ¨<strong>ç¨‹åºè¿è¡Œ</strong>æ—¶==ç»™å¯¹è±¡ç»‘å®šè¡Œçš„å±æ€§å’Œæ–¹æ³•==ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥==å¯¹å·²ç»‘å®šçš„å±æ€§å’Œæ–¹æ³•è¿›è¡Œè§£ç»‘==ã€‚å½“æˆ‘ä»¬éœ€è¦é™å®šè‡ªå®šä¹‰ç±»å‹çš„å¯¹è±¡åªèƒ½ç»‘å®šæŸäº›å±æ€§ï¼Œåˆ™éœ€è¦ä½¿ç”¨<strong><strong>slots</strong></strong>,==å¯¹å­ç±»å¹¶ä¸èµ·ä»»ä½•å·¦å³ã€‚==<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é™å®šPersonå¯¹è±¡åªèƒ½ç»‘å®š_name, _ageå’Œ_genderå±æ€§</span></span><br><span class="line">    __slots__ = (<span class="string">&#x27;_name&#x27;</span>, <span class="string">&#x27;_age&#x27;</span>, <span class="string">&#x27;_gender&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self._name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self, age</span>):</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self._age &lt;= <span class="number">16</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨ç©é£è¡Œæ£‹.&#x27;</span> % self._name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨ç©æ–—åœ°ä¸».&#x27;</span> % self._name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    person = Person(<span class="string">&#x27;ç‹å¤§é”¤&#x27;</span>, <span class="number">22</span>)</span><br><span class="line">    person.play()</span><br><span class="line">    person._gender = <span class="string">&#x27;ç”·&#x27;</span></span><br><span class="line">    <span class="comment"># AttributeError: &#x27;Person&#x27; object has no attribute &#x27;_is_gay&#x27;</span></span><br><span class="line">    <span class="comment"># person._is_gay = True</span></span><br></pre></td></tr></table></figure></p><h3 id="é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•"><a href="#é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•"></a>é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•</h3><p>å®é™…ä¸­ï¼Œ==ç±»ä¸­çš„æ–¹æ³•å¹¶ä¸éœ€è¦éƒ½æ˜¯å¯¹è±¡çš„æ–¹æ³•==<br><em>ä¾‹å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªâ€œä¸‰è§’å½¢â€ç±»ï¼Œé€šè¿‡ä¼ å…¥ä¸‰æ¡è¾¹é•¿æ¥æ„é€ ä¸‰è§’å½¢ï¼Œå¹¶æä¾›è®¡ç®—å‘¨é•¿å’Œé¢ç§¯çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¼ å…¥çš„ä¸‰æ¡è¾¹é•¿æœªå¿…èƒ½æ„é€ å‡ºä¸‰è§’å½¢å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå†™ä¸€ä¸ªæ–¹æ³•æ¥éªŒè¯ä¸‰æ¡è¾¹é•¿æ˜¯å¦å¯ä»¥æ„æˆä¸‰è§’å½¢ï¼Œè¿™ä¸ªæ–¹æ³•å¾ˆæ˜¾ç„¶å°±ä¸æ˜¯å¯¹è±¡æ–¹æ³•ï¼Œå› ä¸ºåœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ä¸‰è§’å½¢å¯¹è±¡å°šæœªåˆ›å»ºå‡ºæ¥ï¼ˆå› ä¸ºéƒ½ä¸çŸ¥é“ä¸‰æ¡è¾¹èƒ½ä¸èƒ½æ„æˆä¸‰è§’å½¢ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å±äºä¸‰è§’å½¢ç±»è€Œå¹¶ä¸å±äºä¸‰è§’å½¢å¯¹è±¡çš„</em>ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Triangle</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, c</span>):</span><br><span class="line">        self._a = a</span><br><span class="line">        self._b = b</span><br><span class="line">        self._c = c</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_valid</span>(<span class="params">a, b, c</span>):</span><br><span class="line">        <span class="keyword">return</span> a + b &gt; c <span class="keyword">and</span> b + c &gt; a <span class="keyword">and</span> a + c &gt; b</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">perimeter</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._a + self._b + self._c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">area</span>(<span class="params">self</span>):</span><br><span class="line">        half = self.perimeter() / <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> sqrt(half * (half - self._a) *</span><br><span class="line">                    (half - self._b) * (half - self._c))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    a, b, c = <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span></span><br><span class="line">    <span class="comment"># é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•éƒ½æ˜¯é€šè¿‡ç»™ç±»å‘æ¶ˆæ¯æ¥è°ƒç”¨çš„</span></span><br><span class="line">    <span class="keyword">if</span> Triangle.is_valid(a, b, c):</span><br><span class="line">        t = Triangle(a, b, c)</span><br><span class="line">        <span class="built_in">print</span>(t.perimeter())</span><br><span class="line">        <span class="comment"># ä¹Ÿå¯ä»¥é€šè¿‡ç»™ç±»å‘æ¶ˆæ¯æ¥è°ƒç”¨å¯¹è±¡æ–¹æ³•ä½†æ˜¯è¦ä¼ å…¥æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡ä½œä¸ºå‚æ•°</span></span><br><span class="line">        <span class="comment"># print(Triangle.perimeter(t))</span></span><br><span class="line">        <span class="built_in">print</span>(t.area())</span><br><span class="line">        <span class="comment"># print(Triangle.area(t))</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;æ— æ³•æ„æˆä¸‰è§’å½¢.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><br>å’Œé™æ€æ–¹æ³•æ¯”è¾ƒç±»ä¼¼ï¼ŒPythonè¿˜å¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ç±»æ–¹æ³•ï¼Œç±»æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°çº¦å®šåä¸º==cls==ï¼Œ<strong>å®ƒä»£è¡¨çš„æ˜¯å½“å‰ç±»ç›¸å…³çš„ä¿¡æ¯çš„å¯¹è±¡ï¼ˆç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰çš„åœ°æ–¹ä¹Ÿç§°ä¹‹ä¸ºç±»çš„å…ƒæ•°æ®å¯¹è±¡ï¼‰</strong>ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥è·å–å’Œç±»ç›¸å…³çš„ä¿¡æ¯å¹¶ä¸”å¯ä»¥åˆ›å»ºå‡ºç±»çš„å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time, localtime, sleep</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Clock</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ•°å­—æ—¶é’Ÿ&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, hour=<span class="number">0</span>, minute=<span class="number">0</span>, second=<span class="number">0</span></span>):</span><br><span class="line">        self._hour = hour</span><br><span class="line">        self._minute = minute</span><br><span class="line">        self._second = second</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">now</span>(<span class="params">cls</span>):</span><br><span class="line">        ctime = localtime(time())</span><br><span class="line">        <span class="keyword">return</span> cls(ctime.tm_hour, ctime.tm_min, ctime.tm_sec)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;èµ°å­—&quot;&quot;&quot;</span></span><br><span class="line">        self._second += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self._second == <span class="number">60</span>:</span><br><span class="line">            self._second = <span class="number">0</span></span><br><span class="line">            self._minute += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self._minute == <span class="number">60</span>:</span><br><span class="line">                self._minute = <span class="number">0</span></span><br><span class="line">                self._hour += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> self._hour == <span class="number">24</span>:</span><br><span class="line">                    self._hour = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ˜¾ç¤ºæ—¶é—´&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;%02d:%02d:%02d&#x27;</span> % \</span><br><span class="line">               (self._hour, self._minute, self._second)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># é€šè¿‡ç±»æ–¹æ³•åˆ›å»ºå¯¹è±¡å¹¶è·å–ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line">    clock = Clock.now()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(clock.show())</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        clock.run()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p><h3 id="ç±»ä¹‹é—´çš„å…³ç³»"><a href="#ç±»ä¹‹é—´çš„å…³ç³»" class="headerlink" title="ç±»ä¹‹é—´çš„å…³ç³»"></a>ç±»ä¹‹é—´çš„å…³ç³»</h3><ul><li>is-aå…³ç³»ä¹Ÿå«ç»§æ‰¿æˆ–è€…æ³›åŒ–ï¼Œ<em>æ¯”å¦‚å­¦ç”Ÿå’Œäººçš„å…³ç³»ã€æ‰‹æœºå’Œç”µå­äº§å“çš„å…³ç³»éƒ½å±äºç»§æ‰¿å…³ç³»ã€‚</em></li><li>has-aå…³ç³»ç§°ä¹‹ä¸ºå…³è”ï¼Œ<em>æ¯”å¦‚éƒ¨é—¨å’Œå‘˜å·¥çš„å…³ç³»ï¼Œæ±½è½¦å’Œå¼•æ“çš„å…³ç³»éƒ½å±äºå…³è”å…³ç³»ï¼›å…³è”å…³ç³»å¦‚æœæ˜¯==æ•´ä½“å’Œéƒ¨åˆ†çš„å…³è”==ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°ä¹‹ä¸º==èšåˆå…³ç³»==ï¼›å¦‚æœæ•´ä½“è¿›ä¸€æ­¥è´Ÿè´£äº†éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸï¼ˆæ•´ä½“å’Œéƒ¨åˆ†æ˜¯ä¸å¯åˆ†å‰²çš„ï¼ŒåŒæ—¶åŒåœ¨ä¹ŸåŒæ—¶æ¶ˆäº¡ï¼‰ï¼Œé‚£ä¹ˆè¿™ç§å°±æ˜¯æœ€å¼ºçš„å…³è”å…³ç³»ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåˆæˆå…³ç³»ã€‚</em></li><li>use-aå…³ç³»ç§°ä¸ºä¾èµ–å…³ç³»ï¼Œ<em>æ¯”å¦‚å¸æœºæœ‰ä¸€ä¸ªé©¾é©¶çš„è¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰ï¼Œå…¶ä¸­ï¼ˆçš„å‚æ•°ï¼‰ä½¿ç”¨åˆ°äº†æ±½è½¦ï¼Œé‚£ä¹ˆå¸æœºå’Œæ±½è½¦çš„å…³ç³»å°±æ˜¯ä¾èµ–å…³ç³»ã€‚</em><br><img src="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/res/uml-example.png" alt="ç±»ä¹‹é—´å…³ç³»"><h3 id="ç»§æ‰¿ä¸å¤šæ€"><a href="#ç»§æ‰¿ä¸å¤šæ€" class="headerlink" title="ç»§æ‰¿ä¸å¤šæ€"></a>ç»§æ‰¿ä¸å¤šæ€</h3>è®©ä¸€ä¸ªç±»ä»å¦ä¸€ä¸ªç±»é‚£é‡Œå°†å±æ€§å’Œæ–¹æ³•ç›´æ¥ç»§æ‰¿ä¸‹æ¥ï¼Œä»è€Œå‡å°‘é‡å¤ä»£ç çš„ç¼–å†™ã€‚==å­ç±»é™¤äº†ç»§æ‰¿çˆ¶ç±»æä¾›çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿˜å¯ä»¥å®šä¹‰è‡ªå·±ç‰¹æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰€ä»¥å­ç±»æ¯”çˆ¶ç±»æ‹¥æœ‰çš„æ›´å¤šçš„èƒ½åŠ›==ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;äºº&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self._name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self, age</span>):</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨æ„‰å¿«çš„ç©è€.&#x27;</span> % self._name)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">watch_av</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self._age &gt;= <span class="number">18</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨è§‚çœ‹çˆ±æƒ…åŠ¨ä½œç‰‡.&#x27;</span> % self._name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%såªèƒ½è§‚çœ‹ã€Šç†Šå‡ºæ²¡ã€‹.&#x27;</span> % self._name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">Person</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å­¦ç”Ÿ&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age, grade</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name, age)</span><br><span class="line">        self._grade = grade</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">grade</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._grade</span><br><span class="line"></span><br><span class="line"><span class="meta">    @grade.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">grade</span>(<span class="params">self, grade</span>):</span><br><span class="line">        self._grade = grade</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">study</span>(<span class="params">self, course</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%sçš„%sæ­£åœ¨å­¦ä¹ %s.&#x27;</span> % (self._grade, self._name, course))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span>(<span class="title class_ inherited__">Person</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è€å¸ˆ&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age, title</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name, age)</span><br><span class="line">        self._title = title</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">title</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._title</span><br><span class="line"></span><br><span class="line"><span class="meta">    @title.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">title</span>(<span class="params">self, title</span>):</span><br><span class="line">        self._title = title</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teach</span>(<span class="params">self, course</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s%sæ­£åœ¨è®²%s.&#x27;</span> % (self._name, self._title, course))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    stu = Student(<span class="string">&#x27;ç‹å¤§é”¤&#x27;</span>, <span class="number">15</span>, <span class="string">&#x27;åˆä¸‰&#x27;</span>)</span><br><span class="line">    stu.study(<span class="string">&#x27;æ•°å­¦&#x27;</span>)</span><br><span class="line">    stu.watch_av()</span><br><span class="line">    t = Teacher(<span class="string">&#x27;éª†æ˜Š&#x27;</span>, <span class="number">38</span>, <span class="string">&#x27;ç –å®¶&#x27;</span>)</span><br><span class="line">    t.teach(<span class="string">&#x27;Pythonç¨‹åºè®¾è®¡&#x27;</span>)</span><br><span class="line">    t.watch_av()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³•ä¹‹åï¼Œ<strong>å¯¹çˆ¶ç±»å·²æœ‰çš„æ–¹æ³•ç»™å‡ºæ–°çš„å®ç°ç‰ˆæœ¬</strong>ï¼Œç§°ä¸º==é‡å†™==ã€‚åŒæ—¶ï¼Œ<strong>è®©çˆ¶ç±»çš„åŒä¸€è¡Œä¸ºåœ¨å­ç±»ä¸­æ‹¥æœ‰ä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼Œä¸åŒå­ç±»å¯¹è±¡ä¼šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸º</strong>ï¼Œè¿™å°±æ˜¯==å¤šæ€==<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pet</span>(<span class="built_in">object</span>, metaclass=ABCMeta):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å® ç‰©&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nickname</span>):</span><br><span class="line">        self._nickname = nickname</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">make_voice</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å‘å‡ºå£°éŸ³&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>(<span class="title class_ inherited__">Pet</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç‹—&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">make_voice</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s: æ±ªæ±ªæ±ª...&#x27;</span> % self._nickname)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span>(<span class="title class_ inherited__">Pet</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;çŒ«&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">make_voice</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s: å–µ...å–µ...&#x27;</span> % self._nickname)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    pets = [Dog(<span class="string">&#x27;æ—ºè´¢&#x27;</span>), Cat(<span class="string">&#x27;å‡¯è’‚&#x27;</span>), Dog(<span class="string">&#x27;å¤§é»„&#x27;</span>)]</span><br><span class="line">    <span class="keyword">for</span> pet <span class="keyword">in</span> pets:</span><br><span class="line">        pet.make_voice()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†==Petç±»å¤„ç†æˆäº†ä¸€ä¸ªæŠ½è±¡ç±»==ï¼Œæ‰€è°“<strong>æŠ½è±¡ç±»å°±æ˜¯ä¸èƒ½å¤Ÿåˆ›å»ºå¯¹è±¡çš„ç±»ï¼Œè¿™ç§ç±»çš„å­˜åœ¨å°±æ˜¯ä¸“é—¨ä¸ºäº†è®©å…¶ä»–ç±»å»ç»§æ‰¿å®ƒ</strong>ã€‚Pythonä»è¯­æ³•å±‚é¢å¹¶æ²¡æœ‰åƒJavaæˆ–C#é‚£æ ·æä¾›å¯¹æŠ½è±¡ç±»çš„æ”¯æŒï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡abcæ¨¡å—çš„ABCMetaå…ƒç±»å’ŒabstractmethodåŒ…è£…å™¨æ¥è¾¾åˆ°æŠ½è±¡ç±»çš„æ•ˆæœ</strong>ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­å­˜åœ¨æŠ½è±¡æ–¹æ³•é‚£ä¹ˆè¿™ä¸ªç±»å°±ä¸èƒ½å¤Ÿå®ä¾‹åŒ–ï¼ˆåˆ›å»ºå¯¹è±¡ï¼‰ã€‚ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒDogå’ŒCatä¸¤ä¸ªå­ç±»åˆ†åˆ«å¯¹Petç±»ä¸­çš„make_voiceæŠ½è±¡æ–¹æ³•è¿›è¡Œäº†é‡å†™å¹¶ç»™å‡ºäº†ä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼Œå½“æˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±è¡¨ç°å‡ºäº†å¤šæ€è¡Œä¸ºï¼ˆåŒæ ·çš„æ–¹æ³•åšäº†ä¸åŒçš„äº‹æƒ…ï¼‰<br><a href="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/09.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6.md">reference</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlè¿›é˜¶</title>
      <link href="/2022/04/29/sql%E8%BF%9B%E9%98%B6/"/>
      <url>/2022/04/29/sql%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="MySQLäº‹åŠ¡"><a href="#MySQLäº‹åŠ¡" class="headerlink" title="MySQLäº‹åŠ¡"></a>MySQLäº‹åŠ¡</h1><h2 id="MySQLäº‹åŠ¡ç®€ä»‹"><a href="#MySQLäº‹åŠ¡ç®€ä»‹" class="headerlink" title="MySQLäº‹åŠ¡ç®€ä»‹"></a>MySQLäº‹åŠ¡ç®€ä»‹</h2><p>ğŸ‘‡ä¸¾ä¸ªä¾‹å­ã€‚æ·»åŠ ä¸€ä¸ªé”€å”®è®¢å•çš„æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>é¦–å…ˆï¼Œä» <code>orders</code> è¡¨ä¸­æŸ¥è¯¢æœ€æ–°çš„é”€å”®è®¢å•å·ï¼Œå¹¶ä½¿ç”¨ä¸‹ä¸€ä¸ªé”€å”®è®¢å•å·ä½œä¸ºæ–°çš„é”€å”®è®¢å•å·ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>orders</code> è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„é”€å”®è®¢å•ã€‚</li><li>ç„¶åï¼Œè·å¾—æ–°æ’å…¥çš„é”€å”®è®¢å•å·</li><li>ä¹‹åï¼Œå°†æ–°çš„é”€å”®è®¢å•é¡¹ç›®ä¸é”€å”®è®¢å•å·ä¸€èµ·æ’å…¥åˆ° <code>orderdetails</code> è¡¨ä¸­</li><li>æœ€åï¼Œä» <code>orders</code> å’Œ <code>orderdetails</code> è¡¨ä¸­é€‰æ‹©æ•°æ®ï¼Œä»¥ç¡®è®¤è¿™äº›å˜åŒ–ã€‚</li></ul><blockquote><p>MySQL äº‹åŠ¡å…è®¸ä½ æ‰§è¡Œä¸€ç»„ MySQL æ“ä½œï¼Œä»¥ç¡®ä¿æ•°æ®åº“ä»ä¸åŒ…å«éƒ¨åˆ†æ“ä½œçš„ç»“æœã€‚åœ¨ä¸€ç»„æ“ä½œä¸­ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œå°±ä¼šå‘ç”Ÿå›æ»šï¼Œå°†æ•°æ®åº“æ¢å¤åˆ°å…¶åŸå§‹çŠ¶æ€ã€‚å¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œæ•´ä¸ªè¯­å¥é›†å°±ä¼šæäº¤åˆ°æ•°æ®åº“ä¸­ã€‚</p></blockquote><h2 id="MySQLäº‹åŠ¡è¯­å¥"><a href="#MySQLäº‹åŠ¡è¯­å¥" class="headerlink" title="MySQLäº‹åŠ¡è¯­å¥"></a>MySQLäº‹åŠ¡è¯­å¥</h2><p>MySQLæä¾›äº†ä»¥ä¸‹é‡è¦è¯­å¥æ¥æ§åˆ¶äº‹åŠ¡ï¼š</p><ul><li>ä¸ºäº†å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œä½ ä½¿ç”¨ <code>START TRANSACTION</code> è¯­å¥ã€‚<code>BEGIN</code> æˆ– <code>BEGIN WORK</code> æ˜¯ <code>START TRANSACTION</code> çš„åˆ«åã€‚</li><li>è¦æäº¤å½“å‰äº‹åŠ¡å¹¶ä½¿å…¶å˜åŒ–æ°¸ä¹…åŒ–ï¼Œä½ è¦ä½¿ç”¨ <code>COMMIT</code> è¯­å¥ã€‚</li><li>è¦å›æ»šå½“å‰äº‹åŠ¡å¹¶å–æ¶ˆå…¶å˜åŒ–ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>ROLLBACK</code> è¯­å¥ã€‚</li><li>è¦ç¦ç”¨æˆ–å¯ç”¨å½“å‰äº‹åŠ¡çš„è‡ªåŠ¨æäº¤æ¨¡å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>SET autocommit</code> è¯­å¥ã€‚</li></ul><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL è‡ªåŠ¨å°†æ›´æ”¹æ°¸ä¹…æ€§åœ°æäº¤ç»™æ•°æ®åº“ã€‚è¦å¼ºè¿« MySQL ä¸è‡ªåŠ¨æäº¤æ›´æ”¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­å¥ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- OR --</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> OFF</span><br></pre></td></tr></table></figure><blockquote><p>ä½ ä½¿ç”¨ä¸‹é¢çš„è¯­å¥æ¥æ˜ç¡®åœ°å¯ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- OR --</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="keyword">ON</span>;</span><br></pre></td></tr></table></figure><h2 id="MySQLäº‹åŠ¡å®ä¾‹"><a href="#MySQLäº‹åŠ¡å®ä¾‹" class="headerlink" title="MySQLäº‹åŠ¡å®ä¾‹"></a>MySQLäº‹åŠ¡å®ä¾‹</h2><p>ä½¿ç”¨æ ·æœ¬æ•°æ®åº“ä¸­çš„è®¢å•å’Œ <code>orderDetails</code> è¡¨è¿›è¡Œæ¼”ç¤ºã€‚</p><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/29/1e62ed8a-f038-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="è®¢å•æ¼”ç¤º"></p><h3 id="COMMIT-å®ä¾‹"><a href="#COMMIT-å®ä¾‹" class="headerlink" title="COMMIT å®ä¾‹"></a>COMMIT å®ä¾‹</h3><p>é¦–å…ˆè¦æŠŠ SQL è¯­å¥åˆ†æˆé€»è¾‘éƒ¨åˆ†ï¼Œå¹¶ç¡®å®šæ•°æ®ä½•æ—¶åº”æäº¤æˆ–å›æ»šã€‚<br>ä¸‹é¢è¯´æ˜äº†åˆ›å»ºä¸€ä¸ªæ–°çš„é”€å”®è®¢å•çš„æ­¥éª¤ï¼š</p><ul><li>é¦–å…ˆï¼Œé€šè¿‡ä½¿ç”¨ <code>START TRANSACTION</code> è¯­å¥å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œä» <code>orders</code> è¡¨ä¸­é€‰æ‹©æœ€æ–°çš„é”€å”®è®¢å•å·ï¼Œå¹¶ä½¿ç”¨ä¸‹ä¸€ä¸ªé”€å”®è®¢å•å·ä½œä¸ºæ–°çš„é”€å”®è®¢å•å·ã€‚</li><li>ç„¶åï¼Œåœ¨ <code>orders</code> è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„é”€å”®è®¢å•ã€‚</li><li>ä¹‹åï¼Œåœ¨ <code>orderdetails</code> è¡¨ä¸­æ’å…¥é”€å”®è®¢å•é¡¹ç›®ã€‚</li><li>æœ€åï¼Œä½¿ç”¨ <code>COMMIT</code> è¯­å¥æäº¤è¯¥äº‹åŠ¡ã€‚<br>å¯ä»¥é€‰æ‹©ä» <code>orders</code> å’Œ <code>orderdetails</code> è¡¨ä¸­é€‰æ‹©æ•°æ®æ¥æ£€æŸ¥æ–°çš„é”€å”®è®¢å•ã€‚<br>ç¤ºä¾‹å¦‚ä¸‹<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. start a new transaction</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. Get the latest order number</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="variable">@orderNumber</span>:<span class="operator">=</span><span class="built_in">MAX</span>(orderNUmber)<span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    orders;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. insert a new order for customer 145</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders(orderNumber,</span><br><span class="line">                   orderDate,</span><br><span class="line">                   requiredDate,</span><br><span class="line">                   shippedDate,</span><br><span class="line">                   status,</span><br><span class="line">                   customerNumber)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="variable">@orderNumber</span>,</span><br><span class="line">       <span class="string">&#x27;2005-05-31&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;2005-06-10&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;2005-06-11&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;In Process&#x27;</span>,</span><br><span class="line">        <span class="number">145</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">-- 4. Insert order line items</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orderdetails(orderNumber,</span><br><span class="line">                         productCode,</span><br><span class="line">                         quantityOrdered,</span><br><span class="line">                         priceEach,</span><br><span class="line">                         orderLineNumber)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="variable">@orderNumber</span>,<span class="string">&#x27;S18_1749&#x27;</span>, <span class="number">30</span>, <span class="string">&#x27;136&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">      (<span class="variable">@orderNumber</span>,<span class="string">&#x27;S18_2248&#x27;</span>, <span class="number">50</span>, <span class="string">&#x27;55.09&#x27;</span>, <span class="number">2</span>); </span><br><span class="line">      </span><br><span class="line"><span class="comment">-- 5. commit changes    </span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure></li></ul><p>ä¸ºäº†è·å¾—æ–°åˆ›å»ºçš„é”€å”®è®¢å•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    a.orderNumber,</span><br><span class="line">    orderDate,</span><br><span class="line">    requiredDate,</span><br><span class="line">    shippedDate,</span><br><span class="line">    status,</span><br><span class="line">    comments,</span><br><span class="line">    customerNumber,</span><br><span class="line">    orderLineNumber,</span><br><span class="line">    productCode,</span><br><span class="line">    quantityOrdered,</span><br><span class="line">    priceEach</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    orders a</span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">    orderdetails b <span class="keyword">USING</span> (orderNumber)</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    a.ordernumber <span class="operator">=</span> <span class="number">10426</span>;</span><br></pre></td></tr></table></figure></p><h3 id="ROLLBACK-å®ä¾‹"><a href="#ROLLBACK-å®ä¾‹" class="headerlink" title="ROLLBACK å®ä¾‹"></a>ROLLBACK å®ä¾‹</h3><p>ç™»å½•åˆ° MySQL æ•°æ®åº“æœåŠ¡å™¨ï¼Œä» <code>orders</code> è¡¨ä¸­åˆ é™¤æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">START</span> TRANSACTION;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DELETE</span> <span class="keyword">FROM</span> orders;</span><br><span class="line">Query OK, <span class="number">327</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure><br>MySQL ç¡®è®¤ <code>orders</code> è¡¨ä¸­çš„æ‰€æœ‰è¡Œè¢«åˆ é™¤äº†ã€‚</p><p>ç¬¬äºŒï¼Œåœ¨ä¸€ä¸ªå•ç‹¬çš„ä¼šè¯ä¸­ç™»å½•åˆ° MySQL æ•°æ®åº“æœåŠ¡å™¨ï¼ŒæŸ¥è¯¢ <code>orders</code> è¡¨ä¸­çš„æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> orders;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">327</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ç¬¬äºŒä¸ªä¼šè¯ä¸­ï¼Œä»ç„¶å¯ä»¥çœ‹åˆ° <code>orders</code> è¡¨ä¸­çš„æ•°æ®ã€‚</p><p>æˆ‘ä»¬å·²ç»åœ¨ç¬¬ä¸€ä¸ªä¼šè¯ä¸­è¿›è¡Œäº†ä¿®æ”¹ã€‚ç„¶è€Œï¼Œè¿™äº›å˜åŒ–å¹¶ä¸æ˜¯æ°¸ä¹…æ€§çš„ã€‚åœ¨ç¬¬ä¸€ä¸ªä¼šè¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æäº¤æˆ–å›æ»šè¿™äº›å˜åŒ–ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ROLLBACK</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br></pre></td></tr></table></figure><br>éªŒè¯ <code>orders</code> è¡¨çš„å†…å®¹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> orders;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">327</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>ä»è¾“å‡ºä¸­å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œæ›´æ”¹å·²å›æ»šã€‚</p><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="comment">-- æ’å…¥ Xie Xun çš„ä¿¡æ¯ --</span></span><br><span class="line"><span class="comment">-- Write your SQL Query here --</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> teachers (name,age,country)</span><br><span class="line"><span class="keyword">values</span>(<span class="string">&#x27;Xie Xun&#x27;</span>,<span class="number">49</span>,<span class="string">&#x27;CN&#x27;</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure></p><h1 id="é”çš„è®¤è¯†"><a href="#é”çš„è®¤è¯†" class="headerlink" title="é”çš„è®¤è¯†"></a>é”çš„è®¤è¯†</h1><p><strong>åœºæ™¯</strong><br>ä¸€ä¸ªå¾ˆä¹…æ²¡æœ‰æ”¹åŠ¨çš„è®¿é—®é‡è¾ƒä½ç³»ç»Ÿï¼Œç”±äºè®¿é—®å¢å¤§å¿½ç„¶å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œç»è¿‡æ—¥å¿—æŸ¥çœ‹å’Œä»£ç æ’æŸ¥å‘ç°åŸå› å¦‚ä¸‹</p><ul><li>è¡¨ A ä¸»é”®ï¼šidï¼ŒçŠ¶æ€ï¼šstatus</li><li>è¡¨ B ä¸»é”®ï¼šidï¼Œç‰ˆæœ¬å·ï¼šversion ï¼Œç´¯ç§¯æ€»é¢ï¼štotal<br>è¡¨A<br>|id|status|name|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|1|1|å°æ˜|<br>|2|1|å°çº¢|<br>|3|1|å¼ ä¸‰|<br>è¡¨B<br>|id|version|total|project_name|<br>|:â€”-:|:â€”-:|:â€”-:|:â€”-:|<br>|1|1|1000|é¡¹ç›®åç§°|</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å°æ˜ --</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">-- â€¦â€¦ --</span></span><br><span class="line"><span class="keyword">update</span> A <span class="keyword">set</span> status <span class="operator">=</span> <span class="number">2</span> <span class="keyword">where</span> id<span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> status <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> B <span class="keyword">set</span> total <span class="operator">=</span> total <span class="operator">+</span> XXX1 <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> version <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å°çº¢ --</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">-- â€¦â€¦ --</span></span><br><span class="line"><span class="keyword">update</span> A <span class="keyword">set</span> status <span class="operator">=</span> <span class="number">2</span> <span class="keyword">where</span> id<span class="operator">=</span> <span class="number">2</span> <span class="keyword">and</span> status <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> B <span class="keyword">set</span> total <span class="operator">=</span> total <span class="operator">+</span> XXX2 <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> version <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¼ ä¸‰ --</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">update</span> A <span class="keyword">set</span> status <span class="operator">=</span> <span class="number">2</span> <span class="keyword">where</span> id<span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> status <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> B <span class="keyword">set</span> total <span class="operator">=</span> total <span class="operator">+</span> XXX3 <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> version <span class="operator">=</span> <span class="number">1</span>; </span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure><p>è¡¨ A çš„æ›´æ–°æ“ä½œæ˜¯ç”¨æˆ·è®¢å•çŠ¶æ€å®Œæˆçš„æ›´æ–°ï¼Œè¡¨ B çš„æ›´æ–°æ“ä½œæ˜¯ä¸šåŠ¡ä¸Šçš„ç»Ÿè®¡ã€‚<br>å¾ˆæ˜æ˜¾å½“å¹¶å‘äº§ç”Ÿæ—¶ï¼ˆå¤šä¸ªäº‹åŠ¡å»æ“ä½œè¡¨ B åŒä¸€è¡Œæ•°æ®ï¼‰è¡¨ B çš„æ›´æ–°ä¼šè¢«[[#ä¹è§‚é”]] versionæ§åˆ¶ä½ç„¶åä»£ç é‡Œåˆ¤å®šæ›´æ–°å¤±è´¥å¹¶ä¸”æŠ›å‡ºå¼‚å¸¸å¯¼è‡´ç”¨æˆ·è¡¨Açš„æ›´æ–°è¢«å›æ»šã€‚<br><code>é—®é¢˜ä¸åœ¨äºç”¨äº†ä¹è§‚é”ï¼Œè€Œæ˜¯åœ¨äºä¸ç›¸å¹²çš„ä¸¤ä¸ªä¸šåŠ¡æ”¾åˆ°äº†ä¸€ä¸ªäº‹åŠ¡é‡Œ</code>ï¼Œç»Ÿè®¡å’Œè®¢å•çŠ¶æ€æ›´æ–°åº”è¯¥å‰¥ç¦»å¼€å»åšã€‚<br>ä¸Šé¢çš„é—®é¢˜å¯¼è‡´äº†éƒ¨åˆ†è®¢å•æ”¯ä»˜å®Œæˆæ¶ˆæ¯æ¶ˆè´¹çš„å»¶è¿Ÿï¼Œé‡å¤å¾ˆå¤šæ¬¡æ‰è¢«æ¶ˆè´¹åˆ°ï¼Œé—´éš”æ—¶é—´è¾ƒé•¿ï¼Œç”¨æˆ·è§‰å¾—å·²ç»æ‰£æ¬¾äº†è®¢å•ä¸ºä»€ä¹ˆè¿˜æ²¡æœ‰æˆåŠŸã€‚</p><p>Oracle æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŸºæœ¬éƒ½æ˜¯<strong>è¯»å·²æäº¤ï¼ˆREAD-COMMITTED</strong>ï¼‰ï¼Œæ‰€æœ‰çš„é”ä¹Ÿé’ˆå¯¹è¿™ä¸ªçº§åˆ«æ¥æ€»ç»“</p><blockquote><p>MySQL é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ <code>Repeatable read</code>ï¼ˆå¯é‡å¤è¯»ï¼‰</p></blockquote><p><code>æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">like</span> <span class="string">&#x27;%isolation%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><h2 id="é”çš„è§£é‡Š"><a href="#é”çš„è§£é‡Š" class="headerlink" title="é”çš„è§£é‡Š"></a>é”çš„è§£é‡Š</h2><p>é”ï¼šè®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ã€‚</p><h2 id="é”çš„é‡è¦æ€§"><a href="#é”çš„é‡è¦æ€§" class="headerlink" title="é”çš„é‡è¦æ€§"></a>é”çš„é‡è¦æ€§</h2><p>åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤äº†ä¼ ç»Ÿçš„è®¡ç®—èµ„æºï¼ˆCPUã€RAMã€I\\Oç­‰ï¼‰çš„äº‰æŠ¢ï¼Œæ•°æ®ä¹Ÿæ˜¯ä¸€ç§ä¾›å¤šç”¨æˆ·å…±äº«çš„èµ„æºã€‚<br>å› æ­¤ï¼Œå¦‚ä½•<code>ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ï¼Œæœ‰æ•ˆæ€§</code>ï¼Œæ˜¯æ‰€æœ‰æ•°æ®åº“å¿…é¡»è¦è§£å†³çš„é—®é¢˜ã€‚é”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿é—®æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ ï¼Œå› æ­¤é”å¯¹æ•°æ®åº“å°¤å…¶é‡è¦ã€‚</p><h2 id="é”çš„ç¼ºç‚¹"><a href="#é”çš„ç¼ºç‚¹" class="headerlink" title="é”çš„ç¼ºç‚¹"></a>é”çš„ç¼ºç‚¹</h2><p><code>åŠ é”æ˜¯æ¶ˆè€—èµ„æºçš„</code>ï¼Œé”çš„å„ç§æ“ä½œï¼ŒåŒ…æ‹¬ï¼šè·å¾—é”ã€æ£€æµ‹é”æ˜¯å¦å·²ç»è§£é™¤ã€é‡Šæ”¾é”ç­‰ï¼Œéƒ½ä¼šå¢åŠ ç³»ç»Ÿçš„å¼€é”€ã€‚</p><h2 id="é”çš„ç±»å‹"><a href="#é”çš„ç±»å‹" class="headerlink" title="é”çš„ç±»å‹"></a>é”çš„ç±»å‹</h2><h3 id="è‡ªå¢é”"><a href="#è‡ªå¢é”" class="headerlink" title="è‡ªå¢é”"></a>è‡ªå¢é”</h3><p><strong>æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„è‡ªå¢é”æ¨¡å¼ï¼š</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%innodb_autoinc_lock_mode%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><ul><li><strong>0</strong>ï¼š<code>traditonal</code> æ¯æ¬¡ <code>insert</code> è¯­å¥æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿè¡¨é”</li><li><strong>1</strong>ï¼š<code>consecutive simple insert</code> ä¼šè·å¾—æ‰¹é‡çš„é”ï¼Œä¿è¯ä¸€æ‰¹æ’å…¥è‡ªå¢åºåˆ—çš„è¿ç»­æ€§ï¼Œæ’å…¥ä¹‹å‰æå‰é‡Šæ”¾é”ï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ä½ ä¼šå‘ç°å½“ä½  <code>insert</code> å¤šæ¡æ•°æ®å›æ»šçš„æ—¶å€™è™½ç„¶ DB æ²¡æœ‰æ’å…¥æ•°æ®ï¼Œä½†æ˜¯è‡ªå¢ ID å·²ç»å¢é•¿äº†ï¼Œä¹Ÿæ˜¯æ•°æ®åº“é»˜è®¤çš„çº§åˆ«</li><li><strong>2</strong>ï¼š<code>interleaved</code> ä¸ä¼šé”è¡¨ï¼Œå®æ—¶æ’å…¥ï¼Œå¹¶å‘æœ€é«˜ï¼Œä½†æ˜¯åŸºäºä¸»ä»çš„å¤åˆ¶æ˜¯ä¸å®‰å…¨çš„ï¼Œæ„Ÿå…´è¶£å¯ä»¥å»æŸ¥è¯¢ RBR å’Œ SBR çš„ä¼˜ç¼ºç‚¹</li></ul><p>è‡ªå¢é”æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨çº§åˆ«é”ï¼ˆtable-level lockï¼‰ï¼Œä¸“é—¨é’ˆå¯¹äº‹åŠ¡æ’å…¥ <code>AUTO_INCREMENT</code> ç±»å‹çš„åˆ—ã€‚æœ€ç®€å•çš„æƒ…å†µï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å¾€è¡¨ä¸­æ’å…¥è®°å½•ï¼Œæ‰€æœ‰å…¶ä»–äº‹åŠ¡çš„æ’å…¥å¿…é¡»ç­‰å¾…ï¼Œä»¥ä¾¿ç¬¬ä¸€ä¸ªäº‹åŠ¡æ’å…¥çš„è¡Œï¼Œæ˜¯è¿ç»­çš„ä¸»é”®å€¼ã€‚</p><p><strong>æ¡ˆä¾‹</strong><br>å¦‚æœæ²¡æœ‰è‡ªå¢é”çš„æƒ…å†µä¸‹å¦‚ä¸‹è¡¨ï¼Œid ä¸ºè‡ªå¢ <code>AUTO_INCREMENT = 4</code><br>|id|name|<br>|:â€”-:|:â€”-:|<br>|1|å¼ æ— å¿Œ|<br>|2|èµµæ•|<br>|3|å‘¨èŠ·è‹¥|<br>è¿™æ—¶å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼šinsert ä¸€æ¡è®°å½•å¼ ä¸‰ä¸°ï¼Œè‡ªå¢åºåˆ—åˆ†é…åˆ°çš„ id ä¸º 4ï¼Œäº‹åŠ¡ä¸æäº¤åˆå¼€å¯ä¸€ä¸ªäº‹åŠ¡ Bï¼šinsert ä¸€æ¡è®°å½•å¼ ç¿ å±±ï¼Œè‡ªå¢åºåˆ—åˆ†é…åˆ°çš„ id ä¸º 5ï¼Œäº‹åŠ¡ä¸æäº¤äº‹åŠ¡ A åˆæ’å…¥ä¸€æ¡è®°å½•ï¼Œinsert ä¸€æ¡è®°å½•ä¸ºæ®·æ¢¨äº­ï¼Œè¿™ä¸ªæ˜¯åè¢«åˆ†é…åˆ°çš„ id ä¸º 6ã€‚<br>ç”±äºåœ¨è¯»æäº¤äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ä¸ä¼šæŸ¥è¯¢åˆ°å…¶ä»–æœªæäº¤çš„äº‹åŠ¡ï¼Œ äº‹åŠ¡ A æ­¤æ—¶æŸ¥è¯¢ id&gt;3 çš„è®°å½•ä¼šè¿”å› 4ï¼šå¼ ä¸‰ä¸°ï¼Œ6ï¼šæ®·æ¢¨äº­ã€‚å°±ä¼šæœ‰ä¸€ä¸ªäº‹åŠ¡é‡Œæäº¤çš„æ•°æ®è‡ªå¢ id ä¸æ˜¯è¿ç»­çš„é—®é¢˜äº§ç”Ÿ<br>|id|name|<br>|:â€”-:|:â€”-:|<br>|1|å¼ æ— å¿Œ|<br>|2|èµµæ•|<br>|3|å‘¨èŠ·è‹¥|<br>|4|å¼ ä¸‰ä¸°|<br>|5|å¼ ç¿ å±±|<br>|6|æ®·æ¢¨äº­|</p><p>é‡‡ç”¨è‡ªå¢é”å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</p><ul><li><strong>innodb_autoinc_lock_mode = 0</strong><br>åœ¨è¿™ä¸€æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„ insert è¯­å¥éƒ½è¦åœ¨è¯­å¥å¼€å§‹çš„æ—¶å€™å¾—åˆ°ä¸€ä¸ªè¡¨çº§çš„ auto_inc é”ï¼Œåœ¨è¯­å¥ç»“æŸçš„æ—¶å€™æ‰é‡Šæ”¾<br>è¿™ç§æ¨¡å¼ä¸‹ <code>auto_inc</code> é”ä¸€ç›´è¦ä¿æŒåˆ°è¯­å¥çš„ç»“æŸï¼Œæ‰€ä»¥è¿™ä¸ªå°±å½±å“åˆ°äº†å¹¶å‘çš„æ’å…¥ï¼Œä½†æ˜¯ä¸»ä»åŒæ­¥æ—¶å€™æ˜¯å®‰å…¨çš„</li><li><strong>innodb_autoinc_lock_mode = 1</strong><br>è¿™ä¸€æ¨¡å¼ä¸‹å» <code>simple insert</code> åšäº†ä¼˜åŒ–ï¼Œç”±äº <code>simple insert</code> ä¸€æ¬¡æ€§æ’å…¥å€¼çš„ä¸ªæ•°å¯ä»¥ç«‹é©¬å¾—åˆ°ç¡®å®šï¼Œæ‰€ä»¥ <code>MySQL</code> å¯ä»¥ä¸€æ¬¡ç”Ÿæˆå‡ ä¸ªè¿ç»­çš„å€¼ï¼Œç”¨äºè¿™ä¸ª <code>insert</code> è¯­å¥ï¼Œä¹Ÿä¿è¯ä¸»ä»åŒæ­¥åŸºäºè¯­å¥çš„å¤åˆ¶å®‰å…¨<br>è¿™ä¸€æ¨¡å¼ä¹Ÿæ˜¯ <code>MySQL</code> çš„é»˜è®¤æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼çš„å¥½å¤„æ˜¯ <code>auto_inc</code> é”ä¸è¦ä¸€ç›´ä¿æŒåˆ°è¯­å¥çš„ç»“æŸï¼Œåªè¦è¯­å¥å¾—åˆ°äº†ç›¸åº”çš„å€¼åå°±å¯ä»¥æå‰é‡Šæ”¾é”</li><li><strong>innodb_autoinc_lock_mode = 2</strong><br>æ— è‡ªå¢é”ï¼Œä¼šå¯¼è‡´ä¸Šé¢æ¡ˆä¾‹çš„é—®é¢˜ï¼ŒåŒä¸€æ‰¹ <code>insert</code> æäº¤è‡ªå¢ä¸è¿ç»­</li></ul><h3 id="å…±äº«é”å’Œæ’å®ƒé”ï¼ˆShared-and-Exclusive-Locksï¼‰"><a href="#å…±äº«é”å’Œæ’å®ƒé”ï¼ˆShared-and-Exclusive-Locksï¼‰" class="headerlink" title="å…±äº«é”å’Œæ’å®ƒé”ï¼ˆShared and Exclusive Locksï¼‰"></a>å…±äº«é”å’Œæ’å®ƒé”ï¼ˆShared and Exclusive Locksï¼‰</h3><h4 id="å¹¶å‘æ§åˆ¶"><a href="#å¹¶å‘æ§åˆ¶" class="headerlink" title="å¹¶å‘æ§åˆ¶"></a>å¹¶å‘æ§åˆ¶</h4><p>æåˆ°å…±äº«é”å’Œæ’å®ƒé”å°±ä¸å¾—ä¸æ<code>å¹¶å‘æ§åˆ¶</code>ï¼ˆConcurrency Controlï¼‰ï¼Œ<code>å¹¶å‘æ§åˆ¶å¯ä»¥è§£å†³ä¸´ç•Œèµ„æºæ“ä½œæ—¶ä¸ä¸€è‡´çš„æƒ…å†µäº§ç”Ÿï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§å¸¸è§çš„æ‰‹æ®µå°±æ˜¯é”å’Œæ•°æ®å¤šç‰ˆæœ¬</code>ï¼ˆMulti Versionï¼‰</p><h4 id="ç›´æ¥åŠ é”"><a href="#ç›´æ¥åŠ é”" class="headerlink" title="ç›´æ¥åŠ é”"></a>ç›´æ¥åŠ é”</h4><p>è¿™ç§æ–¹å¼ä¼šå¯¼è‡´è¢«åŠ é”çš„èµ„æºéƒ½è¢«é”ä½ï¼Œè¯»å–ä»»åŠ¡ä¹Ÿæ— æ³•æ‰§è¡Œç›´åˆ°é”é‡Šæ”¾ï¼Œæ‰€æœ‰æ‰§è¡Œçš„ä»»åŠ¡ç›¸å½“äºä¸²è¡ŒåŒ–æ–¹å¼ï¼Œç®€å•ç²—æš´ï¼Œä¸èƒ½å¹¶å‘</p><h4 id="å…±äº«é”ï¼ˆShared-Locksï¼‰ç®€ç§°ä¸º-S-é”"><a href="#å…±äº«é”ï¼ˆShared-Locksï¼‰ç®€ç§°ä¸º-S-é”" class="headerlink" title="å…±äº«é”ï¼ˆShared Locksï¼‰ç®€ç§°ä¸º S é”"></a>å…±äº«é”ï¼ˆShared Locksï¼‰ç®€ç§°ä¸º S é”</h4><p>è¯»å–æ•°æ®æ—¶å€™å¯ä»¥åŠ  S é”ã€‚<br>å…±äº« (S) é”å…è®¸å¹¶å‘äº‹åŠ¡è¯»å– (SELECT) ä¸€ä¸ªèµ„æºã€‚èµ„æºä¸Šå­˜åœ¨å…±äº« (S) é”æ—¶ï¼Œä»»ä½•å…¶å®ƒäº‹åŠ¡éƒ½ä¸èƒ½ä¿®æ”¹æ•°æ®ã€‚ä¸€æ—¦å·²ç»è¯»å–æ•°æ®ï¼Œä¾¿ç«‹å³é‡Šæ”¾èµ„æºä¸Šçš„å…±äº« (S) é”ï¼Œé™¤éå°†äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºå¯é‡å¤è¯»æˆ–æ›´é«˜çº§åˆ«ï¼Œæˆ–è€…åœ¨äº‹åŠ¡ç”Ÿå­˜å‘¨æœŸå†…ç”¨é”å®šæç¤ºä¿ç•™å…±äº« (S) é”ã€‚</p><h4 id="æ’å®ƒé”-ï¼ˆExclusive-Locksï¼‰ç®€ç§°ä¸º-X-é”"><a href="#æ’å®ƒé”-ï¼ˆExclusive-Locksï¼‰ç®€ç§°ä¸º-X-é”" class="headerlink" title="æ’å®ƒé” ï¼ˆExclusive Locksï¼‰ç®€ç§°ä¸º X é”"></a>æ’å®ƒé” ï¼ˆExclusive Locksï¼‰ç®€ç§°ä¸º X é”</h4><p>ä¿®æ”¹æ•°æ®æ—¶å€™åŠ  X é”ã€‚<br>æ’å®ƒ (X) é”å¯ä»¥é˜²æ­¢å¹¶å‘äº‹åŠ¡å¯¹èµ„æºè¿›è¡Œè®¿é—®ã€‚å…¶å®ƒäº‹åŠ¡ä¸èƒ½è¯»å–æˆ–ä¿®æ”¹æ’å®ƒ (X) é”é”å®šçš„æ•°æ®ã€‚<br><strong>å…±äº«é”ä¹‹é—´å¯ä»¥å¹¶è¡Œï¼Œæ’å®ƒé”å’Œå…±äº«é”ä¹‹é—´äº’æ–¥</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦å…±äº«é”å¼€å¯æ²¡æœ‰é‡Šæ”¾æ‰çš„æ—¶å€™ï¼Œæ›´æ–°é”æ˜¯ä¸èƒ½æŠ¢å çš„ï¼Œæ­¤æ—¶å…¶ä»–è¯»å–åŒèµ„æºçš„æ“ä½œå¯ä»¥è¿›è¡Œè¯»å–ä¸å—é™åˆ¶ï¼›åŒç†<strong>æ’å®ƒé”å¼€å¯æ—¶å€™åªè¦æ²¡æœ‰é‡Šæ”¾å…¶ä»–ä¸ç®¡æ˜¯æ’å®ƒé”è¿˜æ˜¯å…±äº«é”éƒ½ä¸å¯ä»¥æŠ¢å èµ„æºç›´åˆ°é”é‡Šæ”¾</strong>ã€‚</p><p>ä¸¾ä¾‹è¡¨A<br>|id|name|<br>|:â€”-:|:â€”-:|<br>|1|å¼ æ— å¿Œ|<br>|2|å¼ ä¸‰ä¸°|</p><ul><li><strong>ä»¥ä¸‹ä¾‹å­ä¸­çš„ <code>start transaction1;</code> åªç”¨äºåŒºåˆ«äº‹åŠ¡ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­çš„è¯­å¥åº”å½“ä¸º <code>start transaction;</code> æˆ– <code>begin;</code></strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction1;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> lock <span class="keyword">in</span> share mode;</span><br><span class="line"><span class="comment">-- â€¦â€¦ -- </span></span><br><span class="line"><span class="keyword">start</span> transaction2;</span><br><span class="line"><span class="keyword">update</span> A <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;èµµæ•&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- â€¦â€¦ --</span></span><br></pre></td></tr></table></figure><p>å¦‚æœäº‹åŠ¡ transaction1 ä¸è¿›è¡Œæäº¤ S é”ä¸è¢«é‡Šæ”¾ï¼Œé‚£ä¹ˆ transaction2 å°±æ‹¿ç€ X é”ä¸€ç›´ç­‰å¾… S é”é‡Šæ”¾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction3;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> lock <span class="keyword">in</span> share mode;</span><br></pre></td></tr></table></figure><p>å¦‚æœäº‹åŠ¡ transaction3 åšåŒæ ·æŸ¥è¯¢å¯ä»¥ç›´æ¥è·å– S é”è¿›è¡ŒæŸ¥è¯¢  </p><p>è¿™ä¸ªæ—¶å€™å¦‚æœäº‹åŠ¡ transaction1 è¦è¿›è¡Œ delete æ“ä½œ<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction1;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> lock <span class="keyword">in</span> share mode;</span><br><span class="line"><span class="comment">-- â€¦â€¦ --</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- â€¦â€¦ --</span></span><br></pre></td></tr></table></figure><br>æ­¤æ—¶ transaction1 å‘ç° X é”è¢« transaction2 å æ®äº†æ‹¿ä¸åˆ° X é”ä¸€ç›´åœ¨ç­‰å¾…ï¼Œtransaction2 æ‹¿ç€ X é”ç­‰ç€ transaction1 çš„ S é”é‡Šæ”¾ä¹Ÿåœ¨ç­‰å¾…ï¼Œè¿™æ ·äº’ç›¸ç­‰å¾…å°±äº§ç”Ÿäº†æ­»é” deadLockï¼Œå‘ç”Ÿæ­»é”åï¼ŒInnoDB ä¼šä¸ºç¬¬ä¸€ä¸ªå®¢æˆ·äº§ç”Ÿé”™è¯¯ä¿¡æ¯å¹¶é‡Šæ”¾é”</p><h3 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h3><h4 id="æ­»é”åŸå› "><a href="#æ­»é”åŸå› " class="headerlink" title="æ­»é”åŸå› "></a>æ­»é”åŸå› </h4><ol><li>å¦‚ä¸Šæ‰€è¿°å¹¶å‘ä¿®æ”¹åŒä¸€è®°å½•</li><li>äº‹åŠ¡ä¹‹é—´å¯¹èµ„æºè®¿é—®ï¼ˆè¡¨ï¼‰é¡ºåºçš„äº¤æ›¿è¿›è¡Œï¼Œä¸ç¬¬ä¸€æ¡å¤§åŒå°å¼‚ï¼Œä¸Šå‡åˆ°é”è¡¨çš„çº§åˆ«</li><li>æ•°æ®é‡åºå¤§æ—¶å€™ç´¢å¼•å»ºç«‹æœºåˆ¶ä¸è¡Œï¼Œç»å¸¸æ‰«å…¨è¡¨æ“ä½œï¼Œä¹Ÿä¼šé€ æˆèµ„æºé˜»å¡æ­»é”</li><li>æ„¿æ„åœ¨ä»£ç é‡Œå¼€å¤§äº‹åŠ¡ç„¶åå¯¹æ•°æ®åº“ä¸€é¡¿æ“ä½œäº’ç›¸ç­‰å¾…ï¼Œå®¹æ˜“å¼•å‘æ­»é”ï¼Œæ‰€ä»¥ä»£ç é‡Œè¦èŠ‚ä¿­å¯¹äº‹åŠ¡çš„å¼€é”€ï¼Œä»¥åŠäº‹åŠ¡å¼€é”€æ—¶å€™å°½å¯èƒ½æœ‰æ•ˆåˆç†åˆ©ç”¨èµ„æº</li></ol><h4 id="æ•°æ®å¤šç‰ˆæœ¬"><a href="#æ•°æ®å¤šç‰ˆæœ¬" class="headerlink" title="æ•°æ®å¤šç‰ˆæœ¬"></a>æ•°æ®å¤šç‰ˆæœ¬</h4><p>X é”å é¢†åå…¶ä»– S é”æ²¡æ³•å ç”¨å¯¼è‡´åªè¦å†™æ²¡å®Œæˆè¯»å°±ä¸èƒ½è¿›è¡Œå¹¶å‘æŸ¥è¯¢ï¼ŒInnoDB å¼•å…¥äº†æ•°æ®å¤šç‰ˆæœ¬æ¦‚å¿µå»è§£å†³è¿™ä¸€é—®é¢˜<br>æ ¸å¿ƒåŸç†ç®€å•è®²å°±æ˜¯<code>clone äº†ä¸€ä¸ªç‰ˆæœ¬æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ¯”å¦‚åŸæœ‰çš„æ•°æ®ç‰ˆæœ¬å·æ˜¯ Version0ï¼Œè¿™ä¸ªæ—¶å€™è¿›è¡Œå†™æ“ä½œ clone äº†ä¸€ä»½ç‰ˆæœ¬å· V1ï¼Œè¿™ä¸ªæ—¶å€™å¯¹ V1 ç‰ˆæœ¬æ•°æ®è¿›è¡Œä¿®æ”¹å†™å…¥æ“ä½œ</code>ï¼›ä¸æ­¤åŒæ—¶å…¶ä»–æŸ¥è¯¢è¯»ä»»åŠ¡å¹¶å‘è¿›æ¥ä¸€æ ·å¯ä»¥è¯»å– V0 ç‰ˆæœ¬æ•°æ®ä¸å—ä»»ä½•å½±å“ï¼Œè¿™æ ·å°±è§£å†³äº†åœ¨æ•°æ®æ›´æ–°å›å†™ä¹‹å‰ä¸èƒ½è¯»å–çš„é—®é¢˜ï¼Œè¿›ä¸€æ­¥æé«˜äº†æ•°æ®åº“å¼•æ“å¤„ç†å¹¶å‘çš„èƒ½åŠ›</p><h5 id="InnoDB-å¦‚ä½•æ“ä½œå¤šç‰ˆæœ¬æ§åˆ¶ï¼Ÿ"><a href="#InnoDB-å¦‚ä½•æ“ä½œå¤šç‰ˆæœ¬æ§åˆ¶ï¼Ÿ" class="headerlink" title="InnoDB å¦‚ä½•æ“ä½œå¤šç‰ˆæœ¬æ§åˆ¶ï¼Ÿ"></a>InnoDB å¦‚ä½•æ“ä½œå¤šç‰ˆæœ¬æ§åˆ¶ï¼Ÿ</h5><ol><li>redoï¼šäº‹åŠ¡æäº¤åéœ€è¦æŠŠæ•°æ®åˆ·ç›˜ï¼ŒåŸæœ‰çš„æœºæ¢°ç£ç›˜æƒ…å†µä¸‹æ•ˆç‡å¾ˆä½ï¼ˆå›ºç›˜å¦è¯´ï¼‰ï¼Œéšæœºå†™æ€§èƒ½ä½ï¼Œè¿™æ ·å°±å…ˆæ”¾åˆ° redo æ—¥å¿—ä¸­ï¼Œå®šæœŸæŠŠä¸€æ‰¹æ•°æ®åˆ·ç›˜ï¼Œå·§å¦™çš„åˆ©ç”¨ redo æ—¥å¿—æŠŠéšæœºå†™å˜æˆäº†é¡ºåºå†™</li><li>undoï¼šäº‹åŠ¡æ²¡æœ‰æäº¤ä¹‹å‰å¯èƒ½ä¼š rollbackï¼Œundo å°±æ˜¯æŠŠæ—§çš„æ•°æ®é•œåƒæ”¾åˆ° undo æ—¥å¿—é‡Œï¼Œå›æ»šæ—¶æ¢å¤æ•°æ®</li><li>å­˜å‚¨ undo æ—¥å¿—åœ°æ–¹æ˜¯å›æ»šæ®µï¼Œäº‹åŠ¡æäº¤å›æ»šæ®µæ—¥å¿—å¯ä»¥åˆ é™¤ï¼Œå›æ»šæ—¶æŸ¥æ‰¾å›æ»šæ®µè®°å½•å¤åŸï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ—§çš„æ•°æ®å­˜å‚¨åœ¨å›æ»šæ®µä¸­</li></ol><p>InnoDB æœ¬èº«å°±æ˜¯ MVCC å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶å¼•æ“ï¼Œé€šè¿‡è¯»å–æ—§ç‰ˆæœ¬æ•°æ®æ¥é™ä½å¹¶å‘äº‹åŠ¡çš„é”å†²çªï¼Œæé«˜ä»»åŠ¡çš„å¹¶å‘åº¦ï¼Œä¸ MyISam æ¯”ä¸å•å•åªæ˜¯æ”¯æŒäº‹åŠ¡é‚£ä¹ˆç®€å•</p><h4 id="å¿«ç…§è¯»ï¼ˆsnapshot-readï¼‰"><a href="#å¿«ç…§è¯»ï¼ˆsnapshot-readï¼‰" class="headerlink" title="å¿«ç…§è¯»ï¼ˆsnapshot readï¼‰"></a>å¿«ç…§è¯»ï¼ˆsnapshot readï¼‰</h4><p>å›æ»šæ®µçš„æ•°æ®å¯ä»¥ç†è§£ä¸ºæ—§æ•°æ®å†å²çš„å¿«ç…§ï¼Œè¿™ç§ä¸åŠ é”çš„ä¸€è‡´æ€§çš„è¯»å–å°±æ˜¯å¿«ç…§è¯»ï¼Œæ‰€ä»¥ä¼šæ”¯æ’‘é«˜å¹¶å‘</p><h3 id="InnoDB-é”çš„ç§ç±»ä¹‹æ„å‘é”ã€è®°å½•é”å’Œé—´éš™é”"><a href="#InnoDB-é”çš„ç§ç±»ä¹‹æ„å‘é”ã€è®°å½•é”å’Œé—´éš™é”" class="headerlink" title="InnoDB é”çš„ç§ç±»ä¹‹æ„å‘é”ã€è®°å½•é”å’Œé—´éš™é”"></a>InnoDB é”çš„ç§ç±»ä¹‹æ„å‘é”ã€è®°å½•é”å’Œé—´éš™é”</h3><h4 id="æ„å‘é”ï¼ˆIntention-Locks-table-level-lockï¼‰"><a href="#æ„å‘é”ï¼ˆIntention-Locks-table-level-lockï¼‰" class="headerlink" title="æ„å‘é”ï¼ˆIntention Locks; table-level lockï¼‰"></a>æ„å‘é”ï¼ˆIntention Locks; table-level lockï¼‰</h4><p>æ„å‘é”æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨çº§é”ï¼Œæ„å‘é”æ˜¯ä¸ºäº†è®© InnoDB å¤šç²’åº¦çš„é”èƒ½å…±å­˜è€Œè®¾è®¡çš„ã€‚å–å¾—è¡Œçš„å…±äº«é”å’Œæ’ä»–é”ä¹‹å‰éœ€è¦å…ˆå–å¾—è¡¨çš„æ„å‘å…±äº«é”ï¼ˆISï¼‰å’Œæ„å‘æ’ä»–é”ï¼ˆIXï¼‰ï¼Œ<code>æ„å‘å…±äº«é”å’Œæ„å‘æ’ä»–é”éƒ½æ˜¯ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ å’Œè‡ªåŠ¨é‡Šæ”¾çš„</code>ï¼Œæ•´ä¸ªè¿‡ç¨‹æ— éœ€äººå·¥å¹²é¢„ã€‚<br>æ„å‘é”å°±æ˜¯æŒ‡<code>æœªæ¥çš„æŸä¸€ä¸ªæ—¶åˆ»äº‹åŠ¡å¯èƒ½è¦åŠ å…±äº«é”æˆ–è€…æ’å®ƒé”</code>ï¼Œæå‰å£°æ˜ä¸€ä¸ªæ„å‘ï¼Œåˆ†ä¸ºä¸¤ç§ï¼š</p><h5 id="æ„å‘å…±äº«é”ï¼ˆIntention-Shared-Lockï¼‰-IS"><a href="#æ„å‘å…±äº«é”ï¼ˆIntention-Shared-Lockï¼‰-IS" class="headerlink" title="æ„å‘å…±äº«é”ï¼ˆIntention Shared Lockï¼‰ IS"></a>æ„å‘å…±äº«é”ï¼ˆIntention Shared Lockï¼‰ IS</h5><p>äº‹åŠ¡æœ‰æ„å‘å¯¹è¡¨ä¸­çš„æŸäº›è¡ŒåŠ å…±äº«é”ï¼ˆSé”ï¼‰<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- äº‹åŠ¡è¦è·å–æŸäº›è¡Œçš„ S é”ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IS é”ã€‚</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span> <span class="keyword">FROM</span> <span class="keyword">table</span> ... LOCK <span class="keyword">IN</span> SHARE MODE;</span><br></pre></td></tr></table></figure></p><h5 id="æ„å‘æ’å®ƒé”ï¼ˆIntention-Exclusive-Lockï¼‰IX"><a href="#æ„å‘æ’å®ƒé”ï¼ˆIntention-Exclusive-Lockï¼‰IX" class="headerlink" title="æ„å‘æ’å®ƒé”ï¼ˆIntention Exclusive Lockï¼‰IX"></a>æ„å‘æ’å®ƒé”ï¼ˆIntention Exclusive Lockï¼‰IX</h5><p>äº‹åŠ¡æœ‰æ„å‘å¯¹è¡¨ä¸­çš„æŸäº›è¡ŒåŠ æ’ä»–é”ï¼ˆXé”ï¼‰<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- äº‹åŠ¡è¦è·å–æŸäº›è¡Œçš„ X é”ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IX é”ã€‚</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span> <span class="keyword">FROM</span> <span class="keyword">table</span> ... <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¦è®¾ç½® IS é” --</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span> lock <span class="keyword">in</span> share mode;</span><br><span class="line"><span class="comment">-- è¦è®¾ç½® IX é” --</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> A <span class="keyword">where</span> id <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">for</span> <span class="keyword">update</span>;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œå¦‚æœç¤ºä¾‹ 1 å’Œ 2 éƒ½å¼€å¯äº†äº‹åŠ¡ï¼Œäº‹åŠ¡ 1 é”ä½äº†è¡¨ A çš„å…¶ä¸­ id=1 çš„ä¸€è¡Œï¼Œäº‹åŠ¡ 2 è¦è·å–æ•´ä¸ªè¡¨çš„æ›´æ–°é”éœ€è¦è¿›è¡Œåˆ¤æ–­<br>step1ï¼šåˆ¤æ–­è¡¨ A æ˜¯å¦æœ‰è¡¨çº§é”<br>step2ï¼šåˆ¤æ–­è¡¨ A æ¯ä¸€è¡Œæ˜¯å¦æœ‰è¡Œçº§é”<br>å½“æ•°æ®é‡åºå¤§çš„æ—¶å€™ step2 è¿™ç§åˆ¤æ–­ååˆ†ä½æ•ˆï¼Œäºæ˜¯å°±æœ‰æ„å‘é”åè®®</p><p><strong>æ„å‘é”åè®®ï¼š</strong><br>äº‹åŠ¡è¦è·å–è¡¨ A æŸäº›è¡Œçš„ S é”å¿…é¡»è¦è·å–è¡¨ A çš„ IS é”<br>äº‹åŠ¡è¦è·å–è¡¨ A æŸäº›è¡Œçš„ X é”å¿…é¡»è¦è·å–è¡¨ A çš„ IX é”<br>è¿™æ—¶å€™ step2 å°±æ”¹å˜æˆäº†å¯¹æ„å‘é”çš„åˆ¤æ–­<br>step2ï¼šå‘ç°è¡¨ A æœ‰ IS é”ï¼Œè¯´æ˜è¡¨ A è‚¯å®šæœ‰è¡Œçº§çš„ S é”ï¼Œå› æ­¤ï¼Œäº‹åŠ¡ B ç”³è¯·å†™é”é˜»å¡ç­‰å¾…ï¼Œåˆ¤æ–­æ•ˆç‡æå¤§æé«˜</p><h4 id="è®°å½•é”ï¼ˆRecord-Locksï¼‰"><a href="#è®°å½•é”ï¼ˆRecord-Locksï¼‰" class="headerlink" title="è®°å½•é”ï¼ˆRecord Locksï¼‰"></a>è®°å½•é”ï¼ˆRecord Locksï¼‰</h4><p><code>SELECT c1 FROM t WHERE c1 = 10 FOR UPDATE;</code> è¿™ä¸€è¡Œåˆ™æ˜¯ä½¿ç”¨äº†è®°å½•é”ï¼Œä¸å…è®¸å…¶ä»–äº‹åŠ¡è¿›è¡Œå¢ï¼Œåˆ ï¼Œæ”¹<br>ä½†æ˜¯ <code>SELECT c1 FROM t WHERE c1 = 10;</code> æ˜¯æ²¡æœ‰é”çš„ï¼Œèµ°çš„æ˜¯å¿«ç…§è¯»ï¼Œä¸Šæ–‡å·²ç»é˜æ˜è¿‡äº†<br>è®°å½•é”æœ¬èº«ä¸æ˜¯é”å®šè®°å½•æ•°æ®æœ¬èº«è€Œæ˜¯é”å®šç´¢å¼•è®°å½•ï¼Œå¦‚æœè¦é”çš„åˆ—æ²¡æœ‰ç´¢å¼•ï¼Œåˆ™ä¼šè¿›è¡Œå…¨è¡¨è®°å½•åŠ é”</p><h4 id="é—´éš™é”ï¼ˆGap-Locksï¼‰"><a href="#é—´éš™é”ï¼ˆGap-Locksï¼‰" class="headerlink" title="é—´éš™é”ï¼ˆGap Locksï¼‰"></a>é—´éš™é”ï¼ˆGap Locksï¼‰</h4><p>æ¯”å¦‚ <code>SELECT c1 FROM t WHERE c1 BETWEEN 10 and 20 FOR UPDATE;</code><br>æ’å…¥ c1 ä¸º 15 çš„è®°å½•ä¼šè¢«é”å®šä¸å¯æ‰§è¡Œ<br>è¿™ç§é»˜è®¤å­˜åœ¨äºå¯é‡å¤è¯»çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸­çš„é”ï¼Œé”å®šè¢«åœˆå®šçš„èŒƒå›´ä¸å…è®¸ insertï¼Œé˜²æ­¢ä¸å¯é‡å¤è¯»ï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«éƒ½æ˜¯è¯»å·²æäº¤ï¼Œé»˜è®¤ä¼šäº§ç”Ÿä¸å¯é‡å¤è¯»çš„é—®é¢˜<br><a href="https://www.lintcode.com/learn/84/293">reference_æ„å‘é”ã€è®°å½•é”å’Œé—´éš™é”</a></p><h3 id="InnoDB-é”çš„ç§ç±»ä¹‹ä¸´é”®é”å’Œæ’å…¥æ„å‘é”"><a href="#InnoDB-é”çš„ç§ç±»ä¹‹ä¸´é”®é”å’Œæ’å…¥æ„å‘é”" class="headerlink" title="InnoDB é”çš„ç§ç±»ä¹‹ä¸´é”®é”å’Œæ’å…¥æ„å‘é”"></a>InnoDB é”çš„ç§ç±»ä¹‹ä¸´é”®é”å’Œæ’å…¥æ„å‘é”</h3><h4 id="ä¸´é”®é”ï¼ˆNext-Key-Locksï¼‰"><a href="#ä¸´é”®é”ï¼ˆNext-Key-Locksï¼‰" class="headerlink" title="ä¸´é”®é”ï¼ˆNext-Key Locksï¼‰"></a>ä¸´é”®é”ï¼ˆNext-Key Locksï¼‰</h4><p>è¿™ä¸ªé”æœ¬è´¨æ˜¯è®°å½•é”åŠ ä¸Š gap é”ï¼Œæ•°æ®åº“å¯é‡å¤è¯»äº‹åŠ¡éš”ç¦»çº§åˆ«é»˜è®¤å­˜åœ¨</p><h4 id="æ’å…¥æ„å‘é”ï¼ˆInsert-Intention-Locksï¼‰"><a href="#æ’å…¥æ„å‘é”ï¼ˆInsert-Intention-Locksï¼‰" class="headerlink" title="æ’å…¥æ„å‘é”ï¼ˆInsert Intention Locksï¼‰"></a>æ’å…¥æ„å‘é”ï¼ˆInsert Intention Locksï¼‰</h4><p>æ’å…¥æ„å‘é”æ˜¯é—´éš™é”çš„ä¸€ç§ï¼Œä¸“é—¨é’ˆå¯¹ insert æ“ä½œï¼Œå®˜æ–¹æ„æ€æ˜¯è¯´å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€ä¸ªç´¢å¼•åŒä¸€ä¸ªèŒƒå›´åŒºé—´æ’å…¥è®°å½•æ—¶å€™ï¼Œå¦‚æœæ’å…¥ä½ç½®ä¸å†²çªï¼Œä¸ä¼šå½¼æ­¤é˜»å¡ <code>éš”ç¦»çº§åˆ«è¿˜æ˜¯ RR</code><br><a href="https://www.lintcode.com/learn/84/294">reference_ä¸´é”®é”å’Œæ’å…¥æ„å‘é”</a></p><h3 id="å¦‚ä½•åŠ è¡¨é”"><a href="#å¦‚ä½•åŠ è¡¨é”" class="headerlink" title="å¦‚ä½•åŠ è¡¨é”"></a>å¦‚ä½•åŠ è¡¨é”</h3><blockquote><p>MySQLå¸¸ç”¨å¼•æ“æœ‰ MyISAM å’Œ InnoDBï¼Œè€Œ InnoDB æ˜¯ MySQL é»˜è®¤çš„å¼•æ“ã€‚MyISAM ä¸æ”¯æŒè¡Œé”ï¼Œè€Œ InnoDB æ”¯æŒè¡Œé”å’Œè¡¨é”ã€‚</p></blockquote><h4 id="éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰"><a href="#éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰" class="headerlink" title="éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰"></a>éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰</h4><blockquote><p>MyISAM åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼ˆSELECTï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆUPDATEã€DELETEã€INSERTç­‰ï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸éœ€è¦ç”¨æˆ·å¹²é¢„ï¼Œå› æ­¤ç”¨æˆ·ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥ç”¨ <code>LOCK TABLE;</code> å‘½ä»¤ç»™ MyISAM è¡¨æ˜¾å¼åŠ é”ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¸Šè¯»é” --</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="comment">-- ä¸Šå†™é” --</span></span><br><span class="line"><span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span></span><br></pre></td></tr></table></figure><h4 id="æ˜¾å¼ä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰"><a href="#æ˜¾å¼ä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰" class="headerlink" title="æ˜¾å¼ä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰"></a>æ˜¾å¼ä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰</h4><p>ä¸Šå…±äº«é”ï¼ˆè¯»é”ï¼‰çš„å†™æ³•ï¼š<code>lock in share mode</code>ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  column_name <span class="keyword">from</span> table_name <span class="keyword">where</span> lock <span class="keyword">in</span> share modeï¼›</span><br></pre></td></tr></table></figure></p><p>ä¸Šæ’å®ƒé”ï¼ˆå†™é”ï¼‰çš„å†™æ³•ï¼š<code>for update</code>ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">where</span> conditions <span class="keyword">for</span> <span class="keyword">update</span>ï¼›</span><br></pre></td></tr></table></figure></p><h4 id="è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰"><a href="#è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰" class="headerlink" title="è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰"></a>è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è§£é”æ‰€æœ‰é”è¡¨ --</span></span><br><span class="line">UNLOCK TABLES;</span><br></pre></td></tr></table></figure><p><strong>Example</strong><br>ğŸ‘‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ MySQL ä¸­è¡¨é”ä¹‹è¯»é”çš„ç”¨æ³•ã€‚</p><p>å‡è®¾æˆ‘ä»¬è¦æ›´æ–° teachers è¡¨ä¸­ï¼ŒLinghu Chong çš„é‚®ç®±ä¸º <code>linghu.chong@ninechapter.com</code>ï¼Œä½†æ˜¯ <code>teachers</code> è¡¨è¢«ä¸Šäº†è¯»é”ï¼Œè¯·ç¼–å†™ SQL è¯­å¥ï¼Œæ¥å®ç°æ›´æ–° Linghu Chong çš„é‚®ç®±ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å¯¹ teachers è¡¨ä¸Šè¯»é” --</span></span><br><span class="line">LOCK TABLES teachers READ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è§£é” --</span></span><br><span class="line">UNLOCK TABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ›´æ–°é‚®ç®± --</span></span><br><span class="line"><span class="keyword">UPDATE</span> teachers </span><br><span class="line"><span class="keyword">SET</span> email <span class="operator">=</span> <span class="string">&#x27;linghu.chong@ninechapter.com&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Linghu Chong&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> LOCK TABLES teachers READ;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> teachers</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> email <span class="operator">=</span> <span class="string">&#x27;linghu.chong@ninechapter.com&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Linghu Chong&#x27;</span>;</span><br><span class="line">ERROR <span class="number">1099</span> (HY000): <span class="keyword">Table</span> <span class="string">&#x27;teachers&#x27;</span> was locked <span class="keyword">with</span> a READ lock <span class="keyword">and</span> can<span class="string">&#x27;t be updated</span></span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> UNLOCK TABLES;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> teachers</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> email <span class="operator">=</span> <span class="string">&#x27;linghu.chong@ninechapter.com&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Linghu Chong&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure><br>è¯´æ˜ï¼š<br>åœ¨ä¸Šé¢çš„ SQL è¯­å¥ä¸­ï¼Œç”±äºå¯¹ <code>teachers</code> è¡¨åŠ äº†è¯»é”ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ <code>UPDATE</code> è¯­å¥æ›´æ–°ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¯»é”ä¸Šä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œéœ€è¦å…ˆè§£é”ï¼Œå†è¿›è¡Œ <code>UPDATE</code> æ“ä½œã€‚</p><p><strong>Example</strong><br>ğŸ‘‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ MySQL ä¸­è¡¨é”ä¹‹å†™é”çš„ç”¨æ³•ã€‚<br>å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢ <code>teachers</code> è¡¨ä¸­æ‰€æœ‰çš„ä¿¡æ¯ï¼Œä½†æ˜¯ï¼Œ<code>courses</code> è¡¨è¢«åŠ äº†å†™é”ï¼Œè¯·ç¼–å†™ SQL è¯­å¥ï¼Œæ¥å®ç°æŸ¥è¯¢ <code>teachers</code> è¡¨ä¸­æ‰€æœ‰çš„ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å¯¹ courses è¡¨ä¸Šå†™é” --</span></span><br><span class="line">LOCK TABLES courses WRITE;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è§£é” --</span></span><br><span class="line">UNLOCK TABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ teachers è¡¨ä¸­æ‰€æœ‰ä¿¡æ¯ --</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> teachers;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> LOCK TABLES courses WRITE;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teachers;</span><br><span class="line"><span class="comment">-- ERROR 1100 (HY000): Table &#x27;teachers&#x27; was not locked with LOCK TABLES --</span></span><br><span class="line">mysql<span class="operator">&gt;</span> UNLOCK TABLES;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teachers;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name             <span class="operator">|</span> email                     <span class="operator">|</span> age <span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span>  <span class="number">20</span> <span class="operator">|</span> UK      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Northern Beggar  <span class="operator">|</span> northern.beggar<span class="variable">@qq</span>.com    <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span>  <span class="number">28</span> <span class="operator">|</span> USA     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> JP      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Linghu Chong     <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span>  <span class="number">18</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>è¯´æ˜ï¼š<br>åœ¨ä¸Šé¢çš„ SQL è¯­å¥ä¸­ï¼Œç”±äºå¯¹ <code>courses</code> è¡¨åŠ äº†å†™é”ï¼Œæ‰€ä»¥åªèƒ½å¯¹æŒæœ‰å†™é”çš„è¡¨è¿›è¡Œ<code>è¯»æˆ–å†™æ“ä½œ</code>ï¼Œå¦‚æœæƒ³å¯¹<code>å…¶ä»–çš„è¡¨è¿›è¡Œæ“ä½œï¼Œéœ€è¦å…ˆè§£é”</code>(åŒ…æ‹¬select)ã€‚</p><h3 id="å¦‚ä½•åŠ è¡Œé”"><a href="#å¦‚ä½•åŠ è¡Œé”" class="headerlink" title="å¦‚ä½•åŠ è¡Œé”"></a>å¦‚ä½•åŠ è¡Œé”</h3><blockquote><p>è¡¨é”è™½ç„¶å¼€é”€å°ï¼ŒåŠ é”å¿«ï¼Œä½†é«˜å¹¶å‘ä¸‹æ€§èƒ½ä½ã€‚è¡Œé”åå‘äº InnoDB å­˜å‚¨å¼•æ“ï¼Œè™½ç„¶å¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼Œé”å®šç²’åº¦å°ï¼Œä¼šå‡ºç°æ­»é”ï¼Œä½†é«˜å¹¶å‘ä¸‹æ€§èƒ½æ›´é«˜ã€‚</p></blockquote><p>äº‹åŠ¡å’Œè¡Œé”éƒ½æ˜¯åœ¨<code>ç¡®ä¿æ•°æ®å‡†ç¡®çš„åŸºç¡€ä¸Šæå‡å¹¶å‘çš„å¤„ç†èƒ½åŠ›ã€‚</code>å› æ­¤ï¼ŒInnoDB å­˜å‚¨å¼•æ“ç›¸æ¯” MyISAM è€Œè¨€ï¼Œ<code>æ›´é€‚åˆé«˜å¹¶å‘åœºæ™¯ï¼ŒåŒæ—¶æ”¯æŒäº‹åŠ¡å¤„ç†</code>ã€‚InnoDB ä¸ MyISAM ç›¸æ¯”<code>æœ€å¤§ä¸åŒä¹‹å¤„ä¹Ÿåœ¨äºè¿™ä¸¤ç‚¹ï¼šæ”¯æŒäº‹åŠ¡ã€é‡‡ç”¨è¡Œçº§é”</code>ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">è¡Œé”ä¼˜ç¼º</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">åŠ£åŠ¿</td><td style="text-align:center">å¼€é”€å¤§ã€åŠ é”æ…¢ã€ä¼šå‡ºç°æ­»é”</td></tr><tr><td style="text-align:center">ä¼˜åŠ¿</td><td style="text-align:center">ç²’åº¦å°ã€å‘ç”Ÿé”å†²çªå‡ ç‡å°ã€å¤„ç†å¹¶å‘èƒ½åŠ›å¼º</td></tr></tbody></table></div><p>è¡Œé”æ˜¯ MySQL ä¸­ç²’åº¦æœ€ç»†çš„ä¸€ç§é”æœºåˆ¶ï¼Œåªå¯¹å½“å‰æ‰€æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ï¼Œè¡Œé”å‘ç”Ÿå†²çªçš„æ¦‚ç‡å¾ˆä½ï¼Œå…¶ç²’åº¦æœ€å°ï¼Œä½†åŠ é”çš„ä»£ä»·æœ€å¤§ã€‚è¡Œé”æœ‰åˆ†ä¸ºå…±äº«é”ï¼ˆS é”ï¼‰å’Œæ’ä»–é”ï¼ˆX é”ï¼‰ã€‚<br>|è¡Œé”|æè¿°|<br>|:â€”-:|:â€”-:|<br>|Sé”|è¯»é”ï¼Œå…±äº«é”|<br>|Xé”|å†™é”ï¼Œæ’å®ƒé”|<br><code>InnoDB çš„è¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•é¡¹æ·»åŠ é”æ¥å®ç°çš„</code>ï¼Œè¿™ä¸€ç‚¹ MySQL ä¸ Oracle ä¸åŒï¼Œ<code>Oracle æ˜¯é€šè¿‡åœ¨æ•°æ®åº“ä¸­å¯¹ç›¸åº”çš„æ•°æ®è¡ŒåŠ é”æ¥å®ç°</code>ã€‚InnoDB è¡Œé”åªæœ‰åœ¨é€šè¿‡<code>ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®</code>æ—¶æ‰èƒ½ä½¿ç”¨ï¼Œå¦åˆ™ä¼šç›´æ¥ä½¿ç”¨è¡¨çº§é”ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¡Œçº§é”ä¸€å®šè¦ä½¿ç”¨ç´¢å¼•ã€‚</p><h4 id="éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰-1"><a href="#éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰-1" class="headerlink" title="éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰"></a>éšå¼ä¸Šé”ï¼ˆé»˜è®¤ï¼Œè‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨é‡Šæ”¾ï¼‰</h4><p>InnoDB è¡Œé”çš„åŠ é”çš„æ–¹å¼æ˜¯è‡ªåŠ¨åŠ é”</p><ul><li>å¯¹äº UPDATEã€DELETEã€INSERT æ“ä½œï¼ŒInnoDB ä¼šè‡ªåŠ¨ç»™æ¶‰åŠæ•°æ®é›†æ·»åŠ æ’ä»–é”</li><li>å¯¹äº SELECT æ“ä½œï¼ŒInnoDB ä¸ä¼šæ·»åŠ ä»»ä½•é”<br>|æ“ä½œ|è¯­å¥|è‡ªåŠ¨åŠ é”|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|DQL|SELECT|æ— |<br>|DML|INSERT/DELETE/UPDATE|Xé”|<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¸ä¼šä¸Šé” --</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¸Šå†™é” --</span></span><br><span class="line"><span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span></span><br></pre></td></tr></table></figure><h4 id="æ˜¾ç¤ºä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰"><a href="#æ˜¾ç¤ºä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰" class="headerlink" title="æ˜¾ç¤ºä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰"></a>æ˜¾ç¤ºä¸Šé”ï¼ˆæ‰‹åŠ¨ï¼‰</h4>InnoDB æ‰‹å·¥åŠ é”æ–¹å¼<br><code>LOCK IN SHARE MODE</code> ä¸ <code>FOR UPDATE</code> åªèƒ½åœ¨äº‹åŠ¡å†…èµ·ä½œç”¨ï¼Œä»¥ä¿è¯å½“å‰ä¼šè¯äº‹åŠ¡é”å®šçš„è¡Œä¸ä¼šè¢«å…¶ä»–ä¼šè¯ä¿®æ”¹ã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¯»é” --</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line">LOCK <span class="keyword">IN</span> SHARE MODE;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å†™é” --</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure></li></ul><h4 id="è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰-1"><a href="#è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰-1" class="headerlink" title="è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰"></a>è§£é”ï¼ˆæ‰‹åŠ¨ï¼‰</h4><ol><li>æäº¤äº‹åŠ¡ï¼ˆcommitï¼‰</li><li>å›æ»šäº‹åŠ¡ï¼ˆrollbackï¼‰</li><li>é˜»å¡è¿›ç¨‹ï¼ˆkillï¼‰</li></ol><h2 id="å¦‚ä½•æ’æŸ¥é”"><a href="#å¦‚ä½•æ’æŸ¥é”" class="headerlink" title="å¦‚ä½•æ’æŸ¥é”"></a>å¦‚ä½•æ’æŸ¥é”</h2><h3 id="å¦‚ä½•æ’æŸ¥è¡¨é”"><a href="#å¦‚ä½•æ’æŸ¥è¡¨é”" class="headerlink" title="å¦‚ä½•æ’æŸ¥è¡¨é”"></a>å¦‚ä½•æ’æŸ¥è¡¨é”</h3><p><strong>Gammar</strong><br><strong>æŸ¥çœ‹è¡¨é”æƒ…å†µ</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">OPEN</span> TABLES;</span><br></pre></td></tr></table></figure><br><strong>è¡¨é”åˆ†æ</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;table%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;table%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name              <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Table_locks_immediate      <span class="operator">|</span> <span class="number">59</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Table_locks_waited         <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Table_open_cache_hits      <span class="operator">|</span> <span class="number">75</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Table_open_cache_misses    <span class="operator">|</span> <span class="number">26</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Table_open_cache_overflows <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br><code>Table_locks_waited</code>ï¼šå‡ºç°è¡¨çº§é”å®šäº‰ç”¨è€Œå‘ç”Ÿç­‰å¾…çš„æ¬¡æ•°ï¼ˆä¸èƒ½ç«‹å³è·å–é”çš„æ¬¡æ•°ï¼Œæ¯ç­‰å¾…ä¸€æ¬¡å€¼åŠ  1ï¼‰ï¼Œæ­¤å€¼é«˜è¯´æ˜å­˜åœ¨ç€è¾ƒä¸¥é‡çš„è¡¨çº§é”äº‰ç”¨æƒ…å†µ<br><code>Table_locks_immediate</code>ï¼šäº§ç”Ÿè¡¨çº§é”å®šæ¬¡æ•°ï¼Œä¸æ˜¯å¯ä»¥ç«‹å³è·å–é”çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œæ¯ç«‹å³è·å–é”åŠ  1</p><h3 id="å¦‚ä½•æ’æŸ¥è¡Œé”"><a href="#å¦‚ä½•æ’æŸ¥è¡Œé”" class="headerlink" title="å¦‚ä½•æ’æŸ¥è¡Œé”"></a>å¦‚ä½•æ’æŸ¥è¡Œé”</h3><p><strong>Gammar</strong><br><strong>è¡Œé”åˆ†æ</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_row_lock%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_row_lock%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name                 <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Innodb_row_lock_current_waits <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Innodb_row_lock_time          <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Innodb_row_lock_time_avg      <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Innodb_row_lock_time_max      <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Innodb_row_lock_waits         <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><ul><li><code>Innodb_row_lock_current_waits</code>ï¼šå½“å‰æ­£åœ¨ç­‰å¾…é”å®šçš„æ•°é‡</li><li><code>Innodb_row_lock_time</code>ï¼šä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨é”å®šæ€»æ—¶é—´é•¿åº¦</li><li><code>Innodb_row_lock_time_avg</code>ï¼šæ¯æ¬¡ç­‰å¾…æ‰€èŠ±å¹³å‡æ—¶é—´</li><li><code>Innodb_row_lock_time_max</code>ï¼šä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨ç­‰å¾…æœ€é•¿çš„ä¸€æ¬¡æ‰€èŠ±æ—¶é—´</li><li><code>Innodb_row_lock_waits</code>ï¼šç³»ç»Ÿå¯åŠ¨ååˆ°ç°åœ¨æ€»å…±ç­‰å¾…çš„æ¬¡æ•°</li></ul><h4 id="ä¼˜åŒ–å»ºè®®"><a href="#ä¼˜åŒ–å»ºè®®" class="headerlink" title="ä¼˜åŒ–å»ºè®®"></a>ä¼˜åŒ–å»ºè®®</h4><ol><li>å°½å¯èƒ½è®©æ‰€æœ‰æ•°æ®æ£€ç´¢éƒ½é€šè¿‡ç´¢å¼•æ¥å®Œæˆï¼Œé¿å…æ— ç´¢å¼•è¡Œé”å‡çº§ä¸ºè¡¨é”</li><li>åˆç†è®¾è®¡ç´¢å¼•ï¼Œå°½é‡ç¼©å°é”çš„èŒƒå›´</li><li>å°½å¯èƒ½è¾ƒå°‘æ£€ç´¢æ¡ä»¶ï¼Œé¿å…[[#é—´éš™é”ï¼ˆGap Locksï¼‰]]</li><li>å°½é‡æ§åˆ¶äº‹åŠ¡å¤§å°ï¼Œå‡å°‘é”å®šèµ„æºé‡å’Œæ—¶é—´é•¿åº¦</li><li>å°½å¯èƒ½ä½çº§åˆ«äº‹åŠ¡éš”ç¦»</li></ol><h2 id="MySQLä¹è§‚é”ä¸æ‚²è§‚é”"><a href="#MySQLä¹è§‚é”ä¸æ‚²è§‚é”" class="headerlink" title="MySQLä¹è§‚é”ä¸æ‚²è§‚é”"></a>MySQLä¹è§‚é”ä¸æ‚²è§‚é”</h2><p>å½“å¾ˆå¤šäººï¼ˆä¸€ä¸¤ä¸ªäººä¼°è®¡ä¸è¡Œï¼‰åŒæ—¶å¯¹åŒä¸€æ¡æ•°æ®åšä¿®æ”¹çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ•°æ®çš„æœ€ç»ˆç»“æœæ˜¯æ€æ ·çš„å‘¢ï¼Ÿ<br>è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„å¹¶å‘æƒ…å†µï¼Œè¿™æ ·ä¼šå¯¼è‡´ä»¥ä¸‹ä¸¤ç§ç»“æœï¼š</p><ul><li>æ›´æ–°é”™è¯¯ï¼Œä½ ä¿®æ”¹ä¹‹åçš„æ•°æ®å¯èƒ½è¢«åˆ«äººè¦†ç›–äº†ï¼Œå¯¼è‡´ä½ å¾ˆæ‡µé€¼ï¼Œç”šè‡³æ€€ç–‘è‡ªå·±å¼€å‘çš„åŠŸèƒ½æ˜¯å¦æœ‰é—®é¢˜ï¼›</li><li>è„è¯»ï¼Œæ•°æ®æ›´æ–°é”™è¯¯ï¼Œå¯¼è‡´è¯»æ•°æ®ä¹Ÿæ˜¯é”™çš„ï¼ŒæŸ¥è¯¢å‡ºä¸€äº›é»˜è®¤å¥‡å¦™çš„æ•°æ®ï¼Œçœ‹åˆ°çš„ä¸æ˜¯ä½ è‡ªå·±ä¿®æ”¹çš„ç»“æœã€‚<br>é”åˆ†ä¸º<code>ä¹è§‚é”å’Œæ‚²è§‚é”</code>ï¼Œå®ƒçš„ç›®çš„æ˜¯ç”¨æ¥<code>è§£å†³å¹¶å‘æ§åˆ¶çš„é—®é¢˜</code>ã€‚<br>MyISAM å¼•æ“ä¸æ”¯æŒäº‹åŠ¡ï¼Œæ‰€ä»¥ä¸è€ƒè™‘å®ƒæœ‰ä¹è§‚é”å’Œæ‚²è§‚é”æ¦‚å¿µã€‚MyISAM åªæœ‰è¡¨é”ï¼Œé”åˆåˆ†ä¸ºè¯»é”å’Œå†™é”ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬åªè®¨è®ºInnoDB å¼•æ“ã€‚ä¹è§‚é”å’Œæ‚²è§‚é”<code>å¹¶ä¸æ˜¯è§£å†³å¹¶å‘æ§åˆ¶çš„å”¯ä¸€æ‰‹æ®µ</code>ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ kafkaï¼ŒMQ ä¹‹ç±»çš„ä½œä¸ºç¼“å†²ç­‰ç­‰ï¼‰ï¼Œè€Œä¸”ä¹è§‚é”å’Œæ‚²è§‚é”å¹¶<code>ä¸ä»…é™åˆ¶åœ¨ MySQL ä¸­ä½¿ç”¨</code>ï¼Œå®ƒæ˜¯ä¸€ç§æ¦‚å¿µï¼Œå¾ˆå¤šå…¶ä»–çš„åº”ç”¨ï¼Œå¦‚ redisï¼Œmemcached ç­‰ï¼Œåªè¦å­˜åœ¨å¹¶å‘æƒ…å†µçš„ï¼Œéƒ½å¯ä»¥åº”ç”¨è¿™ç§æ¦‚å¿µï¼Œåªæ˜¯æ–¹å¼ä¸Šæœ‰äº›å·®åˆ«è€Œå·²ã€‚</li></ul><h3 id="ä¹è§‚é”"><a href="#ä¹è§‚é”" class="headerlink" title="ä¹è§‚é”"></a>ä¹è§‚é”</h3><p>ä¹è§‚é”ï¼Œç®€å•åœ°è¯´ï¼Œå°±æ˜¯ä»åº”ç”¨ç³»ç»Ÿå±‚é¢ä¸Šåšå¹¶å‘æ§åˆ¶ï¼Œå»åŠ é”ã€‚<br>å®ç°ä¹è§‚é”å¸¸è§çš„æ–¹å¼ï¼šç‰ˆæœ¬å· versionã€‚å®ç°æ–¹å¼ï¼Œåœ¨æ•°æ®è¡¨ä¸­å¢åŠ ç‰ˆæœ¬å·å­—æ®µï¼Œæ¯æ¬¡å¯¹ä¸€æ¡æ•°æ®åšæ›´æ–°ä¹‹å‰ï¼Œå…ˆæŸ¥å‡ºè¯¥æ¡æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æ›´æ–°æ•°æ®éƒ½ä¼šå¯¹ç‰ˆæœ¬å·è¿›è¡Œæ›´æ–°ï¼Œåœ¨æ›´æ–°æ—¶ï¼ŒæŠŠä¹‹å‰æŸ¥å‡ºçš„ç‰ˆæœ¬å·è·Ÿåº“ä¸­æ•°æ®çš„ç‰ˆæœ¬å·è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜è¯¥æ¡æ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œæ‰§è¡Œæ›´æ–°ã€‚å¦‚æœæ¯”å¯¹çš„ç»“æœæ˜¯ä¸ä¸€è‡´çš„ï¼Œåˆ™è¯´æ˜è¯¥æ¡æ•°æ®å·²ç»è¢«å…¶ä»–äººä¿®æ”¹è¿‡äº†ï¼Œåˆ™ä¸æ›´æ–°ï¼Œå®¢æˆ·ç«¯è¿›è¡Œç›¸åº”çš„æ“ä½œæé†’ã€‚</p><p><strong>Gammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.æŸ¥è¯¢å‡ºå•†å“ä¿¡æ¯ --</span></span><br><span class="line"><span class="keyword">select</span> status,version <span class="keyword">from</span> t_goods <span class="keyword">where</span> id<span class="operator">=</span>#&#123;id&#125;;</span><br><span class="line"><span class="comment">-- 2.æ ¹æ®å•†å“ä¿¡æ¯ç”Ÿæˆè®¢å• --</span></span><br><span class="line"><span class="comment">-- 3.ä¿®æ”¹å•†å“statusä¸º2 --</span></span><br><span class="line"><span class="keyword">update</span> t_goods</span><br><span class="line"><span class="keyword">set</span> status<span class="operator">=</span><span class="number">2</span>,version<span class="operator">=</span>version<span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="keyword">where</span> id<span class="operator">=</span>#&#123;id&#125; <span class="keyword">and</span> version<span class="operator">=</span>#&#123;version&#125;;</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/12/3cbac616-e2bb-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="ä¸å­˜åœ¨å¹²æ‰°"><br>æ³¨æ„ç¬¬äºŒä¸ªäº‹åŠ¡æ‰§è¡Œ update æ—¶ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªäº‹åŠ¡èƒ½å¤Ÿè¯»å–åˆ°ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹çš„ versionã€‚<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/12/5ddea79a-e2bb-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="å­˜åœ¨å¹²æ‰°"><br>InnoDBäº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ˜¯ Repeatable Readï¼Œå› æ­¤æ˜¯ä¸ä¼šå‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»ã€‚<br>åœ¨è¿™ç§æç«¯æƒ…å†µä¸‹ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡çš„ update ç”±äºä¸èƒ½è¯»å–ç¬¬ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆç¬¬ä¸€ä¸ªäº‹åŠ¡å·²ç»å¯¹è¿™ä¸€æ¡æ•°æ®åŠ äº†æ’ä»–é”ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡éœ€è¦ç­‰å¾…è·å–é”ï¼‰ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡è·å–äº†æ’ä»–é”åï¼Œä¼šå‘ç° version å·²ç»å‘ç”Ÿäº†æ”¹å˜ä»è€Œæäº¤å¤±è´¥ã€‚</p><h3 id="æ‚²è§‚é”"><a href="#æ‚²è§‚é”" class="headerlink" title="æ‚²è§‚é”"></a>æ‚²è§‚é”</h3><p>æ‚²è§‚é”ï¼Œç®€å•åœ°è¯´ï¼Œå°±æ˜¯ä»æ•°æ®åº“å±‚é¢ä¸Šåšå¹¶å‘æ§åˆ¶ï¼Œå»åŠ é”ã€‚<br>æ‚²è§‚é”çš„å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼šå…±äº«é”ï¼ˆè¯»é”ï¼‰å’Œæ’å®ƒé”ï¼ˆå†™é”ï¼‰<br><strong>å…±äº«é”ï¼ˆISé”ï¼‰</strong>ï¼Œå®ç°æ–¹å¼æ˜¯åœ¨ SQL è¯­å¥ååŠ  <code>LOCK IN SHARE MODE</code>ï¼Œæ¯”å¦‚ <code>SELECT ... LOCK IN SHARE MODE</code>ï¼Œå³åœ¨ç¬¦åˆæ¡ä»¶çš„rows ä¸Šéƒ½åŠ äº†å…±äº«é”ï¼Œè¿™æ ·çš„è¯ï¼Œå…¶ä»– session å¯ä»¥è¯»å–è¿™äº›è®°å½•ï¼Œä¹Ÿå¯ä»¥ç»§ç»­æ·»åŠ  IS é”ï¼Œä½†æ˜¯æ— æ³•ä¿®æ”¹è¿™äº›è®°å½•ç›´åˆ°ä½ è¿™ä¸ªåŠ é”çš„ session æ‰§è¡Œå®Œæˆï¼ˆå¦åˆ™ç›´æ¥é”ç­‰å¾…è¶…æ—¶ï¼‰ã€‚<br><strong>æ’å®ƒé”ï¼ˆIXé”ï¼‰</strong>ï¼Œå®ç°æ–¹å¼æ˜¯åœ¨ SQL è¯­å¥ååŠ  <code>FOR UPDATE</code>ï¼Œæ¯”å¦‚ <code>SELECT ... FOR UPDATE</code>ï¼Œå³åœ¨ç¬¦åˆæ¡ä»¶çš„ rows ä¸Šéƒ½åŠ äº†æ’å®ƒé”ï¼Œå…¶ä»– session ä¹Ÿå°±æ— æ³•åœ¨è¿™äº›è®°å½•ä¸Šæ·»åŠ ä»»ä½•çš„ S é”æˆ– X é”ã€‚å¦‚æœä¸å­˜åœ¨ä¸€è‡´æ€§éé”å®šè¯»çš„è¯ï¼Œé‚£ä¹ˆå…¶ä»– session æ˜¯æ— æ³•è¯»å–å’Œä¿®æ”¹è¿™äº›è®°å½•çš„ï¼Œä½†æ˜¯ InnoDB æœ‰éé”å®šè¯»ï¼ˆå¿«ç…§è¯»å¹¶ä¸éœ€è¦åŠ é”ï¼‰ï¼Œfor update ä¹‹åå¹¶ä¸ä¼šé˜»å¡å…¶ä»– session çš„å¿«ç…§è¯»å–æ“ä½œï¼Œé™¤äº† <code>select ...lock in share mode</code> å’Œ <code>select ... for update</code> è¿™ç§æ˜¾ç¤ºåŠ é”çš„æŸ¥è¯¢æ“ä½œã€‚<br><strong>é€šè¿‡å¯¹æ¯”ï¼Œå‘ç° for update çš„åŠ é”æ–¹å¼æ— éæ˜¯æ¯” lock in share mode çš„æ–¹å¼å¤šé˜»å¡äº† <code>select...lock in share mode</code> çš„æŸ¥è¯¢æ–¹å¼ï¼Œå¹¶ä¸ä¼šé˜»å¡å¿«ç…§è¯»ã€‚</strong></p><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="comment">-- 0. å¼€å§‹äº‹åŠ¡ï¼ˆä¸‰è€…é€‰ä¸€å°±å¯ä»¥ï¼‰ --</span></span><br><span class="line"><span class="keyword">begin</span>;<span class="operator">/</span><span class="keyword">begin</span> work;<span class="operator">/</span><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">-- 1. æŸ¥è¯¢å‡ºå•†å“ä¿¡æ¯ --</span></span><br><span class="line"><span class="keyword">select</span> status <span class="keyword">from</span> t_goods <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">for</span> <span class="keyword">update</span>; </span><br><span class="line"><span class="comment">-- 2. æ ¹æ®å•†å“ä¿¡æ¯ç”Ÿæˆè®¢å• --</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_orders (id,goods_id) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">1</span>); </span><br><span class="line"><span class="comment">-- 3. ä¿®æ”¹å•†å“ status ä¸º 2 -- </span></span><br><span class="line"><span class="keyword">update</span> t_goods <span class="keyword">set</span> status<span class="operator">=</span><span class="number">2</span>; </span><br><span class="line"><span class="comment">-- 4. æäº¤äº‹åŠ¡ --</span></span><br><span class="line"><span class="keyword">commit</span>;<span class="operator">/</span><span class="keyword">commit</span> work;</span><br></pre></td></tr></table></figure></p><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/9/ea0dbff2-e055-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="example"><br>ä¸Šé¢çš„æŸ¥è¯¢è¯­å¥ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>selectâ€¦for update</code> çš„æ–¹å¼ï¼Œ è¿™æ ·å°±é€šè¿‡å¼€å¯æ’ä»–é”çš„æ–¹å¼å®ç°äº†æ‚²è§‚é”ã€‚æ­¤æ—¶åœ¨ t_goods è¡¨ä¸­ï¼Œid ä¸º 1 çš„ é‚£æ¡æ•°æ®å°±è¢«æˆ‘ä»¬é”å®šäº†ï¼Œå…¶å®ƒçš„äº‹åŠ¡å¿…é¡»ç­‰æœ¬æ¬¡äº‹åŠ¡æäº¤ä¹‹åæ‰èƒ½æ‰§è¡Œã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¿è¯å½“å‰çš„æ•°æ®ä¸ä¼šè¢«å…¶å®ƒäº‹åŠ¡ä¿®æ”¹ã€‚</p><h4 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" class="headerlink" title="è¡¥å……ï¼š"></a>è¡¥å……ï¼š</h4><ol><li>MyISAM åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼ˆSELECTï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”,åœ¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆUPDATEã€DELETEã€INSERTç­‰ï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ã€‚</li><li>MySQL InnoDB é»˜è®¤è¡Œçº§é”ã€‚è¡Œçº§é”éƒ½æ˜¯åŸºäºç´¢å¼•çš„ï¼Œå¦‚æœä¸€æ¡ SQL è¯­å¥ç”¨ä¸åˆ°ç´¢å¼•æ˜¯ä¸ä¼šä½¿ç”¨è¡Œçº§é”çš„ï¼Œä¼šä½¿ç”¨è¡¨çº§é”æŠŠæ•´å¼ è¡¨é”ä½ã€‚</li><li>ä»ä¸Šé¢å¯¹ä¸¤ç§é”çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ä¸¤ç§é”å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸å¯è®¤ä¸ºä¸€ç§å¥½äºå¦ä¸€ç§ï¼Œåƒä¹è§‚é”é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ˆå¤šè¯»åœºæ™¯ï¼‰ï¼Œå³å†²çªçœŸçš„å¾ˆå°‘å‘ç”Ÿçš„æ—¶å€™ï¼Œè¿™æ ·å¯ä»¥çœå»äº†é”çš„å¼€é”€ï¼ŒåŠ å¤§äº†ç³»ç»Ÿçš„æ•´ä¸ªååé‡ã€‚ä½†å¦‚æœæ˜¯å¤šå†™çš„æƒ…å†µï¼Œä¸€èˆ¬ä¼šç»å¸¸äº§ç”Ÿå†²çªï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸Šå±‚åº”ç”¨ä¼šä¸æ–­çš„è¿›è¡Œ retryï¼Œè¿™æ ·åå€’æ˜¯é™ä½äº†æ€§èƒ½ï¼Œæ‰€ä»¥ä¸€èˆ¬å¤šå†™çš„åœºæ™¯ä¸‹ç”¨æ‚²è§‚é”å°±æ¯”è¾ƒåˆé€‚ã€‚</li></ol><h1 id="è§¦å‘å™¨"><a href="#è§¦å‘å™¨" class="headerlink" title="è§¦å‘å™¨"></a>è§¦å‘å™¨</h1><h2 id="è®¤è¯†è§¦å‘å™¨"><a href="#è®¤è¯†è§¦å‘å™¨" class="headerlink" title="è®¤è¯†è§¦å‘å™¨"></a>è®¤è¯†è§¦å‘å™¨</h2><p>åœ¨ MySQL ä¸­ï¼Œè§¦å‘å™¨æ˜¯ä¸€ä¸ªå­˜å‚¨ç¨‹åºï¼Œå®ƒå¯¹ç›¸å…³è¡¨ä¸­å‘ç”Ÿçš„æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ç­‰äº‹ä»¶è‡ªåŠ¨è°ƒç”¨ã€‚<br>SQL æ ‡å‡†å®šä¹‰äº†ä¸¤ç§ç±»å‹çš„è§¦å‘å™¨ï¼šè¡Œçº§è§¦å‘å™¨å’Œè¯­å¥çº§è§¦å‘å™¨ã€‚</p><ul><li>è¡Œçº§è§¦å‘å™¨æ˜¯ä¸ºæ¯æ¡æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤çš„è®°å½•æ¿€æ´»çš„ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªè¡¨æœ‰ 100 æ¡è®°å½•è¢«æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼Œé‚£ä¹ˆè¿™ä¸ªè§¦å‘å™¨å°±ä¼šä¸ºå—å½±å“çš„ 100 æ¡è®°å½•è‡ªåŠ¨è°ƒç”¨ 100 æ¬¡ã€‚</li><li>è¯­å¥çº§è§¦å‘å™¨å¯¹æ¯ä¸ªäº‹åŠ¡æ‰§è¡Œä¸€æ¬¡ï¼Œä¸ç®¡æœ‰å¤šå°‘è¡Œè¢«æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ã€‚<br><code>MySQL åªæ”¯æŒè¡Œçº§è§¦å‘å™¨ã€‚å®ƒä¸æ”¯æŒè¯­å¥çº§è§¦å‘å™¨</code>ã€‚</li></ul><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/27/2ae4b97c-eebb-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="è§¦å‘å™¨"></p><p><strong>è§¦å‘å™¨ä¼˜ç‚¹</strong></p><ul><li>è§¦å‘å™¨æä¾›äº†å¦ä¸€ç§æ–¹æ³•æ¥æ£€æŸ¥æ•°æ®çš„å®Œæ•´æ€§ã€‚</li><li>è§¦å‘å™¨å¯ä»¥å¤„ç†æ¥è‡ªæ•°æ®åº“å±‚çš„é”™è¯¯ã€‚</li><li>è§¦å‘å™¨æä¾›äº†ä¸€ç§è¿è¡Œè®¡åˆ’ä»»åŠ¡çš„æ›¿ä»£æ–¹æ³•ã€‚é€šè¿‡ä½¿ç”¨è§¦å‘å™¨ï¼Œä½ ä¸éœ€è¦ç­‰å¾…é¢„å®šäº‹ä»¶çš„è¿è¡Œï¼Œå› ä¸ºè§¦å‘å™¨ä¼šåœ¨è¡¨å†…æ•°æ®å‘ç”Ÿå˜åŒ–ä¹‹å‰æˆ–ä¹‹åè‡ªåŠ¨è°ƒç”¨ã€‚</li><li>è§¦å‘å™¨å¯¹äºå®¡è®¡è¡¨ä¸­çš„æ•°æ®å˜åŒ–éå¸¸æœ‰ç”¨ã€‚</li></ul><p><strong>è§¦å‘å™¨ç¼ºç‚¹</strong></p><ul><li>è§¦å‘å™¨åªèƒ½æä¾›æ‰©å±•éªŒè¯ï¼Œè€Œä¸æ˜¯æ‰€æœ‰çš„éªŒè¯ã€‚å¯¹äºç®€å•çš„éªŒè¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ NOT NULLã€UNIQUEã€CHECK å’Œ FOREIGN KEYçº¦æŸã€‚</li><li>è§¦å‘å™¨å¯èƒ½å¾ˆéš¾æ’é™¤æ•…éšœï¼Œå› ä¸ºå®ƒä»¬åœ¨æ•°æ®åº“ä¸­è‡ªåŠ¨æ‰§è¡Œï¼Œè€Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå¯èƒ½ä¸çŸ¥é“ã€‚</li><li>è§¦å‘å™¨å¯èƒ½ä¼šå¢åŠ  MySQL æœåŠ¡å™¨çš„å¼€é”€ã€‚</li></ul><h2 id="MySQLåˆ›å»ºè§¦å‘å™¨"><a href="#MySQLåˆ›å»ºè§¦å‘å™¨" class="headerlink" title="MySQLåˆ›å»ºè§¦å‘å™¨"></a>MySQLåˆ›å»ºè§¦å‘å™¨</h2><h3 id="MySQL-CREATE-TRIGGER-è¯­æ³•"><a href="#MySQL-CREATE-TRIGGER-è¯­æ³•" class="headerlink" title="MySQL CREATE TRIGGER è¯­æ³•"></a>MySQL CREATE TRIGGER è¯­æ³•</h3><p><strong>Grammar</strong><br><code>CREATE TRIGGER</code> è¯­å¥åˆ›å»ºä¸€ä¸ªæ–°çš„è§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">&#123;BEFORE <span class="operator">|</span> AFTER&#125; &#123;<span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">UPDATE</span><span class="operator">|</span> <span class="keyword">DELETE</span> &#125;</span><br><span class="line"><span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åé¢æŒ‡å®šè¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚æ³¨æ„ï¼Œè§¦å‘å™¨çš„åç§°åœ¨æ•°æ®åº“ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</li><li>æ¥ä¸‹æ¥ï¼ŒæŒ‡å®šè§¦å‘å™¨çš„åŠ¨ä½œæ—¶é—´ï¼Œå¯ä»¥æ˜¯ <code>BEFORE</code> æˆ– <code>AFTER</code>ï¼Œè¡¨ç¤ºåœ¨æ¯æ¡è®°å½•è¢«ä¿®æ”¹ä¹‹å‰æˆ–ä¹‹åè°ƒç”¨è¯¥è§¦å‘å™¨ã€‚</li><li>ç„¶åï¼ŒæŒ‡å®šæ¿€æ´»è§¦å‘å™¨çš„æ“ä½œï¼Œå¯ä»¥æ˜¯ <code>INSERT</code>ã€<code>UPDATE</code> æˆ– <code>DELETE</code>ã€‚</li><li>ä¹‹åï¼Œåœ¨ <code>ON</code> å…³é”®å­—åé¢æŒ‡å®šè§¦å‘å™¨æ‰€å±çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨æ¿€æ´»æ—¶è¦æ‰§è¡Œçš„è¯­å¥ã€‚å¦‚æœä½ æƒ³æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>BEGIN END</code> å¤åˆè¯­å¥</li></ul><p>è§¦å‘å™¨ä¸»ä½“å¯ä»¥è®¿é—®è¢« DML è¯­å¥å½±å“çš„åˆ—çš„å€¼ã€‚<br>ä¸ºäº†åŒºåˆ† DML å¯åŠ¨ä¹‹å‰å’Œä¹‹åçš„åˆ—çš„å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>NEW</code> å’Œ <code>OLD</code> ä¿®é¥°ç¬¦ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœä½ æ›´æ–°åˆ—æè¿°ï¼Œåœ¨è§¦å‘å™¨ä¸»ä½“ä¸­ï¼Œä½ å¯ä»¥è®¿é—®æ›´æ–°å‰çš„æè¿°å€¼ <code>OLD.description</code> å’Œæ–°å€¼ <code>NEW.description</code>ã€‚<br>ä¸‹è¡¨è¯´æ˜äº† <code>OLD</code> å’Œ <code>NEW</code> ä¿®æ”¹å™¨çš„å¯ç”¨æ€§ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">|</span> <span class="keyword">Trigger</span> Event <span class="operator">|</span> <span class="keyword">OLD</span> <span class="operator">|</span> <span class="keyword">NEW</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> :<span class="comment">----: | :----: | :----: |</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">No</span> <span class="operator">|</span> Yes <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">UPDATE</span> <span class="operator">|</span> Yes <span class="operator">|</span> Yes <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">DELETE</span> <span class="operator">|</span> Yes <span class="operator">|</span> <span class="keyword">No</span> <span class="operator">|</span></span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>åˆ›å»ºä¸€ä¸ªè§¦å‘å™¨æ¥è®°å½• <code>employees</code> è¡¨çš„å˜åŒ–ã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>employees_audit</code> çš„æ–°è¡¨ï¼Œä»¥ä¿æŒå¯¹ <code>employees</code> è¡¨çš„ä¿®æ”¹ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees_audit (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    employeeNumber <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    lastname <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    changedat DATETIME <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    action <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ª <code>BEFORE UPDATE</code> è§¦å‘å™¨ï¼Œåœ¨å¯¹ <code>employees</code> è¡¨è¿›è¡Œä¿®æ”¹ä¹‹å‰è°ƒç”¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_employee_update </span><br><span class="line">    BEFORE <span class="keyword">UPDATE</span> <span class="keyword">ON</span> employees</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees_audit</span><br><span class="line"> <span class="keyword">SET</span> action <span class="operator">=</span> <span class="string">&#x27;update&#x27;</span>,</span><br><span class="line">     employeeNumber <span class="operator">=</span> OLD.employeeNumber,</span><br><span class="line">     lastname <span class="operator">=</span> OLD.lastname,</span><br><span class="line">     changedat <span class="operator">=</span> NOW();</span><br></pre></td></tr></table></figure><br>åœ¨è§¦å‘å™¨çš„æ­£æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>OLD</code> å…³é”®å­—æ¥è®¿é—®å—è§¦å‘å™¨å½±å“çš„è¡Œçš„ <code>employeeNumber</code> å’Œ <code>lastname</code> åˆ—çš„å€¼ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br><span class="line">#æŸ¥çœ‹æ‰€æœ‰è§¦å‘å™¨</span><br></pre></td></tr></table></figure></p><h2 id="MySQLåˆ é™¤è§¦å‘å™¨"><a href="#MySQLåˆ é™¤è§¦å‘å™¨" class="headerlink" title="MySQLåˆ é™¤è§¦å‘å™¨"></a>MySQLåˆ é™¤è§¦å‘å™¨</h2><h3 id="MySQL-DROP-TRIGGER-è¯­æ³•"><a href="#MySQL-DROP-TRIGGER-è¯­æ³•" class="headerlink" title="MySQL DROP TRIGGER è¯­æ³•"></a>MySQL DROP TRIGGER è¯­æ³•</h3><p><strong>Grammar</strong><br><code>DROP TRIGGER</code> è¯­å¥ä»æ•°æ®åº“ä¸­åˆ é™¤äº†ä¸€ä¸ªè§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> [IF <span class="keyword">EXISTS</span>] [schema_name.]trigger_name;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>DROP TRIGGER</code> å…³é”®å­—åé¢æŒ‡å®šè¦åˆ é™¤çš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼ŒæŒ‡å®šè§¦å‘å™¨æ‰€å±æ¨¡å¼çš„åç§°ã€‚å¦‚æœè·³è¿‡æ¨¡å¼åç§°ï¼Œè¯¥è¯­å¥å°†åˆ é™¤å½“å‰æ•°æ®åº“ä¸­çš„è§¦å‘å™¨ã€‚</li><li>ç¬¬ä¸‰ï¼Œä½¿ç”¨ <code>IF EXISTS</code> é€‰é¡¹ï¼Œåœ¨è§¦å‘å™¨å­˜åœ¨çš„æƒ…å†µä¸‹æœ‰æ¡ä»¶åœ°åˆ é™¤è§¦å‘å™¨ã€‚<code>IF EXISTS</code> å­å¥æ˜¯å¯é€‰çš„ã€‚<br>å¦‚æœä½ ä¸ä½¿ç”¨ <code>IF EXISTS</code> å­å¥è€Œåˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„è§¦å‘å™¨ï¼ŒMySQL ä¼šå‘å‡ºä¸€ä¸ªé”™è¯¯ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä½¿ç”¨ <code>IF EXISTS</code> å­å¥ï¼ŒMySQL ä¼šå‘å‡ºä¸€ä¸ªæ³¨é‡Šã€‚<br><code>DROP TRIGGER</code> è¦æ±‚ä¸è§¦å‘å™¨ç›¸å…³çš„è¡¨æœ‰ <code>TRIGGER</code> æƒé™ã€‚</li></ul><blockquote><p>æ³¨æ„ï¼Œå¦‚æœä½ åˆ é™¤ä¸€ä¸ªè¡¨ï¼ŒMySQL å°†è‡ªåŠ¨æ”¾å¼ƒä¸è¯¥è¡¨ç›¸å…³çš„æ‰€æœ‰è§¦å‘å™¨ã€‚</p></blockquote><p><strong>Example</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>billings</code> çš„è¡¨è¿›è¡Œæ¼”ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> billings (</span><br><span class="line">    billingNo <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    customerNo <span class="type">INT</span>,</span><br><span class="line">    billingDate <span class="type">DATE</span>,</span><br><span class="line">    amount <span class="type">DEC</span>(<span class="number">10</span> , <span class="number">2</span> ),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (billingNo)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>ç¬¬äºŒï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œåä¸º <code>BEFORE UPDATE</code>ï¼Œä¸ <code>billings</code> è¡¨ç›¸å…³è”ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_billing_update</span><br><span class="line">    BEFORE <span class="keyword">UPDATE</span> </span><br><span class="line">    <span class="keyword">ON</span> billings <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF new.amount <span class="operator">&gt;</span> old.amount <span class="operator">*</span> <span class="number">10</span> <span class="keyword">THEN</span></span><br><span class="line">        SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;45000&#x27;</span> </span><br><span class="line">            <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> <span class="string">&#x27;New amount cannot be 10 times greater than the current amount.&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span> $$    </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>è§¦å‘å™¨åœ¨ä»»ä½•æ›´æ–°å‰éƒ½ä¼šæ¿€æ´»ã€‚å¦‚æœæ–°çš„é‡‘é¢æ˜¯å½“å‰é‡‘é¢çš„ 10 å€ï¼Œè§¦å‘å™¨ä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯ã€‚<br><code>SQLSTATU 45000</code>å¼‚å¸¸å¤„ç†</p><p>ç¬¬ä¸‰ï¼Œæ˜¾ç¤ºè§¦å‘å™¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br></pre></td></tr></table></figure></p><p>ç¬¬å››ï¼Œåˆ é™¤ <code>before_billing_update</code> è§¦å‘å™¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> before_billing_update;</span><br></pre></td></tr></table></figure></p><p>æœ€åï¼Œå†æ¬¡æ˜¾ç¤ºè§¦å‘å™¨ï¼Œä»¥éªŒè¯ç§»é™¤æƒ…å†µï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br></pre></td></tr></table></figure></p><h2 id="è§¦å‘å™¨åŸºæœ¬æ“ä½œ"><a href="#è§¦å‘å™¨åŸºæœ¬æ“ä½œ" class="headerlink" title="è§¦å‘å™¨åŸºæœ¬æ“ä½œ"></a>è§¦å‘å™¨åŸºæœ¬æ“ä½œ</h2><h3 id="MySQL-BEFORE-INSERT-Trigger"><a href="#MySQL-BEFORE-INSERT-Trigger" class="headerlink" title="MySQL BEFORE INSERT Trigger"></a>MySQL BEFORE INSERT Trigger</h3><h4 id="MySQL-BEFORE-INSERT-TRIGGER-è¯­æ³•"><a href="#MySQL-BEFORE-INSERT-TRIGGER-è¯­æ³•" class="headerlink" title="MySQL BEFORE INSERT TRIGGER è¯­æ³•"></a>MySQL BEFORE INSERT TRIGGER è¯­æ³•</h4><p><strong>Grammar</strong><br>MySQL <code>BEFORE INSERT</code> è§¦å‘å™¨æ˜¯åœ¨è¡¨å‘ç”Ÿæ’å…¥äº‹ä»¶ä¹‹å‰è‡ªåŠ¨è§¦å‘çš„ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    BEFORE <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body;</span><br></pre></td></tr></table></figure></p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å­å¥ä¸­æŒ‡å®šä½ è¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>BEFORE INSERT</code> å­å¥æ¥æŒ‡å®šè°ƒç”¨è§¦å‘å™¨çš„æ—¶é—´ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè§¦å‘å™¨æ‰€å…³è”çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨ä¸»ä½“ï¼Œå…¶ä¸­åŒ…å«ä¸€æ¡æˆ–å¤šæ¡åœ¨è§¦å‘å™¨è¢«è°ƒç”¨æ—¶æ‰§è¡Œçš„ SQL è¯­å¥ã€‚<br>å¦‚æœåœ¨è§¦å‘å™¨ä¸»ä½“ä¸­æœ‰å¤šæ¡è¯­å¥ï¼Œå¿…é¡»ä½¿ç”¨ <code>BEGIN END</code> å—å¹¶æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    BEFORE <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼Œåœ¨ <code>BEFORE INSERT</code> è§¦å‘å™¨ä¸­ï¼Œä½ å¯ä»¥è®¿é—®å’Œæ”¹å˜ <code>NEW</code> å€¼ã€‚ä½†æ˜¯ï¼Œä½ ä¸èƒ½è®¿é—® <code>OLD</code> å€¼ï¼Œå› ä¸º <code>OLD</code> å€¼æ˜¾ç„¶ä¸å­˜åœ¨ã€‚</p></blockquote></li></ul><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/2a4a8c2e-ef44-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="INSERT"></p><p><strong>Example</strong><br>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>BEFORE INSERT</code> è§¦å‘å™¨ï¼Œä»å¦ä¸€ä¸ªè¡¨ä¸­ç»´æŠ¤ä¸€ä¸ªæ±‡æ€»è¡¨ã€‚<br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>WorkCenters</code> çš„æ–°è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> WorkCenters;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> WorkCenters (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    capacity <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œåˆ›å»ºå¦ä¸€ä¸ªåä¸º <code>WorkCenterStats</code> çš„è¡¨ï¼Œå­˜å‚¨å·¥ä½œä¸­å¿ƒçš„èƒ½åŠ›æ±‡æ€»ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> WorkCenterStats;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> WorkCenterStats(</span><br><span class="line">    totalCapacity <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ä»¥ä¸‹è§¦å‘å™¨åœ¨ä¸€ä¸ªæ–°çš„å·¥ä½œä¸­å¿ƒæ’å…¥åˆ° <code>WorkCenter</code> è¡¨ä¸­ä¹‹å‰ï¼Œæ›´æ–° <code>WorkCenterStats</code> è¡¨ä¸­çš„æ€»å®¹é‡ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_workcenters_insert</span><br><span class="line">BEFORE <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> WorkCenters <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> rowcount <span class="type">INT</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) </span><br><span class="line">    <span class="keyword">INTO</span> rowcount</span><br><span class="line">    <span class="keyword">FROM</span> WorkCenterStats;</span><br><span class="line">    </span><br><span class="line">    IF rowcount <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">UPDATE</span> WorkCenterStats</span><br><span class="line">        <span class="keyword">SET</span> totalCapacity <span class="operator">=</span> totalCapacity <span class="operator">+</span> new.capacity;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> WorkCenterStats(totalCapacity)</span><br><span class="line">        <span class="keyword">VALUES</span>(new.capacity);</span><br><span class="line">    <span class="keyword">END</span> IF; </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè§¦å‘å™¨ä¸­ï¼š<br>é¦–å…ˆï¼Œè§¦å‘å™¨çš„åç§°æ˜¯ <code>CREATE TRIGGER</code> å­å¥ä¸­æŒ‡å®šçš„ <code>before_workcenters_insert</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_workcenters_insert</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BEFORE <span class="keyword">INSERT</span></span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œè¯¥è§¦å‘å™¨æ‰€å…³è”çš„è¡¨æ˜¯ <code>WorkCenters</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> WorkCenters <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br></pre></td></tr></table></figure><br>å¦‚æœè¡¨ <code>WorkCenterStats</code> ä¸­å­˜åœ¨è®°å½•ï¼Œè§¦å‘å™¨å°†å®¹é‡æ·»åŠ åˆ° <code>totalCapacity</code> åˆ—ä¸­ã€‚å¦åˆ™ï¼Œå®ƒå°±å‘ <code>WorkCenterStats</code> è¡¨æ’å…¥ä¸€æ¡æ–°çš„è®°å½•ã€‚<br><strong>æµ‹è¯• MySQL BEFORE INSERT è§¦å‘å™¨</strong><br>é¦–å…ˆï¼Œåœ¨ <code>WorkCenter</code> è¡¨ä¸­æ’å…¥ä¸€æ¡æ–°è¡Œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> WorkCenters(name, capacity)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;Mold Machine&#x27;</span>,<span class="number">100</span>);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œä» <code>WorkCenterStats</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> WorkCenterStats;  </span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/a8325d42-ef44-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"><br>è§¦å‘å™¨å·²ç»è¢«è°ƒç”¨ï¼Œå¹¶åœ¨ <code>WorkCenterStats</code> è¡¨ä¸­æ’å…¥äº†ä¸€æ¡æ–°è¡Œã€‚<br>ç¬¬ä¸‰ï¼Œæ’å…¥ä¸€ä¸ªæ–°çš„å·¥ä½œä¸­å¿ƒï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> WorkCenters(name, capacity)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;Packing&#x27;</span>,<span class="number">200</span>);</span><br></pre></td></tr></table></figure><br>æœ€åï¼Œä» <code>WorkCenterStats</code> æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> WorkCenterStats;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/eb68f0b2-ef44-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"><br>è§¦å‘å™¨å·²ç»æŒ‰ç…§é¢„æœŸå°†æ€»å®¹é‡ä» 100 æ›´æ–°åˆ° 200ã€‚</p><p><strong>Example</strong><br>æè¿°<br>æˆ‘ä»¬éœ€è¦ç»™ <code>courses</code> è¡¨æ·»åŠ ä¸€ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œå¹¶å‘½åä¸º <code>before_courses_insert</code> ï¼Œå½“æ–°å¢è¯¾ç¨‹æ•°æ®æ—¶ï¼Œå¦‚æœæ•™å¸ˆ <code>id</code> åœ¨æ•™å¸ˆè¡¨ä¸­ä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥æ¡è¯¾ç¨‹æ•°æ®çš„æ•™å¸ˆ <code>id</code> ç½®ä¸º 0ï¼Œä¸”åˆ›å»ºæ—¶é—´ç½®ä¸º <code>NULL</code> ï¼Œè¯·ç¼–å†™ SQL è¯­å¥å®ç°è¯¥è§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---------------111----------------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_courses_insert</span><br><span class="line">before <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> courses <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> id_count <span class="type">int</span>;</span><br><span class="line">Â  Â  Â <span class="keyword">select</span> <span class="built_in">count</span>(id)</span><br><span class="line">Â  Â  Â <span class="keyword">into</span> id_count</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> teachers</span><br><span class="line">Â  Â  Â <span class="keyword">where</span> id<span class="operator">=</span>new.teacher_id;</span><br><span class="line">Â  Â  Â if id_count<span class="operator">&lt;=</span><span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new.teacher_id<span class="operator">=</span><span class="number">0</span>,new.created_at<span class="operator">=</span><span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="comment">---------------222-----------------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_courses_insert</span><br><span class="line">before <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> courses <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â if new.teacher_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> teachers) <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new.teacher_id<span class="operator">=</span><span class="number">0</span>,new.created_at<span class="operator">=</span><span class="keyword">null</span>;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-----------------------------------</span></span><br></pre></td></tr></table></figure></p><h3 id="MySQL-AFTER-INSERT-Trigger"><a href="#MySQL-AFTER-INSERT-Trigger" class="headerlink" title="MySQL AFTER INSERT Trigger"></a>MySQL AFTER INSERT Trigger</h3><p><strong>Grammar</strong><br>MySQL <code>AFTER INSERT</code> è§¦å‘å™¨æ˜¯åœ¨è¡¨ä¸Šå‘ç”Ÿæ’å…¥äº‹ä»¶åè‡ªåŠ¨è°ƒç”¨çš„ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    AFTER <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">        trigger_body</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åé¢æŒ‡å®šè¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>AFTER INSERT</code> å­å¥æ¥æŒ‡å®šè°ƒç”¨è§¦å‘å™¨çš„æ—¶é—´ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè¦åˆ›å»ºè§¦å‘å™¨çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨ä¸»ä½“ï¼Œå®ƒç”±ä¸€æ¡æˆ–å¤šæ¡åœ¨è§¦å‘å™¨è¢«è°ƒç”¨æ—¶æ‰§è¡Œçš„è¯­å¥ç»„æˆã€‚</li></ul><p>å¦‚æœè§¦å‘å™¨ä¸»ä½“æœ‰å¤šæ¡è¯­å¥ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>BEGIN END</code> å—å¹¶æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    AFTER <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></p><p>åœ¨ <code>AFTER INSERT</code> è§¦å‘å™¨ä¸­ï¼Œå¯ä»¥è®¿é—® <code>NEW</code> å€¼ï¼Œä½†æ˜¯ä¸èƒ½æ”¹å˜å®ƒä»¬ã€‚å¦å¤–ï¼Œä½ ä¹Ÿä¸èƒ½è®¿é—® <code>OLD</code> å€¼ï¼Œå› ä¸ºåœ¨ <code>INSERT</code> è§¦å‘å™¨ä¸Šæ²¡æœ‰ <code>OLD</code> å€¼ã€‚</p><p><strong>Example</strong><br><strong>è®¾ç½®ä¸€ä¸ªæ ·æœ¬è¡¨</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>members</code> çš„æ–°è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> members;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> members (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">    birthDate <span class="type">DATE</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œåˆ›å»ºå¦ä¸€ä¸ªåä¸º <code>reminders</code> çš„è¡¨ï¼Œå­˜å‚¨ç»™ä¼šå‘˜çš„æé†’ä¿¡æ¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> reminders;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> reminders (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    memberId <span class="type">INT</span>,</span><br><span class="line">    message <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id , memberId)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><h4 id="åˆ›å»º-AFTER-INSERT-è§¦å‘å™¨å®ä¾‹"><a href="#åˆ›å»º-AFTER-INSERT-è§¦å‘å™¨å®ä¾‹" class="headerlink" title="åˆ›å»º AFTER INSERT è§¦å‘å™¨å®ä¾‹"></a>åˆ›å»º AFTER INSERT è§¦å‘å™¨å®ä¾‹</h4><p>ä¸‹é¢çš„è¯­å¥åˆ›å»ºäº†ä¸€ä¸ª <code>AFTER INSERT</code> è§¦å‘å™¨ï¼Œå¦‚æœä¼šå‘˜çš„å‡ºç”Ÿæ—¥æœŸä¸º <code>NULL</code>ï¼Œåˆ™å°†æé†’ä¿¡æ¯æ’å…¥åˆ° <code>reminders</code> è¡¨ä¸­ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> after_members_insert</span><br><span class="line">AFTER <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> members <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF NEW.birthDate <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> reminders(memberId, message)</span><br><span class="line">        <span class="keyword">VALUES</span>(new.id,CONCAT(<span class="string">&#x27;Hi &#x27;</span>, NEW.name, <span class="string">&#x27;, please update your date of birth.&#x27;</span>));</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè§¦å‘å™¨ä¸­ï¼š<br>é¦–å…ˆï¼Œè§¦å‘å™¨çš„åç§°æ˜¯åœ¨ <code>CREATE TRIGGER</code> å­å¥ä¸­æŒ‡å®šçš„ <code>after_members_insert</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> after_members_insert</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AFTER <span class="keyword">INSERT</span></span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œè§¦å‘å™¨æ‰€å…³è”çš„è¡¨æ˜¯ <code>members</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> members <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br></pre></td></tr></table></figure><br>æœ€åï¼Œåœ¨è§¦å‘å™¨ä¸»ä½“ä¸­ï¼Œå¦‚æœæˆå‘˜çš„å‡ºç”Ÿæ—¥æœŸä¸º <code>NULL</code>ï¼Œåˆ™åœ¨ <code>reminders</code> è¡¨ä¸­æ’å…¥ä¸€æ¡æ–°è¡Œã€‚</p><h3 id="MySQL-BEFORE-UPDATE-Trigger"><a href="#MySQL-BEFORE-UPDATE-Trigger" class="headerlink" title="MySQL BEFORE UPDATE Trigger"></a>MySQL BEFORE UPDATE Trigger</h3><p><strong>Grammar</strong><br>åœ¨ä¸è§¦å‘å™¨ç›¸å…³çš„è¡¨å‘ç”Ÿæ›´æ–°äº‹ä»¶ä¹‹å‰ï¼ŒMySQL <code>BEFORE UPDATE</code> è§¦å‘å™¨ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">BEFORE <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åæŒ‡å®šä½ è¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>BEFORE UPDATE</code> å­å¥æ¥æŒ‡å®šè°ƒç”¨è§¦å‘å™¨çš„æ—¶é—´ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè§¦å‘å™¨æ‰€å±çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨ä¸»ä½“ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè¯­å¥ã€‚<br>å¦‚æœä½ åœ¨è§¦å‘å™¨ä¸»ä½“ä¸­æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¯­å¥ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>BEGIN END</code> å—ã€‚æ­¤å¤–ï¼Œä½ éœ€è¦æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    BEFORE <span class="keyword">UPDATE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><strong>Example</strong><br><strong>è®¾ç½®ä¸€ä¸ªæ ·æœ¬è¡¨</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>sales</code> çš„æ–°è¡¨ï¼Œä»¥å­˜å‚¨é”€å”®é‡ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> sales;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sales (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    product <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    quantity <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    fiscalYear <span class="type">SMALLINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    fiscalMonth TINYINT <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">CHECK</span>(fiscalMonth <span class="operator">&gt;=</span> <span class="number">1</span> <span class="keyword">AND</span> fiscalMonth <span class="operator">&lt;=</span> <span class="number">12</span>),</span><br><span class="line">    <span class="keyword">CHECK</span>(fiscalYear <span class="keyword">BETWEEN</span> <span class="number">2000</span> <span class="keyword">and</span> <span class="number">2050</span>),</span><br><span class="line">    <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;=</span><span class="number">0</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span>(product, fiscalYear, fiscalMonth),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>ç¬¬äºŒï¼Œåœ¨ <code>sales</code> è¡¨ä¸­æ’å…¥ä¸€äº›è¡Œï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sales(product, quantity, fiscalYear, fiscalMonth)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;2003 Harley-Davidson Eagle Drag Bike&#x27;</span>,<span class="number">120</span>, <span class="number">2020</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="string">&#x27;1969 Corvair Monza&#x27;</span>, <span class="number">150</span>,<span class="number">2020</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="string">&#x27;1970 Plymouth Hemi Cuda&#x27;</span>, <span class="number">200</span>,<span class="number">2020</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>ç¬¬ä¸‰ï¼Œä» <code>sales</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ä»¥éªŒè¯æ’å…¥ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> sales;</span><br></pre></td></tr></table></figure></li></ul><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_sales_update</span><br><span class="line">BEFORE <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> sales <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> errorMessage <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line">    <span class="keyword">SET</span> errorMessage <span class="operator">=</span> CONCAT(<span class="string">&#x27;The new quantity &#x27;</span>,</span><br><span class="line">                        NEW.quantity,</span><br><span class="line">                        <span class="string">&#x27; cannot be 3 times greater than the current quantity &#x27;</span>,</span><br><span class="line">                        OLD.quantity);</span><br><span class="line">                        </span><br><span class="line">    IF new.quantity <span class="operator">&gt;</span> old.quantity <span class="operator">*</span> <span class="number">3</span> <span class="keyword">THEN</span></span><br><span class="line">        SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;45000&#x27;</span> </span><br><span class="line">            <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> errorMessage;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span> $$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>åœ¨ <code>sales</code> è¡¨ä¸­çš„æ¯ä¸€æ¡è®°å½•å‘ç”Ÿæ›´æ–°äº‹ä»¶ä¹‹å‰ï¼Œè§¦å‘å™¨ä¼šè‡ªåŠ¨è¢«è§¦å‘ã€‚<br>å¦‚æœä½ å°†æ•°é‡åˆ—ä¸­çš„å€¼æ›´æ–°ä¸ºä¸€ä¸ªæ¯”å½“å‰å€¼å¤§ 3 å€çš„æ–°å€¼ï¼Œè§¦å‘å™¨ä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯å¹¶åœæ­¢æ›´æ–°ã€‚<br>é¦–å…ˆï¼Œè§¦å‘å™¨çš„åç§°æ˜¯åœ¨ <code>CREATE TRIGGER</code> å­å¥ä¸­æŒ‡å®šçš„ <code>before_sales_update</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_sales_update</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BEFORE <span class="keyword">UPDATE</span></span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œè§¦å‘å™¨æ‰€å…³è”çš„è¡¨æ˜¯ <code>sales</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> sales <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br></pre></td></tr></table></figure><br>ç¬¬å››ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡å¹¶å°†å…¶å€¼è®¾ç½®ä¸ºé”™è¯¯ä¿¡æ¯ã€‚<br>æ³¨æ„ï¼Œåœ¨ <code>BEFORE TRIGGER</code> ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <code>OLD</code> å’Œ <code>NEW</code> ä¿®æ”¹å™¨è®¿é—®åˆ—çš„æ–°æ—§å€¼ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> errorMessage <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line"><span class="keyword">SET</span> errorMessage <span class="operator">=</span> CONCAT(<span class="string">&#x27;The new quantity &#x27;</span>,</span><br><span class="line">                        NEW.quantity,</span><br><span class="line">                        <span class="string">&#x27; cannot be 3 times greater than the current quantity &#x27;</span>,</span><br><span class="line">                        OLD.quantity);</span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>CONCAT()</code> å‡½æ•°æ¥å½¢æˆé”™è¯¯ä¿¡æ¯ã€‚</p><p>æœ€åï¼Œä½¿ç”¨ <code>IF-THEN</code> è¯­å¥æ£€æŸ¥æ–°å€¼æ˜¯å¦æ¯”æ—§å€¼å¤§ 3 å€ï¼Œç„¶åä½¿ç”¨ <code>SIGNAL</code> è¯­å¥å¼•å‘ä¸€ä¸ªé”™è¯¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF new.quantity <span class="operator">&gt;</span> old.quantity <span class="operator">*</span> <span class="number">3</span> <span class="keyword">THEN</span></span><br><span class="line">        SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;45000&#x27;</span> </span><br><span class="line">            <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> errorMessage;</span><br><span class="line"><span class="keyword">END</span> IF;</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong></p><blockquote><p>æˆ‘ä»¬éœ€è¦ç»™ <code>courses</code> è¡¨æ·»åŠ ä¸€ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œå¹¶å‘½åä¸º <code>before_courses_update</code> ï¼Œå½“æ›´æ–°è¯¾ç¨‹æ•°æ®æ—¶ï¼Œå¦‚æœæ•™å¸ˆ <code>id</code> åœ¨æ•™å¸ˆè¡¨ä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¸æ›´æ–°è¯¥æ¡æ•°æ®çš„æ•™å¸ˆ <code>id</code>ï¼Œè¯·ç¼–å†™ SQL è¯­å¥å®ç°è¯¥è§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_courses_update</span><br><span class="line">before <span class="keyword">update</span></span><br><span class="line"><span class="keyword">on</span> courses <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â if new.teacher_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> teachers) <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new.teacher_id<span class="operator">=</span>old.teacher_id;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></p></blockquote><h3 id="MySQL-AFTER-UPDATE-Trigger"><a href="#MySQL-AFTER-UPDATE-Trigger" class="headerlink" title="MySQL AFTER UPDATE Trigger"></a>MySQL AFTER UPDATE Trigger</h3><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">AFTER <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åæŒ‡å®šä½ è¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>AFTER UPDATE</code> å­å¥æ¥æŒ‡å®šè°ƒç”¨è§¦å‘å™¨çš„æ—¶é—´ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè§¦å‘å™¨æ‰€å±çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šç”±ä¸€ä¸ªæˆ–å¤šä¸ªè¯­å¥ç»„æˆçš„è§¦å‘å™¨ä¸»ä½“ã€‚<br>å¦‚æœä½ åœ¨è§¦å‘å™¨ä¸»ä½“ä¸­æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¯­å¥ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>BEGIN END</code> å—ã€‚æ­¤å¤–ï¼Œä½ éœ€è¦æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    AFTER <span class="keyword">UPDATE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></li></ul><p><strong>Example</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>sales</code> çš„è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> Sales;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Sales (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    product <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    quantity <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    fiscalYear <span class="type">SMALLINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    fiscalMonth TINYINT <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">CHECK</span>(fiscalMonth <span class="operator">&gt;=</span> <span class="number">1</span> <span class="keyword">AND</span> fiscalMonth <span class="operator">&lt;=</span> <span class="number">12</span>),</span><br><span class="line">    <span class="keyword">CHECK</span>(fiscalYear <span class="keyword">BETWEEN</span> <span class="number">2000</span> <span class="keyword">and</span> <span class="number">2050</span>),</span><br><span class="line">    <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;=</span><span class="number">0</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span>(product, fiscalYear, fiscalMonth),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>ç¬¬äºŒï¼Œåœ¨ <code>sales</code> è¡¨ä¸­æ’å…¥ä¸€äº›è¡Œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Sales(product, quantity, fiscalYear, fiscalMonth)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;2001 Ferrari Enzo&#x27;</span>,<span class="number">140</span>, <span class="number">2021</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="string">&#x27;1998 Chrysler Plymouth Prowler&#x27;</span>, <span class="number">110</span>,<span class="number">2021</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="string">&#x27;1913 Ford Model T Speedster&#x27;</span>, <span class="number">120</span>,<span class="number">2021</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸‰ï¼Œä» <code>sales</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ä»¥éªŒè¯æ’å…¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> SalesChanges;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SalesChanges (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    salesId <span class="type">INT</span>,</span><br><span class="line">    beforeQuantity <span class="type">INT</span>,</span><br><span class="line">    afterQuantity <span class="type">INT</span>,</span><br><span class="line">    changedAt <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>åˆ›å»º AFTER UPDATE è§¦å‘å™¨å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> after_sales_update</span><br><span class="line">AFTER <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> sales <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF OLD.quantity <span class="operator">&lt;&gt;</span> new.quantity <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> SalesChanges(salesId,beforeQuantity, afterQuantity)</span><br><span class="line">        <span class="keyword">VALUES</span>(old.id, old.quantity, new.quantity);</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></p><h3 id="MySQL-BEFORE-DELETE-Trigger"><a href="#MySQL-BEFORE-DELETE-Trigger" class="headerlink" title="MySQL BEFORE DELETE Trigger"></a>MySQL BEFORE DELETE Trigger</h3><p><strong>Grammar</strong><br>MySQL <code>BEFORE DELETE</code> è§¦å‘å™¨åœ¨ä¸€ä¸ªè¡¨å‘ç”Ÿåˆ é™¤äº‹ä»¶ä¹‹å‰è‡ªåŠ¨è§¦å‘ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    BEFORE <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åæŒ‡å®šä½ è¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>BEFORE DELETE</code> å­å¥æ¥æŒ‡å®šè§¦å‘å™¨åœ¨åˆ é™¤äº‹ä»¶ä¹‹å‰è¢«è°ƒç”¨ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè§¦å‘å™¨æ‰€å±çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨ä¸»ä½“ï¼Œå®ƒç”±ä¸€ä¸ªæˆ–å¤šä¸ªåœ¨è§¦å‘å™¨è¢«è§¦å‘æ—¶æ‰§è¡Œçš„è¯­å¥ç»„æˆã€‚<br>å¦‚æœä½ åœ¨è§¦å‘å™¨ä¸»ä½“ä¸­æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¯­å¥ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>BEGIN END</code> å—ã€‚æ­¤å¤–ï¼Œä½ éœ€è¦æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    BEFORE <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>åœ¨ <code>BEFORE DELETE</code> è§¦å‘å™¨ä¸­ï¼Œä½ å¯ä»¥è®¿é—® <code>OLD</code> è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½æ›´æ–°å®ƒã€‚å¦å¤–ï¼Œåœ¨ <code>BEFORE DELETE</code> è§¦å‘å™¨ä¸­æ²¡æœ‰ <code>NEW</code> è¡Œã€‚<br><strong>Example</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>Salaries</code> çš„æ–°è¡¨ï¼Œå­˜å‚¨å‘˜å·¥çš„å·¥èµ„ä¿¡æ¯ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> Salaries;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Salaries (</span><br><span class="line">    employeeNumber <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    validFrom <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    amount <span class="type">DEC</span>(<span class="number">12</span> , <span class="number">2</span> ) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>ç¬¬äºŒï¼Œåœ¨ <code>Salaries</code> è¡¨ä¸­æ’å…¥ä¸€äº›è¡Œï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> salaries(employeeNumber,validFrom,amount)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="number">1002</span>,<span class="string">&#x27;2000-01-01&#x27;</span>,<span class="number">50000</span>),</span><br><span class="line">    (<span class="number">1056</span>,<span class="string">&#x27;2000-01-01&#x27;</span>,<span class="number">60000</span>),</span><br><span class="line">    (<span class="number">1076</span>,<span class="string">&#x27;2000-01-01&#x27;</span>,<span class="number">70000</span>);</span><br></pre></td></tr></table></figure>ç¬¬ä¸‰ï¼Œåˆ›å»ºä¸€ä¸ªå­˜å‚¨è¢«åˆ é™¤å·¥èµ„çš„è¡¨ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> SalaryArchives;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SalaryArchives (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">    employeeNumber <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    validFrom <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    amount <span class="type">DEC</span>(<span class="number">12</span> , <span class="number">2</span> ) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    deletedAt <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> NOW()</span><br><span class="line">);</span><br></pre></td></tr></table></figure><strong>åˆ›å»º BEFORE DELETE è§¦å‘å™¨å®ä¾‹</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_salaries_delete</span><br><span class="line">BEFORE <span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">ON</span> salaries <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> SalaryArchives(employeeNumber,validFrom,amount)</span><br><span class="line">    <span class="keyword">VALUES</span>(OLD.employeeNumber,OLD.validFrom,OLD.amount);</span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></li></ul><p>é¦–å…ˆï¼Œè§¦å‘å™¨çš„åç§°æ˜¯åœ¨ <code>CREATE TRIGGER</code> å­å¥ä¸­æŒ‡å®šçš„ <code>before_salaries_delete</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_salaries_delete</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BEFORE DELETE</span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œè§¦å‘å™¨æ‰€å…³è”çš„è¡¨æ˜¯ <code>Salaries</code> è¡¨ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ON Salaries FOR EACH ROW</span><br></pre></td></tr></table></figure><br>æœ€åï¼Œåœ¨è§¦å‘å™¨ä¸»ä½“å†…å°†åˆ é™¤çš„è¡Œæ’å…¥åˆ° <code>SalaryArchives</code> è¡¨ä¸­ã€‚</p><p><strong>Example</strong><br>ä¸ºåä¸º <code>members</code> çš„è¡¨åˆ›å»ºäº†ä¸€ä¸ª <code>DELETE</code> è§¦å‘å™¨ï¼Œè¦æ±‚å®ç°å½“æœ‰ä¸€æ¡æ•°æ®è¢«åˆ é™¤æ—¶ï¼Œåˆ™å°†æé†’ä¿¡æ¯ <code>memberId</code> = <code>[id]</code>ï¼Œ<code>message</code> = <code>&#39;Delete members &#123;[old]&#125;&#39;</code> æ’å…¥åˆ° <code>reminders</code> è¡¨ä¸­<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_members_delete</span><br><span class="line"></span><br><span class="line">before <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> members <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> new_message <span class="type">varchar</span>(<span class="number">255</span>);</span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> c <span class="type">int</span>;</span><br><span class="line">Â  Â  Â <span class="comment">--ä¸å­˜åœ¨çš„å‚æ•°éœ€è¦å…ˆå£°æ˜</span></span><br><span class="line">Â  Â  Â <span class="keyword">select</span> <span class="built_in">count</span>(email) <span class="keyword">into</span> c <span class="keyword">from</span> members <span class="keyword">where</span> id<span class="operator">=</span>old.id;</span><br><span class="line">Â  Â  Â if c <span class="operator">!=</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new_message<span class="operator">=</span>concat(<span class="string">&#x27;Delete members &#123;[id=&#x27;</span>,old.id,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[name=&#x27;</span>,old.name,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[email=&#x27;</span>,old.email,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[birthDate=&#x27;</span>,old.birthDate,<span class="string">&#x27;]&#125;&#x27;</span>);</span><br><span class="line">Â  Â  Â <span class="keyword">else</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new_message<span class="operator">=</span>concat(<span class="string">&#x27;Delete members &#123;[id=&#x27;</span>,old.id,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[name=&#x27;</span>,old.name,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[email=null] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[birthDate=&#x27;</span>,old.birthDate,<span class="string">&#x27;]&#125;&#x27;</span>);</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line">Â  Â  Â <span class="comment">--if then</span></span><br><span class="line">Â  Â  Â <span class="comment">--â€¦â€¦ </span></span><br><span class="line">Â  Â  Â <span class="comment">--else </span></span><br><span class="line">Â  Â  Â <span class="comment">--â€¦â€¦ </span></span><br><span class="line">Â  Â  Â <span class="comment">--end if;</span></span><br><span class="line">Â  Â  Â <span class="keyword">insert</span> <span class="keyword">into</span> reminders(memberId,message)</span><br><span class="line">Â  Â  Â <span class="keyword">values</span>(old.id,new_message);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">--------------------2222-----------------------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_members_delete</span><br><span class="line">before <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> members <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> new_message <span class="type">varchar</span>(<span class="number">255</span>);</span><br><span class="line">Â  Â  Â if (<span class="keyword">select</span> email <span class="keyword">from</span> members <span class="keyword">where</span> id<span class="operator">=</span>old.id) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new_message<span class="operator">=</span>concat(<span class="string">&#x27;Delete members &#123;[id=&#x27;</span>,old.id,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[name=&#x27;</span>,old.name,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[email=&#x27;</span>,old.email,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[birthDate=&#x27;</span>,old.birthDate,<span class="string">&#x27;]&#125;&#x27;</span>);</span><br><span class="line">Â  Â  Â <span class="keyword">else</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> new_message<span class="operator">=</span>concat(<span class="string">&#x27;Delete members &#123;[id=&#x27;</span>,old.id,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[name=&#x27;</span>,old.name,<span class="string">&#x27;] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[email=null] &#x27;</span>,</span><br><span class="line">Â  Â  Â  Â  Â  <span class="string">&#x27;[birthDate=&#x27;</span>,old.birthDate,<span class="string">&#x27;]&#125;&#x27;</span>);</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line">Â  Â  Â <span class="keyword">insert</span> <span class="keyword">into</span> reminders(memberId,message)</span><br><span class="line">Â  Â  Â <span class="keyword">values</span>(old.id,new_message);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></p><h3 id="MySQL-AFTER-DELETE-Trigger"><a href="#MySQL-AFTER-DELETE-Trigger" class="headerlink" title="MySQL AFTER DELETE Trigger"></a>MySQL AFTER DELETE Trigger</h3><p><strong>Grammar</strong><br>MySQL <code>AFTER DELETE</code> è§¦å‘å™¨æ˜¯åœ¨è¡¨å‘ç”Ÿåˆ é™¤äº‹ä»¶åè‡ªåŠ¨è°ƒç”¨çš„ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    AFTER <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>CREATE TRIGGER</code> å…³é”®å­—åæŒ‡å®šä½ è¦åˆ›å»ºçš„è§¦å‘å™¨çš„åç§°ã€‚</li><li>ç¬¬äºŒï¼Œä½¿ç”¨ <code>AFTER DELETE</code> å­å¥æ¥æŒ‡å®šè§¦å‘å™¨åœ¨åˆ é™¤äº‹ä»¶ä¹‹å‰è¢«è°ƒç”¨ã€‚</li><li>ç¬¬ä¸‰ï¼Œåœ¨ <code>ON</code> å…³é”®å­—åæŒ‡å®šè§¦å‘å™¨æ‰€å±çš„è¡¨çš„åç§°ã€‚</li><li>æœ€åï¼ŒæŒ‡å®šè§¦å‘å™¨ä¸»ä½“ï¼Œå®ƒç”±ä¸€ä¸ªæˆ–å¤šä¸ªåœ¨è§¦å‘å™¨è¢«è§¦å‘æ—¶æ‰§è¡Œçš„è¯­å¥ç»„æˆã€‚<br>å¦‚æœä½ åœ¨è§¦å‘å™¨ä¸»ä½“ä¸­æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¯­å¥ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>BEGIN END</code> å—ã€‚æ­¤å¤–ï¼Œä½ éœ€è¦æ”¹å˜é»˜è®¤çš„åˆ†éš”ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">    AFTER <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$    </span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>åœ¨ <code>AFTER DELETE</code> è§¦å‘å™¨ä¸­ï¼Œä½ å¯ä»¥è®¿é—® <code>OLD</code> è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½æ›´æ–°å®ƒã€‚<br>æ³¨æ„ï¼Œåœ¨ <code>AFTER DELETE</code> è§¦å‘å™¨ä¸­æ²¡æœ‰æ–°çš„è®°å½•ã€‚</li></ul><p><strong>Example</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>Salaries</code> çš„æ–°è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> Salaries;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Salaries (</span><br><span class="line">    employeeNumber <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œåœ¨ <code>Salaries</code> è¡¨ä¸­æ’å…¥ä¸€äº›è¡Œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Salaries(employeeNumber,salary)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="number">1002</span>,<span class="number">5000</span>),</span><br><span class="line">    (<span class="number">1056</span>,<span class="number">7000</span>),</span><br><span class="line">    (<span class="number">1076</span>,<span class="number">8000</span>);</span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œåˆ›å»ºå¦ä¸€ä¸ªåä¸º <code>SalaryBudgets</code> çš„è¡¨ï¼Œå­˜å‚¨ <code>Salaries</code> è¡¨ä¸­çš„å·¥èµ„æ€»é¢ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> SalaryBudgets;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SalaryBudgets(</span><br><span class="line">    total <span class="type">DECIMAL</span>(<span class="number">15</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬å››ï¼Œä½¿ç”¨ <code>SUM()</code> å‡½æ•°ä» <code>Salaries</code> è¡¨ä¸­è·å¾—å·¥èµ„æ€»é¢ï¼Œå¹¶å°†å…¶æ’å…¥åˆ° <code>SalaryBudgets</code> è¡¨ä¸­ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SalaryBudgets(total)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) </span><br><span class="line"><span class="keyword">FROM</span> Salaries;</span><br></pre></td></tr></table></figure><br>æœ€åï¼Œä» <code>SalaryBudgets</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SalaryBudgets; </span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>æˆ‘ä»¬éœ€è¦ç»™ <code>teachers</code> è¡¨æ·»åŠ ä¸€ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œå½“åˆ é™¤ä¸€æ¡æ•™å¸ˆæ•°æ®æ—¶ï¼Œå¦‚æœæ•™å¸ˆ <code>id</code> åœ¨ <code>courses</code> è¡¨ä¸­çš„ <code>teacher_id</code> æœ‰å­˜åœ¨ï¼Œåˆ™å°†è¯¥ <code>teacher_id</code> ç½®ä¸º <code>0</code> ï¼Œè¯·ç¼–å†™ SQL è¯­å¥å®ç°è¯¥è§¦å‘å™¨ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> after_teacher_delete</span><br><span class="line">Â  Â  Â after <span class="keyword">delete</span></span><br><span class="line">Â  Â  Â <span class="keyword">on</span> teachers <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â if old.id <span class="keyword">in</span> (<span class="keyword">select</span> teacher_id <span class="keyword">from</span> courses) <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">update</span> courses</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> teacher_id<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> teacher_id<span class="operator">=</span>old.id;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºå¤šä¸ªè§¦å‘å™¨"><a href="#åˆ›å»ºå¤šä¸ªè§¦å‘å™¨" class="headerlink" title="åˆ›å»ºå¤šä¸ªè§¦å‘å™¨"></a>åˆ›å»ºå¤šä¸ªè§¦å‘å™¨</h2><h3 id="MySQL-Multiple-Triggers-è¯­æ³•"><a href="#MySQL-Multiple-Triggers-è¯­æ³•" class="headerlink" title="MySQL Multiple Triggers è¯­æ³•"></a>MySQL Multiple Triggers è¯­æ³•</h3><p>åœ¨ MySQL 5.7.2 ç‰ˆæœ¬ä¹‹å‰ï¼Œä½ åªèƒ½ä¸ºä¸€ä¸ªè¡¨ä¸­çš„äº‹ä»¶åˆ›å»ºä¸€ä¸ªè§¦å‘å™¨ï¼Œä¾‹å¦‚ï¼Œä½ åªèƒ½ä¸º <code>BEFORE UPDATE</code> æˆ– <code>AFTER UPDATE</code> äº‹ä»¶åˆ›å»ºä¸€ä¸ªè§¦å‘å™¨ã€‚MySQL 5.7.2+ å–æ¶ˆäº†è¿™ä¸€é™åˆ¶ï¼Œå…è®¸ä½ ä¸ºä¸€ä¸ªç»™å®šçš„è¡¨åˆ›å»ºå¤šä¸ªå…·æœ‰ç›¸åŒäº‹ä»¶å’Œè¡ŒåŠ¨æ—¶é—´çš„è§¦å‘å™¨ã€‚å½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¿™äº›è§¦å‘å™¨å°†ä¾æ¬¡æ¿€æ´»ã€‚<br>ä¸‹é¢æ˜¯å®šä¹‰ä¸€ä¸ªè§¦å‘å™¨çš„è¯­æ³•ï¼Œè¯¥è§¦å‘å™¨å°†åœ¨ç°æœ‰è§¦å‘å™¨ä¹‹å‰æˆ–ä¹‹åæ¿€æ´»ï¼Œä»¥å“åº”ç›¸åŒçš„äº‹ä»¶å’Œæ“ä½œæ—¶é—´ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">&#123;BEFORE<span class="operator">|</span>AFTER&#125;&#123;<span class="keyword">INSERT</span><span class="operator">|</span><span class="keyword">UPDATE</span><span class="operator">|</span><span class="keyword">DELETE</span>&#125; </span><br><span class="line"><span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line">&#123;FOLLOWS<span class="operator">|</span><span class="keyword">PRECEDES</span>&#125; existing_trigger_name</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- statements</span></span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼Œ<code>FOLLOWS</code> æˆ– <code>PRECEDES</code> æŒ‡å®šäº†æ–°çš„è§¦å‘å™¨åº”è¯¥åœ¨ç°æœ‰è§¦å‘å™¨ä¹‹å‰æˆ–ä¹‹åè¢«è°ƒç”¨ã€‚</p><ul><li><code>FOLLOWS</code> å…è®¸æ–°çš„è§¦å‘å™¨åœ¨ä¸€ä¸ªç°æœ‰çš„è§¦å‘å™¨ä¹‹åæ¿€æ´»ã€‚</li><li><code>PRECEDES</code> å…è®¸æ–°çš„è§¦å‘å™¨åœ¨ç°æœ‰è§¦å‘å™¨ä¹‹å‰æ¿€æ´»ã€‚<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/7e5a036e-ef65-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="å›¾ç¤º"></li></ul><p><strong>Example</strong><br>ä½¿ç”¨ <code>products</code> è¡¨è¿›è¡Œæ¼”ç¤ºã€‚<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/89028e1c-ef65-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="products"><br>å‡è®¾æƒ³æ”¹å˜ä¸€ä¸ªäº§å“çš„ä»·æ ¼ï¼ˆ<code>MSRP</code> åˆ—ï¼‰ï¼Œå¹¶åœ¨ä¸€ä¸ªå•ç‹¬çš„åä¸º <code>PriceLogs</code> çš„è¡¨ä¸­è®°å½•æ—§ä»·æ ¼ã€‚<br>é¦–å…ˆï¼Œä½¿ç”¨ä¸‹é¢çš„ <code>CREATE TABLE</code> è¯­å¥åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>price_logs</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> PriceLogs (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    productCode <span class="type">VARCHAR</span>(<span class="number">15</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> </span><br><span class="line">                        <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> </span><br><span class="line">            <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (productCode)</span><br><span class="line">        <span class="keyword">REFERENCES</span> products (productCode)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE </span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œå½“ <code>products</code> è¡¨çš„ <code>BEFORE UPDATE</code> äº‹ä»¶å‘ç”Ÿæ—¶æ¿€æ´»ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_products_update </span><br><span class="line">   BEFORE <span class="keyword">UPDATE</span> <span class="keyword">ON</span> products </span><br><span class="line">   <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     IF OLD.msrp <span class="operator">&lt;&gt;</span> NEW.msrp <span class="keyword">THEN</span></span><br><span class="line">         <span class="keyword">INSERT</span> <span class="keyword">INTO</span> PriceLOgs(product_code,price)</span><br><span class="line">         <span class="keyword">VALUES</span>(old.productCode,old.msrp);</span><br><span class="line">     <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œæ£€æŸ¥äº§å“ <code>S12_1099</code> çš„ä»·æ ¼ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    productCode, </span><br><span class="line">    msrp </span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    products</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    productCode <span class="operator">=</span> <span class="string">&#x27;S12_1099&#x27;</span>;</span><br></pre></td></tr></table></figure><br>å¹¶ä½¿ç”¨ä»¥ä¸‹ <code>UPDATE</code> è¯­å¥æ”¹å˜äº§å“çš„ä»·æ ¼ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> products</span><br><span class="line"><span class="keyword">SET</span> msrp <span class="operator">=</span> <span class="number">200</span></span><br><span class="line"><span class="keyword">WHERE</span> productCode <span class="operator">=</span> <span class="string">&#x27;S12_1099&#x27;</span>;</span><br></pre></td></tr></table></figure><br>ç¬¬å››ï¼Œä» <code>PriceLogs</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> PriceLogs;</span><br></pre></td></tr></table></figure></p><p>ä¸ºäº†å¤šè§¦å‘å™¨æ¼”ç¤ºçš„ç›®çš„ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„å•ç‹¬çš„è¡¨æ¥å­˜å‚¨è¿›è¡Œæ›´æ”¹çš„ç”¨æˆ·çš„æ•°æ®ã€‚<br>ç¬¬äº”ï¼Œåˆ›å»º <code>UserChangeLogs</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> UserChangeLogs (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    productCode <span class="type">VARCHAR</span>(<span class="number">15</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    updatedAt <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> </span><br><span class="line">        <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> </span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updatedBy <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (productCode)</span><br><span class="line">        <span class="keyword">REFERENCES</span> products (productCode)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE </span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬å…­ï¼Œä¸º <code>products</code> è¡¨åˆ›å»ºä¸€ä¸ª <code>BEFORE UPDATE</code> è§¦å‘å™¨ã€‚è¿™ä¸ªè§¦å‘å™¨åœ¨ <code>before_products_update</code> è§¦å‘å™¨ä¹‹åæ¿€æ´»ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_products_update_log_user</span><br><span class="line">   BEFORE <span class="keyword">UPDATE</span> <span class="keyword">ON</span> products </span><br><span class="line">   <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line">   FOLLOWS before_products_update</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF OLD.msrp <span class="operator">&lt;&gt;</span> NEW.msrp <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> </span><br><span class="line">            UserChangeLogs(productCode,updatedBy)</span><br><span class="line">        <span class="keyword">VALUES</span></span><br><span class="line">            (OLD.productCode,<span class="keyword">USER</span>());</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>ç¬¬ä¸ƒï¼Œä½¿ç”¨ä»¥ä¸‹ <code>UPDATE</code> è¯­å¥æ›´æ–°äº§å“çš„ä»·æ ¼ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> </span><br><span class="line">    products</span><br><span class="line"><span class="keyword">SET</span> </span><br><span class="line">    msrp <span class="operator">=</span> <span class="number">220</span></span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    productCode <span class="operator">=</span> <span class="string">&#x27;S12_1099&#x27;</span>;</span><br></pre></td></tr></table></figure><br>ç¬¬å…«ï¼Œä» <code>PriceLogs</code> å’Œ <code>UserChangeLogs</code> ä¸¤ä¸ªè¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> PriceLogs;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/1674d34a-ef66-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> UserChangeLogs;</span><br></pre></td></tr></table></figure><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/1e7de748-ef66-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"></p><p><strong>è§¦å‘é¡ºåºä¿¡æ¯</strong><br>å¦‚æœä½¿ç”¨ <code>SHOW TRIGGERS</code> è¯­å¥æ¥æ˜¾ç¤ºè§¦å‘å™¨ï¼Œä½ å°†çœ‹ä¸åˆ°è§¦å‘å™¨å¯¹åŒä¸€äº‹ä»¶å’ŒåŠ¨ä½œæ—¶é—´çš„æ¿€æ´»é¡ºåºã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">FROM</span> classicmodels</span><br><span class="line"><span class="keyword">WHERE</span> `<span class="keyword">table</span>` <span class="operator">=</span> <span class="string">&#x27;products&#x27;</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/3456a0dc-ef66-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="show triggers"></p><p>ä¸ºäº†æ‰¾åˆ°è¿™äº›ä¿¡æ¯ï¼Œä½ éœ€è¦åœ¨ <code>information_schema</code> æ•°æ®åº“çš„è§¦å‘å™¨è¡¨ä¸­æŸ¥è¯¢ <code>action_order</code> åˆ—ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    trigger_name, </span><br><span class="line">    action_order</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    information_schema.triggers</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    trigger_schema <span class="operator">=</span> <span class="string">&#x27;classicmodels&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> </span><br><span class="line">    event_object_table , </span><br><span class="line">    action_timing , </span><br><span class="line">    event_manipulation;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/531ff6bc-ef66-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="trigger_detail"></p><p><strong>Example</strong><br>LintCode éƒ¨é—¨æ–°è¿›äº†ä¸€æ‰¹ç§‘ç ”äººå‘˜ï¼Œä¸ºäº†ä¿æŠ¤ä»–ä»¬çš„äººèº«å®‰å…¨ï¼Œéœ€è¦åœ¨ <code>teachers</code> è¡¨ä¸­ï¼Œå°†ä»–ä»¬çš„ä¿¡æ¯åˆ é™¤ã€‚è¯·ç¼–å†™è§¦å‘å™¨ï¼Œå®ç°æ¯æ¬¡åˆ é™¤ <code>teachers</code> è¡¨ä¸­çš„ä¿¡æ¯æ—¶ï¼Œä¼šåœ¨ <code>teachers_bkp</code> ä¸­è®°å½•å…¶ä¿¡æ¯ã€‚éƒ¨åˆ†å¾·é«˜æœ›é‡çš„ç§‘ç ”äººå‘˜æ¸´æœ›åŠ å…¥ä¸­å›½ï¼ˆ<code>CN</code>ï¼‰å›½ç±ï¼Œè¯·ç¼–å†™è§¦å‘å™¨ï¼Œå®ç°è¯¥åŠŸèƒ½ã€‚<br>æˆ‘ä»¬éœ€è¦ç»™ <code>teachers</code> è¡¨æ·»åŠ ä¸¤ä¸ªæ–°çš„è§¦å‘å™¨ï¼Œå½“åˆ é™¤ä¸€æ¡æ•™å¸ˆæ•°æ®æ—¶ï¼š</p><ul><li>è§¦å‘å™¨ <code>bkp_teachers_delete</code>ï¼šå°†åˆ é™¤çš„æ•°æ®å¤‡ä»½åˆ°ç»“æ„ç›¸åŒçš„å¤‡ä»½è¡¨ <code>teachers_bkp</code> ä¸­ï¼›</li><li>è§¦å‘å™¨ <code>before_teachers_delete</code>ï¼šå°† <code>teachers_bkp</code> è¡¨ä¸­æœ€å¹´é•¿çš„æ•™å¸ˆå›½ç±æ”¹ä¸º â€˜CNâ€™ï¼›</li><li>è§¦å‘å™¨ <code>bkp_teachers_delete</code> éœ€åœ¨è§¦å‘å™¨ <code>before_teachers_delete</code> ä¹‹å‰æ‰§è¡Œã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> bkp_teachers_delete</span><br><span class="line">after <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> teachers <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">insert</span> <span class="keyword">into</span> teachers_bkp(name,email,age,country)</span><br><span class="line">Â  Â  Â <span class="keyword">values</span>(old.name,old.email,old.age,old.country);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> before_teachers_delete</span><br><span class="line">after <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> teachers <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line">follows bkp_teachers_delete</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> id1 <span class="type">int</span> ;</span><br><span class="line">Â  Â  Â <span class="comment">--å£°æ˜ç±»å‹</span></span><br><span class="line">Â  Â  Â <span class="keyword">select</span> id <span class="keyword">into</span> id1</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> teachers_bkp</span><br><span class="line">Â  Â  Â <span class="keyword">where</span> age<span class="operator">=</span>(<span class="keyword">select</span> <span class="built_in">max</span>(age) <span class="keyword">from</span> teachers_bkp <span class="keyword">where</span> country<span class="operator">!=</span><span class="string">&#x27;CN&#x27;</span>)</span><br><span class="line">Â  Â  Â limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â <span class="comment">--ä¸èƒ½selectå’ŒupdateåŒä¸€å¼ è¡¨ï¼Œæ‰€ä»¥è¦åˆ†å¼€selectå’Œupdateè¯­å¥</span></span><br><span class="line">Â  Â  Â <span class="keyword">update</span> teachers_bkp</span><br><span class="line">Â  Â  Â <span class="keyword">set</span> country<span class="operator">=</span><span class="string">&#x27;CN&#x27;</span></span><br><span class="line">Â  Â  Â <span class="keyword">where</span> id<span class="operator">=</span>id1;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure></li></ul><h2 id="å¦‚ä½•ä»MySQLçš„è§¦å‘å™¨ä¸­è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"><a href="#å¦‚ä½•ä»MySQLçš„è§¦å‘å™¨ä¸­è°ƒç”¨å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="å¦‚ä½•ä»MySQLçš„è§¦å‘å™¨ä¸­è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"></a>å¦‚ä½•ä»MySQLçš„è§¦å‘å™¨ä¸­è°ƒç”¨å­˜å‚¨è¿‡ç¨‹</h2><p>MySQL å…è®¸é€šè¿‡ä½¿ç”¨ <code>CALL</code> è¯­å¥ä»ä¸€ä¸ªè§¦å‘å™¨è°ƒç”¨ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ã€‚é€šè¿‡è¿™æ ·åšï¼Œä½ å¯ä»¥åœ¨å‡ ä¸ªè§¦å‘å™¨ä¸­é‡å¤ä½¿ç”¨åŒä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ã€‚<br>ç„¶è€Œï¼Œè§¦å‘å™¨ä¸èƒ½è°ƒç”¨æœ‰ <code>OUT</code> æˆ– <code>INOUT</code> å‚æ•°çš„å­˜å‚¨è¿‡ç¨‹ï¼Œæˆ–ä½¿ç”¨åŠ¨æ€ SQL çš„å­˜å‚¨è¿‡ç¨‹ã€‚</p><p><strong>Example</strong><br>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨ï¼Œç§°ä¸º <code>accounts</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> accounts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> accounts (</span><br><span class="line">    accountId <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    amount <span class="type">DECIMAL</span>(<span class="number">10</span> , <span class="number">2</span> ) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (accountId),</span><br><span class="line">    <span class="keyword">CHECK</span>(amount <span class="operator">&gt;=</span> <span class="number">0</span>) </span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œåœ¨ <code>accounts</code> è¡¨ä¸­æ’å…¥ä¸¤è¡Œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> accounts(name, amount)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;John Doe&#x27;</span>, <span class="number">1000</span>),</span><br><span class="line">    (<span class="string">&#x27;Jane Bush&#x27;</span>, <span class="number">500</span>);</span><br></pre></td></tr></table></figure><br>ç¬¬ä¸‰ï¼Œä» <code>accounts</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> accounts;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/67f8daee-ef67-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="accounts"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> Withdraw(</span><br><span class="line">    fromAccountId <span class="type">INT</span>, </span><br><span class="line">    withdrawAmount <span class="type">DEC</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF withdrawAmount <span class="operator">&lt;=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">        SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;45000&#x27;</span> </span><br><span class="line">            <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> <span class="string">&#x27;The withdrawal amount must be greater than zero&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">UPDATE</span> accounts </span><br><span class="line">    <span class="keyword">SET</span> amount <span class="operator">=</span> amount <span class="operator">-</span> withdrawAmount</span><br><span class="line">    <span class="keyword">WHERE</span> accountId <span class="operator">=</span> fromAccountId;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨æ­¤å­˜å‚¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå–æ¬¾é‡‘é¢å°äºæˆ–ç­‰äºé›¶ï¼Œå°±ä¼šå¼•å‘é”™è¯¯ã€‚ å¦åˆ™ï¼Œå®ƒå°†ä¼šæ›´æ–°è´¦æˆ·çš„é‡‘é¢ã€‚</p></blockquote><p><strong>åˆ›å»ºä¸€ä¸ªæ£€æŸ¥ææ¬¾çš„å­˜å‚¨è¿‡ç¨‹</strong><br>ä¸‹é¢çš„è¯­å¥åˆ›å»ºäº†ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œç”¨äºæ£€æŸ¥ä»ä¸€ä¸ªè´¦æˆ·ä¸­ææ¬¾çš„æƒ…å†µï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> CheckWithdrawal(</span><br><span class="line">    fromAccountId <span class="type">INT</span>,</span><br><span class="line">    withdrawAmount <span class="type">DEC</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> balance <span class="type">DEC</span>(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> withdrawableAmount <span class="type">DEC</span>(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> message <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- get current balance of the account</span></span><br><span class="line">    <span class="keyword">SELECT</span> amount </span><br><span class="line">    <span class="keyword">INTO</span> balance</span><br><span class="line">    <span class="keyword">FROM</span> accounts</span><br><span class="line">    <span class="keyword">WHERE</span> accountId <span class="operator">=</span> fromAccountId;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- Set minimum balance</span></span><br><span class="line">    <span class="keyword">SET</span> withdrawableAmount <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line">    IF withdrawAmount <span class="operator">&gt;</span> withdrawableAmount <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SET</span> message <span class="operator">=</span> CONCAT(<span class="string">&#x27;Insufficient amount, the maximum withdrawable is &#x27;</span>, withdrawableAmount);</span><br><span class="line">        SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;45000&#x27;</span> </span><br><span class="line">            <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> message;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªå­˜å‚¨è¿‡ç¨‹ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œè·å–è´¦æˆ·çš„å½“å‰ä½™é¢ã€‚</li><li>ç¬¬äºŒï¼Œè®¾ç½®å¯æå–é‡‘é¢ã€‚è´¦æˆ·çš„æœ€ä½ä½™é¢å¿…é¡»æ˜¯ 25ã€‚</li><li>ç¬¬ä¸‰ï¼Œå¦‚æœææ¬¾é‡‘é¢å¤§äºå¯ææ¬¾é‡‘é¢ï¼Œåˆ™å¼•å‘é”™è¯¯ã€‚</li></ul><p><strong>åˆ›å»ºä¸€ä¸ªè°ƒç”¨å­˜å‚¨è¿‡ç¨‹çš„è§¦å‘å™¨</strong><br>ä¸‹é¢çš„è¯­å¥åˆ›å»ºä¸€ä¸ª <code>BEFORE UPDATE</code> è§¦å‘å™¨ï¼Œè¯¥è§¦å‘å™¨è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ <code>CheckWithdrawal</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> before_accounts_update</span><br><span class="line">BEFORE <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> accounts <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">CALL</span> CheckWithdrawal (</span><br><span class="line">        OLD.accountId, </span><br><span class="line">        OLD.amount <span class="operator">-</span> NEW.amount</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br><strong>æµ‹è¯•äº¤æ˜“</strong><br>é¦–å…ˆï¼Œä»è´¦æˆ· id 1 ä¸­æå– 400ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> withdraw(<span class="number">1</span>, <span class="number">400</span>);</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œä» <code>accounts</code> è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> accounts</span><br><span class="line"><span class="keyword">WHERE</span> accountId <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/bef15632-ef67-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"><br>ç¬¬ä¸‰ï¼Œä»è´¦æˆ· id 1 ä¸­æå– 600ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> withdraw(<span class="number">1</span>, <span class="number">600</span>);</span><br></pre></td></tr></table></figure><br>å­˜å‚¨è¿‡ç¨‹ <code>Withdraw</code> æ‰§è¡Œä¸€ä¸ª <code>UPDATE</code> è¯­å¥ï¼Œè¯¥è¯­å¥è‡ªåŠ¨è°ƒç”¨è§¦å‘å™¨ <code>before_accounts_update</code>ã€‚<br><code>before_account_update</code> è§¦å‘å™¨ç„¶åè°ƒç”¨å­˜å‚¨è¿‡ç¨‹ <code>CheckWithdrawal</code> æ¥æ£€æŸ¥ææ¬¾ã€‚å®ƒå‘å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºææ¬¾é‡‘é¢å¯¼è‡´æœ€ä½ä½™é¢ä¸ºé›¶ï¼Œå°äº 25ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error Code: <span class="number">1644.</span> Insufficient amount, the maximum withdrawable <span class="keyword">is</span> <span class="number">575.00</span></span><br></pre></td></tr></table></figure><br>å››ã€ä»è´¦æˆ· id 1 æå– 575ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> withdraw(<span class="number">1</span>, <span class="number">575</span>);</span><br></pre></td></tr></table></figure><br>æœ€åï¼Œé€šè¿‡æŸ¥è¯¢ <code>accounts</code> è¡¨ä¸­çš„æ•°æ®æ¥éªŒè¯ææ¬¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> accounts</span><br><span class="line"><span class="keyword">WHERE</span> accountId <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/28/ee646d6e-ef67-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="outcome"></p><h2 id="MySQLæ˜¾ç¤ºè§¦å‘å™¨"><a href="#MySQLæ˜¾ç¤ºè§¦å‘å™¨" class="headerlink" title="MySQLæ˜¾ç¤ºè§¦å‘å™¨"></a>MySQLæ˜¾ç¤ºè§¦å‘å™¨</h2><p><strong>Grammar</strong><br><code>SHOW TRIGGERS</code> è¯­å¥æ˜¾ç¤ºæ‰€æœ‰çš„è§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS</span><br><span class="line">[&#123;<span class="keyword">FROM</span> <span class="operator">|</span> <span class="keyword">IN</span>&#125; database_name]</span><br><span class="line">[<span class="keyword">LIKE</span> <span class="string">&#x27;pattern&#x27;</span> <span class="operator">|</span> <span class="keyword">WHERE</span> search_condition];</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼Œå¦‚æœä¸ä½¿ç”¨æœ€åä¸¤ä¸ªå­å¥ï¼Œ<code>SHOW TRIGGERS</code> ä¼šè¿”å›æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è§¦å‘å™¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br></pre></td></tr></table></figure><br>è¦æ˜¾ç¤ºä¸€ä¸ªç‰¹å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è§¦å‘å™¨ï¼Œéœ€è¦åœ¨ <code>FROM</code> æˆ– <code>IN</code> å…³é”®å­—åé¢æŒ‡å®šæ•°æ®åº“åç§°ï¼Œåƒè¿™æ ·ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">FROM</span> database_name;</span><br><span class="line"><span class="comment">-- OR --</span></span><br><span class="line"><span class="keyword">SHOW</span> TRIGGERS</span><br><span class="line"><span class="keyword">IN</span> database_name;</span><br></pre></td></tr></table></figure><br>ä¸ºäº†æ ¹æ®æ¨¡å¼æŸ¥æ‰¾è§¦å‘å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>LIKE</code> å­å¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">LIKE</span> <span class="string">&#x27;pattern&#x27;</span>;</span><br><span class="line"><span class="comment">-- OR --</span></span><br><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">FROM</span> database_name</span><br><span class="line"><span class="keyword">LIKE</span> <span class="string">&#x27;pattern&#x27;</span>;</span><br></pre></td></tr></table></figure><br><code>LIKE</code> å­å¥çš„å«ä¹‰ä¸ <code>SELECT</code> è¯­å¥ä¸­çš„ç›¸åŒã€‚<br>ä¸ºäº†æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è§¦å‘å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>WHERE</code> å­å¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">WHERE</span> search_condition;</span><br><span class="line"><span class="comment">-- OR --</span></span><br><span class="line"><span class="keyword">SHOW</span> TRIGGERS </span><br><span class="line"><span class="keyword">FROM</span> database_name</span><br><span class="line"><span class="keyword">WHERE</span> search_condition;</span><br></pre></td></tr></table></figure><br><code>SHOW TRIGGERS</code> è¯­å¥è¿”å›ä¸€ä¸ªç»“æœé›†ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ åˆ—ï¼š</p><ul><li>trigger: è§¦å‘å™¨çš„åç§°</li><li>event: è°ƒç”¨è§¦å‘å™¨çš„äº‹ä»¶ï¼Œä¾‹å¦‚ INSERTã€UPDATE æˆ– DELETE</li><li>table: è§¦å‘å™¨æ‰€å±çš„è¡¨</li><li>statement: è§¦å‘å™¨çš„ä¸»ä½“</li><li>timing: è§¦å‘å™¨çš„æ¿€æ´»æ—¶é—´ï¼Œå¯ä»¥æ˜¯ BEFORE æˆ– AFTER</li><li>created: è§¦å‘å™¨çš„åˆ›å»ºæ—¶é—´</li><li>sql_mode: è§¦å‘å™¨æ‰§è¡Œæ—¶çš„ SQL_MODE</li><li>definer: åˆ›å»ºè§¦å‘å™¨çš„ç”¨æˆ·è´¦æˆ·</li><li>character_set_client</li><li>collation_connection</li><li>database collation<blockquote><p>æ³¨æ„ï¼Œè¦æ‰§è¡Œ <code>SHOW TRIGGERS</code> è¯­å¥ï¼Œä½ éœ€è¦æœ‰ <code>SUPER</code> æƒé™ã€‚</p></blockquote></li></ul><p><strong>Example</strong><br>ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ <code>SHOW TRIGGERS</code> è¯­å¥æ¥è·å–å½“å‰ MySQL æœåŠ¡å™¨ä¸­æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰è§¦å‘å™¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS;</span><br></pre></td></tr></table></figure><br>ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºäº† <code>classicmodels</code> æ•°æ®åº“ä¸­çš„æ‰€æœ‰è§¦å‘å™¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS</span><br><span class="line"><span class="keyword">FROM</span> classicmodels;</span><br></pre></td></tr></table></figure><br>ä¸‹é¢çš„è¯­å¥æ˜¾ç¤ºäº†ä¸ <code>employees</code> è¡¨ç›¸å…³çš„æ‰€æœ‰è§¦å‘å™¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS</span><br><span class="line"><span class="keyword">FROM</span> classicmodels</span><br><span class="line"><span class="keyword">WHERE</span> `<span class="keyword">table</span>` <span class="operator">=</span> <span class="string">&#x27;employees&#x27;</span>;</span><br></pre></td></tr></table></figure><br><strong>æ€»ç»“</strong><br>ä½¿ç”¨ <code>SHOW TRIGGERS</code> è¯­å¥æ¥è·å¾—æ‰€æœ‰çš„è§¦å‘å™¨<br>ä½¿ç”¨ <code>SHOW TRIGGERS FROM &#39;database&#39;</code> è¯­å¥æ¥è·å–æ•°æ®åº“ä¸­çš„æ‰€æœ‰è§¦å‘å™¨ã€‚<br>ä½¿ç”¨ <code>SHOW TRIGGERS FROM &#39;database&#39; WHERE table = &#39;name&#39;</code> æ¥è·å¾—ä¸ä¸€ä¸ªè¡¨ç›¸å…³çš„æ‰€æœ‰è§¦å‘å™¨ã€‚</p><h1 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h1><h2 id="è§†å›¾ç®€ä»‹"><a href="#è§†å›¾ç®€ä»‹" class="headerlink" title="è§†å›¾ç®€ä»‹"></a>è§†å›¾ç®€ä»‹</h2><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> courses.name <span class="keyword">AS</span> name, created_at, teachers.name <span class="keyword">AS</span> teacher</span><br><span class="line"><span class="keyword">FROM</span> courses</span><br><span class="line">   <span class="keyword">INNER</span> <span class="keyword">JOIN</span> teachers <span class="keyword">ON</span> courses.teacher_id <span class="operator">=</span> teachers.id;</span><br></pre></td></tr></table></figure><br>è¿è¡Œåçš„è¾“å‡ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> courses.name <span class="keyword">AS</span> name, created_at, teachers.name <span class="keyword">AS</span> teacher</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> courses</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> teachers <span class="keyword">ON</span> courses.teacher_id <span class="operator">=</span> teachers.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> name                    <span class="operator">|</span> created_at <span class="operator">|</span> teacher          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> Advanced Algorithms     <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Django                  <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Web                     <span class="operator">|</span> <span class="number">2020</span><span class="number">-04</span><span class="number">-22</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Big Data                <span class="operator">|</span> <span class="number">2020</span><span class="number">-09</span><span class="number">-11</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Artificial Intelligence <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Data Analysis           <span class="operator">|</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-12</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Object Oriented Design  <span class="operator">|</span> <span class="number">2020</span><span class="number">-08</span><span class="number">-08</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming     <span class="operator">|</span> <span class="number">2018</span><span class="number">-08</span><span class="number">-18</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>ä¸‹ä¸€æ¬¡ï¼Œå¦‚æœè¿˜æƒ³è·å¾—ç›¸åŒçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¾ç¨‹åç§°ã€è¯¾ç¨‹åˆ›å»ºæ—¥æœŸå’Œè®²å¸ˆå§“åï¼Œåˆ™éœ€è¦å†æ¬¡å‘å‡ºç›¸åŒçš„æŸ¥è¯¢ã€‚<br>ä¸€ç§æ–¹æ³•æ˜¯å°†æŸ¥è¯¢ä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¯ä»¥æ˜¯ .txt æˆ– .sql æ–‡ä»¶ï¼Œä»¥ä¾¿ç¨åå¯ä»¥ä» MySQL Workbench æˆ–ä»»ä½•å…¶ä»– MySQL å®¢æˆ·ç«¯å·¥å…·æ‰“å¼€å’Œæ‰§è¡Œå®ƒã€‚<br>ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯å°†æŸ¥è¯¢ä¿å­˜åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸­ï¼Œå¹¶ä¸ºå…¶æŒ‡å®šä¸€ä¸ªåç§°ã€‚è¿™ç§å‘½åçš„æŸ¥è¯¢è¢«ç§°ä¸ºæ•°æ®åº“è§†å›¾ï¼Œæˆ–è€…ç®€å•åœ°è¯´ï¼šè§†å›¾ã€‚<br>æ ¹æ®å®šä¹‰ï¼Œè§†å›¾æ˜¯ä¸€ä¸ªå­˜å‚¨åœ¨æ•°æ®åº“ç›®å½•ä¸­çš„å‘½åæŸ¥è¯¢ã€‚<br>è¦åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾ï¼Œéœ€è¦ä½¿ç”¨ CREATE VIEW è¯­å¥ã€‚è¯¥è¯­å¥åœ¨ä¸Šè¿°æŸ¥è¯¢çš„åŸºç¡€ä¸Šåˆ›å»ºäº†ä¸€ä¸ªè§†å›¾ <code>v_courses_teachers</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_courses_teachers</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> courses.name <span class="keyword">AS</span> name, created_at, teachers.name <span class="keyword">AS</span> teacher</span><br><span class="line"><span class="keyword">FROM</span> courses</span><br><span class="line">   <span class="keyword">INNER</span> <span class="keyword">JOIN</span> teachers <span class="keyword">ON</span> courses.teacher_id <span class="operator">=</span> teachers.id;</span><br></pre></td></tr></table></figure><br>è¿è¡Œåè¾“å‡ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_courses_teachers</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AS</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> courses.name <span class="keyword">AS</span> name, created_at, teachers.name <span class="keyword">AS</span> teacher</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> courses</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> teachers <span class="keyword">ON</span> courses.teacher_id <span class="operator">=</span> teachers.id;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><br>ä¸€æ—¦ä½ æ‰§è¡Œäº† CREATE VIEW è¯­å¥ï¼ŒMySQL å°±ä¼šåˆ›å»ºè§†å›¾å¹¶å°†å…¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚<br>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨ SQL è¯­å¥ä¸­æŠŠè¯¥è§†å›¾ä½œä¸ºè¡¨æ¥å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ SELECT è¯­å¥æŸ¥è¯¢ <code>v_courses_teachers</code> è§†å›¾çš„æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_courses_teachers;</span><br></pre></td></tr></table></figure><br>è¿è¡Œåçš„è¾“å‡ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_courses_teachers;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> name                    <span class="operator">|</span> created_at <span class="operator">|</span> teacher          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> Advanced Algorithms     <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Django                  <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Web                     <span class="operator">|</span> <span class="number">2020</span><span class="number">-04</span><span class="number">-22</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Big Data                <span class="operator">|</span> <span class="number">2020</span><span class="number">-09</span><span class="number">-11</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Artificial Intelligence <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Data Analysis           <span class="operator">|</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-12</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Object Oriented Design  <span class="operator">|</span> <span class="number">2020</span><span class="number">-08</span><span class="number">-08</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming     <span class="operator">|</span> <span class="number">2018</span><span class="number">-08</span><span class="number">-18</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+------------+------------------+</span></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><br>è§†å›¾å¹¶ä¸å®é™…å­˜å‚¨æ•°æ®ã€‚å½“ä½ å¯¹è§†å›¾å‘å‡º SELECT è¯­å¥æ—¶ï¼ŒMySQL ä¼šæ‰§è¡Œè§†å›¾å®šä¹‰ä¸­æŒ‡å®šçš„åŸºç¡€æŸ¥è¯¢ï¼Œå¹¶è¿”å›ç»“æœé›†ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œæœ‰æ—¶ï¼Œè§†å›¾è¢«ç§°ä¸ºè™šæ‹Ÿè¡¨ã€‚<br><code>MySQL å…è®¸ä»ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­æ£€ç´¢æ•°æ®çš„ SELECT è¯­å¥åˆ›å»ºä¸€ä¸ªè§†å›¾</code>ã€‚è¿™å¼ å›¾ç‰‡è¯´æ˜äº†ä¸€ä¸ªåŸºäºå¤šä¸ªè¡¨çš„åˆ—çš„è§†å›¾ã€‚<br><strong>Example</strong><br>åˆ›å»ºä¸€ä¸ªåä¸º <code>v_week</code> çš„è§†å›¾ï¼Œé€šè¿‡æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢è¿”å›ä¸€å‘¨çš„ 7 å¤©ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_week(<span class="keyword">day</span>) <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Mon&#x27;</span> </span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Tue&#x27;</span></span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Web&#x27;</span></span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Thu&#x27;</span></span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Fri&#x27;</span></span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Sat&#x27;</span></span><br><span class="line">    <span class="keyword">UNION</span> </span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;Sun&#x27;</span>;</span><br></pre></td></tr></table></figure><br><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_week;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">day</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="operator">|</span> Mon <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tue <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Web <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Thu <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Fri <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Sat <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Sun <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="MySQL-è§†å›¾çš„ä¼˜åŠ¿"><a href="#MySQL-è§†å›¾çš„ä¼˜åŠ¿" class="headerlink" title="MySQL è§†å›¾çš„ä¼˜åŠ¿"></a>MySQL è§†å›¾çš„ä¼˜åŠ¿</h3><ul><li>ç®€åŒ–å¤æ‚çš„æŸ¥è¯¢<br>è§†å›¾æœ‰åŠ©äºç®€åŒ–å¤æ‚çš„æŸ¥è¯¢ã€‚å¦‚æœä½ æœ‰ä»»ä½•<code>ç»å¸¸ä½¿ç”¨çš„å¤æ‚æŸ¥è¯¢</code>ï¼Œä½ å¯ä»¥<code>åŸºäºå®ƒåˆ›å»ºä¸€ä¸ªè§†å›¾</code>ï¼Œè¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ SELECT è¯­å¥æ¥å¼•ç”¨è¯¥è§†å›¾ï¼Œè€Œä¸æ˜¯é‡æ–°è¾“å…¥æŸ¥è¯¢å†…å®¹ã€‚</li><li>ä½¿é€»è¾‘ä¸šåŠ¡ä¸€è‡´<br>å‡è®¾ä½ ä¸å¾—ä¸åœ¨æ¯ä¸ªæŸ¥è¯¢ä¸­é‡å¤å†™ç›¸åŒçš„å…¬å¼ã€‚æˆ–è€…ä½ æœ‰ä¸€ä¸ªå…·æœ‰å¤æ‚ä¸šåŠ¡é€»è¾‘çš„æŸ¥è¯¢ã€‚ä¸ºäº†ä½¿è¿™ç§<code>é€»è¾‘åœ¨ä¸åŒçš„æŸ¥è¯¢ä¸­ä¿æŒä¸€è‡´ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè§†å›¾æ¥å­˜å‚¨è®¡ç®—ç»“æœï¼Œå¹¶éšè—å…¶å¤æ‚æ€§</code>ã€‚</li><li><strong>å¢åŠ é¢å¤–çš„å®‰å…¨å±‚</strong><br>ä¸€ä¸ªè¡¨å¯èƒ½ä¼šæš´éœ²å‡ºå¾ˆå¤šæ•°æ®ï¼ŒåŒ…æ‹¬æ•æ„Ÿæ•°æ®ï¼Œå¦‚ä¸ªäººå’Œé“¶è¡Œä¿¡æ¯ã€‚<br>é€šè¿‡<code>ä½¿ç”¨è§†å›¾å’Œæƒé™ï¼Œä½ å¯ä»¥é™åˆ¶ç”¨æˆ·å¯ä»¥è®¿é—®å“ªäº›æ•°æ®ï¼Œåªå‘ä»–ä»¬æš´éœ²å¿…è¦çš„æ•°æ®</code>ã€‚<br>ä¾‹å¦‚ï¼Œè¡¨ employees å¯èƒ½åŒ…å« SSN å’Œåœ°å€ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åº”è¯¥åªç”±äººåŠ›èµ„æºéƒ¨é—¨è®¿é—®ã€‚<br>å¦‚æœè¦å°†ä¸€èˆ¬ä¿¡æ¯ï¼Œå¦‚åå­—ã€å§“æ°å’Œæ€§åˆ«æš´éœ²ç»™æ€»åŠ¡éƒ¨é—¨ï¼Œä½ å¯ä»¥åŸºäºè¿™äº›åˆ—åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œå¹¶æˆäºˆæ€»åŠ¡éƒ¨é—¨çš„ç”¨æˆ·è®¿é—®è¯¥è§†å›¾ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¡¨ employeesã€‚</li><li>å®ç°å‘åå…¼å®¹<br>åœ¨é—ç•™ç³»ç»Ÿä¸­ï¼Œè§†å›¾å¯ä»¥å®ç°å‘åå…¼å®¹ã€‚<br>å‡è®¾ï¼Œä½ æƒ³æŠŠä¸€ä¸ªå¤§è¡¨è§„èŒƒåŒ–ä¸ºè®¸å¤šå°è¡¨ã€‚è€Œä¸”ä½ ä¸æƒ³å½±å“å½“å‰å¼•ç”¨è¯¥è¡¨çš„åº”ç”¨ç¨‹åºã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åœ¨æ–°è¡¨çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªåç§°ä¸è¡¨ç›¸åŒçš„è§†å›¾ï¼Œè¿™æ ·æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥åƒå¼•ç”¨è¡¨ä¸€æ ·å¼•ç”¨è¯¥è§†å›¾ã€‚<blockquote><p>æ³¨æ„ï¼Œè§†å›¾å’Œè¡¨ä¸èƒ½æœ‰ç›¸åŒçš„åå­—ï¼Œæ‰€ä»¥ä½ éœ€è¦å…ˆåˆ é™¤è¡¨ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªä¸è¢«åˆ é™¤çš„è¡¨åå­—ç›¸åŒçš„è§†å›¾ã€‚</p></blockquote></li></ul><h2 id="åˆ›å»ºè§†å›¾"><a href="#åˆ›å»ºè§†å›¾" class="headerlink" title="åˆ›å»ºè§†å›¾"></a>åˆ›å»ºè§†å›¾</h2><h3 id="MySQL-CREATE-VIEW-è¯­å¥"><a href="#MySQL-CREATE-VIEW-è¯­å¥" class="headerlink" title="MySQL CREATE VIEW è¯­å¥"></a>MySQL CREATE VIEW è¯­å¥</h3><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">VIEW</span> [db_name.]view_name [(column_list)]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  <span class="keyword">select</span><span class="operator">-</span>statement;</span><br></pre></td></tr></table></figure><br>é¦–å…ˆï¼Œåœ¨ CREATE VIEW å…³é”®å­—åæŒ‡å®šè¦åˆ›å»ºçš„è§†å›¾çš„åç§°ã€‚</p><blockquote><p>è§†å›¾çš„åç§°åœ¨æ•°æ®åº“ä¸­æ˜¯<strong>å”¯ä¸€çš„</strong>ã€‚å› ä¸ºåŒä¸€æ•°æ®åº“ä¸­çš„è§†å›¾å’Œè¡¨å…±äº«åŒä¸€ä¸ªå‘½åç©ºé—´ï¼Œæ‰€ä»¥<code>è§†å›¾çš„åç§°ä¸èƒ½ä¸ç°æœ‰è¡¨çš„åç§°ç›¸åŒ</code>ã€‚</p></blockquote><p>ç¬¬äºŒï¼Œå¦‚æœä½ æƒ³æ›¿æ¢ä¸€ä¸ªå·²ç»å­˜åœ¨çš„è§†å›¾ï¼Œè¯·ä½¿ç”¨ OR REPLACE é€‰é¡¹ã€‚å¦‚æœè¯¥è§†å›¾ä¸å­˜åœ¨ï¼ŒOR REPLACE æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚<br>ç¬¬ä¸‰ï¼Œä¸ºè§†å›¾æŒ‡å®šä¸€ä¸ªåˆ—çš„åˆ—è¡¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè§†å›¾çš„åˆ—æ¥è‡ª SELECT è¯­å¥çš„é€‰æ‹©åˆ—è¡¨ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨è§†å›¾åç§°åé¢çš„æ‹¬å·ä¸­åˆ—å‡ºåˆ—ï¼Œæ˜ç¡®æŒ‡å®šè§†å›¾çš„åˆ—åˆ—è¡¨ã€‚<br>æœ€åï¼ŒæŒ‡å®šä¸€ä¸ªå®šä¹‰è¯¥è§†å›¾çš„ SELECT è¯­å¥ã€‚SELECT è¯­å¥å¯ä»¥ä»è¡¨æˆ–è§†å›¾ä¸­æŸ¥è¯¢æ•°æ®ã€‚MySQL å…è®¸ä½ åœ¨ SELECT è¯­å¥ä¸­ä½¿ç”¨ ORDER BY å­å¥ï¼Œä½†å¦‚æœä½ æ‹¥æœ‰è‡ªå·±çš„ ORDER BY å­å¥çš„æŸ¥è¯¢ä»è§†å›¾ä¸­é€‰æ‹©ï¼Œåˆ™å¿½ç•¥å®ƒã€‚</p><p><strong>Example</strong><br><strong>1. åˆ›å»ºä¸€ä¸ªç®€å•çš„è§†å›¾</strong><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/7c668958-e51d-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="orderDetails"><br>è¯¥è¯­å¥ä½¿ç”¨ <code>CREATE VIEW</code> è¯­å¥æ¥åˆ›å»ºè¡¨ç¤ºæ¯ä¸ªè®¢å•çš„æ€»é”€å”®é¢çš„è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> salePerOrder <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        orderNumber, </span><br><span class="line">        <span class="built_in">SUM</span>(quantityOrdered <span class="operator">*</span> priceEach) total</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        orderDetails</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">by</span> orderNumber</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> total <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><br>å¦‚æœæ‚¨ä½¿ç”¨ <code>SHOW TABLE</code> å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰è¡¨ <code>classicmodels</code> æ•°æ®åº“ï¼Œæ‚¨å°†çœ‹åˆ°è§†å›¾ <code>salesPerOrder</code> æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/a0c2c474-e51d-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="show tables"><br>è¿™æ˜¯å› ä¸ºè§†å›¾å’Œè¡¨å…±äº«ä¸å‰é¢æåˆ°çš„ç›¸åŒçš„å‘½åç©ºé—´ã€‚<br>è¦çŸ¥é“å“ªä¸ªå¯¹è±¡æ˜¯è§†å›¾æˆ–è¡¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>SHOW FULL TABLES;</code> å‘½ä»¤å¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/b9f5949e-e51d-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="show full tables"><br>è¿™ <code>table_type</code> ç»“æœé›†ä¸­çš„åˆ—æŒ‡å®šå¯¹è±¡çš„ç±»å‹ï¼šè§†å›¾æˆ–è¡¨ï¼ˆåŸºè¡¨ï¼‰ã€‚</p><p><strong>2. åŸºäºä¸€ä¸ªè§†å›¾åˆ›å»ºè§†å›¾</strong><br>MySQL å…è®¸æ‚¨åŸºäºå¦ä¸€ä¸ªè§†å›¾æ¥åˆ›å»ºè§†å›¾ã€‚<br>ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º <code>bigSalesOrder</code> çš„è§†å›¾åŸºäº <code>salesPerOrder</code>ï¼ŒæŸ¥çœ‹ä»¥æ˜¾ç¤ºæ€»è®¡å¤§äº <code>60000</code> çš„æ¯ä¸ªé”€å”®è®¢å•å¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> bigSalesOrder <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        orderNumber, </span><br><span class="line">        ROUND(total,<span class="number">2</span>) <span class="keyword">as</span> total</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        salePerOrder</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        total <span class="operator">&gt;</span> <span class="number">60000</span>;</span><br></pre></td></tr></table></figure><br>ç°åœ¨ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢ <code>bigSalesOrder</code> è§†å›¾å¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    orderNumber, </span><br><span class="line">    total</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    bigSalesOrder;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/139fd5ae-e51e-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="show table"></p><p><strong>3. ä½¿ç”¨è¿æ¥åˆ›å»ºè§†å›¾</strong><br>è¿˜å¯ä»¥ä½¿ç”¨ <code>CREATE VIEW</code> è¯­å¥æ¥åˆ›å»ºåŸºäºå¤šä¸ªè¡¨çš„è§†å›¾çš„è¯­å¥ã€‚ å®ƒä½¿ç”¨ <code>INNER JOIN</code> è¿æ¥è¡¨çš„å­å¥ã€‚<br><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> customerOrders <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    orderNumber,</span><br><span class="line">    customerName,</span><br><span class="line">    <span class="built_in">SUM</span>(quantityOrdered <span class="operator">*</span> priceEach) total</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    orderDetails</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders o <span class="keyword">USING</span> (orderNumber)</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> customers <span class="keyword">USING</span> (customerNumber)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> orderNumber;</span><br></pre></td></tr></table></figure><br>è¯¥è¯­å¥ä» <code>customerOrders</code> è§†å›¾ä¸­é€‰æ‹©æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customerOrders </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> total <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><br><strong>Result</strong><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/32dc78f0-e51e-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="éƒ¨åˆ†è¾“å‡º"></p><p><strong>4. ä½¿ç”¨å­æŸ¥è¯¢åˆ›å»ºè§†å›¾</strong><br>ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ <code>CREATE VIEW</code> è¯­å¥æ¥åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œå…¶ SELECT è¯­å¥ä½¿ç”¨å­æŸ¥è¯¢ã€‚è¯¥è§†å›¾åŒ…å«ä¹°å…¥ä»·æ ¼é«˜äºæ‰€æœ‰äº§å“å¹³å‡ä»·æ ¼çš„äº§å“ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> aboveAvgProducts <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        productCode, </span><br><span class="line">        productName, </span><br><span class="line">        buyPrice</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        products</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        buyPrice <span class="operator">&gt;</span> (</span><br><span class="line">            <span class="keyword">SELECT</span> </span><br><span class="line">                <span class="built_in">AVG</span>(buyPrice)</span><br><span class="line">            <span class="keyword">FROM</span></span><br><span class="line">                products)</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> buyPrice <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šè¿° <code>aboveAvgProducts</code> ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> aboveAvgProducts;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/57556e9e-e51e-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="éƒ¨åˆ†ç»“æœ"></p><p><strong>5. ä½¿ç”¨æ˜¾å¼è§†å›¾åˆ—åˆ›å»ºè§†å›¾</strong><br>è¿™ä¸ªè¯­å¥ä½¿ç”¨ <code>CREATE VIEW</code> è¯­å¥åœ¨ <code>customers</code> å’Œ <code>orders</code> è¡¨çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾ï¼Œå¹¶å¸¦æœ‰æ˜ç¡®çš„è§†å›¾åˆ—ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customerOrderStats (</span><br><span class="line">   customerName, </span><br><span class="line">   orderCount</span><br><span class="line">) </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        customerName, </span><br><span class="line">        <span class="built_in">COUNT</span>(orderNumber)</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        customers</span><br><span class="line">            <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">        orders <span class="keyword">USING</span> (customerNumber)</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> customerName;</span><br></pre></td></tr></table></figure><br>è¯¥æŸ¥è¯¢è¿”å› <code>customerOrderStats</code> è§†å›¾ä¸­çš„æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    customerName,</span><br><span class="line">    orderCount</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    customerOrderStats</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> </span><br><span class="line">    orderCount, </span><br><span class="line">    customerName;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/7a317ff2-e51e-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="æ˜¾å¼è§†å›¾"></p><p><strong>Example</strong><br>æè¿°<br>å¼ ä¸‰æœ€è¿‘å¯¹ <code>MySQL</code> æ•°æ®åº“æ„Ÿå…´è¶£ï¼Œå†³å®šè¦å¥½å¥½å­¦ä¹ æ•°æ®åº“ï¼Œä½†â€¦å­¦ä¹ çš„é“è·¯æ€»æ˜¯å……æ»¡è‰°è¾›çš„ã€‚å¼ ä¸‰ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼Œä»–å·¦æ€å³æƒ³ã€è‹¦æ€å†¥æƒ³ã€èŒ¶ä¸æ€é¥­ä¸æƒ³ä¹Ÿæ²¡èƒ½æƒ³å‡ºè§£å†³åŠæ³•ã€‚æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œç°æœ‰ <code>teachers</code> è¡¨ä¸­è®°å½•ç€ç¦»èŒçš„æ•™å¸ˆä¿¡æ¯ï¼Œ<code>id</code> çš„å€¼å³æ˜¯æ•™å¸ˆç¦»èŒçš„é¡ºåºï¼Œåœ¨ <code>courses</code> è¡¨ä¸­è®°å½•ç€æ¯ä¸ªæ•™å¸ˆæ•™æˆçš„è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” id ä¸º <code>teacher_id</code>ã€‚<strong>ç°åœ¨çŸ¥é“æ•™å¸ˆæ˜¯ä»¥å›½ç±æ¥åˆ†å›¢é˜Ÿçš„ï¼Œä¸”æ¯ä¸ªå›¢é˜Ÿçš„æˆç«‹è‡³å°‘æœ‰ <code>3</code> ä¸ªæ•™å¸ˆï¼Œè‹¥æ˜¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒï¼Œåˆ™åœ¨ <code>teachers</code> è¡¨ä¸­ä¿¡æ¯è®°å½•ä¸ºè¿ç»­ä¸”å›½ç±ç›¸åŒï¼Œç°åœ¨éœ€è¦ç»Ÿè®¡æ¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒä¼šæœ‰å¤šå°‘å­¦ç”Ÿéœ€è¦ç­‰å¾…æ–°çš„æ•™å¸ˆï¼Œç»“æœæŒ‰å›¢é˜Ÿå›½ç±æ’åº</strong>ã€‚ä»–éœ€è¦åˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v_courses_teachers</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒå­¦ä»¬å¿«æ¥å¸®å¸®å¼ ä¸‰å°ä¼™å­å§ ~<br><a href="https://www.lintcode.com/learn/130/664">resource</a><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_courses_teachers <span class="keyword">as</span> (</span><br><span class="line">Â  Â  <span class="keyword">select</span> tt.country,<span class="built_in">sum</span>(tt.student_count) student_count</span><br><span class="line">Â  Â  <span class="keyword">from</span> (</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">select</span> <span class="keyword">distinct</span> t1.id,t1.country,c.student_count</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">from</span> teachers t1 <span class="keyword">left</span> <span class="keyword">join</span> teachers t2</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">on</span> t1.id<span class="operator">=</span>t2.id<span class="number">-1</span> <span class="keyword">or</span> t1.id<span class="operator">=</span>t2.id<span class="operator">+</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> courses c <span class="keyword">on</span> t1.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">where</span> t1.country<span class="operator">=</span>t2.country</span><br><span class="line">Â  Â  ) tt</span><br><span class="line">Â  Â  <span class="keyword">group</span> <span class="keyword">by</span> tt.country</span><br><span class="line">Â  Â  <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><h2 id="è§†å›¾å¤„ç†"><a href="#è§†å›¾å¤„ç†" class="headerlink" title="è§†å›¾å¤„ç†"></a>è§†å›¾å¤„ç†</h2><h3 id="è§†å›¾å¤„ç†ç®—æ³•"><a href="#è§†å›¾å¤„ç†ç®—æ³•" class="headerlink" title="è§†å›¾å¤„ç†ç®—æ³•"></a>è§†å›¾å¤„ç†ç®—æ³•</h3><p><code>CREATE VIEW</code> å’Œ <code>ALTER VIEW</code> è¯­å¥æœ‰ä¸€ä¸ªå¯é€‰çš„å­å¥ï¼š<code>ALGORITHM</code>ã€‚<br>å®ƒå†³å®šäº† MySQL å¦‚ä½•å¤„ç†ä¸€ä¸ªè§†å›¾ï¼Œå¯ä»¥å–ä¸‰ä¸ªå€¼ä¹‹ä¸€ï¼š<code>MERGE</code>ã€<code>TEMPTABLE</code> å’Œ <code>UNDEFINE</code>ã€‚</p><p><strong>Gammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE][ALGORITHM <span class="operator">=</span> &#123;<span class="keyword">MERGE</span> <span class="operator">|</span> TEMPTABLE <span class="operator">|</span> UNDEFINED&#125;] <span class="keyword">VIEW</span> </span><br><span class="line">   view_name[(column_list)]</span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line">   <span class="keyword">select</span><span class="operator">-</span>statement;</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [ALGORITHM <span class="operator">=</span> &#123;<span class="keyword">MERGE</span> <span class="operator">|</span> TEMPTABLE <span class="operator">|</span> UNDEFINED&#125;] <span class="keyword">VIEW</span> </span><br><span class="line">   view_name[(column_list)] </span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line">   <span class="keyword">select</span><span class="operator">-</span>statement;</span><br></pre></td></tr></table></figure><h4 id="MERGE"><a href="#MERGE" class="headerlink" title="MERGE"></a>MERGE</h4><p>å½“ä½ ä» MERGE è§†å›¾æŸ¥è¯¢æ—¶ï¼ŒMySQL å¤„ç†ä»¥ä¸‹æ­¥éª¤ã€‚</p><ul><li>é¦–å…ˆï¼Œå°†è¾“å…¥æŸ¥è¯¢ä¸è§†å›¾å®šä¹‰ä¸­çš„ SELECT è¯­å¥åˆå¹¶ä¸ºä¸€ä¸ªå•ä¸€çš„æŸ¥è¯¢ã€‚</li><li>ç„¶åï¼Œæ‰§è¡Œåˆå¹¶åçš„æŸ¥è¯¢ä»¥è¿”å›ç»“æœé›†ã€‚<blockquote><p>æ³¨æ„ï¼Œå°†è¾“å…¥æŸ¥è¯¢å’Œè§†å›¾å®šä¹‰çš„ SELECT è¯­å¥åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„æŸ¥è¯¢è¢«ç§°ä¸º<strong>è§†å›¾è§£æ</strong>ã€‚</p></blockquote></li></ul><p><strong>Example</strong><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/c0649378-e51f-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="cumstomers"></p><p>ä¸‹é¢çš„ SQL è¯­å¥ä»¥ <code>customers</code> è¡¨ä¸ºåŸºç¡€ï¼Œç”¨ <code>MERGE</code> ç®—æ³•åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>contactPersons</code> çš„è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ALGORITHM<span class="operator">=</span><span class="keyword">MERGE</span> <span class="keyword">VIEW</span> contactPersons(</span><br><span class="line">    customerName, </span><br><span class="line">    firstName, </span><br><span class="line">    lastName, </span><br><span class="line">    phone</span><br><span class="line">) <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    customerName, </span><br><span class="line">    contactFirstName, </span><br><span class="line">    contactLastName, </span><br><span class="line">    phone</span><br><span class="line"><span class="keyword">FROM</span> customers;</span><br></pre></td></tr></table></figure><br>å¦‚æœä½ ä½¿ç”¨ä»¥ä¸‹ SQL è¯­å¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> contactPersons</span><br><span class="line"><span class="keyword">WHERE</span> customerName <span class="keyword">LIKE</span> <span class="string">&#x27;%Co%&#x27;</span>;</span><br></pre></td></tr></table></figure><br>MySQL æ‰§è¡Œäº†è¿™äº›æ­¥éª¤ï¼š</p><ol><li>å°†è§†å›¾åç§° <code>contactPersons</code> è½¬æ¢ä¸ºè¡¨åç§° <code>customers</code>ã€‚</li><li>å°† <code>(*)</code> è½¬æ¢ä¸ºåˆ—è¡¨åˆ—å <code>customerName, firstName, lastName, phone</code>ï¼Œå¯¹åº”äº <code>customerName, contactFirstName, contactLastName, phone</code>ã€‚</li><li>æ·»åŠ  WHERE å­å¥ã€‚<br>ç”±æ­¤äº§ç”Ÿçš„è¯­å¥ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    customerName, </span><br><span class="line">    contactFirstName, </span><br><span class="line">    contactLastName, </span><br><span class="line">    phone</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    customers</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    customerName <span class="keyword">LIKE</span> <span class="string">&#x27;%Co%&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ol><h4 id="TEMTABLE"><a href="#TEMTABLE" class="headerlink" title="TEMTABLE"></a>TEMTABLE</h4><p>å½“ä½ å‘ TEMPTABLE è§†å›¾å‘å‡ºæŸ¥è¯¢æ—¶ï¼ŒMySQL ä¼šæ‰§è¡Œè¿™äº›æ­¥éª¤ã€‚</p><ul><li>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨æ¥å­˜å‚¨è§†å›¾å®šä¹‰ä¸­çš„ SELECT çš„ç»“æœã€‚</li><li>ç„¶åï¼Œé’ˆå¯¹è¯¥ä¸´æ—¶è¡¨æ‰§è¡Œè¾“å…¥æŸ¥è¯¢ã€‚<br>å› ä¸º MySQL å¿…é¡»åˆ›å»ºä¸´æ—¶è¡¨æ¥å­˜å‚¨ç»“æœé›†ï¼Œå¹¶å°†æ•°æ®ä»åŸºè¡¨ç§»åˆ°ä¸´æ—¶è¡¨ï¼Œæ‰€ä»¥ TEMPTABLE ç®—æ³•çš„æ•ˆç‡æ¯” MERGE ç®—æ³•ä½ã€‚<blockquote><p>æ³¨æ„ï¼Œ<code>TEMPTABLE è§†å›¾ä¸èƒ½è¢«æ›´æ–°</code>ã€‚</p></blockquote></li></ul><h4 id="UNDEFINED"><a href="#UNDEFINED" class="headerlink" title="UNDEFINED"></a>UNDEFINED</h4><p>å½“ä½ åˆ›å»ºè§†å›¾è€Œä¸æŒ‡å®š ALGORITHM å­å¥æˆ–æ˜ç¡®æŒ‡å®š <code>ALGORITHM=UNDEFINED</code> æ—¶ï¼ŒUNDEFINED æ˜¯é»˜è®¤ç®—æ³•ã€‚<br>æ­¤å¤–ï¼Œå½“ä½ ç”¨ <code>ALGORITHM=MERGE</code> åˆ›å»ºè§†å›¾ï¼Œè€Œ MySQL åªèƒ½ç”¨ä¸´æ—¶è¡¨å¤„ç†è¯¥è§†å›¾æ—¶ï¼ŒMySQL ä¼šè‡ªåŠ¨å°†ç®—æ³•è®¾ç½®ä¸º UNDEFINED å¹¶äº§ç”Ÿä¸€ä¸ªè­¦å‘Šã€‚<br>UNDEFINED å…è®¸ MySQL é€‰æ‹© MERGE æˆ– TEMPTABLEã€‚è€Œå¦‚æœå¯èƒ½çš„è¯ï¼ŒMySQL æ›´å€¾å‘äº MERGE è€Œä¸æ˜¯ TEMPTABLEï¼Œå› ä¸º MERGE é€šå¸¸æ¯” TEMPTABLE æ›´æœ‰æ•ˆã€‚</p><h2 id="MySQLçš„ALTER-VIEWè¯­å¥"><a href="#MySQLçš„ALTER-VIEWè¯­å¥" class="headerlink" title="MySQLçš„ALTER VIEWè¯­å¥"></a>MySQLçš„ALTER VIEWè¯­å¥</h2><p><strong>Gammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span></span><br><span class="line">    [ALGORITHM <span class="operator">=</span> &#123;UNDEFINED <span class="operator">|</span> <span class="keyword">MERGE</span> <span class="operator">|</span> TEMPTABLE&#125;]</span><br><span class="line">    <span class="keyword">VIEW</span> view_name [(column_list)]</span><br><span class="line">    <span class="keyword">AS</span> select_statement;</span><br></pre></td></tr></table></figure><br><strong>Example</strong><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/3d63ee72-e521-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="example"></p><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåŸºäº <code>orders</code> å’Œ <code>orderdetails</code> è¡¨çš„è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> salesOrders <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        orderNumber, </span><br><span class="line">        productCode,</span><br><span class="line">        quantityOrdered, </span><br><span class="line">        priceEach, </span><br><span class="line">        status</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        orders</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">        orderDetails <span class="keyword">USING</span> (orderNumber);</span><br></pre></td></tr></table></figure></p><p>ç¬¬äºŒï¼Œä»è§†å›¾ <code>salesOrders</code> ä¸­æŸ¥è¯¢æ•°æ®ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> salesorders;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸‰ï¼Œä½¿ç”¨ ALTER VIEW è¯­å¥å°†è§†å›¾çš„å¤„ç†ç®—æ³•ä» UNDEFINED æ”¹ä¸º MERGEï¼Œå¹¶åœ¨è§†å›¾ä¸­æ·»åŠ  <code>customerNumber</code> åˆ—ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> </span><br><span class="line">    ALGORITHM<span class="operator">=</span><span class="keyword">MERGE</span></span><br><span class="line"><span class="keyword">VIEW</span> salesOrders <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        orderNumber, </span><br><span class="line">        customerNumber,</span><br><span class="line">        productCode,</span><br><span class="line">        quantityOrdered, </span><br><span class="line">        priceEach, </span><br><span class="line">        status</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        orders</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">        orderDetails <span class="keyword">USING</span> (orderNumber); </span><br></pre></td></tr></table></figure></p><p>æœ€åç»“æœ<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> salesorders;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/78be659c-e521-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"></p><h2 id="å¯æ›´æ–°è§†å›¾"><a href="#å¯æ›´æ–°è§†å›¾" class="headerlink" title="å¯æ›´æ–°è§†å›¾"></a>å¯æ›´æ–°è§†å›¾</h2><h3 id="å¯æ›´æ–°è§†å›¾ä»‹ç»"><a href="#å¯æ›´æ–°è§†å›¾ä»‹ç»" class="headerlink" title="å¯æ›´æ–°è§†å›¾ä»‹ç»"></a>å¯æ›´æ–°è§†å›¾ä»‹ç»</h3><p>åœ¨ MySQLä¸­ï¼Œè§†å›¾ä¸ä»…æ˜¯å¯æŸ¥è¯¢çš„ï¼Œä¹Ÿæ˜¯å¯æ›´æ–°çš„ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ INSERT æˆ– UPDATE è¯­å¥ï¼Œé€šè¿‡å¯æ›´æ–°çš„è§†å›¾æ’å…¥æˆ–æ›´æ–°åŸºç¡€è¡¨çš„è¡Œã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨ DELETE è¯­å¥é€šè¿‡è§†å›¾åˆ é™¤åŸºç¡€è¡¨çš„è¡Œã€‚<br>ç„¶è€Œï¼Œè¦åˆ›å»ºä¸€ä¸ªå¯æ›´æ–°çš„è§†å›¾ï¼Œå®šä¹‰è¯¥è§†å›¾çš„ SELECT è¯­å¥ä¸èƒ½åŒ…å«ä»¥ä¸‹ä»»ä½•å…ƒç´ ã€‚</p><ul><li>èšåˆå‡½æ•°ï¼Œå¦‚ MINï¼ŒMAXï¼ŒSUMï¼ŒAVG å’Œ COUNT   <code>ä¸èƒ½å’ŒWhereä½¿ç”¨</code></li><li>DISTINCT</li><li>GROUP BY å­å¥</li><li>HAVING å­å¥</li><li>UNION æˆ– UNION ALL å­å¥</li><li>å¤–è¿æ¥</li><li>åœ¨ SELECT å­å¥æˆ– WHERE å­å¥ä¸­çš„å­æŸ¥è¯¢ï¼ŒæŒ‡çš„æ˜¯åœ¨ FROM å­å¥ä¸­å‡ºç°çš„è¡¨</li><li>åœ¨ FROM å­å¥ä¸­å¯¹ä¸å¯æ›´æ–°çš„è§†å›¾çš„å¼•ç”¨</li><li>åªå¼•ç”¨å­—é¢æ„ä¹‰çš„å€¼</li><li>å¯¹åŸºè¡¨çš„ä»»ä½•åˆ—çš„å¤šæ¬¡å¼•ç”¨<br>å¦‚æœä½ ç”¨ TEMPTABLE ç®—æ³•åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œä½ ä¸èƒ½æ›´æ–°è¿™ä¸ªè§†å›¾ã€‚</li></ul><p><strong>Example</strong><br>é¦–å…ˆï¼Œæˆ‘ä»¬æ ¹æ®æ ·æœ¬æ•°æ®åº“ä¸­çš„ <code>office</code> è¡¨åˆ›å»ºä¸€ä¸ªåä¸º <code>officeInfo</code> çš„è§†å›¾ã€‚è¯¥è§†å›¾å¼•ç”¨äº† <code>office</code> è¡¨ä¸­çš„ä¸‰ä¸ªåˆ—ï¼š<code>officeCode</code>ï¼Œ<code>phone</code> å’Œ <code>city</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> officeInfo</span><br><span class="line"> <span class="keyword">AS</span> </span><br><span class="line">   <span class="keyword">SELECT</span> officeCode, phone, city</span><br><span class="line">   <span class="keyword">FROM</span> offices;</span><br></pre></td></tr></table></figure><br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ SQL è¯­å¥ä» <code>officeInfo</code> è§†å›¾ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    officeInfo;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/e9ca9f28-e529-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="officeInfo"></p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>officeInfo</code> è§†å›¾ï¼Œä½¿ç”¨ä¸‹é¢çš„ UPDATE è¯­å¥ï¼Œæ”¹å˜å¸¦æœ‰ <code>officeCode=4</code> çš„åŠå…¬å®¤çš„ç”µè¯å·ç ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> officeInfo </span><br><span class="line"><span class="keyword">SET</span> </span><br><span class="line">    phone <span class="operator">=</span> <span class="string">&#x27;+33 14 723 5555&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    officeCode <span class="operator">=</span> <span class="number">4</span>;</span><br></pre></td></tr></table></figure><br>æœ€åï¼Œä¸ºäº†éªŒè¯è¿™ä¸ªå˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼Œä» <code>officeInfo</code> è§†å›¾ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    officeInfo</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    officeCode <span class="operator">=</span> <span class="number">4</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/238cd44c-e52a-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"></p><h3 id="å¯æ›´æ–°è§†å›¾æ“ä½œ"><a href="#å¯æ›´æ–°è§†å›¾æ“ä½œ" class="headerlink" title="å¯æ›´æ–°è§†å›¾æ“ä½œ"></a>å¯æ›´æ–°è§†å›¾æ“ä½œ</h3><p>å¯ä»¥é€šè¿‡æŸ¥è¯¢ <code>information_schema</code> æ•°æ®åº“ä¸­ <code>views</code> è¡¨çš„ <code>is_updatable</code> åˆ—æ¥æ£€æŸ¥æ•°æ®åº“ä¸­çš„è§†å›¾æ˜¯å¦æ˜¯å¯æ›´æ–°çš„ã€‚<br>ä¸‹é¢çš„æŸ¥è¯¢ä» <code>classicmodels</code> æ•°æ®åº“ä¸­è·å–æ‰€æœ‰è§†å›¾ï¼Œå¹¶æ˜¾ç¤ºå“ªäº›è§†å›¾æ˜¯å¯æ›´æ–°çš„ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    table_name, </span><br><span class="line">    is_updatable</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    information_schema.views</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    table_schema <span class="operator">=</span> <span class="string">&#x27;classicmodels&#x27;</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/8ebf7f74-e52c-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="å¯æ›´æ–°æŸ¥è¯¢"></p><h4 id="é€šè¿‡è§†å›¾åˆ é™¤è¡Œ"><a href="#é€šè¿‡è§†å›¾åˆ é™¤è¡Œ" class="headerlink" title="é€šè¿‡è§†å›¾åˆ é™¤è¡Œ"></a>é€šè¿‡è§†å›¾åˆ é™¤è¡Œ</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º <code>items</code> çš„è¡¨ï¼Œåœ¨ <code>items</code> è¡¨ä¸­æ’å…¥ä¸€äº›è¡Œï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œå…¶ä¸­åŒ…å«ä»·æ ¼å¤§äº <code>700</code> çš„é¡¹ç›®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- create a new table named items --</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> items (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">11</span> , <span class="number">2</span> ) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- insert data into the items table --</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> items(name,price) </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;Laptop&#x27;</span>,<span class="number">700.56</span>),(<span class="string">&#x27;Desktop&#x27;</span>,<span class="number">699.99</span>),(<span class="string">&#x27;iPad&#x27;</span>,<span class="number">700.50</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- create a view based on items table --</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> LuxuryItems <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        items</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        price <span class="operator">&gt;</span> <span class="number">700</span>;</span><br><span class="line">        </span><br><span class="line"><span class="comment">-- query data from the LuxuryItems view --</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    LuxuryItems;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/b5b05392-e52c-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="items"></p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨ DELETE è¯­å¥æ¥åˆ é™¤ä¸€æ¡ id å€¼ä¸º 3 çš„è®°å½•ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> LuxuryItems </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    id <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure><br>MySQL è¿”å›ä¸€ä¸ªæ¶ˆæ¯è¯´ï¼Œæœ‰ 1 è¡Œå—åˆ°å½±å“ã€‚</p><p>ç¬¬ä¸‰ï¼Œè®©æˆ‘ä»¬å†æ¬¡é€šè¿‡è§†å›¾æ£€æŸ¥æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    LuxuryItems;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/2e146c74-e52d-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="LuxuryItems"></p><p>ç¬¬å››ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»åŸºç¡€è¡¨é¡¹ä¸­æŸ¥è¯¢æ•°æ®ï¼Œä»¥éªŒè¯ DELETE è¯­å¥æ˜¯å¦çœŸçš„åˆ é™¤äº†è¯¥è¡Œã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    items;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/39bc3fde-e52d-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="items"><br>æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œid ä¸º 3 çš„è¡Œè¢«ä»åŸºç¡€è¡¨ä¸­åˆ é™¤äº†ã€‚</p><h3 id="WITH-CHECK-OPTIONå­å¥"><a href="#WITH-CHECK-OPTIONå­å¥" class="headerlink" title="WITH CHECK OPTIONå­å¥"></a>WITH CHECK OPTIONå­å¥</h3><p>åˆ›å»ºä¸€ä¸ªè§†å›¾æ¥æ˜¾ç¤ºä¸€ä¸ªè¡¨çš„éƒ¨åˆ†æ•°æ®ã€‚ç„¶è€Œï¼Œä¸€ä¸ªç®€å•çš„è§†å›¾æ˜¯å¯æ›´æ–°çš„ï¼Œå› æ­¤æœ‰å¯èƒ½æ›´æ–°é‚£äº›é€šè¿‡è§†å›¾ä¸å¯è§çš„æ•°æ®ã€‚è¿™ç§æ›´æ–°ä¼šä½¿è§†å›¾ä¸ä¸€è‡´ã€‚ä¸ºäº†ç¡®ä¿è§†å›¾çš„ä¸€è‡´æ€§ï¼Œåœ¨åˆ›å»ºæˆ–ä¿®æ”¹è§†å›¾æ—¶ï¼Œè¦ä½¿ç”¨ <code>WITH CHECK OPTION</code> å­å¥ã€‚<br><code>WITH CHECK OPTION</code> æ˜¯ CREATE VIEW è¯­å¥çš„ä¸€ä¸ªå¯é€‰å­å¥ã€‚<code>WITH CHECK OPTION</code> é˜²æ­¢è§†å›¾æ›´æ–°æˆ–æ’å…¥é€šè¿‡å®ƒä¸å¯è§çš„è¡Œã€‚æ¢å¥è¯è¯´ï¼Œæ¯å½“ä½ é€šè¿‡è§†å›¾æ›´æ–°æˆ–æ’å…¥åŸºè¡¨çš„è¡Œæ—¶ï¼ŒMySQL ç¡®ä¿æ’å…¥æˆ–æ›´æ–°æ“ä½œç¬¦åˆè§†å›¾çš„å®šä¹‰ã€‚</p><p><strong>Gammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span>] view_name </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">  select_statement</span><br><span class="line">  <span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure><br>æ³¨æ„ä½ æŠŠåˆ†å·ï¼ˆ;ï¼‰æ”¾åœ¨ <code>WITH CHECK OPTION</code> å­å¥çš„æœ«å°¾ï¼Œè€Œä¸æ˜¯æ”¾åœ¨å®šä¹‰è§†å›¾çš„ SELECT è¯­å¥çš„æœ«å°¾ã€‚</p><p><strong>Example</strong><br>é¦–å…ˆï¼ŒåŸºäºé›‡å‘˜è¡¨åˆ›å»ºä¸€ä¸ªåä¸º <code>vps</code> çš„è§†å›¾ï¼Œä»¥æ˜¾ç¤ºå·¥ä½œå¤´è¡”ä¸ºå‰¯æ€»è£çš„é›‡å‘˜ï¼Œä¾‹å¦‚é”€å”®å‰¯æ€»è£ã€è¥é”€å‰¯æ€»è£ (VP e.g., VP Sales, VP Marketingï¼‰ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> vps <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        employeeNumber,</span><br><span class="line">        lastname,</span><br><span class="line">        firstname,</span><br><span class="line">        jobtitle,</span><br><span class="line">        extension,</span><br><span class="line">        email,</span><br><span class="line">        officeCode,</span><br><span class="line">        reportsTo</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        jobTitle <span class="keyword">LIKE</span> <span class="string">&#x27;%VP%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹ SELECT è¯­å¥ä» <code>vps</code> è§†å›¾ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> vps;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/0ece18c2-e53e-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="vps"></p><p>å› ä¸º <code>vps</code> æ˜¯ä¸€ä¸ªç®€å•çš„è§†å›¾ï¼Œå®ƒæ˜¯å¯æ›´æ–°çš„ã€‚<br>ç„¶åï¼Œé€šè¿‡ <code>vps</code> è§†å›¾å‘ <code>employees</code> è¡¨æ’å…¥ä¸€æ¡è®°å½•ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> vps(</span><br><span class="line">    employeeNumber,</span><br><span class="line">    firstName,</span><br><span class="line">    lastName,</span><br><span class="line">    jobTitle,</span><br><span class="line">    extension,</span><br><span class="line">    email,</span><br><span class="line">    officeCode,</span><br><span class="line">    reportsTo</span><br><span class="line">) </span><br><span class="line"><span class="keyword">VALUES</span>(</span><br><span class="line">    <span class="number">1703</span>,</span><br><span class="line">    <span class="string">&#x27;Lily&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Bush&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;IT Manager&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;x9111&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;lilybush@classicmodelcars.com&#x27;</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">1002</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>è¯·æ³¨æ„ï¼Œé€šè¿‡ <code>vps</code> è§†å›¾ï¼Œæ–°åˆ›å»ºçš„å‘˜å·¥æ˜¯ä¸å¯è§çš„ï¼Œå› ä¸ºå¥¹çš„å·¥ä½œå¤´è¡”æ˜¯ IT ç»ç†ï¼Œè€Œè¿™ä¸æ˜¯å‰¯æ€»è£ï¼ˆ å› ä¸ºå¥¹çš„èŒä½æ˜¯ <code>IT Manager</code>ï¼Œè¿™ä¸æ˜¯ <code>VP</code> ï¼‰ã€‚ä½ å¯ä»¥ç”¨ä¸‹é¢çš„ SELECT è¯­å¥æ¥éªŒè¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">   <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">   employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> </span><br><span class="line">   employeeNumber <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/3b9f36a6-e53e-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="employees"><br>è¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³é€šè¿‡ <code>vps</code> è§†å›¾å…¬å¼€å‰¯æ€»è£çš„å‘˜å·¥ï¼Œè€Œä¸æ˜¯å…¶ä»–å‘˜å·¥ã€‚<br>ä¸ºäº†ç¡®ä¿è§†å›¾çš„ä¸€è‡´æ€§ï¼Œä½¿ç”¨æˆ·åªèƒ½æ˜¾ç¤ºæˆ–æ›´æ–°é€šè¿‡è§†å›¾å¯è§çš„æ•°æ®ï¼Œä½ å¯ä»¥åœ¨åˆ›å»ºæˆ–ä¿®æ”¹è§†å›¾æ—¶ä½¿ç”¨ <code>WITH CHECK OPTION</code>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> vps <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        employeeNumber,</span><br><span class="line">        lastName,</span><br><span class="line">        firstName,</span><br><span class="line">        jobTitle,</span><br><span class="line">        extension,</span><br><span class="line">        email,</span><br><span class="line">        officeCode,</span><br><span class="line">        reportsTo</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        jobTitle <span class="keyword">LIKE</span> <span class="string">&#x27;%VP%&#x27;</span> </span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ <code>CREATE OR REPLACE</code> è¯­å¥æœ«å°¾çš„ <code>WITH CHECK OPTION</code>ã€‚<br>ä¹‹åï¼Œé€šè¿‡ <code>vps</code> è§†å›¾å‘ <code>employees</code> è¡¨æ’å…¥ä¸€æ¡è®°å½•ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> vps(employeeNumber,firstname,lastname,jobtitle,extension,email,officeCode,reportsTo)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1704</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;Smith&#x27;</span>,<span class="string">&#x27;IT Staff&#x27;</span>,<span class="string">&#x27;x9112&#x27;</span>,<span class="string">&#x27;johnsmith@classicmodelcars.com&#x27;</span>,<span class="number">1</span>,<span class="number">1703</span>);</span><br></pre></td></tr></table></figure><br>è¿™ä¸€æ¬¡ï¼ŒMySQL æ‹’ç»äº†è¿™ä¸ªæ’å…¥ï¼Œå¹¶å‘å‡ºäº†ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error Code: <span class="number">1369.</span> <span class="keyword">CHECK</span> OPTION failed <span class="string">&#x27;classicmodels.vps&#x27;</span></span><br></pre></td></tr></table></figure><br>æœ€åï¼Œé€šè¿‡ <code>vps</code> è§†å›¾åœ¨ <code>employees</code> è¡¨ä¸­æ’å…¥ä¸€ä¸ªèŒä½åç§°ä¸º <code>SVP Marketing</code> çš„é›‡å‘˜ï¼Œçœ‹çœ‹æ˜¯å¦å…è®¸ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> vps(employeeNumber,firstname,lastname,jobtitle,extension,email,officeCode,reportsTo)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1704</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;Smith&#x27;</span>,<span class="string">&#x27;SVP Marketing&#x27;</span>,<span class="string">&#x27;x9112&#x27;</span>,<span class="string">&#x27;johnsmith@classicmodelcars.com&#x27;</span>,<span class="number">1</span>,<span class="number">1076</span>);</span><br></pre></td></tr></table></figure><br>MySQL å‘å‡ºæ¶ˆæ¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">rows</span>(s) affected.</span><br></pre></td></tr></table></figure><br>ä½ å¯ä»¥é€šè¿‡æŸ¥è¯¢ <code>vps</code> è§†å›¾çš„æ•°æ®æ¥éªŒè¯æ’å…¥ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> vps;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/9ac85acc-e53e-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="vps_later"></p><h2 id="æ˜¾ç¤ºè§†å›¾"><a href="#æ˜¾ç¤ºè§†å›¾" class="headerlink" title="æ˜¾ç¤ºè§†å›¾"></a>æ˜¾ç¤ºè§†å›¾</h2><h3 id="show-full-tables"><a href="#show-full-tables" class="headerlink" title="show full tables"></a>show full tables</h3><p>è¦æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>SHOW FULL TABLES</code> è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES </span><br><span class="line"><span class="keyword">WHERE</span> table_type <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span>;</span><br></pre></td></tr></table></figure><br>å› ä¸º <code>SHOW FULL TABLES</code> è¯­å¥åŒæ—¶è¿”å›è¡¨å’Œè§†å›¾ï¼Œä½ éœ€è¦æ·»åŠ ä¸€ä¸ª WHERE å­å¥æ¥åªè·å¾—è§†å›¾ã€‚</p><p>å¦‚æœä½ æƒ³æ˜¾ç¤ºå¦ä¸€ä¸ªæ•°æ®åº“çš„æ‰€æœ‰è§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¯­æ³•ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES</span><br><span class="line">[&#123;<span class="keyword">FROM</span> <span class="operator">|</span> <span class="keyword">IN</span> &#125; database_name]</span><br><span class="line"><span class="keyword">WHERE</span> table_type <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span>;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­å¥ä¸­ï¼Œæˆ‘ä»¬åœ¨ FROM æˆ– IN å­å¥åé¢æŒ‡å®šäº†è¦æ˜¾ç¤ºè§†å›¾çš„æ•°æ®åº“åç§°ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºäº†æ¥è‡ª <code>sys</code> æ•°æ®åº“çš„æ‰€æœ‰è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES <span class="keyword">IN</span> sys </span><br><span class="line"><span class="keyword">WHERE</span> table_type<span class="operator">=</span><span class="string">&#x27;VIEW&#x27;</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/6e4932f2-e546-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="sys_show_view"></p><p>å¦‚æœä½ æƒ³æ ¹æ®ä¸€ä¸ªæ¨¡å¼è·å¾—ä¸€ä¸ªè§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ LIKE å­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES</span><br><span class="line">[&#123;<span class="keyword">FROM</span> <span class="operator">|</span> <span class="keyword">IN</span> &#125; database_name]</span><br><span class="line"><span class="keyword">LIKE</span> <span class="keyword">pattern</span>;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¾‹å­ä½¿ç”¨ LIKE å­å¥ä» <code>sys</code> æ•°æ®åº“ä¸­æ‰¾åˆ°æ‰€æœ‰è§†å›¾ï¼Œå…¶åç§°ä»¥ <code>waits</code> å¼€å¤´ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES </span><br><span class="line"><span class="keyword">FROM</span> sys</span><br><span class="line"><span class="keyword">LIKE</span> <span class="string">&#x27;waits%&#x27;</span>;</span><br></pre></td></tr></table></figure></p><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/c89dfd6e-e546-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="sys_show_view_waits"></p><blockquote><p>æ³¨æ„ï¼Œå¦‚æœä½ å¯¹ä¸€ä¸ªè§†å›¾æ²¡æœ‰æƒé™ï¼Œå®ƒå°†ä¸ä¼šæ˜¾ç¤ºåœ¨ <code>SHOW TABLES</code> è¯­å¥çš„è¾“å‡ºä¸­ã€‚</p></blockquote><h3 id="ä½¿ç”¨-INFORMATION-SCHEMA-æ•°æ®åº“"><a href="#ä½¿ç”¨-INFORMATION-SCHEMA-æ•°æ®åº“" class="headerlink" title="ä½¿ç”¨ INFORMATION_SCHEMA æ•°æ®åº“"></a>ä½¿ç”¨ INFORMATION_SCHEMA æ•°æ®åº“</h3><p><code>INFORMATION_SCHEMA</code> æ•°æ®åº“æä¾›å¯¹ MySQL æ•°æ®åº“å…ƒæ•°æ®çš„è®¿é—®ï¼Œå¦‚æ•°æ®åº“çš„åç§°ã€è¡¨ã€åˆ—çš„æ•°æ®ç±»å‹æˆ–æƒé™ã€‚<br><code>INFORMATION_SCHEMA</code> æœ‰æ—¶è¢«ç§°ä¸ºæ•°æ®åº“å­—å…¸æˆ–ç³»ç»Ÿç›®å½•ã€‚<br>ä¸ºäº†æ˜¾ç¤ºä¸€ä¸ªæ•°æ®åº“çš„è§†å›¾ï¼Œä½ ä½¿ç”¨ <code>INFORMATION_SCHEMA</code> ä¸­çš„è¡¨ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> information_schema.tables;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæ˜¯éƒ¨åˆ†è¾“å‡ºï¼š<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/b406b968-e546-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="outcome"><br>åœ¨è¿™ä¸ªè¾“å‡ºä¸­ï¼Œæˆ‘ä»¬åªå¯¹ <code>table_schema</code>ï¼Œ<code>table_name</code>ï¼Œ<code>table_type</code> ä¸‰ä¸ªåˆ—æ„Ÿå…´è¶£ã€‚</p><ul><li><code>table_schema</code> åˆ—å­˜å‚¨äº†è§†å›¾ï¼ˆæˆ–è¡¨ï¼‰çš„æ¨¡å¼æˆ–æ•°æ®åº“ã€‚</li><li><code>table_name</code> åˆ—å­˜å‚¨äº†è§†å›¾ï¼ˆæˆ–è¡¨ï¼‰çš„åç§°ã€‚</li><li><code>table_type</code> åˆ—å­˜å‚¨äº†è¡¨çš„ç±»å‹ã€‚<code>BASE TABLE</code> ä»£è¡¨è¡¨ï¼Œ<code>VIEW</code> ä»£è¡¨è§†å›¾ï¼Œæˆ–è€… <code>SYSTEM VIEW</code> ä»£è¡¨ <code>INFORMATION_SCHEMA</code> è¡¨ã€‚</li></ul><p>æŸ¥è¯¢ <code>classicmodels</code> æ•°æ®åº“ä¸­çš„æ‰€æœ‰è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    table_name view_name</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    information_schema.tables </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    table_type   <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span> <span class="keyword">AND</span> </span><br><span class="line">    table_schema <span class="operator">=</span> <span class="string">&#x27;classicmodels&#x27;</span>;</span><br></pre></td></tr></table></figure></p><p>è¦æ ¹æ®ä¸€ä¸ªæ¨¡å¼æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šçš„è§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>table_name</code> åˆ—ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªæŸ¥è¯¢æ‰¾åˆ°æ‰€æœ‰åç§°ä»¥ <code>customer</code> å¼€å¤´çš„è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    table_name view_name</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    information_schema.tables </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    table_type   <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span> <span class="keyword">AND</span> </span><br><span class="line">    table_schema <span class="operator">=</span> <span class="string">&#x27;classicmodels&#x27;</span> <span class="keyword">AND</span></span><br><span class="line">    table_name   <span class="keyword">LIKE</span> <span class="string">&#x27;customer%&#x27;</span>;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/0e943aea-e547-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="examplr of information"></p><h2 id="RENAME-VIEW"><a href="#RENAME-VIEW" class="headerlink" title="RENAME VIEW"></a>RENAME VIEW</h2><p>å› ä¸ºè§†å›¾å’Œè¡¨å…±äº«åŒä¸€ä¸ªå‘½åç©ºé—´ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ <code>RENAME TABLE</code> è¯­å¥æ¥æ”¹å˜è§†å›¾çš„åç§°ã€‚<br><strong>Gammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RENAME <span class="keyword">TABLE</span> original_view_name </span><br><span class="line"><span class="keyword">TO</span> new_view_name;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œåœ¨ <code>RENAME TABLE</code> å…³é”®å­—åé¢æŒ‡å®šè¦é‡å‘½åçš„è§†å›¾çš„åç§°ã€‚</li><li>ç„¶åï¼Œåœ¨ <code>TO</code> å…³é”®å­—åé¢æŒ‡å®šè§†å›¾çš„æ–°åç§°ã€‚<br>å¦ä¸€ç§é—´æ¥é‡å‘½åè§†å›¾çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>DROP VIEW</code> å’Œ <code>CREATE VIEW</code> è¯­å¥çš„åºåˆ—ã€‚</li><li>é¦–å…ˆï¼Œä½¿ç”¨ <code>SHOW CREATE VIEW</code> è¯­å¥æ¥å¤åˆ¶è§†å›¾çš„ DDLã€‚</li><li>å…¶æ¬¡ï¼Œä½¿ç”¨ <code>DROP VIEW</code> è¯­å¥æ”¾å¼ƒè¯¥è§†å›¾ã€‚</li><li>æœ€åï¼Œç”¨ä½ åœ¨æ­¥éª¤ 1 ä¸­å¤åˆ¶çš„ DDL åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾ï¼Œå¹¶å°†å…¶é‡æ–°å‘½åã€‚<br>é€šè¿‡ä½¿ç”¨ä¸€è¿ä¸²çš„ <code>DROP</code> å’Œ <code>CREATE VIEW</code> è¯­å¥ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªè§†å›¾ä»ä¸€ä¸ªæ•°æ®åº“è½¬ç§»åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ã€‚</li></ul><p><strong>Example</strong></p><ol><li><p>ä½¿ç”¨ RENAME TABLE è¯­å¥é‡å‘½åä¸€ä¸ªè§†å›¾<br>é¦–å…ˆï¼Œä¸ºåˆ›å»ºä¸€ä¸ªåä¸º <code>productLineSales</code> çš„æ–°è§†å›¾ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> productLineSales <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    productLine, </span><br><span class="line">    <span class="built_in">SUM</span>(quantityOrdered) totalQtyOrdered</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    productLines</span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">    products <span class="keyword">USING</span> (productLine)</span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">    orderdetails <span class="keyword">USING</span> (productCode)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> productLine;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œå°†è§†å›¾ <code>productLineSales</code> é‡å‘½åä¸º <code>productLineQtySales</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RENAME <span class="keyword">TABLE</span> productLineSales </span><br><span class="line"><span class="keyword">TO</span> productLineQtySales;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ï¼Œä½¿ç”¨ <code>SHOW FULL TABLES</code> æ¥æ£€æŸ¥è§†å›¾æ˜¯å¦å·²ç»æˆåŠŸé‡å‘½åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> TABLES <span class="keyword">WHERE</span> table_type <span class="operator">=</span> <span class="string">&#x27;VIEW&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ DROP VIEW å’Œ CREATE VIEW åºåˆ—é‡å‘½åä¸€ä¸ªè§†å›¾<br>å‡è®¾ä½ æƒ³æŠŠè§†å›¾ <code>productLineQtySales</code> çš„åå­—æ”¹ä¸º <code>categorySales</code>ã€‚</p></li></ol><p>é¦–å…ˆï¼Œä½¿ç”¨ <code>SHOW CREATE VIEW</code> æ¥è·å–è§†å›¾çš„ DDLï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> productLineQtySales;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/b32e5cf4-e54a-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="show create view"></p><p>ç¬¬äºŒï¼Œåˆ é™¤è§†å›¾ <code>productLineQtySales</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> productLineQtySales;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸‰ï¼Œåœ¨ DDL ä¸­æ”¹å˜è§†å›¾çš„åç§°å¹¶æ‰§è¡Œå®ƒï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> categorySales <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    productLine, </span><br><span class="line">    <span class="built_in">SUM</span>(quantityOrdered) totalQtyOrdered</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    productLines</span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">    products <span class="keyword">USING</span> (productLine)</span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">    orderDetails <span class="keyword">USING</span> (productCode)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> productLine;</span><br></pre></td></tr></table></figure></p><h2 id="DROP-VIEW"><a href="#DROP-VIEW" class="headerlink" title="DROP VIEW"></a>DROP VIEW</h2><p><strong>Gammar</strong><br><code>DROP VIEW</code> è¯­å¥ä»æ•°æ®åº“ä¸­åˆ é™¤äº†ä¸€ä¸ªè§†å›¾ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> [IF <span class="keyword">EXISTS</span>] view_name;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼Œä½ åœ¨ <code>DROP VIEW</code> å…³é”®å­—åé¢æŒ‡å®šè¦åˆ é™¤çš„è§†å›¾çš„åç§°ã€‚<br><code>IF EXISTS</code> é€‰é¡¹åªæœ‰åœ¨è§†å›¾å­˜åœ¨çš„æƒ…å†µä¸‹æ‰ä¼šæœ‰æ¡ä»¶åœ°åˆ é™¤è¯¥è§†å›¾ã€‚<br>è¦ä¸€æ¬¡åˆ é™¤å¤šä¸ªè§†å›¾ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> [IF <span class="keyword">EXISTS</span>] view_name1 [,view_name2]...;</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ç§è¯­æ³•ä¸­ï¼Œå¦‚æœåœ¨ <code>DROP VIEW</code> å­å¥åæŒ‡å®šçš„ä»»ä½•è§†å›¾ä¸å­˜åœ¨ï¼Œ<code>DROP VIEW</code> è¯­å¥å°±ä¼šå¤±è´¥ï¼Œå¹¶ä¸”ä¸ä¼šåˆ é™¤ä»»ä½•è§†å›¾ã€‚</p><p>å¦‚æœä½ ä½¿ç”¨ <code>IF EXISTS</code> é€‰é¡¹ï¼Œå¹¶ä¸”æœ‰ä¸€äº›è§†å›¾ä¸å­˜åœ¨ï¼Œ<code>DROP VIEW</code> è¯­å¥ä¼šä¸ºæ¯ä¸ªä¸å­˜åœ¨çš„è§†å›¾ç”Ÿæˆä¸€ä¸ª Noteã€‚</p><p><strong>Example</strong></p><ol><li>åˆ é™¤ä¸€ä¸ªè§†å›¾</li></ol><p>åœ¨ <code>customers</code> å’Œ <code>payments</code> è¡¨çš„åŸºç¡€ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>customerPayments</code> çš„è§†å›¾ï¼š<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/8325b410-e54c-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="customers"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customerPayments </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        customerName, </span><br><span class="line">        <span class="built_in">SUM</span>(amount) payment</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        customers</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> payments </span><br><span class="line">        <span class="keyword">USING</span> (customerNumber)</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> </span><br><span class="line">        customerName;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä½¿ç”¨ <code>DROP VIEW</code> è¯­å¥æ¥åˆ é™¤ <code>customerPayments</code> è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> IF <span class="keyword">EXISTS</span> customerPayments;</span><br></pre></td></tr></table></figure></p><ol><li>åˆ é™¤å¤šä¸ªè§†å›¾<br>è¿™æ¡è¯­å¥åœ¨ <code>employees</code> è¡¨å’Œ <code>offices</code> è¡¨çš„åŸºç¡€ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>employeeOffices</code> çš„è§†å›¾ï¼š<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/15/cd4f6298-e54c-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="views"></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> employeeOffices <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        firstName, lastName, addressLine1, city</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees</span><br><span class="line">            <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">        offices <span class="keyword">USING</span> (officeCode);</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„è¯­å¥ä½¿ç”¨ DROP VIEW è¯­å¥æ¥åˆ é™¤ä¸¤ä¸ªè§†å›¾ <code>employeeOffices</code> å’Œ <code>eOffices</code>ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> employeeOffices, eOffices;</span><br></pre></td></tr></table></figure><br>MySQL å‘å‡ºä»¥ä¸‹é”™è¯¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error Code: <span class="number">1051.</span> <span class="literal">Unknown</span> <span class="keyword">table</span> <span class="string">&#x27;classicmodels.eoffices&#x27;</span></span><br></pre></td></tr></table></figure><br>æ·»åŠ  <code>IF EXISTS</code> é€‰é¡¹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> IF <span class="keyword">EXISTS</span> employeeOffices, eOffices;</span><br></pre></td></tr></table></figure><br>MySQL å‘å‡ºè­¦å‘Šï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> warning(s): <span class="number">1051</span> <span class="literal">Unknown</span> <span class="keyword">table</span> <span class="string">&#x27;classicmodels.eoffices&#x27;</span></span><br></pre></td></tr></table></figure></p><h2 id="MySQLçš„è§†å›¾çš„æœ¬åœ°å’Œçº§è”"><a href="#MySQLçš„è§†å›¾çš„æœ¬åœ°å’Œçº§è”" class="headerlink" title="MySQLçš„è§†å›¾çš„æœ¬åœ°å’Œçº§è”"></a>MySQLçš„è§†å›¾çš„æœ¬åœ°å’Œçº§è”</h2><h3 id="æ£€æŸ¥æœ¬åœ°å’Œçº§è”çš„èŒƒå›´"><a href="#æ£€æŸ¥æœ¬åœ°å’Œçº§è”çš„èŒƒå›´" class="headerlink" title="æ£€æŸ¥æœ¬åœ°å’Œçº§è”çš„èŒƒå›´"></a>æ£€æŸ¥æœ¬åœ°å’Œçº§è”çš„èŒƒå›´</h3><p>å½“ä½ ç”¨ <code>WITH CHECK OPTION</code> å­å¥åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œå¹¶å¯¹è¯¥è§†å›¾å‘å‡º DML è¯­å¥ï¼Œå¦‚ <code>INSERT</code>ã€<code>UPDATE</code> å’Œ <code>DELETE</code>ï¼ŒMySQL ä¼šæ£€æŸ¥ä»¥ç¡®ä¿è¢«æ”¹å˜çš„è¡Œç¬¦åˆè¯¥è§†å›¾çš„å®šä¹‰ã€‚<br>ä¸ºäº†ç¡®å®šæ£€æŸ¥çš„èŒƒå›´ï¼ŒMySQL æä¾›äº†ä¸¤ä¸ªé€‰é¡¹ï¼š<code>LOCAL</code> å’Œ <code>CASCADED</code>ã€‚<br>å¦‚æœä½ æ²¡æœ‰åœ¨ <code>WITH CHECK OPTION</code> å­å¥ä¸­æ˜ç¡®æŒ‡å®šå…³é”®è¯ï¼ŒMySQL é»˜è®¤ä½¿ç”¨ <code>CASCADED</code>ã€‚</p><h3 id="MySQL-WITH-CASCADED-CHECK-OPTION"><a href="#MySQL-WITH-CASCADED-CHECK-OPTION" class="headerlink" title="MySQL WITH CASCADED CHECK OPTION"></a>MySQL WITH CASCADED CHECK OPTION</h3><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º <code>t1</code> çš„è¡¨ï¼Œè¯¥è¡¨æœ‰ä¸€ä¸ªæ•°æ®ç±»å‹ä¸ºæ•´æ•°çš„åˆ— <code>c</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (</span><br><span class="line">    c <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>t1</code> è¡¨çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v1</code>ï¼Œ<code>c</code> åˆ—çš„æ•°æ®å¤§äº 10ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> v1 </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        c</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        t1</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">        c <span class="operator">&gt;</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure><br>å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š <code>WITH CHECK OPTION</code>ï¼Œæ‰€ä»¥å°½ç®¡ä¸‹é¢çš„è¯­å¥ä¸ç¬¦åˆ <code>v1</code> è§†å›¾çš„å®šä¹‰ï¼Œä½†å®ƒè¿˜æ˜¯å¯ä»¥å·¥ä½œã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v1(c) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">5</span>);</span><br></pre></td></tr></table></figure><br>ç„¶åï¼Œåœ¨ <code>v1</code> è§†å›¾çš„åŸºç¡€ä¸Šï¼Œç”¨ <code>WITH CASCADED CHECK OPTION</code> å­å¥åˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v2</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> v2 </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> c <span class="keyword">FROM</span> v1 </span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CASCADED</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure><br>ç°åœ¨ï¼Œé€šè¿‡ <code>v2</code> è§†å›¾åœ¨ <code>t1</code> è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°å€¼ä¸º 5 çš„è®°å½•ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v2(c) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">5</span>);</span><br></pre></td></tr></table></figure><br>MySQL å‘å¸ƒäº†ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error Code: <span class="number">1369.</span> <span class="keyword">CHECK</span> OPTION failed <span class="string">&#x27;classicmodels.v2&#x27;</span></span><br></pre></td></tr></table></figure><br>å®ƒæ²¡æœ‰å‘ç°ä¸ç¬¦åˆ <code>v2</code> è§†å›¾å®šä¹‰çš„æ–°è¡Œã€‚<br>ä¹‹åï¼Œåœ¨ <code>v2</code> çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º <code>v3</code> çš„æ–°è§†å›¾ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> v3 </span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> c</span><br><span class="line">    <span class="keyword">FROM</span> v2</span><br><span class="line">    <span class="keyword">WHERE</span> c <span class="operator">&lt;</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure><br>é€šè¿‡ <code>v3</code> è§†å›¾åœ¨ <code>t1</code> è¡¨ä¸­æ’å…¥ä¸€æ¡æ–°è¡Œï¼Œå€¼ä¸º 8ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v3(c) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">8</span>);</span><br></pre></td></tr></table></figure><br>MySQL å‘å¸ƒäº†ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error Code: <span class="number">1369.</span> <span class="keyword">CHECK</span> OPTION failed <span class="string">&#x27;classicmodels.v3&#x27;</span></span><br></pre></td></tr></table></figure><br>å°½ç®¡è¯¥è¡Œä¼¼ä¹ç¬¦åˆ <code>v3</code> è§†å›¾çš„å®šä¹‰ï¼Œä½†æ’å…¥è¯­å¥è¿˜æ˜¯å¤±è´¥äº†ã€‚<br>å› ä¸ºè§†å›¾ <code>v3</code> ä¾èµ–äº <code>v2</code> è§†å›¾ï¼Œè€Œ <code>v2</code> è§†å›¾æœ‰é€‰é¡¹ <code>WITH CASCADED CHECK OPTION</code>ã€‚<br>ç„¶è€Œï¼Œä¸‹é¢çš„æ’å…¥è¯­å¥å¯ä»¥å·¥ä½œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v3(c) <span class="keyword">VALUES</span> (<span class="number">30</span>);</span><br></pre></td></tr></table></figure></p><h3 id="MySQL-WITH-LOCAL-CHECK-OPTION"><a href="#MySQL-WITH-LOCAL-CHECK-OPTION" class="headerlink" title="MySQL WITH LOCAL CHECK OPTION"></a>MySQL WITH LOCAL CHECK OPTION</h3><p>é¦–å…ˆï¼Œå°† <code>v2</code> è§†å›¾æ”¹ä¸ºä½¿ç”¨ <code>WITH LOCAL CHECK OPTION</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> v2 <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        c</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        v1 </span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure><br>ç¬¬äºŒï¼Œæ’å…¥ä¸æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ç›¸åŒçš„è¡Œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v2(c) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">5</span>);</span><br></pre></td></tr></table></figure><br>å®ƒæˆåŠŸäº†ã€‚</p><p>å› ä¸º <code>v2</code> è§†å›¾æ²¡æœ‰ä»»ä½•è§„åˆ™ã€‚è§†å›¾ <code>v2</code> æ˜¯ä¾èµ–äº <code>v1</code> è§†å›¾çš„ã€‚ç„¶è€Œï¼Œ<code>v1</code> è§†å›¾æ²¡æœ‰æŒ‡å®šæ£€æŸ¥é€‰é¡¹ï¼Œå› æ­¤ï¼ŒMySQL è·³è¿‡äº†å¯¹ <code>v1</code> è§†å›¾ä¸­è§„åˆ™çš„æ£€æŸ¥ã€‚</p><p>æ³¨æ„ï¼Œåœ¨ç”¨ <code>WITH CASCADED CHECK OPTION</code> åˆ›å»ºçš„ <code>v2</code> è§†å›¾ä¸­ï¼Œè¿™ä¸ªè¯­å¥å¤±è´¥äº†ã€‚</p><p>ç¬¬ä¸‰ï¼Œé€šè¿‡ <code>v3</code> è§†å›¾å‘ <code>t1</code> è¡¨æ’å…¥åŒä¸€è¡Œã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v3(c) <span class="keyword">VALUES</span> (<span class="number">8</span>);</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæˆåŠŸäº†ï¼Œå› ä¸º MySQL æ²¡æœ‰æ£€æŸ¥ <code>v1</code> è§†å›¾çš„è§„åˆ™ï¼Œå› ä¸º <code>v2</code> è§†å›¾çš„ <code>WITH LOCAL CHECK OPTION</code>ã€‚<br>å¦å¤–ï¼Œæ³¨æ„åˆ°åœ¨ <code>v2</code> åˆ›å»ºçš„ <code>WITH CASCADED CHECK OPTION</code> çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªè¯­å¥å¤±è´¥äº†ã€‚<br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/18/2cffef90-e7a6-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="local check option"></p><h2 id="ç®¡ç†è§†å›¾"><a href="#ç®¡ç†è§†å›¾" class="headerlink" title="ç®¡ç†è§†å›¾"></a>ç®¡ç†è§†å›¾</h2><h3 id="æ˜¾ç¤ºè§†å›¾å®šä¹‰"><a href="#æ˜¾ç¤ºè§†å›¾å®šä¹‰" class="headerlink" title="æ˜¾ç¤ºè§†å›¾å®šä¹‰"></a>æ˜¾ç¤ºè§†å›¾å®šä¹‰</h3><p><strong>Gammar</strong><br>MySQL æä¾› <code>SHOW CREATE VIEW</code> è¯­å¥ï¼Œæ˜¾ç¤ºè§†å›¾çš„å®šä¹‰ã€‚<br>ä¸‹é¢æ˜¯ <code>SHOW CREATE VIEW</code> è¯­å¥çš„è¯­æ³•ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> [database_name].[view_ name];</span><br></pre></td></tr></table></figure></p><p>è¦æ˜¾ç¤ºä¸€ä¸ªè§†å›¾çš„å®šä¹‰ï¼Œä½ éœ€è¦åœ¨ <code>SHOW CREATE VIEW</code> å­å¥åæŒ‡å®šå…¶åç§°ã€‚<br>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŸºäº <code>employees</code> è¡¨çš„ç®€å•è§†å›¾ï¼Œæ˜¾ç¤ºå…¬å¸çš„ç»„ç»‡ç»“æ„ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> organization <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        CONCAT(E.lastname, E.firstname) <span class="keyword">AS</span> Employee,</span><br><span class="line">        CONCAT(M.lastname, M.firstname) <span class="keyword">AS</span> Manager</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees <span class="keyword">AS</span> E</span><br><span class="line">            <span class="keyword">INNER</span> <span class="keyword">JOIN</span></span><br><span class="line">        employees <span class="keyword">AS</span> M <span class="keyword">ON</span> M.employeeNumber <span class="operator">=</span> E.ReportsTo</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> Manager;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/18/163227be-e7a7-11eb-83d2-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="employees"><br>è¦æ˜¾ç¤ºè§†å›¾çš„å®šä¹‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>SHOW CREATE VIEW</code> è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> organization;</span><br></pre></td></tr></table></figure></p><h3 id="ä¿®æ”¹è§†å›¾"><a href="#ä¿®æ”¹è§†å›¾" class="headerlink" title="ä¿®æ”¹è§†å›¾"></a>ä¿®æ”¹è§†å›¾</h3><p>MySQL æä¾›ä¸¤ä¸ªè¯­å¥ï¼Œå…è®¸ä½ ä¿®æ”¹ç°æœ‰çš„è§†å›¾ï¼š<code>ALTER VIEW</code> å’Œ <code>CREATE OR REPLACE VIEW</code></p><h4 id="ä½¿ç”¨-ALTER-VIEW-è¯­å¥ä¿®æ”¹è§†å›¾"><a href="#ä½¿ç”¨-ALTER-VIEW-è¯­å¥ä¿®æ”¹è§†å›¾" class="headerlink" title="ä½¿ç”¨ ALTER VIEW è¯­å¥ä¿®æ”¹è§†å›¾"></a>ä½¿ç”¨ ALTER VIEW è¯­å¥ä¿®æ”¹è§†å›¾</h4><p>ä¸€æ—¦åˆ›å»ºäº†ä¸€ä¸ªè§†å›¾ï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>ALTER VIEW</code> è¯­å¥æ¥ä¿®æ”¹å®ƒã€‚<br><code>ALTER VIEW</code> è¯­å¥çš„è¯­æ³•ä¸ <code>CREATE VIEW</code> è¯­å¥ç›¸ä¼¼ï¼Œåªæ˜¯ <code>CREATE</code> å…³é”®å­—è¢« <code>ALTER</code> å…³é”®å­—æ‰€ä»£æ›¿ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span></span><br><span class="line"> [ALGORITHM <span class="operator">=</span>  &#123;<span class="keyword">MERGE</span> <span class="operator">|</span> TEMPTABLE <span class="operator">|</span> UNDEFINED&#125;]</span><br><span class="line">  <span class="keyword">VIEW</span> [database_name].  [view_name]</span><br><span class="line">   <span class="keyword">AS</span> </span><br><span class="line"> [<span class="keyword">SELECT</span>  statement]</span><br></pre></td></tr></table></figure><br>ä¸‹é¢çš„è¯­å¥é€šè¿‡æ·»åŠ  <code>email</code> åˆ—ä¿®æ”¹äº† <code>organization</code> è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> organization</span><br><span class="line">  <span class="keyword">AS</span> </span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(E.lastname,E.firstname) <span class="keyword">AS</span> Employee,</span><br><span class="line">         E.email <span class="keyword">AS</span>  employ<span class="operator">*</span><span class="operator">*</span>Example<span class="operator">*</span><span class="operator">*</span>mail,</span><br><span class="line">         CONCAT(M.lastname,M.firstname) <span class="keyword">AS</span> Manager</span><br><span class="line">  <span class="keyword">FROM</span> employees <span class="keyword">AS</span> E</span><br><span class="line">  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees <span class="keyword">AS</span> M</span><br><span class="line">    <span class="keyword">ON</span> M.employeeNumber <span class="operator">=</span> E.ReportsTo</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> Manager;</span><br></pre></td></tr></table></figure><br>ä¸ºäº†éªŒè¯è¿™ä¸€å˜åŒ–ï¼Œä½ å¯ä»¥ä» <code>organization</code> è§†å›¾ä¸­æŸ¥è¯¢æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Organization;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/18/64514948-e7a7-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="result"></p><h4 id="ä½¿ç”¨-CREATE-OR-REPLACE-VIEW-è¯­å¥ä¿®æ”¹è§†å›¾"><a href="#ä½¿ç”¨-CREATE-OR-REPLACE-VIEW-è¯­å¥ä¿®æ”¹è§†å›¾" class="headerlink" title="ä½¿ç”¨ CREATE OR REPLACE VIEW è¯­å¥ä¿®æ”¹è§†å›¾"></a>ä½¿ç”¨ CREATE OR REPLACE VIEW è¯­å¥ä¿®æ”¹è§†å›¾</h4><p>ä¸‹é¢çš„è¯­å¥ä½¿ç”¨ <code>CREATE OR REPLACE VIEW</code> è¯­æ³•æ¥åˆ›å»ºåŸºäº <code>employees</code> è¡¨çš„ <code>contacts</code> è§†å›¾ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> contacts <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        firstName, lastName, extension, email</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/18/9881a7a8-e7a7-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="create or replace"></p><p>å‡è®¾ä½ æƒ³åœ¨ <code>contacts</code> è§†å›¾ä¸­æ·»åŠ  <code>jobtitle</code> åˆ—ï¼Œä½ åªéœ€ä½¿ç”¨ä»¥ä¸‹è¯­å¥å³å¯ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> contacts <span class="keyword">AS</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        firstName, </span><br><span class="line">        lastName, </span><br><span class="line">        extension, </span><br><span class="line">        email, </span><br><span class="line">        jobtitle</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees;</span><br></pre></td></tr></table></figure><br><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/7/18/abb77e42-e7a7-11eb-9724-0242ac1d0002/%E5%9B%BE%E7%89%87.png" alt="create or replace"></p><h4 id="åˆ é™¤è§†å›¾"><a href="#åˆ é™¤è§†å›¾" class="headerlink" title="åˆ é™¤è§†å›¾"></a>åˆ é™¤è§†å›¾</h4><p>ä¸€æ—¦åˆ›å»ºäº†ä¸€ä¸ªè§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>DROP VIEW</code> è¯­å¥æ¥åˆ é™¤å®ƒã€‚ä¸‹é¢è¯´æ˜äº† <code>DROP VIEW</code> è¯­å¥çš„è¯­æ³•ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> [IF <span class="keyword">EXISTS</span>] [database_name].[view_name]</span><br></pre></td></tr></table></figure><br><code>IF EXISTS</code> æ˜¯è¯¥è¯­å¥çš„å¯é€‰å­å¥ï¼Œå®ƒå…è®¸ä½ æ£€æŸ¥è§†å›¾æ˜¯å¦å­˜åœ¨ã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ é¿å…åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„è§†å›¾çš„é”™è¯¯ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åˆ é™¤ç»„ç»‡è§†å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>DROP VIEW</code> è¯­å¥ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> IF <span class="keyword">EXISTS</span> organization;</span><br></pre></td></tr></table></figure></p><h1 id="å­˜å‚¨è¿‡ç¨‹"><a href="#å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹"></a>å­˜å‚¨è¿‡ç¨‹</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯ä¸€ç§åœ¨<code>æ•°æ®åº“ä¸­å­˜å‚¨å¤æ‚ç¨‹åºï¼Œä»¥ä¾¿å¤–éƒ¨ç¨‹åºè°ƒç”¨çš„ä¸€ç§æ•°æ®åº“å¯¹è±¡ã€‚</code><br>å­˜å‚¨è¿‡ç¨‹æ˜¯<code>ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQLè¯­å¥é›†</code>ï¼Œç»ç¼–è¯‘åˆ›å»ºå¹¶ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·å¯é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å®šå‚æ•°(éœ€è¦æ—¶)æ¥è°ƒç”¨æ‰§è¡Œã€‚<code>å­˜å‚¨è¿‡ç¨‹æ€æƒ³ä¸Šå¾ˆç®€å•ï¼Œå°±æ˜¯æ•°æ®åº“ SQL è¯­è¨€å±‚é¢çš„ä»£ç å°è£…ä¸é‡ç”¨</code>ã€‚</p><p><strong> ä¼˜ç‚¹</strong></p><ul><li>å­˜å‚¨è¿‡ç¨‹å¯å°è£…ï¼Œå¹¶éšè—å¤æ‚çš„å•†ä¸šé€»è¾‘ã€‚</li><li>å­˜å‚¨è¿‡ç¨‹å¯ä»¥å›ä¼ å€¼ï¼Œå¹¶å¯ä»¥æ¥å—å‚æ•°ã€‚</li><li>å­˜å‚¨è¿‡ç¨‹æ— æ³•ä½¿ç”¨ SELECT æŒ‡ä»¤æ¥è¿è¡Œï¼Œå› ä¸ºå®ƒæ˜¯å­ç¨‹åºï¼Œä¸æŸ¥çœ‹è¡¨ï¼Œæ•°æ®è¡¨æˆ–ç”¨æˆ·å®šä¹‰å‡½æ•°ä¸åŒã€‚</li><li>å­˜å‚¨è¿‡ç¨‹å¯ä»¥ç”¨åœ¨æ•°æ®æ£€éªŒï¼Œå¼ºåˆ¶å®è¡Œå•†ä¸šé€»è¾‘ç­‰ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li>å­˜å‚¨è¿‡ç¨‹ï¼Œå¾€å¾€å®šåˆ¶åŒ–äºç‰¹å®šçš„æ•°æ®åº“ä¸Šï¼Œå› ä¸ºæ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ä¸åŒã€‚å½“åˆ‡æ¢åˆ°å…¶ä»–å‚å•†çš„æ•°æ®åº“ç³»ç»Ÿæ—¶ï¼Œéœ€è¦é‡å†™åŸæœ‰çš„å­˜å‚¨è¿‡ç¨‹ã€‚</li><li>å­˜å‚¨è¿‡ç¨‹çš„æ€§èƒ½è°ƒæ ¡ä¸æ’°å†™ï¼Œå—é™äºå„ç§æ•°æ®åº“ç³»ç»Ÿã€‚</li></ul><h2 id="å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºå’Œè°ƒç”¨"><a href="#å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºå’Œè°ƒç”¨" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºå’Œè°ƒç”¨"></a>å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºå’Œè°ƒç”¨</h2><ul><li>å­˜å‚¨è¿‡ç¨‹å°±æ˜¯å…·æœ‰åå­—çš„ä¸€æ®µä»£ç ï¼Œç”¨æ¥å®Œæˆä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ã€‚</li><li>åˆ›å»ºçš„å­˜å‚¨è¿‡ç¨‹ä¿å­˜åœ¨æ•°æ®åº“çš„æ•°æ®å­—å…¸ä¸­ã€‚<h3 id="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</h3><strong>Gammar</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> </span><br><span class="line">[DEFINER <span class="operator">=</span> &#123; <span class="keyword">user</span> <span class="operator">|</span> <span class="built_in">CURRENT_USER</span> &#125;] ã€€</span><br><span class="line"><span class="keyword">PROCEDURE</span> sp_name ([proc_parameter[,...]]) </span><br><span class="line">[characteristic ...] routine_body</span><br><span class="line"></span><br><span class="line">proc_parameter: </span><br><span class="line">[ <span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">INOUT</span> ] param_name type</span><br><span class="line"></span><br><span class="line">characteristic: </span><br><span class="line">COMMENT <span class="string">&#x27;string&#x27;</span> </span><br><span class="line"><span class="operator">|</span> <span class="keyword">LANGUAGE</span> <span class="keyword">SQL</span> </span><br><span class="line"><span class="operator">|</span> [<span class="keyword">NOT</span>] <span class="keyword">DETERMINISTIC</span> </span><br><span class="line"><span class="operator">|</span> &#123; <span class="keyword">CONTAINS</span> <span class="keyword">SQL</span> </span><br><span class="line"><span class="operator">|</span> <span class="keyword">NO</span> <span class="keyword">SQL</span> </span><br><span class="line"><span class="operator">|</span> <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA </span><br><span class="line"><span class="operator">|</span> <span class="keyword">MODIFIES</span> <span class="keyword">SQL</span> DATA &#125; </span><br><span class="line"><span class="operator">|</span> <span class="keyword">SQL</span> SECURITY &#123; DEFINER <span class="operator">|</span> INVOKER &#125;</span><br><span class="line"></span><br><span class="line">routine_body: ã€€ã€€</span><br><span class="line">Valid <span class="keyword">SQL</span> routine statement </span><br><span class="line">[begin_label:] <span class="keyword">BEGIN</span> ã€€</span><br><span class="line">[statement_list] ã€€ã€€ã€€ã€€</span><br><span class="line">â€¦â€¦ </span><br><span class="line"><span class="keyword">END</span> [end_label]</span><br></pre></td></tr></table></figure></li></ul><p><strong>Example</strong><br>åˆ›å»ºæ•°æ®åº“ï¼Œå¤‡ä»½æ•°æ®è¡¨ç”¨äºç¤ºä¾‹æ“ä½œï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysqlcreate database db1; </span><br><span class="line">mysqluse db1; </span><br><span class="line">mysql<span class="keyword">create</span> <span class="keyword">table</span> PLAYERS <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> TENNIS.PLAYERS;</span><br><span class="line">mysql<span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">MATCHES</span> <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> TENNIS.MATCHES;</span><br></pre></td></tr></table></figure><br>ä¸‹é¢æ˜¯å­˜å‚¨è¿‡ç¨‹çš„ä¾‹å­ï¼Œåˆ é™¤ç»™å®šçƒå‘˜å‚åŠ çš„æ‰€æœ‰æ¯”èµ›ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysqldelimiter $$ã€€ã€€#å°†è¯­å¥çš„ç»“æŸç¬¦å·ä»åˆ†å·;ä¸´æ—¶æ”¹ä¸ºä¸¤ä¸ª$$(å¯ä»¥æ˜¯è‡ªå®šä¹‰) </span><br><span class="line">mysqlCREATE <span class="keyword">PROCEDURE</span> delete_matches(<span class="keyword">IN</span> p_playerno <span class="type">INTEGER</span>) </span><br><span class="line"><span class="operator">-</span><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="operator">-</span>ã€€ã€€<span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">MATCHES</span> </span><br><span class="line"><span class="operator">-</span>   <span class="keyword">WHERE</span> playerno <span class="operator">=</span> p_playerno; </span><br><span class="line"><span class="operator">-</span><span class="keyword">END</span>$$ </span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec) </span><br><span class="line"></span><br><span class="line">mysqldelimiter;ã€€ã€€#å°†è¯­å¥çš„ç»“æŸç¬¦å·æ¢å¤ä¸ºåˆ†å·</span><br></pre></td></tr></table></figure><br><strong>è§£æ</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œé»˜è®¤æ•°æ®åº“ç›¸å…³è”ï¼Œå¦‚æœæƒ³æŒ‡å®šå­˜å‚¨è¿‡ç¨‹åˆ›å»ºåœ¨æŸä¸ªç‰¹å®šçš„æ•°æ®åº“ä¸‹ï¼Œé‚£ä¹ˆåœ¨è¿‡ç¨‹åå‰é¢åŠ æ•°æ®åº“ååšå‰ç¼€ã€‚ åœ¨å®šä¹‰è¿‡ç¨‹æ—¶ï¼Œä½¿ç”¨ DELIMITER $$ å‘½ä»¤å°†è¯­å¥çš„ç»“æŸç¬¦å·ä»åˆ†å· ; ä¸´æ—¶æ”¹ä¸ºä¸¤ä¸ª $$ï¼Œä½¿å¾—è¿‡ç¨‹ä½“ä¸­ä½¿ç”¨çš„åˆ†å·è¢«ç›´æ¥ä¼ é€’åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ä¼šè¢«å®¢æˆ·ç«¯ï¼ˆå¦‚mysqlï¼‰è§£é‡Šã€‚</p><p><strong>è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼š</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> sp_name[(ä¼ å‚)];</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysqlselect <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">MATCHES</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="operator">|</span> MATCHNO <span class="operator">|</span> TEAMNO <span class="operator">|</span> PLAYERNO <span class="operator">|</span> WON <span class="operator">|</span> LOST <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">6</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">7</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">57</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">0</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">8</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">8</span> <span class="operator">|</span> <span class="number">0</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">9</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">27</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">11</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">112</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec) </span><br><span class="line"></span><br><span class="line">mysqlcall delete_matches(<span class="number">57</span>); </span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.03</span> sec) </span><br><span class="line">mysqlselect <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">MATCHES</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="operator">|</span> MATCHNO <span class="operator">|</span> TEAMNO <span class="operator">|</span> PLAYERNO <span class="operator">|</span> WON <span class="operator">|</span> LOST <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">6</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">8</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="number">8</span> <span class="operator">|</span> <span class="number">0</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">9</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">27</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="number">11</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">112</span> <span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+----------+-----+------+ </span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong>è§£æ</strong>ï¼šåœ¨å­˜å‚¨è¿‡ç¨‹ä¸­è®¾ç½®äº†éœ€è¦ä¼ å‚çš„å˜é‡p_playernoï¼Œè°ƒç”¨å­˜å‚¨è¿‡ç¨‹çš„æ—¶å€™ï¼Œé€šè¿‡ä¼ å‚å°†57èµ‹å€¼ç»™p_playernoï¼Œç„¶åè¿›è¡Œå­˜å‚¨è¿‡ç¨‹é‡Œçš„SQLæ“ä½œã€‚</p><p><strong>å­˜å‚¨è¿‡ç¨‹ä½“</strong></p><ul><li>å­˜å‚¨è¿‡ç¨‹ä½“åŒ…å«äº†åœ¨è¿‡ç¨‹è°ƒç”¨æ—¶å¿…é¡»æ‰§è¡Œçš„è¯­å¥ï¼Œä¾‹å¦‚ï¼šdmlã€ddlè¯­å¥ï¼Œif-then-elseå’Œwhile-doè¯­å¥ã€å£°æ˜å˜é‡çš„declareè¯­å¥ç­‰</li><li>è¿‡ç¨‹ä½“æ ¼å¼ï¼šä»¥beginå¼€å§‹ï¼Œä»¥endç»“æŸ(å¯åµŒå¥—)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">ã€€ã€€<span class="keyword">BEGIN</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="keyword">BEGIN</span></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€statements; </span><br><span class="line">ã€€ã€€ã€€ã€€<span class="keyword">END</span></span><br><span class="line">ã€€ã€€<span class="keyword">END</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--example</span></span><br><span class="line">label1: <span class="keyword">BEGIN</span> ã€€ã€€</span><br><span class="line">label2: <span class="keyword">BEGIN</span> ã€€ã€€ã€€ã€€</span><br><span class="line">label3: <span class="keyword">BEGIN</span> ã€€ã€€ã€€ã€€ã€€ã€€</span><br><span class="line">statements; ã€€ã€€ã€€ã€€</span><br><span class="line"><span class="keyword">END</span> label3 ; ã€€ã€€</span><br><span class="line"><span class="keyword">END</span> label2; </span><br><span class="line"><span class="keyword">END</span> label1</span><br></pre></td></tr></table></figure>æ ‡ç­¾æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</li><li>1ã€å¢å¼ºä»£ç çš„å¯è¯»æ€§</li><li>2ã€åœ¨æŸäº›è¯­å¥(ä¾‹å¦‚:leaveå’Œiterateè¯­å¥)ï¼Œéœ€è¦ç”¨åˆ°æ ‡ç­¾</li></ul><h2 id="å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°"><a href="#å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°"></a>å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°</h2><p>MySQLå­˜å‚¨è¿‡ç¨‹çš„å‚æ•°ç”¨åœ¨å­˜å‚¨è¿‡ç¨‹çš„å®šä¹‰ï¼Œå…±æœ‰ä¸‰ç§å‚æ•°ç±»å‹,IN,OUT,INOUT,å½¢å¼å¦‚ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> å­˜å‚¨è¿‡ç¨‹å([[<span class="keyword">IN</span> <span class="operator">|</span><span class="keyword">OUT</span> <span class="operator">|</span><span class="keyword">INOUT</span> ] å‚æ•°å æ•°æ®ç±»å½¢...])</span><br></pre></td></tr></table></figure></p><ul><li>IN è¾“å…¥å‚æ•°ï¼šè¡¨ç¤ºè°ƒç”¨è€…å‘è¿‡ç¨‹ä¼ å…¥å€¼ï¼ˆä¼ å…¥å€¼å¯ä»¥æ˜¯å­—é¢é‡æˆ–å˜é‡ï¼‰</li><li>OUT è¾“å‡ºå‚æ•°ï¼šè¡¨ç¤ºè¿‡ç¨‹å‘è°ƒç”¨è€…ä¼ å‡ºå€¼(å¯ä»¥è¿”å›å¤šä¸ªå€¼)ï¼ˆä¼ å‡ºå€¼åªèƒ½æ˜¯å˜é‡ï¼‰</li><li>INOUT è¾“å…¥è¾“å‡ºå‚æ•°ï¼šæ—¢è¡¨ç¤ºè°ƒç”¨è€…å‘è¿‡ç¨‹ä¼ å…¥å€¼ï¼Œåˆè¡¨ç¤ºè¿‡ç¨‹å‘è°ƒç”¨è€…ä¼ å‡ºå€¼ï¼ˆå€¼åªèƒ½æ˜¯å˜é‡ï¼‰<h3 id="inè¾“å…¥å‚æ•°"><a href="#inè¾“å…¥å‚æ•°" class="headerlink" title="inè¾“å…¥å‚æ•°"></a>inè¾“å…¥å‚æ•°</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysqldelimiter $$ </span><br><span class="line">mysql <span class="keyword">create</span> <span class="keyword">procedure</span> in_param(<span class="keyword">in</span> p_in <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">select</span> p_in; </span><br><span class="line"><span class="keyword">set</span> p_in<span class="operator">=</span><span class="number">2</span>; </span><br><span class="line"><span class="keyword">select</span> P_in; </span><br><span class="line"><span class="keyword">end</span>$$ </span><br><span class="line">mysql<span class="operator">&gt;</span> delimiter ; </span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="variable">@p</span>_in<span class="operator">=</span><span class="number">1</span>; </span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">call</span> in_param(<span class="variable">@p</span>_in); </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> p_in <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> P_in <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="variable">@p</span>_in; </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@p</span>_in <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br></pre></td></tr></table></figure>ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œp_in åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ï¼Œä½†å¹¶ä¸å½±å“ <strong>@p_in</strong> çš„å€¼ï¼Œå› ä¸ºå‰è€…ä¸ºå±€éƒ¨å˜é‡ã€åè€…ä¸ºå…¨å±€å˜é‡ã€‚<h3 id="outè¾“å‡ºå‚æ•°"><a href="#outè¾“å‡ºå‚æ•°" class="headerlink" title="outè¾“å‡ºå‚æ•°"></a>outè¾“å‡ºå‚æ•°</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> delimiter <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">mysql<span class="operator">&gt;</span>  <span class="keyword">create</span> <span class="keyword">procedure</span> out_param(<span class="keyword">out</span> p_out <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">select</span> p_out; </span><br><span class="line"><span class="keyword">set</span> p_out<span class="operator">=</span><span class="number">2</span>; </span><br><span class="line"><span class="keyword">select</span> p_out; </span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">mysql<span class="operator">&gt;</span> delimiter ; </span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="variable">@p</span>_out<span class="operator">=</span><span class="number">1</span>; </span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">call</span> out_param(<span class="variable">@p</span>_out); </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> p_out <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ ã€€ã€€</span></span><br><span class="line">#å› ä¸º<span class="keyword">out</span>æ˜¯å‘è°ƒç”¨è€…è¾“å‡ºå‚æ•°ï¼Œä¸æ¥æ”¶è¾“å…¥çš„å‚æ•°ï¼Œæ‰€ä»¥å­˜å‚¨è¿‡ç¨‹é‡Œçš„p_outä¸º<span class="keyword">null</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> p_out <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+ </span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="variable">@p</span>_out; </span><br><span class="line"><span class="operator">+</span><span class="comment">--------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@p</span>_out <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">--------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">--------+ ã€€ã€€</span></span><br><span class="line">#è°ƒç”¨äº†out_paramå­˜å‚¨è¿‡ç¨‹ï¼Œè¾“å‡ºå‚æ•°ï¼Œæ”¹å˜äº†p_outå˜é‡çš„å€¼</span><br></pre></td></tr></table></figure><h3 id="inoutè¾“å…¥å‚æ•°"><a href="#inoutè¾“å…¥å‚æ•°" class="headerlink" title="inoutè¾“å…¥å‚æ•°"></a>inoutè¾“å…¥å‚æ•°</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> delimiter $$ </span><br><span class="line">mysql<span class="operator">&gt;</span>  <span class="keyword">create</span> <span class="keyword">procedure</span> inout_param(<span class="keyword">inout</span> p_inout <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">select</span> p_inout; </span><br><span class="line"><span class="keyword">set</span> p_inout<span class="operator">=</span><span class="number">2</span>; </span><br><span class="line"><span class="keyword">select</span> p_inout; </span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line">$$ </span><br><span class="line">mysql<span class="operator">&gt;</span> delimiter ; </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="variable">@p</span>_inout<span class="operator">=</span><span class="number">1</span>; </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">call</span> inout_param(<span class="variable">@p</span>_inout); </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"><span class="operator">|</span> p_inout <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"><span class="operator">|</span> p_inout <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------+ </span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="variable">@p</span>_inout; </span><br><span class="line"><span class="operator">+</span><span class="comment">----------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@p</span>_inout <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">----------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">----------+ </span></span><br><span class="line">#è°ƒç”¨äº†inout_paramå­˜å‚¨è¿‡ç¨‹ï¼Œæ¥å—äº†è¾“å…¥çš„å‚æ•°ï¼Œä¹Ÿè¾“å‡ºå‚æ•°ï¼Œæ”¹å˜äº†å˜é‡</span><br></pre></td></tr></table></figure><strong>æ³¨æ„ï¼š</strong><br>1ã€å¦‚æœè¿‡ç¨‹æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¿…é¡»åœ¨è¿‡ç¨‹ååé¢å†™ä¸Šå°æ‹¬å·ä¾‹ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> sp_name ([proc_parameter[,...]]) â€¦â€¦</span><br></pre></td></tr></table></figure>2ã€ç¡®ä¿å‚æ•°çš„åå­—ä¸ç­‰äºåˆ—çš„åå­—ï¼Œå¦åˆ™åœ¨è¿‡ç¨‹ä½“ä¸­ï¼Œå‚æ•°åè¢«å½“åšåˆ—åæ¥å¤„ç†<br><strong>å»ºè®®ï¼š</strong></li><li>è¾“å…¥å€¼ä½¿ç”¨inå‚æ•°ã€‚</li><li>è¿”å›å€¼ä½¿ç”¨outå‚æ•°ã€‚</li><li>inoutå‚æ•°å°±å°½é‡çš„å°‘ç”¨ã€‚</li></ul><h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><h3 id="å˜é‡å®šä¹‰"><a href="#å˜é‡å®šä¹‰" class="headerlink" title="å˜é‡å®šä¹‰"></a>å˜é‡å®šä¹‰</h3><p>å±€éƒ¨å˜é‡å£°æ˜ä¸€å®šè¦æ”¾åœ¨å­˜å‚¨è¿‡ç¨‹ä½“çš„å¼€å§‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> variable_name [,variable_name...] datatype [<span class="keyword">DEFAULT</span> <span class="keyword">value</span>];</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼Œdatatype ä¸º MySQL çš„æ•°æ®ç±»å‹ï¼Œå¦‚: int, float, date,varchar(length)<br>ä¾‹å¦‚:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> l_int <span class="type">int</span> unsigned <span class="keyword">default</span> <span class="number">4000000</span>; </span><br><span class="line"><span class="keyword">DECLARE</span> l_numeric number(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">9.95</span>; </span><br><span class="line"><span class="keyword">DECLARE</span> l_date <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1999-12-31&#x27;</span>; </span><br><span class="line"><span class="keyword">DECLARE</span> l_datetime datetime <span class="keyword">DEFAULT</span> <span class="string">&#x27;1999-12-31 23:59:59&#x27;</span>; <span class="keyword">DECLARE</span> l_varchar <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;This will not be padded&#x27;</span>;</span><br></pre></td></tr></table></figure></p><h3 id="å˜é‡èµ‹å€¼"><a href="#å˜é‡èµ‹å€¼" class="headerlink" title="å˜é‡èµ‹å€¼"></a>å˜é‡èµ‹å€¼</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> å˜é‡å <span class="operator">=</span> è¡¨è¾¾å¼å€¼ [,variable_name <span class="operator">=</span> expression ...]</span><br></pre></td></tr></table></figure><h3 id="ç”¨æˆ·å˜é‡"><a href="#ç”¨æˆ·å˜é‡" class="headerlink" title="ç”¨æˆ·å˜é‡"></a>ç”¨æˆ·å˜é‡</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;Hello World&#x27;</span> <span class="keyword">into</span> <span class="variable">@x</span>; </span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@x</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@x</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+ </span></span><br><span class="line"><span class="operator">|</span> Hello World <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@y</span><span class="operator">=</span><span class="string">&#x27;Goodbye Cruel World&#x27;</span>; </span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@y</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@y</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+ </span></span><br><span class="line"><span class="operator">|</span> Goodbye Cruel World <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+ </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@z</span><span class="operator">=</span><span class="number">1</span><span class="operator">+</span><span class="number">2</span><span class="operator">+</span><span class="number">3</span>; </span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@z</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="variable">@z</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="number">6</span> <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br></pre></td></tr></table></figure><p>åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ä½¿ç”¨ç”¨æˆ·å˜é‡<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> GreetWorld( ) </span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="variable">@greeting</span>,<span class="string">&#x27; World&#x27;</span>); </span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@greeting</span><span class="operator">=</span><span class="string">&#x27;Hello&#x27;</span>; </span><br><span class="line"><span class="keyword">CALL</span> GreetWorld( ); </span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+ </span></span><br><span class="line"><span class="operator">|</span> CONCAT(<span class="variable">@greeting</span>,<span class="string">&#x27; World&#x27;</span>) <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+ </span></span><br><span class="line"><span class="operator">|</span> Hello World <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br></pre></td></tr></table></figure><br>åœ¨å­˜å‚¨è¿‡ç¨‹é—´ä¼ é€’å…¨å±€èŒƒå›´çš„ç”¨æˆ·å˜é‡<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p1()</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@last</span>_procedure<span class="operator">=</span><span class="string">&#x27;p1&#x27;</span>; </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p2() </span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Last procedure was &#x27;</span>,<span class="variable">@last</span>_procedure); </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CALL</span> p1( ); mysql<span class="operator">&gt;</span> <span class="keyword">CALL</span> p2( ); </span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------------------------+ </span></span><br><span class="line"><span class="operator">|</span> CONCAT(<span class="string">&#x27;Last procedure was &#x27;</span>,<span class="variable">@last</span>_proc <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------------------------+ </span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Last</span> <span class="keyword">procedure</span> was p1 <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------------------------+</span></span><br></pre></td></tr></table></figure><br><strong>æ³¨æ„:</strong></p><ul><li>1ã€ç”¨æˆ·å˜é‡åä¸€èˆ¬ä»¥@å¼€å¤´</li><li>2ã€æ»¥ç”¨ç”¨æˆ·å˜é‡ä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥ç†è§£åŠç®¡ç†</li></ul><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>MySQL å­˜å‚¨è¿‡ç¨‹å¯ä½¿ç”¨ä¸¤ç§é£æ ¼çš„æ³¨é‡Š</p><ul><li>ä¸¤ä¸ªæ¨ªæ†<code>--</code>ï¼šè¯¥é£æ ¼ä¸€èˆ¬ç”¨äºå•è¡Œæ³¨é‡Šã€‚</li><li><strong>c é£æ ¼</strong>ï¼š ä¸€èˆ¬ç”¨äºå¤šè¡Œæ³¨é‡Šã€‚<h3 id="MySQLå­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨"><a href="#MySQLå­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨" class="headerlink" title="MySQLå­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨"></a>MySQLå­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨</h3>ç”¨callå’Œä½ è¿‡ç¨‹åä»¥åŠä¸€ä¸ªæ‹¬å·ï¼Œæ‹¬å·é‡Œé¢æ ¹æ®éœ€è¦ï¼ŒåŠ å…¥å‚æ•°ï¼Œå‚æ•°åŒ…æ‹¬è¾“å…¥å‚æ•°ã€è¾“å‡ºå‚æ•°ã€è¾“å…¥è¾“å‡ºå‚æ•°ã€‚å…·ä½“çš„è°ƒç”¨æ–¹æ³•å¯ä»¥å‚çœ‹ä¸Šé¢çš„ä¾‹å­ã€‚<h3 id="MySQLå­˜å‚¨è¿‡ç¨‹çš„æŸ¥è¯¢"><a href="#MySQLå­˜å‚¨è¿‡ç¨‹çš„æŸ¥è¯¢" class="headerlink" title="MySQLå­˜å‚¨è¿‡ç¨‹çš„æŸ¥è¯¢"></a>MySQLå­˜å‚¨è¿‡ç¨‹çš„æŸ¥è¯¢</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> mysql.proc <span class="keyword">where</span> db<span class="operator">=</span><span class="string">&#x27;æ•°æ®åº“å&#x27;</span>;</span><br><span class="line"><span class="comment">--æˆ–è€…</span></span><br><span class="line"><span class="keyword">select</span> routine_name <span class="keyword">from</span> information_schema.routines <span class="keyword">where</span> routine_schema<span class="operator">=</span><span class="string">&#x27;æ•°æ®åº“å&#x27;</span>;</span><br><span class="line"><span class="comment">--æˆ–è€…</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">procedure</span> status <span class="keyword">where</span> db<span class="operator">=</span><span class="string">&#x27;æ•°æ®åº“å&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> æ•°æ®åº“.å­˜å‚¨è¿‡ç¨‹å;</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥æŸ¥çœ‹å½“å‰å­˜å‚¨è¿‡ç¨‹çš„è¯¦ç»†</p><h3 id="MySQLå­˜å‚¨è¿‡ç¨‹çš„ä¿®æ”¹"><a href="#MySQLå­˜å‚¨è¿‡ç¨‹çš„ä¿®æ”¹" class="headerlink" title="MySQLå­˜å‚¨è¿‡ç¨‹çš„ä¿®æ”¹"></a>MySQLå­˜å‚¨è¿‡ç¨‹çš„ä¿®æ”¹</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span></span><br></pre></td></tr></table></figure><h3 id="MySQLå­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤"><a href="#MySQLå­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤" class="headerlink" title="MySQLå­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤"></a>MySQLå­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span></span><br></pre></td></tr></table></figure><h3 id="MySQLå­˜å‚¨è¿‡ç¨‹çš„æ§åˆ¶è¯­å¥"><a href="#MySQLå­˜å‚¨è¿‡ç¨‹çš„æ§åˆ¶è¯­å¥" class="headerlink" title="MySQLå­˜å‚¨è¿‡ç¨‹çš„æ§åˆ¶è¯­å¥"></a>MySQLå­˜å‚¨è¿‡ç¨‹çš„æ§åˆ¶è¯­å¥</h3><h4 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h4><p><code>å†…éƒ¨çš„å˜é‡</code>åœ¨å…¶<code>ä½œç”¨åŸŸèŒƒå›´å†…äº«æœ‰æ›´é«˜çš„ä¼˜å…ˆæƒ</code>ï¼Œå½“æ‰§è¡Œåˆ° endã€‚å˜é‡æ—¶ï¼Œå†…éƒ¨å˜é‡æ¶ˆå¤±ï¼Œæ­¤æ—¶å·²ç»åœ¨å…¶ä½œç”¨åŸŸå¤–ï¼Œå˜é‡ä¸å†å¯è§äº†ï¼Œåº”ä¸ºåœ¨å­˜å‚¨è¿‡ç¨‹å¤–å†ä¹Ÿä¸èƒ½æ‰¾åˆ°è¿™ä¸ªç”³æ˜çš„å˜é‡ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ out å‚æ•°æˆ–è€…å°†å…¶å€¼æŒ‡æ´¾ç»™ä¼šè¯å˜é‡æ¥ä¿å­˜å…¶å€¼ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc3() </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> x1 <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">default</span> <span class="string">&#x27;outer&#x27;</span>; </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> x1 <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">default</span> <span class="string">&#x27;inner&#x27;</span>; </span><br><span class="line"><span class="keyword">select</span> x1; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="keyword">select</span> x1; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h4 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h4><h5 id="if-then-else"><a href="#if-then-else" class="headerlink" title="if-then-else"></a>if-then-else</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc2(<span class="keyword">IN</span> <span class="keyword">parameter</span> <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> var <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> var<span class="operator">=</span><span class="keyword">parameter</span><span class="operator">+</span><span class="number">1</span>; </span><br><span class="line">if var<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(<span class="number">17</span>);</span><br><span class="line"><span class="keyword">end</span> if; </span><br><span class="line">if <span class="keyword">parameter</span><span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">update</span> t <span class="keyword">set</span> s1<span class="operator">=</span>s1<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="keyword">update</span> t <span class="keyword">set</span> s1<span class="operator">=</span>s1<span class="operator">+</span><span class="number">2</span>; </span><br><span class="line"><span class="keyword">end</span> if; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><h5 id="caseè¯­å¥"><a href="#caseè¯­å¥" class="headerlink" title="caseè¯­å¥"></a>caseè¯­å¥</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc3 (<span class="keyword">in</span> <span class="keyword">parameter</span> <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span> var <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> var<span class="operator">=</span><span class="keyword">parameter</span><span class="operator">+</span><span class="number">1</span>; </span><br><span class="line"><span class="keyword">case</span> var </span><br><span class="line"><span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(<span class="number">17</span>); </span><br><span class="line"><span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(<span class="number">18</span>); </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(<span class="number">19</span>); </span><br><span class="line"><span class="keyword">end</span> <span class="keyword">case</span>; <span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> DELIMITER ; </span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> var<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(<span class="number">30</span>); </span><br><span class="line"><span class="keyword">when</span> var<span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">when</span> var<span class="operator">&lt;</span><span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="keyword">end</span> <span class="keyword">case</span></span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h4><h5 id="while-â€¦â€¦-end-while"><a href="#while-â€¦â€¦-end-while" class="headerlink" title="while â€¦â€¦ end while"></a>while â€¦â€¦ end while</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc4() </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> var <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> var<span class="operator">=</span><span class="number">0</span>; </span><br><span class="line">while var<span class="operator">&lt;</span><span class="number">6</span> do </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(var); </span><br><span class="line"><span class="keyword">set</span> var<span class="operator">=</span>var<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line"><span class="keyword">end</span> while; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while æ¡ä»¶ do</span><br><span class="line">    <span class="comment">--å¾ªç¯ä½“</span></span><br><span class="line">endwhile</span><br></pre></td></tr></table></figure><h5 id="repeatâ€¦â€¦end-repeat"><a href="#repeatâ€¦â€¦end-repeat" class="headerlink" title="repeatâ€¦â€¦end repeat"></a>repeatâ€¦â€¦end repeat</h5><p>å®ƒåœ¨æ‰§è¡Œæ“ä½œåæ£€æŸ¥ç»“æœï¼Œè€Œ while åˆ™æ˜¯æ‰§è¡Œå‰è¿›è¡Œæ£€æŸ¥ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc5 () </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> v <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span><span class="number">0</span>; </span><br><span class="line">repeat </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(v); </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span>v<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line">until v<span class="operator">&gt;=</span><span class="number">5</span> </span><br><span class="line"><span class="keyword">end</span> repeat; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">repeat</span><br><span class="line">    <span class="comment">--å¾ªç¯ä½“</span></span><br><span class="line">until å¾ªç¯æ¡ä»¶  </span><br><span class="line"><span class="keyword">end</span> repeat;</span><br></pre></td></tr></table></figure><h5 id="loop-â€¦â€¦-end-loop"><a href="#loop-â€¦â€¦-end-loop" class="headerlink" title="loop â€¦â€¦ end loop"></a>loop â€¦â€¦ end loop</h5><p>loop å¾ªç¯ä¸éœ€è¦åˆå§‹æ¡ä»¶ï¼Œè¿™ç‚¹å’Œ while å¾ªç¯ç›¸ä¼¼ï¼ŒåŒæ—¶å’Œ repeat å¾ªç¯ä¸€æ ·ä¸éœ€è¦ç»“æŸæ¡ä»¶, leave è¯­å¥çš„æ„ä¹‰æ˜¯ç¦»å¼€å¾ªç¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc6 () </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">declare</span> v <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span><span class="number">0</span>; </span><br><span class="line">LOOP_LABLE:loop </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(v); </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span>v<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line">if v <span class="operator">&gt;=</span><span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">leave LOOP_LABLE;</span><br><span class="line"><span class="keyword">end</span> if; </span><br><span class="line"><span class="keyword">end</span> loop; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure></p><h5 id="LABLESæ ‡å·"><a href="#LABLESæ ‡å·" class="headerlink" title="LABLESæ ‡å·"></a>LABLESæ ‡å·</h5><p>æ ‡å·å¯ä»¥ç”¨åœ¨ begin repeat while æˆ–è€… loop è¯­å¥å‰ï¼Œè¯­å¥æ ‡å·åªèƒ½åœ¨åˆæ³•çš„è¯­å¥å‰é¢ä½¿ç”¨ã€‚å¯ä»¥è·³å‡ºå¾ªç¯ï¼Œä½¿è¿è¡ŒæŒ‡ä»¤è¾¾åˆ°å¤åˆè¯­å¥çš„æœ€åä¸€æ­¥ã€‚</p><h4 id="ITERATEè¿­ä»£"><a href="#ITERATEè¿­ä»£" class="headerlink" title="ITERATEè¿­ä»£"></a>ITERATEè¿­ä»£</h4><p>ITERATE é€šè¿‡å¼•ç”¨å¤åˆè¯­å¥çš„æ ‡å·,æ¥ä»æ–°å¼€å§‹å¤åˆè¯­å¥:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span> </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc10 () </span><br><span class="line"><span class="keyword">begin</span> <span class="keyword">declare</span> v <span class="type">int</span>; </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span><span class="number">0</span>; </span><br><span class="line">LOOP_LABLE:loop </span><br><span class="line">if v<span class="operator">=</span><span class="number">3</span> <span class="keyword">then</span> </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span>v<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line">ITERATE LOOP_LABLE; </span><br><span class="line"><span class="keyword">end</span> if; </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t <span class="keyword">values</span>(v); </span><br><span class="line"><span class="keyword">set</span> v<span class="operator">=</span>v<span class="operator">+</span><span class="number">1</span>; </span><br><span class="line">if v<span class="operator">&gt;=</span><span class="number">5</span> <span class="keyword">then</span> </span><br><span class="line">leave LOOP_LABLE; </span><br><span class="line"><span class="keyword">end</span> if; </span><br><span class="line"><span class="keyword">end</span> loop; </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> </span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><br><a href="https://www.lintcode.com/">å‚è€ƒ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> sql </tag>
            
            <tag> è§†å›¾ </tag>
            
            <tag> è§¦å‘å™¨ </tag>
            
            <tag> MySQLé” </tag>
            
            <tag> Mysqäº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLåŸºç¡€</title>
      <link href="/2022/04/28/SQL/"/>
      <url>/2022/04/28/SQL/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="SQLåŸºç¡€"><a href="#SQLåŸºç¡€" class="headerlink" title="SQLåŸºç¡€"></a>SQLåŸºç¡€</h1><h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><blockquote><p>åŸºæœ¬è¯­æ³•</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨<code>DISTINCT</code>ä½¿æŸ¥è¯¢ä¸é‡å¤<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> `column_name`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br></pre></td></tr></table></figure></p><p><code>SELECT WHERE</code> è¯­å¥æ˜¯ç­›é€‰æŸ¥è¯¢å¾ˆé‡è¦çš„æ“ä½œï¼Œ<code>WHERE</code> å…³é”®å­—åé¢åŠ ä¸Šæ¡ä»¶å¯ä»¥è¿‡æ»¤æ‰æˆ‘ä»¬ä¸éœ€è¦çš„ä¿¡æ¯ï¼Œå¯¹æŸ¥è¯¢æ•ˆç‡æœ‰ç€å¾ˆå¤§çš„æé«˜ã€‚<br>åœ¨ä½¿ç”¨ <code>SELECT WHERE</code> è¯­å¥æ£€ç´¢è¡¨æ•°æ®æ—¶ï¼Œéœ€è¦ç»™å‡ºæ£€ç´¢çš„è¡¨å (table_name)ã€æ£€ç´¢çš„åˆ—å (column_name) å’Œæ“ä½œç¬¦ (operator) ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name1`,`column_name2`â€¦</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` operator `<span class="keyword">value</span>`;</span><br></pre></td></tr></table></figure><ul><li>column_name å¯¹åº”æŒ‡å®šåˆ—çš„åç§°ï¼Œæˆ–è€…æ˜¯å¤šåˆ—ï¼Œç”¨é€—å·ï¼ˆ <code>,</code> ï¼‰åˆ†éš”å¼€</li><li>table_name å¯¹åº”æŸ¥è¯¢è¡¨çš„åç§°</li><li><p>operator ä¸ºæ“ä½œç¬¦![[sqlæ¡ä»¶è¿ç®—#æ¯”è¾ƒè¿ç®—ç¬¦]]ï¼Œå¸¸ç”¨çš„æœ‰ç­‰äº <code>=</code> ã€å°äº <code>&lt;</code> ã€å¤§äº <code>&gt;</code> ã€ä¸ç­‰äº<code>&lt;&gt;</code> æˆ– <code>!=</code>ã€‚</p><blockquote><p>selectåé¢è¦è¾“å‡ºçš„ä¿¡æ¯å¦‚æœæ˜¯å…¨éƒ¨ä¿¡æ¯å°±è·Ÿ*å°±å¯ä»¥ï¼Œ fromåéƒ½æ˜¯è·Ÿä¸Šæ¥è‡ªå“ªä¸ªè¡¨ whereå°±æ˜¯åé¢è·Ÿçš„å°±æ˜¯æ¡ä»¶ï¼Œè®°å¾—éæ•°å­—çš„åŠ ä¸Šå•å¼•å·å°±å¯ä»¥äº†ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span><span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;Artificial Intelligence&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><blockquote><p><strong>INSERT INTO</strong> è¯­å¥ç”¨äºå‘è¡¨ä¸­æ’å…¥æ–°è®°å½•ï¼Œè¿™è¾¹ä»‹ç»ä¸¤ç§ç¼–å†™å½¢å¼ï¼Œç¬¬ä¸€ç§å½¢å¼æ— éœ€æŒ‡å®šåˆ—åï¼Œç¬¬äºŒç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—åã€‚</p></blockquote><h3 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h3><blockquote><p>ç¬¬ä¸€ç§å½¢å¼ï¼Œ<code>ä¸éœ€è¦æŒ‡å®šåˆ—å</code>ã€‚åªéœ€æä¾›æ’å…¥çš„æ•°æ®å³å¯ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `table_name`</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3,...);</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` <span class="keyword">VALUES</span> (<span class="number">13</span>,<span class="string">&#x27;Python&#x27;</span>,<span class="string">&#x27;400&#x27;</span>,<span class="string">&#x27;2021-05-23&#x27;</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒç§æ–¹å¼"><a href="#ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼"></a>ç¬¬äºŒç§æ–¹å¼</h3><blockquote><p>è¿™ç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—åï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `table_name`</span><br><span class="line">(`column1`, `column2`, `column3`,...)</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3,...);</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (`name`, `student_count`, `created_at`, `teacher_id`) <span class="keyword">VALUES</span> (<span class="string">&#x27;Flash Sale&#x27;</span>,<span class="string">&#x27;100&#x27;</span>,<span class="string">&#x27;2018-01-01&#x27;</span>,<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><blockquote><p>åŸºæœ¬è¯­æ³•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `table_name`</span><br><span class="line"><span class="keyword">SET</span> `column1`<span class="operator">=</span>value1,`column2`<span class="operator">=</span>value2,...</span><br><span class="line"><span class="keyword">WHERE</span> `some_column`<span class="operator">=</span>some_value;</span><br></pre></td></tr></table></figure></p></blockquote><h4 id="å®ä¾‹-2"><a href="#å®ä¾‹-2" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `teachers`</span><br><span class="line"><span class="keyword">SET</span> `email` <span class="operator">=</span> <span class="string">&#x27;LinghuChong@lintcode.com&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Linghu Chong&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><blockquote><p>åŸºæœ¬è¯­æ³•</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `some_column` <span class="operator">=</span> `some_value`;</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹-3"><a href="#å®ä¾‹-3" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `courses` <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;Dynamic Programming&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">truncate</span> courses;</span><br></pre></td></tr></table></figure><h4 id="deleteå’Œtruncateçš„åŒºåˆ«"><a href="#deleteå’Œtruncateçš„åŒºåˆ«" class="headerlink" title="deleteå’Œtruncateçš„åŒºåˆ«"></a>deleteå’Œtruncateçš„åŒºåˆ«</h4><p>1ã€åœ¨åŠŸèƒ½ä¸Šï¼Œtruncateæ˜¯æ¸…ç©ºä¸€ä¸ªè¡¨çš„å†…å®¹ï¼Œå®ƒç›¸å½“äºdelete from table_nameã€‚<br>2ã€deleteæ˜¯dmlæ“ä½œï¼Œtruncateæ˜¯ddlæ“ä½œï¼›å› æ­¤ï¼Œç”¨deleteåˆ é™¤æ•´ä¸ªè¡¨çš„æ•°æ®æ—¶ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„roolbackï¼Œå ç”¨å¾ˆå¤šçš„rollback segmentsï¼Œ è€Œtruncateä¸ä¼šã€‚<br>3ã€åœ¨å†…å­˜ä¸­ï¼Œç”¨deleteåˆ é™¤æ•°æ®ï¼Œè¡¨ç©ºé—´ä¸­å…¶è¢«åˆ é™¤æ•°æ®çš„è¡¨å ç”¨çš„ç©ºé—´è¿˜åœ¨ï¼Œä¾¿äºä»¥åçš„ä½¿ç”¨ï¼Œå¦å¤–å®ƒæ˜¯â€œå‡ç›¸â€çš„åˆ é™¤ï¼Œç›¸å½“äºwindowsä¸­ç”¨deleteåˆ é™¤æ•°æ®æ˜¯æŠŠæ•°æ®æ”¾åˆ°å›æ”¶ç«™ä¸­ï¼Œè¿˜å¯ä»¥æ¢å¤ï¼Œå½“ç„¶å¦‚æœè¿™ä¸ªæ—¶å€™é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼ˆOSæˆ–è€…RDBMSï¼‰ï¼Œå®ƒä¹Ÿå°±ä¸èƒ½æ¢å¤äº†ï¼<br>è€Œç”¨truncateæ¸…é™¤æ•°æ®ï¼Œå†…å­˜ä¸­è¡¨ç©ºé—´ä¸­å…¶è¢«åˆ é™¤æ•°æ®çš„è¡¨å ç”¨çš„ç©ºé—´ä¼šè¢«ç«‹å³é‡Šæ”¾ï¼Œç›¸å½“äºwindowsä¸­ç”¨shift+deleteåˆ é™¤æ•°æ®ï¼Œä¸èƒ½å¤Ÿæ¢å¤ï¼<br>4ã€truncate è°ƒæ•´high water mark è€Œdeleteä¸ï¼›truncateä¹‹åï¼ŒTABLEçš„HWMé€€å›åˆ° INITIALå’ŒNEXTçš„ä½ç½®ï¼ˆé»˜è®¤ï¼‰delete åˆ™ä¸å¯ä»¥ã€‚<br>5ã€truncate åªèƒ½å¯¹TABLEï¼Œdelete å¯ä»¥æ˜¯table,view,synonymã€‚<br>6ã€TRUNCATE TABLE çš„å¯¹è±¡å¿…é¡»æ˜¯æœ¬æ¨¡å¼ä¸‹çš„ï¼Œæˆ–è€…æœ‰drop any tableçš„æƒé™ è€Œ DELETE åˆ™æ˜¯å¯¹è±¡å¿…é¡»æ˜¯æœ¬æ¨¡å¼ä¸‹çš„ï¼Œæˆ–è¢«æˆäºˆ DELETE ON SCHEMA.TABLE æˆ–DELETE ANY TABLEçš„æƒé™ã€‚<br>7ã€åœ¨å¤–å±‚ä¸­ï¼Œtruncateæˆ–è€…deleteåï¼Œå…¶å ç”¨çš„ç©ºé—´éƒ½å°†é‡Šæ”¾ã€‚<br>8ã€truncateå’Œdeleteåªåˆ é™¤æ•°æ®ï¼Œè€Œdropåˆ™åˆ é™¤æ•´ä¸ªè¡¨ï¼ˆç»“æ„å’Œæ•°æ®ï¼‰ã€‚</p><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><p>1.TRUNCATE TABLEæ˜¯éå¸¸å¿«çš„<br>2.TRUNCATEä¹‹åçš„è‡ªå¢å­—æ®µä»å¤´å¼€å§‹è®¡æ•°äº†ï¼Œè€ŒDELETEçš„ä»ä¿ç•™åŸæ¥çš„æœ€å¤§æ•°å€¼ </p><h1 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h1><h2 id="åˆ†ç»„æŸ¥è¯¢"><a href="#åˆ†ç»„æŸ¥è¯¢" class="headerlink" title="åˆ†ç»„æŸ¥è¯¢"></a>åˆ†ç»„æŸ¥è¯¢</h2><h3 id="GROUP-BY-å­å¥"><a href="#GROUP-BY-å­å¥" class="headerlink" title="GROUP BY å­å¥"></a>GROUP BY å­å¥</h3><p>GROUP BY å‡½æ•°å°±æ˜¯ SQL ä¸­ç”¨æ¥å®ç°åˆ†ç»„çš„å‡½æ•°ï¼Œå…¶ç”¨äºç»“åˆèšåˆå‡½æ•°ï¼Œèƒ½æ ¹æ®ç»™å®šæ•°æ®åˆ—çš„æ¯ä¸ªæˆå‘˜å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œåˆ†ç»„ç»Ÿè®¡ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªåˆ†ç»„æ±‡æ€»è¡¨ã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name`, aggregate_function(`column_name`)</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` operator <span class="keyword">value</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> `column_name`;</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>GROUP BY å•è¡¨å®ä¾‹<br><strong>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ•™å¸ˆè¡¨ä¸­çš„æ•™å¸ˆæ¥è‡ªä¸åŒçš„å›½å®¶ï¼Œç°éœ€è¦ç»Ÿè®¡ä¸åŒå›½å®¶æ•™å¸ˆçš„äººæ•°ï¼Œå¹¶å°†ç»“æœæŒ‰ç…§ä¸åŒå›½ç±æ•™å¸ˆäººæ•°ä»å°åˆ°å¤§æ’åˆ—ï¼Œè¯·ç¼–å†™ç›¸åº”çš„ SQL è¯­å¥å®ç°ã€‚</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `country`, <span class="built_in">COUNT</span>(`country`) <span class="keyword">AS</span> `teacher_count`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> `country`</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> `teacher_count`, `country`;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `country`, <span class="built_in">COUNT</span>(`country`) <span class="keyword">AS</span> `teacher_count`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> `country`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> `teacher_count`, `country`;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> country <span class="operator">|</span> teacher_count <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> JP      <span class="operator">|</span>             <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> UK      <span class="operator">|</span>             <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> USA     <span class="operator">|</span>             <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CN      <span class="operator">|</span>             <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.04</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>GROUP BY å¤šè¡¨å®ä¾‹<br>è¯¾ç¨‹è¡¨çš„æ¯èŠ‚è¯¾ç¨‹éƒ½æœ‰å¯¹åº”çš„ä¸€ä¸ªæ•™å¸ˆè´Ÿè´£æˆè¯¾ï¼Œè€Œæ¯ä¸€ä¸ªæ•™å¸ˆå¯¹åº”å¤šé—¨è¯¾ç¨‹ï¼Œç°éœ€è¦ç»Ÿè®¡æ¯ä¸ªæ•™å¸ˆæ•™æˆè¯¾ç¨‹çš„å­¦ç”Ÿæ€»æ•°ï¼Œè¯·ç¼–å†™ç›¸åº”çš„ SQL è¯­å¥å®ç°ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> T.name <span class="keyword">AS</span> `teacher_name`, IFNULL(<span class="built_in">SUM</span>(C.student_count), <span class="number">0</span>) <span class="keyword">AS</span> `student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses` C</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> `teachers` T <span class="keyword">ON</span> C.teacher_id <span class="operator">=</span> T.id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> T.id;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> T.name <span class="keyword">AS</span> `teacher_name`, IFNULL(<span class="built_in">SUM</span>(C.student_count), <span class="number">0</span>) <span class="keyword">AS</span> `student_count`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses` C</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> `teachers` T <span class="keyword">ON</span> C.teacher_id <span class="operator">=</span> T.id</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> T.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="operator">|</span> teacher_name     <span class="operator">|</span> student_count <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="operator">|</span> Southern Emperor <span class="operator">|</span>          <span class="number">1520</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Western Venom    <span class="operator">|</span>          <span class="number">4570</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Eastern Heretic  <span class="operator">|</span>          <span class="number">3200</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Northern Beggar  <span class="operator">|</span>             <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Linghu Chong     <span class="operator">|</span>             <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="HAVING-å­å¥"><a href="#HAVING-å­å¥" class="headerlink" title="HAVING å­å¥"></a>HAVING å­å¥</h3><p>ä½¿ç”¨<code>WHERE æ¡ä»¶å­å¥æ—¶ä¼šå‘ç°å…¶ä¸èƒ½ä¸èšåˆå‡½æ•°è”åˆä½¿ç”¨</code>ï¼Œä¸ºè§£å†³è¿™ä¸€ç‚¹ï¼ŒSQL ä¸­æä¾›äº† HAVING å­å¥ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œ HAVING å­å¥ç»å¸¸ä¸ GROUP BY è”åˆä½¿ç”¨ï¼ŒHAVING å­å¥å°±æ˜¯å¯¹åˆ†ç»„ç»Ÿè®¡å‡½æ•°è¿›è¡Œè¿‡æ»¤çš„å­å¥ã€‚<br>HAVING å­å¥å¯¹äº GROUP BY å­å¥è®¾ç½®æ¡ä»¶çš„æ–¹å¼å…¶å®ä¸ WHERE å­å¥ä¸ SELECT çš„æ–¹å¼ç±»ä¼¼ï¼Œè¯­æ³•ä¹Ÿç›¸è¿‘ï¼Œä½† WHERE å­å¥æœç´¢æ¡ä»¶æ˜¯åœ¨åˆ†ç»„æ“ä½œä¹‹å‰ï¼Œè€Œ HAVING åˆ™æ˜¯åœ¨ä¹‹åã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>   `column_name`, aggregate_function(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span>     `table_name` </span><br><span class="line"><span class="keyword">WHERE</span>    `column_name` operator <span class="keyword">value</span> </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> `column_name` </span><br><span class="line"><span class="keyword">HAVING</span>   aggregate_function(`column_name`) operator <span class="keyword">value</span>;</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>ğŸ‘‡<strong>ç°éœ€è¦ç»“åˆæ•™å¸ˆè¡¨ä¸è¯¾ç¨‹è¡¨ï¼Œç»Ÿè®¡ä¸åŒæ•™å¸ˆæ‰€å¼€è¯¾ç¨‹çš„å­¦ç”Ÿæ€»æ•°ï¼Œå¯¹äºæ²¡æœ‰ä»»è¯¾çš„è€å¸ˆï¼Œå­¦ç”Ÿæ€»æ•°è®¡ä¸º 0 ï¼Œæœ€åæŸ¥è¯¢å­¦ç”Ÿæ€»æ•°å°‘äº 3000 çš„æ•™å¸ˆå§“ååŠå­¦ç”Ÿæ€»æ•° ï¼ˆåˆ«åä¸º <code>student_count</code> ï¼‰ï¼Œç»“æœæŒ‰ç…§å­¦ç”Ÿæ€»æ•°å‡åºæ’åˆ—ï¼Œå¦‚æœå­¦ç”Ÿæ€»æ•°ç›¸åŒï¼Œåˆ™æŒ‰ç…§æ•™å¸ˆå§“åå‡åºæ’åˆ—ã€‚</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `T`.`name` <span class="keyword">AS</span> `name`, IFNULL(<span class="built_in">SUM</span>(`C`.`student_count`),<span class="number">0</span>) <span class="keyword">AS</span> `student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses` `C` <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> `teachers` `T`</span><br><span class="line"><span class="keyword">ON</span> `C`.`teacher_id` <span class="operator">=</span> `T`.`id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> `T`.`id`</span><br><span class="line"><span class="keyword">HAVING</span> `student_count` <span class="operator">&lt;</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> `student_count`, `name`;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `T`.`name`, IFNULL(<span class="built_in">SUM</span>(`C`.`student_count`),<span class="number">0</span>) <span class="keyword">AS</span> `student_count`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses` `C` </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> `teachers` `T` <span class="keyword">ON</span> `C`.`teacher_id` <span class="operator">=</span> `T`.`id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> `T`.`id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> `student_count` <span class="operator">&lt;</span> <span class="number">3000</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> `student_count`, `name`;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="operator">|</span> name             <span class="operator">|</span> student_count <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="operator">|</span> Linghu Chong     <span class="operator">|</span>             <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Northern Beggar  <span class="operator">|</span>             <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Southern Emperor <span class="operator">|</span>          <span class="number">1520</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>è¯·ç¼–å†™ SQL è¯­å¥ï¼Œä» <code>teachers</code> è¡¨ä¸­ï¼Œç­›é€‰å‡ºåŒä¸€å›½å®¶çš„æ•™å¸ˆå¹³å‡å¹´é¾„å¤§äºæ‰€æœ‰æ•™å¸ˆå¹³å‡å¹´é¾„çš„å›½å®¶ï¼Œå¹¶è·å–è¿™äº›å›½å®¶çš„æ‰€æœ‰æ•™å¸ˆä¿¡æ¯<a href="https://www.lintcode.com/learn/61/97">lintcode</a>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> teachers</span><br><span class="line"><span class="keyword">WHERE</span> country </span><br><span class="line"><span class="keyword">in</span></span><br><span class="line">(<span class="keyword">SELECT</span> country <span class="keyword">FROM</span> teachers <span class="keyword">group</span> <span class="keyword">by</span> country <span class="keyword">having</span> <span class="built_in">avg</span>(age) <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">avg</span>(age) <span class="keyword">from</span> teachers));</span><br></pre></td></tr></table></figure></p><h2 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h2><h3 id="SELECT-è¯­å¥ä¸­çš„å­æŸ¥è¯¢"><a href="#SELECT-è¯­å¥ä¸­çš„å­æŸ¥è¯¢" class="headerlink" title="SELECT è¯­å¥ä¸­çš„å­æŸ¥è¯¢"></a>SELECT è¯­å¥ä¸­çš„å­æŸ¥è¯¢</h3><p><strong>å½“ä¸€ä¸ªæŸ¥è¯¢æ˜¯å¦ä¸€ä¸ªæŸ¥è¯¢çš„æ¡ä»¶æ—¶</strong>ï¼Œç§°ä¹‹ä¸ºå­æŸ¥è¯¢ã€‚å³åœ¨æŸ¥è¯¢è¯­å¥ä¸­çš„ WHERE æ¡ä»¶å­å¥ä¸­ï¼ŒåˆåµŒå¥—äº†å¦ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å› æ­¤ï¼Œå­æŸ¥è¯¢æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ SELECT è¯­å¥ï¼Œå®ƒå¯ä»¥ä½¿ä¸€ä¸ª SELECTã€INSERT INTO è¯­å¥ã€DELETE è¯­å¥æˆ– UPDATE è¯­å¥åµŒå¥—åœ¨å¦ä¸€å­æŸ¥è¯¢ä¸­ã€‚å­æŸ¥è¯¢çš„è¾“å‡ºå¯ä»¥åŒ…æ‹¬ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼ˆå•è¡Œå­æŸ¥è¯¢ï¼‰ã€å‡ è¡Œå€¼ï¼ˆå¤šè¡Œå­æŸ¥è¯¢ï¼‰ã€æˆ–è€…å¤šåˆ—æ•°æ®ï¼ˆå¤šåˆ—å­æŸ¥è¯¢ï¼‰ã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name(s)`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` OPERATOR (</span><br><span class="line">    <span class="keyword">SELECT</span> `column_name(s)`</span><br><span class="line">    <span class="keyword">FROM</span> `table_name`</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><blockquote><p>ä»¥åŠï¼ŒSQLè¯­è¨€å…è®¸å¤šå±‚åµŒå¥—æŸ¥è¯¢ï¼Œå³ä¸€ä¸ªå­æŸ¥è¯¢ä¸­è¿˜å¯ä»¥åµŒå¥—å…¶ä»–å­æŸ¥è¯¢ã€‚</p></blockquote><p><strong>Example</strong><br><strong>å°æ˜æƒ³äº†è§£ Western Venom è€å¸ˆæ‰€æ•™çš„æ‰€æœ‰è¯¾ç¨‹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç°è¯·ä½ æ¥å¸®åŠ©ä»–æŸ¥è¯¢ç›¸å…³ä¿¡æ¯ã€‚</strong><br>é¦–å…ˆéœ€è¦åœ¨ <code>teachers</code> è¡¨ä¸­æŸ¥è¯¢å§“åä¸º Western Venom çš„è€å¸ˆï¼Œå†æ ¹æ®å…¶æ•™å¸ˆ id åœ¨ <code>courses</code> è¡¨ä¸­é€‰æ‹©å¯¹åº”æ•™å¸ˆ id çš„æ‰€æœ‰è¯¾ç¨‹ä¿¡æ¯ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡åµŒå¥—å­æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ä¸ºæ•™å¸ˆ idï¼Œçˆ¶æŸ¥è¯¢åˆ™ä¸ºå…¨éƒ¨è¯¾ç¨‹ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Western Venom&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Western Venom&#x27;</span></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+----------------+-------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name                    <span class="operator">|</span> student_count  <span class="operator">|</span> created_at  <span class="operator">|</span> teacher_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+----------------+-------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span>            <span class="number">135</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span>  <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Django                  <span class="operator">|</span>             <span class="number">78</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span>  <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Artificial Intelligence <span class="operator">|</span>            <span class="number">166</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span>  <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span>             <span class="number">78</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span>  <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+----------------+-------------+------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="INSERT-è¯­å¥ä¸­çš„å­æŸ¥è¯¢"><a href="#INSERT-è¯­å¥ä¸­çš„å­æŸ¥è¯¢" class="headerlink" title="INSERT è¯­å¥ä¸­çš„å­æŸ¥è¯¢"></a>INSERT è¯­å¥ä¸­çš„å­æŸ¥è¯¢</h3><p>å¯¹äº INSERT è¯­å¥ä¸­çš„å­æŸ¥è¯¢æ¥è¯´ï¼Œé¦–å…ˆæ˜¯ä½¿ç”¨å­æŸ¥è¯¢çš„ SELECT è¯­å¥æ‰¾åˆ°éœ€è¦æ’å…¥çš„æ•°æ®ï¼Œä¹‹åå°†è¿”å›çš„æ•°æ®æ’å…¥åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ã€‚åœ¨å­æŸ¥è¯¢ä¸­æ‰€é€‰æ‹©çš„æ•°æ®å¯ä»¥ç”¨ä»»ä½•å­—ç¬¦ã€æ—¥æœŸæˆ–æ•°å­—å‡½æ•°ä¿®æ”¹ã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `table_name`</span><br><span class="line"><span class="keyword">SELECT</span> `colnum_name(s)`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line">[ <span class="keyword">WHERE</span> <span class="keyword">VALUE</span> OPERATOR ]</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨æ„ï¼šINSERT è¯­å¥ä¸­çš„å­æŸ¥è¯¢å…¶å®æ˜¯å°†ä¸€ä¸ªè¡¨ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®â€œå¤åˆ¶â€åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ï¼Œç”±äºä¸»é”®å…·æœ‰å”¯ä¸€æ€§ï¼Œå¦‚æœéœ€è¦ä»…åœ¨å•å¼ è¡¨ä¸­ä½¿ç”¨ INSERT å­æŸ¥è¯¢ï¼Œåªèƒ½åœ¨æ— ä¸»é”®çš„å•å¼ è¡¨ä¸­è¿›è¡Œæ“ä½œï¼Œå¦åˆ™ï¼Œéœ€è¦æœ‰ä¸¤å¼ è¡¨ï¼ˆå¦‚åªä¸€å¼ è¡¨ï¼Œåˆ™éœ€æ–°å»ºä¸€å¼ è¡¨ï¼‰ã€‚<code>ä¸ç”¨values</code></p></blockquote><p><strong>Example</strong><br><strong>å°æ˜åœ¨æ•´ç†æ•°æ®æ—¶å‘ç°æ•™å¸ˆè¡¨æœªå¤‡ä»½ï¼Œä¸ºäº†åŠæ—¶å®Œå–„æ•°æ®çš„å¤‡ä»½ï¼Œç°åœ¨éœ€è¦å°†æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­çš„å…¨éƒ¨ä¿¡æ¯å¤åˆ¶åˆ°ç›¸åŒè¡¨ç»“æ„çš„å¤‡ä»½è¡¨ <code>teachers_bkp</code> ä¸­ï¼Œè¯·ä½¿ç”¨ç›¸å…³ SQL è¯­å¥å®Œæˆæ•™å¸ˆè¡¨çš„å¤‡ä»½ã€‚</strong></p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æŸ¥è¯¢æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå†å°†æŸ¥è¯¢åˆ°çš„æ•°æ®æ’å…¥åˆ°å¤‡ä»½è¡¨ <code>teachers_bkp</code> ä¸­ã€‚å³ï¼ŒæŸ¥è¯¢æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­çš„æ‰€æœ‰ä¿¡æ¯ä¸ºæ’å…¥å¤‡ä»½è¡¨ <code>teachers_bkp</code> ä¸­çš„æ¡ä»¶ã€‚<br>å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡åµŒå¥—å­æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ä¸ºæ•™å¸ˆè¡¨ <code>teachers</code> ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œæ•´ä¸ªè¯­å¥æ˜¯ä¸ºäº†æ’å…¥æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `teachers_bkp`</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `teachers`;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `teachers_bkp`;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name             <span class="operator">|</span> email                     <span class="operator">|</span> age <span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span>  <span class="number">20</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Northern Beggar  <span class="operator">|</span> northern.beggar<span class="variable">@qq</span>.com    <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Western Venom    <span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span>  <span class="number">28</span> <span class="operator">|</span> USA     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Southern Emperor <span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Linghu Chong     <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span>  <span class="number">18</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------+---------------------------+-----+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.05</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="UPDATE-è¯­å¥ä¸­çš„å­æŸ¥è¯¢"><a href="#UPDATE-è¯­å¥ä¸­çš„å­æŸ¥è¯¢" class="headerlink" title="UPDATE è¯­å¥ä¸­çš„å­æŸ¥è¯¢"></a>UPDATE è¯­å¥ä¸­çš„å­æŸ¥è¯¢</h3><p>å¯¹äº UPDATE è¯­å¥ï¼Œé¦–å…ˆé€šè¿‡ SELECT è¯­å¥æŸ¥è¯¢éœ€è¦æ›´æ–°çš„ä¿¡æ¯ï¼Œå†ä½¿ç”¨ UPDATE è¯­å¥å¯¹ä¿¡æ¯è¿›è¡Œæ›´æ–°ã€‚å½“é€šè¿‡ UPDATE è¯­å¥ä½¿ç”¨å­æŸ¥è¯¢æ—¶ï¼Œèƒ½å¤Ÿå®ç°è¡¨ä¸­å•ä¸ªåˆ—æˆ–å¤šä¸ªåˆ—çš„æ•°æ®æ›´æ–°ã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `table_name` </span><br><span class="line"><span class="keyword">SET</span> `column_name` <span class="operator">=</span> `new_value`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` OPERATOR </span><br><span class="line">   (<span class="keyword">SELECT</span> `column_name`</span><br><span class="line">   <span class="keyword">FROM</span> `table_name`</span><br><span class="line">   [<span class="keyword">WHERE</span>] )</span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼šåœ¨ UPDATE è¯­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢ SELECT è¯­å¥æ‰€ç”¨çš„è¡¨å’Œ UPDATE è¯­å¥æ‰€è¦æ›´æ”¹çš„è¡¨<strong>ä¸èƒ½</strong>æ˜¯åŒä¸€å¼ è¡¨ï¼</p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>UPDATE è¯­å¥ä¸­çš„å­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚</p><p><strong>å­¦æ ¡æ•™åŠ¡å¤„æ’è¯¾æ—¶å‘ç°æ•™å¸ˆ Western Venom åˆ›å»ºçš„è¯¾ç¨‹æœ‰è¯¯ï¼Œç°ç´§æ€¥éœ€è¦å°†è¯¥æ•™å¸ˆåˆ›å»ºçš„è¯¾ç¨‹åç§°ä¿®æ”¹ä¸º Javaï¼Œè¯·ä½ ä½¿ç”¨ç›¸å…³çš„ SQL è¯­å¥å®Œæˆã€‚</strong></p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­æŸ¥è¯¢åˆ°æ•™å¸ˆ Western Venom ï¼Œå†æ ¹æ®å…¶æ•™å¸ˆ id åœ¨è¯¾ç¨‹è¡¨ <code>course</code> ä¸­æŸ¥è¯¢è¯¥æ•™å¸ˆ id æ‰€åˆ›å»ºçš„è¯¾ç¨‹åç§° <code>name</code> ï¼Œæœ€åå°†æŸ¥è¯¢åˆ°çš„è¯¾ç¨‹æ›´æ”¹ä¸º Javaã€‚</p><p>å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡åµŒå¥—å­æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ä¸ºæ•™å¸ˆ idï¼Œè€Œæ•´ä¸ªè¯­å¥æ˜¯ä¸ºäº†æ›´æ–°æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `courses`</span><br><span class="line"><span class="keyword">SET</span> `name` <span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line">    <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Western Venom&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> courses;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name                    <span class="operator">|</span> student_count <span class="operator">|</span> created_at <span class="operator">|</span> teacher_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Advanced Algorithms     <span class="operator">|</span>           <span class="number">880</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Java                    <span class="operator">|</span>          <span class="number">1350</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Java                    <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Web                     <span class="operator">|</span>           <span class="number">340</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-04</span><span class="number">-22</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Big Data                <span class="operator">|</span>           <span class="number">700</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-09</span><span class="number">-11</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Java                    <span class="operator">|</span>          <span class="number">1660</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> Java                    <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> Data Analysis           <span class="operator">|</span>           <span class="number">500</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-12</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10</span> <span class="operator">|</span> Object Oriented Design  <span class="operator">|</span>           <span class="number">300</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-08</span><span class="number">-08</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12</span> <span class="operator">|</span> <span class="keyword">Dynamic</span> Programming     <span class="operator">|</span>          <span class="number">2000</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-08</span><span class="number">-18</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="DELETE-è¯­å¥ä¸­çš„å­æŸ¥è¯¢"><a href="#DELETE-è¯­å¥ä¸­çš„å­æŸ¥è¯¢" class="headerlink" title="DELETE è¯­å¥ä¸­çš„å­æŸ¥è¯¢"></a>DELETE è¯­å¥ä¸­çš„å­æŸ¥è¯¢</h3><p>å¯¹äº DELETE è¯­å¥ï¼Œé¦–å…ˆé€šè¿‡ SELECT è¯­å¥æŸ¥è¯¢éœ€è¦åˆ é™¤çš„æ•°æ®ï¼Œå†ä½¿ç”¨ DELETE è¯­å¥å¯¹æ•°æ®è¿›è¡Œåˆ é™¤ã€‚å½“é€šè¿‡ DELETE è¯­å¥ä½¿ç”¨å­æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥å®Œæˆå¤æ‚çš„æ•°æ®åˆ é™¤æ§åˆ¶ã€‚</p><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` OPERATOR </span><br><span class="line">   (<span class="keyword">SELECT</span> `column_name`</span><br><span class="line">   <span class="keyword">FROM</span> `table_name`  </span><br><span class="line">   [<span class="keyword">WHERE</span>] )</span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼šåœ¨ DELETE è¯­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢ SELECT è¯­å¥æ‰€ç”¨çš„è¡¨å’Œ DELETE è¯­å¥æ‰€è¦æ›´æ”¹çš„è¡¨<strong>ä¸èƒ½</strong>æ˜¯åŒä¸€å¼ è¡¨ï¼</p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>DELETE è¯­å¥ä¸­çš„å­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚</p><p><strong>ç°éœ€è¦åˆ é™¤è¯¾ç¨‹è¡¨ä¸­æ‰€æœ‰æ•™å¸ˆå¹´é¾„å°äº 21 å²ï¼ˆä¸åŒ…æ‹¬ 21 å²ï¼‰çš„è¯¾ç¨‹ï¼Œè¯·ä½ ä½¿ç”¨ç›¸å…³çš„ SQL è¯­å¥å®ç°ã€‚</strong></p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­æŸ¥è¯¢åˆ°æ•™å¸ˆå¹´é¾„å°äº 21 å²çš„è€å¸ˆçš„æ•™å¸ˆ id ï¼Œå†æ ¹æ®å…¶æ•™å¸ˆ id åœ¨è¯¾ç¨‹è¡¨ <code>course</code> ä¸­æŸ¥è¯¢è¯¥æ•™å¸ˆ id æ‰€åˆ›å»ºçš„è¯¾ç¨‹å¹¶å°†è¯¾ç¨‹åˆ é™¤ã€‚</p><p>å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡åµŒå¥—å­æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ä¸ºç¬¦åˆæ¡ä»¶çš„æ•™å¸ˆ idï¼Œè€Œæ•´ä¸ªè¯­å¥æ˜¯ä¸ºäº†åˆ é™¤æ•°æ®ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `age` <span class="operator">&lt;</span> <span class="number">21</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> courses;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name                    <span class="operator">|</span> student_count <span class="operator">|</span> created_at <span class="operator">|</span> teacher_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Advanced Algorithms     <span class="operator">|</span>           <span class="number">880</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span>          <span class="number">1350</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Django                  <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Web                     <span class="operator">|</span>           <span class="number">340</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-04</span><span class="number">-22</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Artificial Intelligence <span class="operator">|</span>          <span class="number">1660</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10</span> <span class="operator">|</span> Object Oriented Design  <span class="operator">|</span>           <span class="number">300</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-08</span><span class="number">-08</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="å†…è”è§†å›¾å­æŸ¥è¯¢"><a href="#å†…è”è§†å›¾å­æŸ¥è¯¢" class="headerlink" title="å†…è”è§†å›¾å­æŸ¥è¯¢"></a>å†…è”è§†å›¾å­æŸ¥è¯¢</h3><p>å†…è”è§†å›¾å­æŸ¥è¯¢å®é™…ä¸Šå°±æ˜¯å°†æŸ¥è¯¢çš„ç»“æœé›†ä½œä¸ºä¸€ä¸ªæŸ¥è¯¢è¡¨ï¼Œç»§ç»­è¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚</p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>å†…è”è§†å›¾å­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚<br><strong>ç°éœ€è¦æŸ¥è¯¢å›½ç±ä¸ºç¾å›½ï¼ˆUSAï¼‰ï¼Œä¸”å¹´é¾„æœ€å¤§çš„æ•™å¸ˆï¼Œè¯·ä½¿ç”¨å†…è”è§†å›¾å­æŸ¥è¯¢å®ç°ã€‚</strong><br>æœ¬é¢˜å°†ä»æ•™å¸ˆè¡¨ä¸­æŸ¥è¯¢åˆ°çš„ç¾å›½æ•™å¸ˆä½œä¸ºå†…è”è¡¨ï¼Œå†ä½¿ç”¨ WHERE å­å¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `country` <span class="operator">=</span> <span class="string">&#x27;USA&#x27;</span></span><br><span class="line">) `T`</span><br><span class="line"><span class="keyword">WHERE</span> `age` <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(`age`)</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `country` <span class="operator">=</span> <span class="string">&#x27;USA&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ) `T`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `age` <span class="operator">=</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(`age`)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------+-----------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name          <span class="operator">|</span> email                 <span class="operator">|</span> age <span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------+-----------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Western Venom <span class="operator">|</span> western.venom<span class="variable">@163</span>.com <span class="operator">|</span>  <span class="number">28</span> <span class="operator">|</span> USA     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------+----------</span></span><br></pre></td></tr></table></figure></p><h3 id="IN-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"><a href="#IN-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="IN æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"></a>IN æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢</h3><blockquote><p>ä½¿ç”¨ IN æ“ä½œç¬¦è¿›è¡Œå­æŸ¥è¯¢ï¼Œå…¶å®æ˜¯å°†å­æŸ¥è¯¢è¿”å›çš„é›†åˆå’Œå¤–å±‚æŸ¥è¯¢å¾—åˆ°çš„é›†åˆè¿›è¡Œ<strong>äº¤é›†</strong>è¿ç®—ï¼Œè¿™ä¸ªç»“æœå¯ä»¥æ˜¯é›¶ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªå€¼ã€‚ç”±æ­¤ï¼Œæœ€åå¯ä»¥æŸ¥è¯¢å‡ºä¸åˆ—è¡¨ä¸­ä»»æ„ä¸€ä¸ªå€¼åŒ¹é…çš„è¡Œã€‚</p></blockquote><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` <span class="keyword">IN</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> `column_name`</span><br><span class="line">    <span class="keyword">FROM</span> `table_name`</span><br><span class="line">    <span class="keyword">WHERE</span> `column_name` <span class="operator">=</span> <span class="keyword">VALUE</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>IN æ“ä½œç¬¦å¤šè¡Œå­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚<br><strong>ç°éœ€è¦æŸ¥è¯¢å›½ç±ä¸ºç¾å›½ï¼ˆUSAï¼‰çš„æ•™å¸ˆæ‰€å¼€çš„æ‰€æœ‰è¯¾ç¨‹ï¼Œè¯·ä½¿ç”¨ IN æ“ä½œç¬¦è¿›è¡Œå¤šè¡Œå­æŸ¥è¯¢ã€‚</strong><br>ä¸ºäº†å¾—åˆ°æ»¡è¶³æ¡ä»¶çš„è¯¾ç¨‹åç§°ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ•°æ®ä¸ºå›½ç± <code>country</code> ä¸ºç¾å›½ï¼ˆUSAï¼‰çš„æ•™å¸ˆæ‰€å¯¹åº”çš„æ•™å¸ˆ idï¼Œå†æ ¹æ®è¿™ä¸ª id ï¼Œåœ¨è¯¾ç¨‹è¡¨<code>courses</code> ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œæœ€ç»ˆå¾—åˆ°æ‰€æœ‰çš„è¯¾ç¨‹åç§° <code>name</code>ã€‚<br>è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡åµŒå¥—å­æŸ¥è¯¢åˆ°çš„ä¿¡æ¯ä¸ºå›½ç±ä¸ºç¾å›½çš„å…¨éƒ¨æ•™å¸ˆçš„æ•™å¸ˆ idï¼Œçˆ¶æŸ¥è¯¢ä¸ºæŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„è¯¾ç¨‹åç§°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`</span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `country` <span class="operator">=</span> <span class="string">&#x27;USA&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `teacher_id` <span class="keyword">IN</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `country` <span class="operator">=</span> <span class="string">&#x27;USA&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> name                    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Django                  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Artificial Intelligence <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.12</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>NOT IN æ“ä½œç¬¦å¤šè¡Œå­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚<br><strong>ç°éœ€è¦æŸ¥è¯¢å¹´é¾„ä¸å¤§äº20å²çš„æ•™å¸ˆæ‰€æ•™çš„æ‰€æœ‰è¯¾ç¨‹çš„è¯¾ç¨‹åç§°ï¼Œè¯·ä½¿ç”¨ NOT IN æ“ä½œç¬¦è¿›è¡Œå¤šè¡Œå­æŸ¥è¯¢ã€‚</strong><br>å¯¹é¢˜ç›®åˆ†æä¸€ä¸‹å¯ä»¥å¾—åˆ°ï¼Œå­æŸ¥è¯¢ä¸ºåœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­æŸ¥è¯¢å¹´é¾„å¤§äº 20 å²çš„æ•™å¸ˆï¼Œçˆ¶æŸ¥è¯¢åˆ™ä¸ºæŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„è¯¾ç¨‹åç§°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`</span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `age` <span class="operator">&gt;</span> <span class="number">20</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `teacher_id` <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `age` <span class="operator">&gt;</span> <span class="number">20</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> name                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> Big Data            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Data Analysis       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure><h3 id="ANY-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"><a href="#ANY-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="ANY æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"></a>ANY æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢</h3><blockquote><p>æ“ä½œç¬¦ ANY å±äºé€»è¾‘è¿ç®—ç¬¦çš„ä¸€ç§ï¼Œä¸ IN è¿ç®—ç¬¦ä¸åŒï¼Œ<code>ANY å¿…é¡»å’Œå…¶å®ƒçš„æ¯”è¾ƒè¿ç®—ç¬¦å…±åŒä½¿ç”¨</code>ï¼Œå…¶è¡¨ç¤ºæŸ¥è¯¢ç»“æœä¸­çš„ä»»æ„ä¸€ä¸ªã€‚</p></blockquote><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name(s)`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` OPERATOR</span><br><span class="line">   <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> column_name</span><br><span class="line">   <span class="keyword">FROM</span> table_name)</span><br></pre></td></tr></table></figure></p><p>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>ANY æ“ä½œç¬¦å¤šè¡Œå­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚</p><p><strong>ç°éœ€è¦æŸ¥è¯¢å­¦ç”Ÿä¸Šè¯¾äººæ•°è¶…è¿‡ â€œEastern Hereticâ€ çš„ä»»æ„ä¸€é—¨è¯¾çš„å­¦ç”Ÿäººæ•°çš„è¯¾ç¨‹ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ ANY æ“ä½œç¬¦å®ç°å¤šè¡Œå­æŸ¥è¯¢ã€‚</strong><br>ç¬¬ä¸€å±‚çš„çˆ¶æŸ¥è¯¢ä¸ºåœ¨è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„å…¨éƒ¨è¯¾ç¨‹ä¿¡æ¯ï¼Œè¿™ä¸ªæ¡ä»¶ç”±å­æŸ¥è¯¢æ¥å®Œæˆï¼Œå³ä¸ºï¼ŒæŸ¥è¯¢å­¦ç”Ÿä¸Šè¯¾äººæ•°è¶…è¿‡ â€Eastern Hereticâ€œ çš„ä»»æ„ä¸€é—¨è¯¾çš„å­¦ç”Ÿäººæ•°ã€‚è¿™ä¸€éƒ¨åˆ†çš„å­æŸ¥è¯¢ä¸­éœ€è¦ç»“åˆ ANY æ“ä½œç¬¦å®ç°ã€‚ä¹‹åï¼Œå†å°†å­æŸ¥è¯¢è¿›è¡Œæ‹†åˆ†ï¼Œå½¢æˆç¬¬äºŒå±‚çš„åµŒå¥—å­æŸ¥è¯¢ã€‚</p><p>ç¬¬äºŒå±‚çš„çˆ¶æŸ¥è¯¢ä¸ºåœ¨è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æ ¹æ®æ•™å¸ˆ id æŸ¥è¯¢å­¦ç”Ÿä¸Šè¯¾äººæ•°ï¼Œ å…¶å­æŸ¥è¯¢ä¸ºåœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­æŸ¥æ‰¾æ•™å¸ˆå <code>name</code> ä¸º â€œEastern Hereticâ€ çš„æ•™å¸ˆ idã€‚</p><p>ç”±äºæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„è¯¾ç¨‹ä¿¡æ¯ä¸­è‚¯å®šä¸åŒ…å« â€œEastern Hereticâ€ çš„è¯¾ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨ WHERE æ¡ä»¶ä¸­å†è®¾ç½®ä¸€é¡¹ï¼šä¸ä¸º â€œEastern Hereticâ€ æ‰€å¼€çš„è¯¾ç¨‹ ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `student_count` <span class="operator">&gt;</span> <span class="keyword">ANY</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Eastern Heretic&#x27;</span></span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> `teacher_id` <span class="operator">&lt;&gt;</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Eastern Heretic&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `student_count` <span class="operator">&gt;</span> <span class="keyword">ANY</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `student_count`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Eastern Heretic&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> )</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> )</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AND</span> `teacher_id` <span class="operator">&lt;&gt;</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `id`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Eastern Heretic&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name                    <span class="operator">|</span> student_count <span class="operator">|</span> created_at <span class="operator">|</span> teacher_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Advanced Algorithms     <span class="operator">|</span>           <span class="number">880</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span>          <span class="number">1350</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Django                  <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Artificial Intelligence <span class="operator">|</span>          <span class="number">1660</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> Java P6<span class="operator">+</span>                <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-01</span><span class="number">-19</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.06</span> sec)</span><br></pre></td></tr></table></figure><h3 id="ALL-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"><a href="#ALL-æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="ALL æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢"></a>ALL æ“ä½œç¬¦çš„å¤šè¡Œå­æŸ¥è¯¢</h3><blockquote><p>ä¸ ANY ä¸€æ ·ï¼Œæ“ä½œç¬¦ ALL ä¹Ÿå±äºé€»è¾‘è¿ç®—ç¬¦çš„ä¸€ç§ï¼Œä¸”éƒ½é¡»ä¸å…¶å®ƒçš„æ¯”è¾ƒè¿ç®—ç¬¦å…±åŒä½¿ç”¨ï¼Œå…¶è¡¨ç¤ºæŸ¥è¯¢ç»“æœä¸­çš„æ‰€æœ‰ã€‚<br>åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ ALL ï¼Œè¡¨ç¤ºä¸å­æŸ¥è¯¢è¿”å›çš„æ‰€æœ‰å€¼æ¯”è¾ƒä¸ºçœŸï¼Œåˆ™è¿”å›çœŸã€‚</p></blockquote><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name(s)`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` OPERATOR</span><br><span class="line">   <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> column_name</span><br><span class="line">   <span class="keyword">FROM</span> table_name)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>ğŸ‘‡<strong>ç°éœ€è¦æŸ¥è¯¢å­¦ç”Ÿäººæ•°è¶…è¿‡ â€Western Venomâ€œ æ‰€æœ‰è¯¾ç¨‹å­¦ç”Ÿäººæ•°çš„è¯¾ç¨‹ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ ALL æ“ä½œç¬¦å®ç°å¤šè¡Œå­æŸ¥è¯¢ã€‚</strong></p><p>ç¬¬ä¸€å±‚çš„çˆ¶æŸ¥è¯¢ä¸ºåœ¨è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„å…¨éƒ¨è¯¾ç¨‹ä¿¡æ¯ï¼Œè¿™ä¸ªæ¡ä»¶ç”±å­æŸ¥è¯¢æ¥å®Œæˆï¼Œå³ä¸ºï¼ŒæŸ¥è¯¢å­¦ç”Ÿäººæ•°è¶…è¿‡ â€Western Venomâ€œ æ‰€æœ‰è¯¾ç¨‹å­¦ç”Ÿäººæ•°ã€‚è¿™ä¸€éƒ¨åˆ†çš„å­æŸ¥è¯¢ä¸­éœ€è¦ç»“åˆ ALL æ“ä½œç¬¦å®ç°ã€‚ä¹‹åï¼Œå†å°†å­æŸ¥è¯¢è¿›è¡Œæ‹†åˆ†ï¼Œå½¢æˆç¬¬äºŒå±‚çš„åµŒå¥—å­æŸ¥è¯¢ã€‚</p><p>ç¬¬äºŒå±‚çš„çˆ¶æŸ¥è¯¢ä¸ºåœ¨è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æ ¹æ®æ•™å¸ˆ id æŸ¥è¯¢å­¦ç”Ÿä¸Šè¯¾äººæ•°ï¼Œ å…¶å­æŸ¥è¯¢ä¸ºåœ¨æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­æŸ¥æ‰¾æ•™å¸ˆå <code>name</code> ä¸º â€Western Venomâ€œ çš„æ•™å¸ˆ idã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `student_count` <span class="operator">&gt;</span> <span class="keyword">ALL</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `teacher_id` <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span> `id`</span><br><span class="line"><span class="keyword">FROM</span> `teachers`</span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Western Venom&#x27;</span></span><br><span class="line">)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>Result</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT *</span><br><span class="line">    -&gt; FROM `courses`</span><br><span class="line">    -&gt; WHERE `student_count` &gt; ALL(</span><br><span class="line">    -&gt; SELECT `student_count`</span><br><span class="line">    -&gt; FROM `courses`</span><br><span class="line">    -&gt; WHERE `teacher_id` = (</span><br><span class="line">    -&gt; SELECT `id`</span><br><span class="line">    -&gt; FROM `teachers`</span><br><span class="line">    -&gt; WHERE `name` = &#x27;Western Venom&#x27;</span><br><span class="line">    -&gt; )</span><br><span class="line">    -&gt; );</span><br><span class="line">+----+---------------------+---------------+------------+------------+</span><br><span class="line">| id | name                | student_count | created_at | teacher_id |</span><br><span class="line">+----+---------------------+---------------+------------+------------+</span><br><span class="line">| 12 | Dynamic Programming |          2000 | 2018-08-18 |          1 |</span><br><span class="line">+----+---------------------+---------------+------------+------------+</span><br><span class="line">1 row in set (0.06 sec)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br>è¯·ç¼–å†™ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ•™å¸ˆè¡¨ <code>teachers</code> å’Œè¯¾ç¨‹è¡¨ <code>courses</code>ï¼ŒæŸ¥è¯¢æœ€å¹´é•¿çš„è€å¸ˆæ‰€å¼€è¯¾ç¨‹çš„å­¦ç”Ÿæ•°ï¼Œæœ€åè¿”å›å­¦ç”Ÿæ•°å‡è¶…è¿‡è¿™äº›è¯¾ç¨‹çš„è¯¾ç¨‹ä¿¡æ¯ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> courses</span><br><span class="line"><span class="keyword">WHERE</span> student_count <span class="operator">&gt;</span> <span class="keyword">all</span> (</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_count <span class="keyword">FROM</span> courses</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> teacher_id <span class="keyword">in</span></span><br><span class="line">Â  Â  Â (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> teachers <span class="keyword">WHERE</span> age<span class="operator">=</span></span><br><span class="line">Â  Â  Â  Â  Â  (<span class="keyword">SELECT</span> <span class="built_in">max</span>(age) <span class="keyword">FROM</span> teachers)</span><br><span class="line">Â  Â  Â )</span><br><span class="line">);</span><br><span class="line">#å¯èƒ½ä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥ç”¨<span class="keyword">in</span></span><br></pre></td></tr></table></figure></p><h3 id="å¤šåˆ—å­æŸ¥è¯¢"><a href="#å¤šåˆ—å­æŸ¥è¯¢" class="headerlink" title="å¤šåˆ—å­æŸ¥è¯¢"></a>å¤šåˆ—å­æŸ¥è¯¢</h3><p>å½“æ˜¯<strong>å•è¡Œå¤šåˆ—</strong>çš„å­æŸ¥è¯¢æ—¶ï¼Œä¸»æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶è¯­å¥ä¸­å¼•ç”¨å­æŸ¥è¯¢ç»“æœæ—¶å¯ç”¨å•è¡Œæ¯”è¾ƒç¬¦å·ï¼ˆï¼ï¼Œ&gt;ï¼Œ&lt;ï¼Œ&gt;=ï¼Œ&lt;=ï¼Œ &lt;&gt; ç­‰ï¼‰æ¥è¿›è¡Œæ¯”è¾ƒï¼›<br>å½“æ˜¯<strong>å¤šè¡Œå¤šåˆ—</strong>å­æŸ¥è¯¢æ—¶ï¼Œä¸»æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶è¯­å¥ä¸­å¼•ç”¨å­æŸ¥è¯¢ç»“æœæ—¶å¿…é¡»ç”¨å¤šè¡Œæ¯”è¾ƒç¬¦å·ï¼ˆINï¼ŒANYï¼ŒALL ç­‰ï¼‰æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p><p><strong>Example</strong><br>ğŸ‘‡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ <strong>å¤šåˆ—å­æŸ¥è¯¢</strong> çš„ç”¨æ³•ã€‚<br><strong>ç°éœ€è¦æ‰¾åˆ°æ¯ä¸ªå›½å®¶å¹´é¾„æœ€å¤§çš„æ•™å¸ˆï¼Œè¯·ç¼–å†™ SQL è¯­å¥å®ç°å¤šåˆ—å­æŸ¥è¯¢</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, `age`, `country` </span><br><span class="line"><span class="keyword">FROM</span> `teachers` </span><br><span class="line"><span class="keyword">WHERE</span> (`country`, `age`) <span class="keyword">IN</span> ( </span><br><span class="line">        <span class="keyword">SELECT</span> `country`, <span class="built_in">MAX</span>(`age`) </span><br><span class="line">        <span class="keyword">FROM</span> `teachers` </span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> `country` </span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name`, `age`, `country`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> (`country`, `age`) <span class="keyword">IN</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         <span class="keyword">SELECT</span> `country`, <span class="built_in">MAX</span>(`age`)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         <span class="keyword">FROM</span> `teachers`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         <span class="keyword">GROUP</span> <span class="keyword">BY</span> `country`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span> name             <span class="operator">|</span> age <span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----+---------+</span></span><br><span class="line"><span class="operator">|</span> Eastern Heretic  <span class="operator">|</span>  <span class="number">20</span> <span class="operator">|</span> UK      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Northern Beggar  <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Western Venom    <span class="operator">|</span>  <span class="number">28</span> <span class="operator">|</span> USA     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Southern Emperor <span class="operator">|</span>  <span class="number">21</span> <span class="operator">|</span> JP      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.06</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong></p><blockquote><p>è¯·ç¼–å†™ SQL è¯­å¥ï¼Œè¿æ¥ <code>courses</code> ä¸ <code>teachers</code> è¡¨ï¼Œç»Ÿè®¡ä¸åŒå›½ç±æ•™å¸ˆæ‰€å¼€è¯¾ç¨‹çš„å­¦ç”Ÿæ€»æ•°ï¼Œå¯¹äºæ²¡æœ‰ä»»è¯¾çš„è€å¸ˆï¼Œå­¦ç”Ÿæ€»äººæ•°è®¡ä¸º 0 ã€‚æœ€åæŸ¥è¯¢æ•™å¸ˆå›½ç±æ˜¯ â€˜Uâ€™ å¼€å¤´ä¸”<strong>è¿™ä¸ªå›½ç±çš„æ‰€æœ‰æ•™å¸ˆ</strong>çš„å­¦ç”Ÿæ€»æ•°åœ¨ <strong>2000</strong> åˆ° <strong>5000</strong> ä¹‹é—´ï¼ˆåŒ…æ‹¬ 2000 å’Œ 5000ï¼‰çš„æ•™å¸ˆå›½ç±åŠå­¦ç”Ÿæ€»æ•° ï¼ˆåˆ«åä¸º <code>student_count</code> ï¼‰ï¼Œç»“æœæŒ‰ç…§å­¦ç”Ÿæ€»æ•°é™åºæ’åˆ—ï¼Œå¦‚æœå­¦ç”Ÿæ€»æ•°ç›¸åŒï¼Œåˆ™æŒ‰ç…§æ•™å¸ˆå›½ç±å‡åºæ’åˆ—ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t.country,<span class="built_in">sum</span>(c.student_count) student_count</span><br><span class="line"><span class="keyword">FROM</span> courses c</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> teachers t</span><br><span class="line"><span class="keyword">on</span> c.teacher_id<span class="operator">=</span>t.id</span><br><span class="line"><span class="keyword">where</span> t.country <span class="keyword">like</span> <span class="string">&#x27;U%&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> t.country</span><br><span class="line"><span class="keyword">having</span> student_count <span class="keyword">between</span> <span class="number">2000</span> <span class="keyword">and</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> student_count <span class="keyword">desc</span>,t.country <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h2 id="ç®—æ•°å‡½æ•°"><a href="#ç®—æ•°å‡½æ•°" class="headerlink" title="ç®—æ•°å‡½æ•°"></a>ç®—æ•°å‡½æ•°</h2><h3 id="ä½¿ç”¨-AVG-å‡½æ•°æ±‚æ•°å€¼åˆ—çš„å¹³å‡å€¼"><a href="#ä½¿ç”¨-AVG-å‡½æ•°æ±‚æ•°å€¼åˆ—çš„å¹³å‡å€¼" class="headerlink" title="ä½¿ç”¨ AVG() å‡½æ•°æ±‚æ•°å€¼åˆ—çš„å¹³å‡å€¼"></a>ä½¿ç”¨ AVG() å‡½æ•°æ±‚æ•°å€¼åˆ—çš„å¹³å‡å€¼</h3><blockquote><p>å¹³å‡å‡½æ•° AVG() æ˜¯å¹³å‡æ•° AVERAGE çš„ç¼©å†™ï¼Œå®ƒç”¨äºæ±‚æ•°å€¼åˆ—çš„å¹³å‡å€¼ã€‚å®ƒå¯ä»¥ç”¨æ¥è¿”å›æ‰€æœ‰åˆ—çš„å¹³å‡å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥è¿”å›ç‰¹å®šåˆ—å’Œè¡Œçš„å¹³å‡å€¼ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(`student_count`) <span class="keyword">AS</span> `average_student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ <code>AS</code> å…³é”®å­—çš„ä½œç”¨æ˜¯èµ‹äºˆ <code>AVG(student_count)</code> è®¡ç®—ç»“æœåˆ—æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­çš„åˆ«åã€‚</p><h3 id="ä½¿ç”¨-MAX-å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼"><a href="#ä½¿ç”¨-MAX-å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼" class="headerlink" title="ä½¿ç”¨ MAX() å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼"></a>ä½¿ç”¨ MAX() å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼</h3><blockquote><p>æœ€å¤§å€¼å‡½æ•° MAX() ç”¨äºè¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å¤§å€¼ã€‚å®ƒåªæœ‰ä¸€ä¸ªå‚æ•° <code>column_name</code> ï¼Œè¡¨ç¤ºæŒ‡å®šçš„åˆ—åã€‚ä½†æ˜¯å½“å‚æ•° <code>column_name</code> åˆ—ä¸­çš„æ•°æ®å‡ä¸ºç©ºæ—¶ï¼Œç»“æœä¼šè¿”å› NULLã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(`student_count`)</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨-MIN-å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼"><a href="#ä½¿ç”¨-MIN-å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼" class="headerlink" title="ä½¿ç”¨ MIN() å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼"></a>ä½¿ç”¨ MIN() å‡½æ•°è¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼</h3><blockquote><p>MIN() å‡½æ•°çš„åŠŸèƒ½ä¸ MAX() æ­£å¥½ç›¸åï¼Œå®ƒç”¨äºè¿”å›æŒ‡å®šåˆ—ä¸­çš„æœ€å°å€¼ã€‚ä½†ä¸ MAX() ç›¸åŒçš„æ˜¯ï¼Œå®ƒä¹Ÿåªæœ‰ä¸€ä¸ªå‚æ•° <code>column_name</code> ï¼Œè¡¨ç¤ºæŒ‡å®šçš„åˆ—åï¼Œä¸”å½“å‚æ•° <code>column_name</code> åˆ—ä¸­çš„æ•°æ®å‡ä¸ºç©ºæ—¶ï¼Œç»“æœä¼šè¿”å› NULLã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(`student_count`)</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨SUM-å‡½æ•°ç»Ÿè®¡æ•°å€¼åˆ—çš„æ€»æ•°"><a href="#ä½¿ç”¨SUM-å‡½æ•°ç»Ÿè®¡æ•°å€¼åˆ—çš„æ€»æ•°" class="headerlink" title="ä½¿ç”¨SUM()å‡½æ•°ç»Ÿè®¡æ•°å€¼åˆ—çš„æ€»æ•°"></a>ä½¿ç”¨SUM()å‡½æ•°ç»Ÿè®¡æ•°å€¼åˆ—çš„æ€»æ•°</h3><blockquote><p>SUM() å‡½æ•°ç”¨äºç»Ÿè®¡æ•°å€¼åˆ—çš„æ€»æ•°å¹¶è¿”å›å…¶å€¼ã€‚å®ƒåªæœ‰ä¸€ä¸ªå‚æ•° <code>column_name</code> ï¼Œè¡¨ç¤ºæŒ‡å®šçš„åˆ—åï¼Œä½†æ˜¯å½“å‚æ•° <code>column_name</code> åˆ—ä¸­çš„æ•°æ®å‡ä¸ºç©ºæ—¶ï¼Œç»“æœä¼šè¿”å› NULLã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(`student_count`) <span class="keyword">AS</span> `all_student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h2 id="ç®—æ•°å‡½æ•°-1"><a href="#ç®—æ•°å‡½æ•°-1" class="headerlink" title="ç®—æ•°å‡½æ•°"></a>ç®—æ•°å‡½æ•°</h2><h2 id="ä½¿ç”¨ROUND-å‡½æ•°å°†æ•°å€¼å››èˆäº”å…¥"><a href="#ä½¿ç”¨ROUND-å‡½æ•°å°†æ•°å€¼å››èˆäº”å…¥" class="headerlink" title="ä½¿ç”¨ROUND() å‡½æ•°å°†æ•°å€¼å››èˆäº”å…¥"></a>ä½¿ç”¨ROUND() å‡½æ•°å°†æ•°å€¼å››èˆäº”å…¥</h2><blockquote><p><code>ROUND()</code> å‡½æ•°ç”¨äºæŠŠæ•°å€¼å­—æ®µèˆå…¥ä¸ºæŒ‡å®šçš„å°æ•°ä½æ•°ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(`column_name`, `decimals`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br></pre></td></tr></table></figure></p><ul><li>column_name ä¸ºè¦èˆå…¥çš„å­—æ®µ</li><li>decimals è§„å®šè¦è¿”å›çš„å°æ•°ä½æ•°</li><li>ROUND() å‡½æ•°å§‹ç»ˆè¿”å›ä¸€ä¸ªå€¼ã€‚å½“ decimals ä¸ºæ­£æ•°æ—¶ï¼Œcolumn_name å››èˆäº”å…¥ä¸º decimals æ‰€æŒ‡å®šçš„å°æ•°ä½æ•°ã€‚å½“ decimals ä¸ºè´Ÿæ•°æ—¶ï¼Œcolumn_name åˆ™æŒ‰ decimals æ‰€æŒ‡å®šçš„åœ¨å°æ•°ç‚¹çš„å·¦è¾¹å››èˆäº”å…¥ã€‚</li><li>ç‰¹åˆ«çš„ï¼Œå¦‚æœ length æ˜¯è´Ÿæ•°ä¸”å¤§äºå°æ•°ç‚¹å‰çš„æ•°å­—ä¸ªæ•°ï¼ŒROUND() å‡½æ•°å°†è¿”å› 0</li></ul><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="built_in">AVG</span>(`student_count`), <span class="number">2</span>) <span class="keyword">AS</span> `avg_student_count`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨NULL-å‡½æ•°åˆ¤æ–­ç©ºå€¼"><a href="#ä½¿ç”¨NULL-å‡½æ•°åˆ¤æ–­ç©ºå€¼" class="headerlink" title="ä½¿ç”¨NULL()å‡½æ•°åˆ¤æ–­ç©ºå€¼"></a>ä½¿ç”¨NULL()å‡½æ•°åˆ¤æ–­ç©ºå€¼</h3><h4 id="ISNULL"><a href="#ISNULL" class="headerlink" title="ISNULL()"></a>ISNULL()</h4><blockquote><p><code>ISNULL()</code> å‡½æ•°ç”¨äºåˆ¤æ–­å­—æ®µæ˜¯å¦ä¸º NULLï¼Œå®ƒåªæœ‰ä¸€ä¸ªå‚æ•° <code>column_name</code> ä¸ºåˆ—åï¼Œæ ¹æ®<code>column_name</code> åˆ—ä¸­çš„å­—æ®µæ˜¯å¦ä¸º NULL å€¼è¿”å› 0 æˆ– 1ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ISNULL(`column_name`)</span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼š</p><ul><li>å¦‚æœ <code>column_name</code> åˆ—ä¸­çš„æŸä¸ªå­—æ®µæ˜¯ NULL åˆ™è¿”å› 1ï¼Œä¸æ˜¯åˆ™è¿”å› 0</li></ul><h4 id="IFNULL"><a href="#IFNULL" class="headerlink" title="IFNULL()"></a>IFNULL()</h4><blockquote><p><code>IFNULL()</code> å‡½æ•°ä¹Ÿç”¨äºåˆ¤æ–­å­—æ®µæ˜¯å¦ä¸ºNULLï¼Œä½†æ˜¯ä¸ <code>ISNULL()</code> ä¸åŒçš„æ˜¯å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° <code>column_name</code> ä¸ºåˆ—åï¼Œç¬¬äºŒä¸ªå‚æ•° <code>value</code> ç›¸å½“äºå¤‡ç”¨å€¼ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> IFNULL(`column_name`, `<span class="keyword">value</span>`)</span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼š</p><ul><li>å¦‚æœ <code>column_name</code> åˆ—ä¸­çš„æŸä¸ªå­—æ®µæ˜¯ NULL åˆ™è¿”å› value å€¼ï¼Œä¸æ˜¯åˆ™è¿”å›å¯¹åº”å†…å®¹ã€‚</li><li><code>COALESCE(column_name, value)</code> å‡½æ•°ä¹Ÿç”¨äºåˆ¤æ–­å­—æ®µæ˜¯å¦ä¸ºNULLï¼Œå…¶ç”¨æ³•å’Œ <code>IFNULL()</code> ç›¸åŒã€‚</li></ul><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, `email`, ISNULL(`email`), IFNULL(`email`, <span class="number">0</span>), <span class="built_in">COALESCE</span>(`email`, <span class="number">0</span>) </span><br><span class="line"><span class="keyword">FROM</span> `teachers`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨-COUNT-å‡½æ•°è®¡æ•°"><a href="#ä½¿ç”¨-COUNT-å‡½æ•°è®¡æ•°" class="headerlink" title="ä½¿ç”¨ COUNT() å‡½æ•°è®¡æ•°"></a>ä½¿ç”¨ COUNT() å‡½æ•°è®¡æ•°</h3><blockquote><p>COUNT() å‡½æ•°<code>ç”¨äºè®¡æ•°ï¼Œå¯åˆ©ç”¨å…¶ç¡®å®šè¡¨ä¸­è¡Œçš„æ•°ç›®æˆ–è€…ç¬¦åˆç‰¹å®šæ¡ä»¶çš„è¡Œçš„æ•°ç›®</code>ã€‚å½“COUNT() ä¸­çš„å‚æ•°ä¸åŒæ—¶ï¼Œå…¶çš„ç”¨é€”ä¹Ÿæ˜¯æœ‰æ˜æ˜¾çš„ä¸åŒçš„ï¼Œä¸»è¦å¯åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š<code>COUNT(column_name) ã€COUNT( * ) å’Œ COUNT(DISTINCT column_name)</code>ã€‚</p></blockquote><h4 id="COUNT-column-name"><a href="#COUNT-column-name" class="headerlink" title="COUNT( column_name )"></a>COUNT( column_name )</h4><blockquote><p>COUNT(column_name) å‡½æ•°ä¼šå¯¹æŒ‡å®šåˆ—å…·æœ‰çš„è¡Œæ•°è¿›è¡Œè®¡æ•°ï¼Œä½†æ˜¯ä¼šé™¤å»å€¼ä¸º NULL çš„è¡Œã€‚è¯¥å‡½æ•°ä¸»è¦ç”¨äºæŸ¥çœ‹å„åˆ—æ•°æ®çš„æ•°é‡æƒ…å†µï¼Œä¾¿äºç»Ÿè®¡æ•°æ®çš„ç¼ºå¤±å€¼ã€‚<br>å‡å¦‚å‡ºç°æŸä¸€åˆ—çš„æ•°æ®å…¨ä¸º NULL å€¼çš„æƒ…å†µ,ä½¿ç”¨COUNT( column_name ) å‡½æ•°å¯¹è¯¥åˆ—è¿›è¡Œè®¡æ•°ï¼Œä¼šè¿”å› 0ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(`column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><h4 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT(*)"></a>COUNT(*)</h4><blockquote><p>COUNT(*) å‡½æ•°ä¼šå¯¹è¡¨ä¸­è¡Œçš„æ•°ç›®è¿›è¡Œè®¡æ•°ï¼ŒåŒ…æ‹¬å€¼ä¸º NULL æ‰€åœ¨è¡Œå’Œé‡å¤é¡¹æ‰€åœ¨è¡Œã€‚è¯¥å‡½æ•°ä¸»è¦ç”¨äºæŸ¥çœ‹è¡¨ä¸­çš„è®°å½•æ•°ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br></pre></td></tr></table></figure></p><ul><li><p>COUNT(column_name) ä¸­ï¼Œå¦‚æœ <code>column_name</code> å­—æ®µä¸­çš„å€¼ä¸º NULLï¼Œåˆ™è®¡æ•°ä¸ä¼šå¢åŠ ï¼Œè€Œå¦‚æœå­—æ®µå€¼ä¸ºç©ºå­—ç¬¦ä¸²<code>&quot;&quot;</code>ï¼Œåˆ™å­—æ®µå€¼ä¼šåŠ  1</p></li><li><p>COUNT(<em>) ä¸­ï¼Œé™¤éæ•´ä¸ªè®°å½•å…¨ä¸º NULLï¼Œåˆ™è®¡æ•°ä¸ä¼šå¢åŠ ï¼Œå¦‚æœå­˜åœ¨æŸä¸€ä¸ªè®°å½•ä¸ä¸º NULLï¼Œæˆ–è€…ä¸ºç©ºå­—ç¬¦ä¸²<code>&quot;&quot;</code>ï¼Œè®¡æ•°å€¼éƒ½ä¼šåŠ  1ã€‚æ­£å¸¸æ¥è¯´ï¼Œè¡¨éƒ½ä¼šæœ‰ä¸»é”®ï¼Œè€Œä¸»é”®ä¸ä¸ºç©ºï¼Œæ‰€ä»¥ COUNT(</em>) åœ¨æœ‰ä¸»é”®çš„è¡¨ä¸­ç­‰åŒäº COUNT(PRIMARY_KEY)ï¼Œå³æŸ¥è¯¢æœ‰å¤šå°‘æ¡è®°å½•ã€‚</p></li></ul><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> `number_of_course`</span><br><span class="line"><span class="keyword">FROM</span> `courses`</span><br><span class="line"><span class="keyword">WHERE</span> `created_at` <span class="keyword">BETWEEN</span> <span class="string">&#x27;2020-01-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2020-05-31&#x27;</span>;</span><br></pre></td></tr></table></figure></p><h4 id="COUNT-DISTINCT-column-name"><a href="#COUNT-DISTINCT-column-name" class="headerlink" title="COUNT(DISTINCT column_name)"></a>COUNT(DISTINCT column_name)</h4><blockquote><p>COUNT(DISTINCT column_name) å‡½æ•°è¿”å›æŒ‡å®šåˆ—çš„ä¸åŒå€¼çš„æ•°ç›®</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> `column_name`) </span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> `teacher_id`) <span class="keyword">AS</span> `number_of_teacher`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h2 id="æ—¶é—´å‡½æ•°"><a href="#æ—¶é—´å‡½æ•°" class="headerlink" title="æ—¶é—´å‡½æ•°"></a>æ—¶é—´å‡½æ•°</h2><h3 id="ä½¿ç”¨-NOW-ã€-CURDATE-ã€CURTIME-è·å–å½“å‰æ—¶é—´"><a href="#ä½¿ç”¨-NOW-ã€-CURDATE-ã€CURTIME-è·å–å½“å‰æ—¶é—´" class="headerlink" title="ä½¿ç”¨ NOW() ã€ CURDATE()ã€CURTIME() è·å–å½“å‰æ—¶é—´"></a>ä½¿ç”¨ NOW() ã€ CURDATE()ã€CURTIME() è·å–å½“å‰æ—¶é—´</h3><blockquote><p>åœ¨ SQL ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ <strong>NOW()</strong>ã€<strong>CURDATE()</strong>ã€<strong>CURTIME()</strong> æ¥è·å–å½“å‰çš„æ—¶é—´</p><ul><li><code>NOW()</code> å¯ä»¥ç”¨æ¥è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´ æ ¼å¼ï¼šYYYY-MM-DD hh:mm:ss</li><li><code>CURDATE()</code> å¯ä»¥ç”¨æ¥è¿”å›å½“å‰æ—¥æœŸ æ ¼å¼ï¼šYYYY-MM-DD</li><li><code>CURTIME()</code> å¯ä»¥ç”¨æ¥è¿”å›å½“å‰æ—¶é—´ æ ¼å¼ï¼šhh:mm:ss</li></ul></blockquote><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `records`</span><br><span class="line"><span class="keyword">VALUES</span> (NOW(<span class="number">3</span>));</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨-DATE-ã€TIME-å‡½æ•°æå–æ—¥æœŸå’Œæ—¶é—´"><a href="#ä½¿ç”¨-DATE-ã€TIME-å‡½æ•°æå–æ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="ä½¿ç”¨ DATE()ã€TIME() å‡½æ•°æå–æ—¥æœŸå’Œæ—¶é—´"></a>ä½¿ç”¨ DATE()ã€TIME() å‡½æ•°æå–æ—¥æœŸå’Œæ—¶é—´</h3><blockquote><p>DATE()ã€TIME()å¯ä»¥å¯¹ç°æœ‰æ—¶é—´è¿›è¡Œæå–ã€‚<br>ä½¿ç”¨ <code>DATE()</code>ã€<code>TIME()</code> å‡½æ•°åˆ†åˆ«å°† <code>&#39;2021-03-25 16:16:30&#39;</code> è¿™ç»„æ•°æ®ä¸­çš„æ—¥æœŸäºæ—¶é—´æå–å‡ºæ¥ï¼Œå¹¶ç”¨ <code>date</code> ã€<code>time</code> ä½œä¸ºç»“æœé›†åˆ—åã€‚</p></blockquote><p><strong>ä¸¾ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="type">DATE</span>(<span class="string">&#x27;2021-03-25 16:16:30&#x27;</span>) <span class="keyword">AS</span> `<span class="type">date</span>`,<span class="type">TIME</span>(<span class="string">&#x27;2021-03-25 16:16:30&#x27;</span>)  <span class="keyword">AS</span> `<span class="type">time</span>`;</span><br></pre></td></tr></table></figure></p><p><strong>å®ä¾‹</strong></p><blockquote><p>ä½¿ç”¨ <code>DATE()</code> å‡½æ•°ä»è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æŸ¥è¯¢è¯¾ç¨‹çš„åå­— <code>name</code> å’Œè¯¾ç¨‹åˆ›å»ºæ—¶é—´ <code>created_at</code>ï¼Œä»è¯¾ç¨‹åˆ›å»ºæ—¶é—´ <code>created_at</code> ä¸­æå–å‡ºåˆ›å»ºè¯¾ç¨‹çš„æ—¥æœŸï¼Œå¹¶åŠ ä»¥æ ¼å¼åŒ–ï¼Œç”¨ <code>created_date</code> ä½œä¸ºç»“æœé›†åˆ—åã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, <span class="type">DATE</span>(`created_at`) <span class="keyword">AS</span> `created_date` <span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ <code>DATE()</code> ã€ <code>TIME()</code> å‡½æ•°ä»è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æŸ¥è¯¢è¯¾ç¨‹çš„åå­— <code>name</code> å’Œè¯¾ç¨‹åˆ›å»ºæ—¶é—´ <code>created_at</code>ï¼Œä»è¯¾ç¨‹åˆ›å»ºæ—¶é—´ <code>created_at</code> ä¸­æå–å‡ºåˆ›å»ºè¯¾ç¨‹çš„æ—¥æœŸä¸æ—¶é—´ï¼Œç”¨ <code>created_date</code> å’Œ <code>created_time</code> ä½œä¸ºç»“æœé›†åˆ—åã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, `created_at`, </span><br><span class="line">DATE_FORMAT(<span class="type">DATE</span>(`created_at`),&quot;%Y-%m-%d&quot;) <span class="keyword">AS</span> `created_date`,</span><br><span class="line">DATE_FORMAT(<span class="type">TIME</span>(`created_at`),&quot;%H:%i:%s&quot;) <span class="keyword">AS</span> `created_time` </span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-EXTRACT-å‡½æ•°æå–æŒ‡å®šçš„æ—¶é—´ä¿¡æ¯"><a href="#ä½¿ç”¨-EXTRACT-å‡½æ•°æå–æŒ‡å®šçš„æ—¶é—´ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨ EXTRACT() å‡½æ•°æå–æŒ‡å®šçš„æ—¶é—´ä¿¡æ¯"></a>ä½¿ç”¨ EXTRACT() å‡½æ•°æå–æŒ‡å®šçš„æ—¶é—´ä¿¡æ¯</h3><blockquote><p>EXTRACT() å‡½æ•°ç”¨äºè¿”å›æ—¥æœŸ/æ—¶é—´çš„å•ç‹¬éƒ¨åˆ†ï¼Œå¦‚ <code>YEAR</code> (å¹´)ã€<code>MONTH</code> (æœˆ)ã€<code>DAY</code> (æ—¥)ã€<code>HOUR</code> (å°æ—¶)ã€<code>MINUTE</code> (åˆ†é’Ÿ)ã€ <code>SECOND</code> (ç§’)ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(unit <span class="keyword">FROM</span> <span class="type">date</span>)</span><br><span class="line"><span class="keyword">FROM</span> `<span class="keyword">table</span>`</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼š<br>_table_ æ˜¯è¡¨æ ¼å<br>_date_ å‚æ•°æ˜¯åˆæ³•çš„æ—¥æœŸè¡¨è¾¾å¼ã€‚<br>_unit_ å‚æ•°æ˜¯éœ€è¦è¿”å›çš„æ—¶é—´éƒ¨åˆ†ï¼Œå¦‚ <code>YEAR</code> ã€<code>MONTH</code> ã€ <code>DAY</code> ã€ <code>HOUR</code> ã€<code>MINUTE</code> ã€<code>SECOND</code> ç­‰ã€‚</p><p><strong>å®ä¾‹</strong></p><blockquote><p>ä½¿ç”¨ EXTRACT() å‡½æ•°ï¼Œä»è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­æŸ¥è¯¢è¯¾ç¨‹çš„åå­—å’Œåˆ›å»ºæ—¶é—´çš„å°æ—¶æ•°ï¼Œå¹¶ä¸º <code>created_at</code> èµ·åˆ«åä¸º <code>created_hour</code> ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, <span class="built_in">EXTRACT</span>(<span class="keyword">HOUR</span> <span class="keyword">FROM</span> `created_at`) <span class="keyword">AS</span> `created_hour`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-DATE-FORMAT-æ ¼å¼åŒ–è¾“å‡ºæ—¥æœŸ"><a href="#ä½¿ç”¨-DATE-FORMAT-æ ¼å¼åŒ–è¾“å‡ºæ—¥æœŸ" class="headerlink" title="ä½¿ç”¨ DATE_FORMAT() æ ¼å¼åŒ–è¾“å‡ºæ—¥æœŸ"></a>ä½¿ç”¨ DATE_FORMAT() æ ¼å¼åŒ–è¾“å‡ºæ—¥æœŸ</h3><blockquote><p>ä½¿ç”¨ <code>DATE_FORMAT()</code> æ–¹æ³•æ¥æ ¼å¼åŒ–è¾“å‡º date/timeã€‚éœ€è¦æ³¨æ„çš„æ˜¯ <code>DATE_FORMAT()</code> å‡½æ•°è¿”å›çš„æ˜¯<strong>å­—ç¬¦ä¸²</strong>æ ¼å¼ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(<span class="type">date</span>,format);</span><br></pre></td></tr></table></figure><br>å…¶ä¸­<br><code>date</code> ä¸€ä¸ªæœ‰æ•ˆæ—¥æœŸã€‚<br><code>format</code> æ˜¯ date/time çš„è¾“å‡ºæ ¼å¼ã€‚</p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(`created_at`, <span class="string">&#x27;%Y %m&#x27;</span>) <span class="keyword">AS</span> `DATE_FORMAT`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><blockquote><p>DATE_FORMAT(created_at,â€™%Y-%m-%d %H:%i:%sâ€™)<br>%y - å¹´ä»½çš„åä¸¤ä½ï¼ˆ18ï¼‰ %Y - å¹´ä»½ï¼ˆ2018ï¼‰<br>    %M - æœˆä»½çš„åç§°ï¼ˆAprilï¼‰ %m - æœˆä»½æ•°ï¼ˆ4ï¼‰<br>    %D - åºæ•°å·ï¼ˆ13thï¼‰ %d - æ—¥æœŸæ•°ï¼ˆ13ï¼‰<br>    %H - 24è¿›åˆ¶ %h - 12è¿›åˆ¶<br>    %I - å˜æˆ12è¿›åˆ¶å°æ—¶æ•°ï¼Ÿ %i - åˆ†é’Ÿæ•°<br>    %S å’Œ %s ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆå½±å“</p></blockquote><p>æŸ¥è¯¢ <code>courses</code> è¡¨ï¼ŒæŸ¥è¯¢è¯¾ç¨‹åˆ›å»ºæ—¶é—´ï¼ŒæŒ‰ç…§ â€™å¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’â€™ çš„æ ¼å¼è¿”å›ç»“æœï¼Œè¿”å›åˆ—åæ˜¾ç¤ºä¸º <code>DATE_FORMAT</code>ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> date_format(created_at, &quot;%Y-%m-%d %H:%i:%s&quot;) DATE_FORMAT <span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">select</span> date_format(created_at, &quot;%Y-%m-%d %T&quot;) DATE_FORMAT <span class="keyword">from</span> courses</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨-DATE-ADD-å¢åŠ æ—¶é—´"><a href="#ä½¿ç”¨-DATE-ADD-å¢åŠ æ—¶é—´" class="headerlink" title="ä½¿ç”¨ DATE_ADD() å¢åŠ æ—¶é—´"></a>ä½¿ç”¨ DATE_ADD() å¢åŠ æ—¶é—´</h3><blockquote><p><code>DATE_ADD()</code> å‡½æ•°æ˜¯å¸¸ç”¨çš„æ—¶é—´å‡½æ•°ä¹‹ä¸€ï¼Œç”¨äº<strong>å‘æ—¥æœŸæ·»åŠ æŒ‡å®šçš„æ—¶é—´é—´éš”</strong>ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_ADD(<span class="type">date</span>, <span class="type">INTERVAL</span> expr type)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼š<code>date</code> æŒ‡ä»£å¸Œæœ›è¢«æ“ä½œçš„æœ‰æ•ˆæ—¥æœŸï¼Œä¸ºèµ·å§‹æ—¥æœŸ</p><p><code>expr</code> æ˜¯å¸Œæœ›æ·»åŠ çš„æ—¶é—´é—´éš”çš„æ•°å€¼ï¼ˆexpr æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºè´Ÿå€¼çš„é—´éš”ï¼Œå¯ä»¥ä»¥ â€-â€œ å¼€å¤´ï¼‰</p><p><code>type</code> æ˜¯å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œè¡¨ç¤ºåŠ ä¸Šæ—¶é—´é—´éš”çš„å•ä½ï¼ˆå¯ä»¥æ˜¯ MICROSECOND , SECOND , MINUTE , HOUR , DAY , WEEK , MONTH , QUARTER , YEAR ç­‰ï¼‰</p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `name`, DATE_ADD(`created_at`, <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>) <span class="keyword">AS</span> `new_created` </span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨-DATE-SUB-å‡å°‘æ—¶é—´"><a href="#ä½¿ç”¨-DATE-SUB-å‡å°‘æ—¶é—´" class="headerlink" title="ä½¿ç”¨ DATE_SUB() å‡å°‘æ—¶é—´"></a>ä½¿ç”¨ DATE_SUB() å‡å°‘æ—¶é—´</h3><blockquote><p>DATE_SUB() å‡½æ•°æ˜¯å¸¸ç”¨çš„æ—¶é—´å‡½æ•°ä¹‹ä¸€ï¼Œç”¨äº<strong>ä»æ—¥æœŸå‡å»æŒ‡å®šçš„æ—¶é—´é—´éš”</strong>ã€‚å®ƒä¸ <code>DATE_ADD()</code> å‡½æ•°å…·æœ‰ç›¸ä¼¼çš„ç”¨æ³•ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_SUB(<span class="type">date</span>, <span class="type">INTERVAL</span> expr type)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br></pre></td></tr></table></figure><br>å…¶ä¸­ï¼š<code>date</code> æŒ‡ä»£å¸Œæœ›è¢«æ“ä½œçš„æœ‰æ•ˆæ—¥æœŸ</p><p><code>expr</code> æ˜¯å¸Œæœ›æ·»åŠ çš„æ—¶é—´é—´éš”</p><p><code>type</code> æ˜¯å…·ä½“çš„æ•°æ®ç±»å‹ï¼ˆå¯ä»¥æ˜¯ MICROSECOND , SECOND , MINUTE , HOUR , DAY , WEEK , MONTH , QUARTER , YEAR ç­‰ï¼‰</p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `id`,`name`, DATE_SUB(`created_at`, <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">MONTH</span>) <span class="keyword">AS</span> `new_created`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨æ—¶é—´å‡½æ•°-DATEDIFF-å’Œ-TIMESTAMPDIFF-è®¡ç®—æ—¥æœŸå·®"><a href="#ä½¿ç”¨æ—¶é—´å‡½æ•°-DATEDIFF-å’Œ-TIMESTAMPDIFF-è®¡ç®—æ—¥æœŸå·®" class="headerlink" title="ä½¿ç”¨æ—¶é—´å‡½æ•° DATEDIFF() å’Œ TIMESTAMPDIFF() è®¡ç®—æ—¥æœŸå·®"></a>ä½¿ç”¨æ—¶é—´å‡½æ•° DATEDIFF() å’Œ TIMESTAMPDIFF() è®¡ç®—æ—¥æœŸå·®</h3><h4 id="DATEDIFF"><a href="#DATEDIFF" class="headerlink" title="DATEDIFF()"></a>DATEDIFF()</h4><blockquote><p>DATEDIFF() å¸¸ç”¨çš„æ—¥æœŸå·®ï¼Œåœ¨ MySQL ä¸­é»˜è®¤åªèƒ½è®¡ç®—å¤©æ•°å·®ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br>DATEDIFF() ç”¨æ³•ï¼šDATEDIFFï¼ˆæ—¶é—´1ï¼Œæ—¶é—´2ï¼‰<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATEDIFF(æ—¶é—´<span class="number">1</span>,æ—¶é—´<span class="number">2</span>) <span class="keyword">AS</span> date_diff <span class="keyword">FROM</span> courses;</span><br></pre></td></tr></table></figure><br>DATEDIFF() å·®å€¼è®¡ç®—è§„åˆ™ï¼šæ—¶é—´ 1 - æ—¶é—´ 2, <code>date_diff</code> ä¸ºè¿”å›ç»“æœåˆ—åç§°</p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATEDIFF(created_at,<span class="string">&#x27;2018-01-13&#x27;</span>) <span class="keyword">AS</span> date_diff <span class="keyword">FROM</span> courses;</span><br></pre></td></tr></table></figure></p><h4 id="TIMESTAMPDIFF"><a href="#TIMESTAMPDIFF" class="headerlink" title="TIMESTAMPDIFF()"></a>TIMESTAMPDIFF()</h4><blockquote><p>æŸ¥è¯¢åŠŸèƒ½å¤šçš„ MySQL è‡ªå¸¦çš„æ—¥æœŸå‡½æ•°ï¼Œå¯ä»¥è®¡ç®—ä¸¤ä¸ªæ—¥æœŸç›¸å·®çš„å¹´(YEARï¼Œæ—¶é—´1,æ—¶é—´2)ï¼Œæœˆ(MONTHï¼Œæ—¶é—´1,æ—¶é—´2)ï¼Œå‘¨(WEEKï¼Œæ—¶é—´1,æ—¶é—´2)ï¼Œæ—¥(DAYï¼Œæ—¶é—´1,æ—¶é—´2)ï¼Œå°æ—¶(HOURï¼Œæ—¶é—´1,æ—¶é—´2)ã€‚</p></blockquote><p><strong>è¯­æ³•</strong><br>TIMESTAMPDIFF() ç”¨æ³•ï¼šTIMESTAMPDIFF (ç±»å‹,æ—¶é—´1,æ—¶é—´2)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TIMESTAMPDIFF (ç±»å‹,æ—¶é—´<span class="number">1</span>,æ—¶é—´<span class="number">2</span>) <span class="keyword">AS</span> year_diffï¼›</span><br></pre></td></tr></table></figure><br>TIMESTAMPDIFF() å·®å€¼è®¡ç®—è§„åˆ™ï¼šæ—¶é—´ 2 - æ—¶é—´ 1, <code>year_diff</code> ä¸ºè¿”å›ç»“æœåˆ—åç§°</p><p><strong>å®ä¾‹</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">AS</span> `courses_name` ,created_at <span class="keyword">AS</span> `courses_created_at`,TIMESTAMPDIFF(<span class="keyword">YEAR</span>, `created_at`, <span class="string">&#x27;2021-04-01&#x27;</span>) <span class="keyword">AS</span> `year_diff`</span><br><span class="line"><span class="keyword">FROM</span> `courses`;</span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼šDATEDIFF()å’ŒTIMESTAMPDIFF()æ—¶é—´ç›¸å‡çš„é¡ºåºã€‚</p><p>cor# è”ç»“<br>SQL æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯èƒ½åœ¨æ•°æ®æ£€ç´¢æŸ¥è¯¢çš„æ‰§è¡Œä¸­è”ç»“è¡¨ã€‚</p><h3 id="ä»€ä¹ˆå«è”ç»“ï¼Ÿ"><a href="#ä»€ä¹ˆå«è”ç»“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå«è”ç»“ï¼Ÿ"></a>ä»€ä¹ˆå«è”ç»“ï¼Ÿ</h3><p>å¯ä»¥ä¸¾ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­æ¥ç†è§£â€œè”ç»“â€ï¼š<br>ğŸ‘‡<br>åœ¨å¤§å­¦æ¯ä¸€ä¸ªæ–°å­¦æœŸå³å°†å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šé‡åˆ°ä¸€ä¸ªå¤§éš¾é¢˜ï¼Œé‚£å°±æ˜¯é€‰è¯¾ã€‚<br>å‡å¦‚æ‰€æœ‰è¯¾ç¨‹çš„ä¿¡æ¯å’Œæ‰€æœ‰æ•™å¸ˆçš„ä¿¡æ¯éƒ½å­˜æ”¾åœ¨åŒä¸€å¼ è¡¨ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ˜¾å¾—å¾ˆç¹çä¸”ä¸ä¾¿äºä¿¡æ¯çš„æ›´æ”¹ã€‚å› ä¸ºåŒä¸€ä¸ªæ•™å¸ˆå¼€è®¾çš„ä¸åŒè¯¾ç¨‹å¯¹åº”çš„æ•™å¸ˆä¿¡æ¯éƒ½æ˜¯ç›¸åŒçš„ï¼Œå½“æ•™å¸ˆä¿¡æ¯æ”¹å˜æ—¶ï¼Œéœ€è¦ä¿®æ”¹å¤šæ¡è¯¾ç¨‹ã€‚<br>å› æ­¤ï¼Œä¸ºäº†åŒå­¦ä»¬åœ¨é€‰è¯¾æ—¶æ“ä½œæ›´ä¾¿åˆ©ï¼Œæˆ‘ä»¬æ ¹æ®å†…å®¹å°†æ‰€æœ‰æ•°æ®åˆ†è§£ä¸ºäº†ä¸¤ä¸ªè¡¨ï¼Œå³æ•™å¸ˆè¡¨å’Œè¯¾ç¨‹è¡¨ã€‚<br>æˆ‘ä»¬å¯ä»¥å°†ä»–ä»¬ç§°ä¸º<strong>å…³ç³»è¡¨</strong>ã€‚å…³ç³»è¡¨å°±æ˜¯ä¸€ç±»æ•°æ®ä¸€ä¸ªè¡¨ï¼Œå„è¡¨é€šè¿‡æŸäº›å…³ç³»äº’ç›¸å…³è”ã€‚<br>è”ç»“ä¸­çš„ä¸¤å¤§ä¸»è§’â€”â€”<strong>ä¸»é”®ï¼ˆPRIMARY KEYï¼‰</strong>å’Œ<strong>å¤–é”®ï¼ˆFOREIGN KEYï¼‰</strong>ã€‚</p><p>è¡¨1ï¼šcoursesï¼ˆè¯¾ç¨‹è¡¨ï¼‰<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int unsigned|ä¸»é”®|<br>|name|varchar|è¯¾ç¨‹åç§°|<br>|student_count|int|å­¦æœ¯æ€»æ•°|<br>|created_at|date|åˆ›å»ºè¯¾ç¨‹æ—¶é—´|<br>|teacher_id|int|è®²å¸ˆid|<br>è¡¨äºŒï¼šteachersï¼ˆæ•™å¸ˆè¡¨ï¼‰<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int|ä¸»é”®|<br>|name|varchar|è®²å¸ˆå§“å|<br>|email|varchar|è®²å¸ˆé‚®ç®±|<br>|age|int|è®²å¸ˆå¹´é¾„|<br>|country|varchar|è®²å¸ˆå›½ç±|<br>æ•™å¸ˆè¡¨ <code>teachers</code> ä¸­åŒ…å«æ‰€æœ‰æ•™å¸ˆçš„ä¿¡æ¯ï¼Œæ¯ä¸ªæ•™å¸ˆå…·æœ‰å”¯ä¸€çš„æ ‡è¯†ï¼Œè¿™ä¸ªæ ‡è¯†è¢«ç§°ä¸º<strong>ä¸»é”®ï¼ˆPRIMARY KEYï¼‰</strong>ï¼Œå¯ä»¥ä¸º id æˆ–å…¶ä»–å”¯ä¸€å€¼ã€‚æˆ‘ä»¬è¿™é‡Œé€‰æ‹©æ•™å¸ˆç¼–å·ï¼ˆ<code>id</code>ï¼‰ä¸ºæ•™å¸ˆè¡¨çš„ä¸»é”®ã€‚</p><p>è€Œåœ¨è¯¾ç¨‹è¡¨ <code>courses</code> ä¸­ï¼Œé™¤äº†æ•™å¸ˆç¼–å· <code>teacher_id</code>ï¼ˆå³æ•™å¸ˆè¡¨çš„ä¸»é”®ï¼‰å¤–ä¸å­˜å‚¨ä»»ä½•æ•™å¸ˆçš„ä¿¡æ¯ã€‚åˆ™æ•™å¸ˆç¼–å·ä¸ºè¯¾ç¨‹è¡¨çš„<strong>å¤–é”®ï¼ˆFOREIGN KEYï¼‰</strong>ã€‚</p><p>æ•™å¸ˆè¡¨çš„ä¸»é”®åˆå«ä½œè¯¾ç¨‹è¡¨çš„å¤–é”®ï¼Œå› æ­¤è¿™ä¸¤ä¸ªè¡¨é€šè¿‡æ•™å¸ˆç¼–å·è¿™ä¸€åˆ—å…³è”äº†ã€‚</p><h3 id="æ€ä¹ˆåˆ›å»ºè”ç»“ï¼Ÿ"><a href="#æ€ä¹ˆåˆ›å»ºè”ç»“ï¼Ÿ" class="headerlink" title="æ€ä¹ˆåˆ›å»ºè”ç»“ï¼Ÿ"></a>æ€ä¹ˆåˆ›å»ºè”ç»“ï¼Ÿ</h3><p>è§„å®šè¦è”ç»“çš„æ‰€æœ‰è¡¨ä»¥åŠå®ƒä»¬å¦‚ä½•å…³è”å°±å¯ä»¥äº†ã€‚<br>åœ¨è®¾ç½®å…³è”æ¡ä»¶æ—¶ï¼Œä¸ºé¿å…ä¸åŒè¡¨è¢«å¼•ç”¨çš„åˆ—åç›¸åŒï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<strong>å®Œå…¨é™å®šåˆ—å</strong>ï¼ˆç”¨ä¸€ä¸ªç‚¹åˆ†éš”è¡¨åå’Œåˆ—åï¼‰ï¼Œå¦åˆ™ä¼šè¿”å›é”™è¯¯ã€‚<br>ç”¨æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`table1`.`common_field` <span class="operator">=</span> `table2`.`common_field`</span><br></pre></td></tr></table></figure><br>æ•™å¸ˆè¡¨çš„ä¸»é”® <code>id</code> ä¸ºè®¾ç½®çš„å…³è”æ¡ä»¶ä¸ºï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`teachers`.`id` = `courses`.`teacher_id` </span><br></pre></td></tr></table></figure></p><h3 id="JOIN-è¿æ¥å­å¥"><a href="#JOIN-è¿æ¥å­å¥" class="headerlink" title="JOIN è¿æ¥å­å¥"></a>JOIN è¿æ¥å­å¥</h3><p>SQL JOIN è¿æ¥å­å¥ç”¨äºå°†æ•°æ®åº“ä¸­ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šè¡¨ä¸­çš„è®°å½•ç»„åˆèµ·æ¥ã€‚å…¶ç±»å‹ä¸»è¦åˆ†ä¸º INNER JOINï¼ˆå†…è¿æ¥ï¼‰ã€OUTER JOINï¼ˆå¤–è¿æ¥ï¼‰ã€å…¨è¿æ¥ï¼ˆFULL JOINï¼‰å’Œäº¤å‰è¿æ¥ï¼ˆCROSS JOINï¼‰ï¼Œå…¶ä¸­ OUTER JOIN åˆå¯ä»¥ç»†åˆ†ä¸º LEFT JOINï¼ˆå·¦è¿æ¥ï¼‰å’Œ RIGHT JOINï¼ˆå³è¿æ¥ï¼‰ã€‚<br>å› æ­¤ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„ JOIN è¿æ¥ç±»å‹å¦‚ä¸‹ï¼š</p><ul><li><strong>INNER JOIN</strong>ï¼šå¦‚æœè¡¨ä¸­æœ‰è‡³å°‘ä¸€ä¸ªåŒ¹é…ï¼Œåˆ™è¿”å›è¡Œ</li><li><strong>LEFT JOIN</strong>ï¼šå³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å·¦è¡¨è¿”å›æ‰€æœ‰çš„è¡Œ</li><li><strong>RIGHT JOIN</strong>ï¼šå³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å³è¡¨è¿”å›æ‰€æœ‰çš„è¡Œ</li><li><strong>FULL JOIN</strong>ï¼šåªè¦å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œåˆ™è¿”å›è¡Œ</li><li><strong>CROSS JOIN</strong>ï¼šåˆç§°<strong>ç¬›å¡å°”ç§¯</strong>ï¼Œä¸¤ä¸ªè¡¨æ•°æ®ä¸€ä¸€å¯¹åº”ï¼Œè¿”å›ç»“æœçš„è¡Œæ•°ç­‰äºä¸¤ä¸ªè¡¨è¡Œæ•°çš„ä¹˜ç§¯</li></ul><h4 id="å†…è¿æ¥-INNER-JOIN"><a href="#å†…è¿æ¥-INNER-JOIN" class="headerlink" title="å†…è¿æ¥ INNER JOIN"></a>å†…è¿æ¥ INNER JOIN</h4><blockquote><p>å†…è¿æ¥æ ¹æ®è”ç»“æ¡ä»¶æ¥ç»„åˆä¸¤ä¸ªè¡¨ä¸­çš„å­—æ®µï¼Œä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æœè¡¨ã€‚å‡å¦‚æˆ‘ä»¬æƒ³å°†è¡¨ 1 å’Œè¡¨ 2 è¿›è¡Œå†…è¿æ¥ï¼ŒSQL æŸ¥è¯¢ä¼šé€ä¸ªæ¯”è¾ƒè¡¨ 1 å’Œè¡¨ 2 ä¸­çš„æ¯ä¸€æ¡è®°å½•ï¼Œæ¥å¯»æ‰¾æ»¡è¶³è”ç»“æ¡ä»¶çš„æ‰€æœ‰è®°å½•å¯¹ã€‚å½“è”ç»“æ¡ä»¶å¾—ä»¥æ»¡è¶³æ—¶ï¼Œæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•å¯¹çš„å­—æ®µå°†ä¼šç»“åˆåœ¨ä¸€èµ·æ„æˆç»“æœè¡¨ã€‚<br>   <code>ç®€å•çš„è¯´ï¼Œå†…è¿æ¥å°±æ˜¯å–ä¸¤ä¸ªè¡¨çš„äº¤é›†ï¼Œè¿”å›çš„ç»“æœå°±æ˜¯è¿æ¥çš„ä¸¤å¼ è¡¨ä¸­éƒ½æ»¡è¶³æ¡ä»¶çš„éƒ¨åˆ†ã€‚</code></p></blockquote><p><img src="https://media-cn.lintcode.com/new_storage_v2/public/staff/None/3/28/e9f00880-8fa2-11eb-83d2-0242ac1d0002/image.png" alt="INNER_JOIN"></p><p><strong>Grammar</strong><br>åŸºæœ¬è¯­æ³•æœ‰å¦‚ä¸‹ä¸¤ç±»<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `table1`.`column1`, `table2`.`column2`...</span><br><span class="line"><span class="keyword">FROM</span> `table1`</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `table2`</span><br><span class="line"><span class="keyword">ON</span> `table1`.`common_field` <span class="operator">=</span> `table2`.`common_field`;</span><br></pre></td></tr></table></figure><br>æˆ–<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `table1`.`column1`, `table2`.`column2`...</span><br><span class="line"><span class="keyword">FROM</span> `table1`</span><br><span class="line"><span class="keyword">JOIN</span> `table2`</span><br><span class="line"><span class="keyword">ON</span> `table1`.`common_field` <span class="operator">=</span> `table2`.`common_field`;</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨ï¼šINNER JOIN ä¸­ INNER å¯ä»¥çœç•¥ä¸å†™</p></blockquote><p>å…¶ä¸­ï¼Œè¯­æ³•çš„æ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.common_field <span class="operator">=</span> table2.common_field</span><br></pre></td></tr></table></figure><br><code>table1</code> å’Œ <code>table2</code> æ˜¯å†…è¿æ¥çš„ä¸¤ä¸ªè¡¨åï¼Œ<code>table1</code>.<code>common_field</code> å’Œ <code>table2</code>.<code>common_field</code><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè”ç»“æ¡ä»¶éœ€ä½¿ç”¨ç‰¹å®šçš„ ON å­å¥ç»™å‡ºã€‚</p><p><strong>Exemple</strong>ğŸ‘‡<br>è¡¨1ï¼šcoursesï¼ˆè¯¾ç¨‹è¡¨ï¼‰<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int unsigned|ä¸»é”®|<br>|name|varchar|è¯¾ç¨‹åç§°|<br>|student_count|int|å­¦æœ¯æ€»æ•°|<br>|created_at|date|åˆ›å»ºè¯¾ç¨‹æ—¶é—´|<br>|teacher_id|int|è®²å¸ˆid|<br>è¯¾ç¨‹è¡¨ <code>courses</code> çš„ä¸»é”®ä¸º <code>id</code><br>è¡¨ä¸­çš„æ¯ä¸€è¡Œè®°å½•ç€ä¸€é—¨è¯¾ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ•™å¸ˆç¼–å· <code>teacher_id</code><br>ä¸‹é¢æ˜¯é€‰è‡ªè¯¾ç¨‹è¡¨ <code>courses</code> çš„æ•°æ®:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name                    <span class="operator">|</span> student_count <span class="operator">|</span> created_at <span class="operator">|</span> teacher_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Senior Algorithm        <span class="operator">|</span>           <span class="number">880</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-06</span><span class="number">-01</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span>          <span class="number">1350</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-07</span><span class="number">-18</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Django                  <span class="operator">|</span>           <span class="number">780</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-02</span><span class="number">-29</span> <span class="operator">|</span>          <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Web                     <span class="operator">|</span>           <span class="number">340</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-04</span><span class="number">-22</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Big Data                <span class="operator">|</span>           <span class="number">700</span> <span class="operator">|</span> <span class="number">2020</span><span class="number">-09</span><span class="number">-11</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Artificial Intelligence <span class="operator">|</span>          <span class="number">1660</span> <span class="operator">|</span> <span class="number">2018</span><span class="number">-05</span><span class="number">-13</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+---------------+------------+------------+</span></span><br></pre></td></tr></table></figure><br>è¡¨äºŒï¼šteachersï¼ˆæ•™å¸ˆè¡¨ï¼‰<br>|åˆ—å|ç±»å‹|æ³¨é‡Š|<br>|:â€”-:|:â€”-:|:â€”-:|<br>|id|int|ä¸»é”®|<br>|name|varchar|è®²å¸ˆå§“å|<br>|email|varchar|è®²å¸ˆé‚®ç®±|<br>|age|int|è®²å¸ˆå¹´é¾„|<br>|country|varchar|è®²å¸ˆå›½ç±|<br>æ•™å¸ˆè¡¨ <code>teachers</code> çš„ä¸»é”®ä¸º <code>id</code><br>è¡¨ä¸­çš„æ¯ä¸€è¡Œè®°å½•ç€ä¸€ä½æ•™å¸ˆçš„ä¿¡æ¯<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">------+------------------+---------------------------+------+---------+</span></span><br><span class="line"><span class="operator">|</span>  id  <span class="operator">|</span> name             <span class="operator">|</span> email                     <span class="operator">|</span> age  <span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------+---------------------------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span> <span class="number">20</span>   <span class="operator">|</span> UK      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> Northern Beggar  <span class="operator">|</span> northern.beggar<span class="variable">@qq</span>.com    <span class="operator">|</span> <span class="number">21</span>   <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> Western Venom    <span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span> <span class="number">28</span>   <span class="operator">|</span> USA     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>    <span class="operator">|</span> Southern Emperor <span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span> <span class="number">21</span>   <span class="operator">|</span> JP      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>    <span class="operator">|</span> Linghu Chong     <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span> <span class="number">18</span>   <span class="operator">|</span> CN      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------+---------------------------+------+---------+</span></span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `c`.`id`, `c`.`name` <span class="keyword">AS</span> `course_name`, `t`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line"><span class="keyword">FROM</span> `courses` `c`</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> `teachers` `t` <span class="keyword">ON</span> `c`.`teacher_id` <span class="operator">=</span> `t`.`id`;</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>courses</code> <code>c</code> ç­‰åŒäº <code>courses</code> AS <code>c</code> ï¼Œç»™<code>courses</code> è¡¨å–åˆ«åä¸º <code>c</code></li><li><code>teachers</code> <code>t</code> ç­‰åŒäº <code>teachers</code> AS <code>t</code> ï¼Œç»™ <code>teachers</code> è¡¨å–åˆ«åä¸º <code>t</code></li><li>INNER JOIN ä¹Ÿå¯å†™ä½œ JOIN</li></ul></blockquote><p>æ‰§è¡Œä»¥ä¸Šä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `c`.`id`, `c`.`name` <span class="keyword">AS</span> `course_name`, `t`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> `courses` `c`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> `teachers` `t` <span class="keyword">ON</span> `c`.`teacher_id` <span class="operator">=</span> `t`.`id`;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> course_name             <span class="operator">|</span> teacher_name     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Senior Algorithm        <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> <span class="keyword">System</span> Design           <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Django                  <span class="operator">|</span> <span class="keyword">NULL</span>             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Web                     <span class="operator">|</span> Southern Emperor <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Big Data                <span class="operator">|</span> Eastern Heretic  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Artificial Intelligence <span class="operator">|</span> Western Venom    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------------+------------------+</span></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.05</span> sec)</span><br></pre></td></tr></table></figure></p><h4 id="å¤–è¿æ¥-OUTER-JOIN"><a href="#å¤–è¿æ¥-OUTER-JOIN" class="headerlink" title="å¤–è¿æ¥ OUTER JOIN"></a>å¤–è¿æ¥ OUTER JOIN</h4><p>å¤–è¿æ¥å¯ä»¥å°†æŸä¸ªè¡¨æ ¼ä¸­ï¼Œåœ¨å¦å¤–ä¸€å¼ è¡¨æ ¼ä¸­æ— å¯¹åº”å…³ç³»ï¼Œä½†æ˜¯ä¹Ÿèƒ½å°†æ•°æ®åŒ¹é…å‡ºæ¥ã€‚<br>åœ¨MySQLä¸­ï¼Œå¤–è¿æ¥æŸ¥è¯¢ä¼šè¿”å›æ‰€æ“ä½œçš„è¡¨ä¸­è‡³å°‘ä¸€ä¸ªè¡¨çš„æ‰€æœ‰æ•°æ®è®°å½•ã€‚åœ¨MySQLä¸­ï¼Œæ•°æ®æŸ¥è¯¢é€šè¿‡SQLè¯­å¥ â€œOUTER JOINâ€¦ONâ€ æ¥å®ç°ï¼Œå¤–è¿æ¥æŸ¥è¯¢å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li>å·¦å¤–è¿æ¥</li><li>å³å¤–è¿æ¥</li><li>å…¨å¤–è¿æ¥</li></ul><p>å¤–è¿æ¥æ•°æ®æŸ¥è¯¢<strong>Grammar</strong>å¦‚ä¸‹ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="number">1</span>,column_name <span class="number">2</span> ... column_name n</span><br><span class="line">    <span class="keyword">FROM</span> table1</span><br><span class="line">        <span class="keyword">LEFT</span> <span class="operator">|</span> <span class="keyword">RIGHT</span> <span class="operator">|</span> <span class="keyword">FULL</span>  (<span class="keyword">OUTER</span>) <span class="keyword">JOIN</span> table2</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">CONDITION</span>;</span><br></pre></td></tr></table></figure><br>åœ¨ä¸Šè¿°è¯­å¥ä¸­ï¼Œå‚æ•° column_name è¡¨ç¤ºæ‰€è¦æŸ¥è¯¢çš„å­—æ®µåå­—ï¼Œæ¥æºäºæ‰€è¿æ¥çš„è¡¨ table1 å’Œ table2ï¼Œå…³é”®å­— OUTER JOIN è¡¨ç¤ºè¡¨è¿›è¡Œå¤–è¿æ¥ï¼Œå‚æ•° CONDITION è¡¨ç¤ºè¿›è¡ŒåŒ¹é…çš„æ¡ä»¶ã€‚</p><ul><li>å·¦å¤–è¿æ¥ LEFT JOIN<br>å¤–è¿æ¥æŸ¥è¯¢ä¸­çš„å·¦å¤–è¿æ¥å°±æ˜¯æŒ‡æ–°å…³ç³»ä¸­æ‰§è¡ŒåŒ¹é…æ¡ä»¶æ—¶ï¼Œä»¥å…³é”®å­— LEFT JOIN å·¦è¾¹çš„è¡¨ä¸ºå‚è€ƒè¡¨ã€‚<code>å·¦å¤–è¿æ¥çš„ç»“æœåŒ…æ‹¬ LEFT OUTER å­å¥ä¸­æŒ‡å®šçš„å·¦è¡¨çš„æ‰€æœ‰è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯è¿æ¥åˆ—æ‰€åŒ¹é…çš„è¡Œ</code>ï¼Œè¿™å°±æ„å‘³ç€ï¼Œ<code>å·¦è¿æ¥ä¼šè¿”å›å·¦è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ï¼ŒåŠ ä¸Šå³è¡¨ä¸­åŒ¹é…åˆ°çš„è®°å½•</code>ã€‚å¦‚æœå·¦è¡¨çš„æŸè¡Œåœ¨å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…è¡Œï¼Œé‚£ä¹ˆåœ¨ç›¸å…³è”çš„ç»“æœè¡Œä¸­ï¼Œå³è¡¨çš„æ‰€æœ‰é€‰æ‹©åˆ—è¡¨å‡ä¸ºç©ºå€¼ã€‚</li></ul><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="number">1</span>,column_name <span class="number">2</span> ... column_name n</span><br><span class="line">    <span class="keyword">FROM</span> table1</span><br><span class="line">        <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">CONDITION</span> ;</span><br></pre></td></tr></table></figure></p><p><strong>Exemple</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c.name <span class="keyword">AS</span> course_name, t.name <span class="keyword">AS</span> teacher_name</span><br><span class="line"><span class="keyword">FROM</span> teachers t</span><br><span class="line">    <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> courses c <span class="keyword">ON</span> c.teacher_id <span class="operator">=</span> t.id;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> c.name <span class="keyword">AS</span> course_name, t.name <span class="keyword">AS</span> teacher_name</span><br><span class="line">     <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> teachers t</span><br><span class="line">          <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> courses c <span class="keyword">ON</span> c.teacher_id <span class="operator">=</span> t.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+--------------------+</span></span><br><span class="line"><span class="operator">|</span>  course_name           <span class="operator">|</span> teacher_name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> Big Data         <span class="operator">|</span>Eastern Heretic     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Data Analysis          <span class="operator">|</span>Eastern Heretic     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming <span class="operator">|</span>Eastern Heretic     <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                 <span class="operator">|</span>Northern Beggar     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">System</span> Design          <span class="operator">|</span>Western Venom       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Django         <span class="operator">|</span>Western Venom       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Artificial Intelligence<span class="operator">|</span>Western Venom       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Java P6<span class="operator">+</span>         <span class="operator">|</span>Western Venom       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Senior Algorithm <span class="operator">|</span>Southern Emperor    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Web                 <span class="operator">|</span>Southern Emperor    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Object Oriented Design <span class="operator">|</span>Southern Emperor    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                 <span class="operator">|</span>Linghu Chong        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+--------------------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><ul><li>å³å¤–è¿æ¥<br>å¤–è¿æ¥æŸ¥è¯¢ä¸­çš„å³å¤–è¿æ¥æ˜¯æŒ‡æ–°å…³ç³»ä¸­æ‰§è¡ŒåŒ¹é…æ¡ä»¶æ—¶ï¼Œ<code>ä»¥å…³é”®å­— RIGHT JOIN å³è¾¹çš„è¡¨ä¸ºå‚è€ƒè¡¨ï¼Œå¦‚æœå³è¡¨çš„æŸè¡Œåœ¨å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…è¡Œï¼Œå·¦è¡¨å°±è¿”å›ç©ºå€¼</code>ã€‚</li></ul><p><strong>Grammar</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="number">1</span>,column_name <span class="number">2</span> ... column_name n</span><br><span class="line">    <span class="keyword">FROM</span> table1</span><br><span class="line">        <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">CONDITION</span> ;</span><br></pre></td></tr></table></figure></p><p><strong>Exemple</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c.name <span class="keyword">AS</span> course_name, t.name <span class="keyword">AS</span> teacher_nameï¼Œt.email <span class="keyword">AS</span> teacher_email</span><br><span class="line"><span class="keyword">FROM</span> courses c</span><br><span class="line">    <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> teachers t <span class="keyword">ON</span> c.teacher_id <span class="operator">=</span> t.id;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> c.name <span class="keyword">AS</span> course_name, t.name <span class="keyword">AS</span> teacher_name, t.email <span class="keyword">AS</span> teacher_email</span><br><span class="line">     <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> courses c</span><br><span class="line">     <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> teachers t <span class="keyword">ON</span> c.teacher_id <span class="operator">=</span> t.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+----------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span>  course_name           <span class="operator">|</span> teacher_name         <span class="operator">|</span> teacher_email             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+----------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming <span class="operator">|</span> Eastern Heretic<span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Data Analysis    <span class="operator">|</span> Eastern Heretic<span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Big Data            <span class="operator">|</span> Eastern Heretic<span class="operator">|</span> eastern.heretic<span class="variable">@gmail</span>.com <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Dynamic</span> Programming    <span class="operator">|</span> Northern Beggar<span class="operator">|</span> northern.beggar<span class="variable">@qq</span>.com    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Java P6<span class="operator">+</span>         <span class="operator">|</span> Western Venom<span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Artificial Intelligence<span class="operator">|</span> Western Venom<span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Django         <span class="operator">|</span> Western Venom<span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">System</span> Design         <span class="operator">|</span> Western Venom<span class="operator">|</span> western.venom<span class="variable">@163</span>.com     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Object Oriented Design <span class="operator">|</span> Southern Emperor<span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Web                 <span class="operator">|</span> Southern Emperor<span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Advanced Algorithms <span class="operator">|</span> Southern Emperor<span class="operator">|</span> southern.emperor<span class="variable">@qq</span>.com   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                 <span class="operator">|</span> Linghu Chong        <span class="operator">|</span> <span class="keyword">NULL</span>                      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+----------------------+---------------------------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><ul><li>å…¨å¤–è¿æ¥<br>FULL OUTER JOIN å…³é”®å­—åªè¦å·¦è¡¨ï¼ˆtable1ï¼‰å’Œå³è¡¨ï¼ˆtable2ï¼‰å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œåˆ™è¿”å›è¡Œã€‚FULL OUTER JOIN å…³é”®å­—ç»“åˆäº† LEFT JOIN å’Œ RIGHT JOIN çš„ç»“æœã€‚<blockquote><p>æ³¨ï¼šMySQL æ•°æ®åº“ä¸æ”¯æŒå…¨è¿æ¥ï¼Œæƒ³è¦å®ç°å…¨è¿æ¥å¯ä»¥ä½¿ç”¨ UNION ALL æ¥å°†å·¦è¿æ¥å’Œå³è¿æ¥ç»“æœç»„åˆåœ¨ä¸€èµ·å®ç°å…¨è¿æ¥ã€‚</p></blockquote></li></ul><p><strong>UNION</strong> ï¼šè”åˆçš„æ„æ€ï¼Œå³æŠŠä¸¤æ¬¡æˆ–å¤šæ¬¡æŸ¥è¯¢ç»“æœåˆå¹¶èµ·æ¥<br>è¦æ±‚ï¼šä¸¤æ¬¡æŸ¥è¯¢çš„åˆ—æ•°å¿…é¡»ä¸€è‡´ï¼ŒåŒæ—¶ï¼Œæ¯æ¡ SELECT è¯­å¥ä¸­çš„åˆ—çš„é¡ºåºå¿…é¡»ç›¸åŒ</p><p><strong>Grammar</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name 1,column_name 2 ... column_name n</span><br><span class="line">    FROM table1</span><br><span class="line">        LEFT JOIN table2 ON CONDITION </span><br><span class="line">UNION</span><br><span class="line">SELECT column_name 1,column_name 2 ... column_name n</span><br><span class="line">    FROM table1</span><br><span class="line">        RIGHT JOIN table2 ON CONDITION ;</span><br></pre></td></tr></table></figure></p><p><strong>Exemple</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT c.name AS course_name, t.age AS teacher_age</span><br><span class="line">FROM courses c</span><br><span class="line">LEFT JOIN teachers t ON c.teacher_id = t.id</span><br><span class="line">UNION</span><br><span class="line">SELECT c.name AS course_name, t.age AS teacher_age</span><br><span class="line">FROM courses c</span><br><span class="line">RIGHT JOIN teachers t ON c.teacher_id = t.id;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql-&gt; SELECT c.name AS course_name, t.age AS teacher_age</span><br><span class="line">     -&gt; FROM courses c</span><br><span class="line">    LEFT JOIN teachers t ON c.teacher_id = t.id</span><br><span class="line">     -&gt; UNION</span><br><span class="line">     -&gt; SELECT c.name AS course_name, t.age AS teacher_age</span><br><span class="line">     -&gt; FROM courses c</span><br><span class="line">    RIGHT JOIN teachers t ON c.teacher_id = t.id;</span><br><span class="line">+------------------------+---------------+</span><br><span class="line">|  course_name           | teacher_age   | </span><br><span class="line">+------------------------+---------------+</span><br><span class="line">| Advanced Algorithms | 21            | </span><br><span class="line">| System Design         | 28            | </span><br><span class="line">| Django                 | 28            | </span><br><span class="line">| Web Southern         | 21            |  </span><br><span class="line">| Big Data             | 20            |  </span><br><span class="line">| Artificial Intelligence| 28            | </span><br><span class="line">| Java P6+             | 28            |  </span><br><span class="line">| Data Analysis Eastern | 20            |  </span><br><span class="line">| Object Oriented Design | 21            |  </span><br><span class="line">| Dynamic Programming | 20            |  </span><br><span class="line">| Linghu Chong          | 18            | </span><br><span class="line">| NULL                 | 21            |  </span><br><span class="line">| NULL                 | 18            |  </span><br><span class="line">+------------------------+----------------------+---------------------------+</span><br><span class="line">13 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure></p><h4 id="äº¤å‰è¿æ¥-CROSS-JOIN"><a href="#äº¤å‰è¿æ¥-CROSS-JOIN" class="headerlink" title="äº¤å‰è¿æ¥ CROSS JOIN"></a>äº¤å‰è¿æ¥ CROSS JOIN</h4><h5 id="ä»€ä¹ˆæ˜¯äº¤å‰è¿æ¥"><a href="#ä»€ä¹ˆæ˜¯äº¤å‰è¿æ¥" class="headerlink" title="ä»€ä¹ˆæ˜¯äº¤å‰è¿æ¥"></a>ä»€ä¹ˆæ˜¯äº¤å‰è¿æ¥</h5><p>äº¤å‰è¿æ¥ï¼šè¿”å›å·¦è¡¨ä¸­çš„æ‰€æœ‰è¡Œï¼Œå·¦è¡¨ä¸­çš„æ¯ä¸€è¡Œä¸å³è¡¨ä¸­çš„æ‰€æœ‰è¡Œç»„åˆã€‚å³å°†ä¸¤ä¸ªè¡¨çš„æ•°æ®ä¸€ä¸€å¯¹åº”ï¼Œå…¶æŸ¥è¯¢ç»“æœçš„è¡Œæ•°ä¸ºå·¦è¡¨ä¸­çš„è¡Œæ•°ä¹˜ä»¥å³è¡¨ä¸­çš„è¡Œæ•°ã€‚<br>CROSS JOINï¼ˆäº¤å‰è¿æ¥ï¼‰çš„ç»“æœä¹Ÿç§°ä½œç¬›å¡å°”ç§¯ï¼Œç¬›å¡å°”ä¹˜ç§¯æ˜¯æŒ‡åœ¨æ•°å­¦ä¸­ï¼Œä¸¤ä¸ªé›†åˆ X å’Œ Y çš„ç¬›å¡å°“ç§¯ï¼ˆCartesian productï¼‰ï¼Œåˆç§°ç›´ç§¯ï¼Œè¡¨ç¤ºä¸º<strong>X Ã— Y</strong>ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯ X çš„æˆå‘˜è€Œç¬¬äºŒä¸ªå¯¹è±¡æ˜¯ Y çš„æ‰€æœ‰å¯èƒ½æœ‰åºå¯¹çš„å…¶ä¸­ä¸€ä¸ªæˆå‘˜ã€‚</p><h5 id="äº¤å‰è¿æ¥çš„ä¸¤ç§å®šä¹‰æ–¹å¼"><a href="#äº¤å‰è¿æ¥çš„ä¸¤ç§å®šä¹‰æ–¹å¼" class="headerlink" title="äº¤å‰è¿æ¥çš„ä¸¤ç§å®šä¹‰æ–¹å¼"></a>äº¤å‰è¿æ¥çš„ä¸¤ç§å®šä¹‰æ–¹å¼</h5><p>äº¤å‰è¿æ¥æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼Œåˆ†ä¸º<code>éšå¼è¿æ¥å’Œæ˜¾å¼è¿æ¥</code>ã€‚ä¸¤ç§å®šä¹‰æ–¹å¼çš„æŸ¥è¯¢ç»“æœæ˜¯ç›¸åŒçš„ã€‚</p><ul><li>éšå¼äº¤å‰è¿æ¥ï¼šä¸éœ€è¦ä½¿ç”¨ CROSS JOIN å…³é”®å­—ï¼Œåªè¦åœ¨ SELECT è¯­å¥çš„ FROM è¯­å¥åå°†è¦è¿›è¡Œäº¤å‰è¿æ¥çš„è¡¨ååˆ—å‡ºå³å¯ï¼Œè¿™ç§æ–¹å¼åŸºæœ¬ä¸Šå¯ä»¥è¢«ä»»æ„æ•°æ®åº“ç³»ç»Ÿæ”¯æŒã€‚<br><strong>Grammar</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `table1`.`column1`, `table2`.`column2`...</span><br><span class="line"><span class="keyword">FROM</span> `table1`,`table2`;</span><br></pre></td></tr></table></figure></li></ul><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  `courses`.`name` <span class="keyword">AS</span> `course_name`, `teachers`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line"><span class="keyword">FROM</span> `courses` ,`teachers`;</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  `c`.`name` <span class="keyword">AS</span> `course_name`, `t`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line"><span class="keyword">FROM</span> `courses` `c`,`teachers` `t`;</span><br></pre></td></tr></table></figure><ul><li>æ˜¾å¼äº¤å‰è¿æ¥ï¼šä¸éšå¼äº¤å‰è¿æ¥çš„åŒºåˆ«å°±æ˜¯å®ƒä½¿ç”¨ CROSS JOIN å…³é”®å­—ï¼Œç”¨æ³•ä¸ INNER JOINç›¸ä¼¼ã€‚<br><strong>Grammar</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `table1`.`column1`, `table2`.`column2`...</span><br><span class="line"><span class="keyword">FROM</span> `table1`</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> `table2`;</span><br></pre></td></tr></table></figure></li></ul><p><strong>Example</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT  `courses`.`name` AS `course_name`, `teachers`.`name` AS `teacher_name`</span><br><span class="line">FROM `courses` </span><br><span class="line">CROSS JOIN `teachers`;</span><br></pre></td></tr></table></figure><br>æˆ–<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT  `c`.`name` AS `course_name`, `t`.`name` AS `teacher_name`</span><br><span class="line">FROM `courses` `c`</span><br><span class="line">CROSS JOIN `teachers` `t`;</span><br></pre></td></tr></table></figure></p><p><strong>Example</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `c`.`name` <span class="keyword">AS</span> `course_name`, `t`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line"><span class="keyword">FROM</span> `courses` `c`</span><br><span class="line">Â  Â  Â <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> `teachers` `t`;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">### è¾“å…¥æ•°æ®</span><br><span class="line">### courses</span><br><span class="line">| id |        name        | student_count |  created_at  | teacher_id |</span><br><span class="line">| :- | :----------------- | :------------ | :----------- | :--------- |</span><br><span class="line">| 1  | &#x27;Senior Algorithm&#x27; | 880           | &#x27;2020-06-01&#x27; | 4          |</span><br><span class="line">| 2  | &#x27;System Design&#x27;    | 1350          | &#x27;2020-07-18&#x27; | 3          |</span><br><span class="line">| 3  | &#x27;Django&#x27;           | 780           | &#x27;2020-02-29&#x27; | 5          |</span><br><span class="line">| 4  | &#x27;Web&#x27;              | 340           | &#x27;2020-04-22&#x27; | 4          |</span><br><span class="line"></span><br><span class="line">### teachers</span><br><span class="line"></span><br><span class="line">| id |        name        |            email            | age | country |</span><br><span class="line">| :- | :----------------- | :-------------------------- | :-- | :------ |</span><br><span class="line">| 1  | &#x27;Eastern Heretic&#x27;  | &#x27;eastern.heretic@gmail.com&#x27; | 20  | &#x27;UK&#x27;    |</span><br><span class="line">| 2  | &#x27;Northern Beggar&#x27;  | &#x27;northern.beggar@qq.com&#x27;    | 21  | &#x27;CN&#x27;    |</span><br><span class="line">| 3  | &#x27;Western Venom&#x27;    | &#x27;western.venom@163.com&#x27;     | 28  | &#x27;USA&#x27;   |</span><br><span class="line">| 4  | &#x27;Southern Emperor&#x27; | &#x27;southern.emperor@qq.com&#x27;   | 21  | &#x27;JP&#x27;    |</span><br><span class="line">| 5  | &#x27;Linghu Chong&#x27;     | None                        | 18  | &#x27;CN&#x27;    |</span><br><span class="line"></span><br><span class="line">###è¾“å‡ºç»“æœ</span><br><span class="line">|    course_name     |   teacher_name    |</span><br><span class="line">| :----------------- | :---------------- |</span><br><span class="line">| &#x27;Senior Algorithm&#x27; | &#x27;Eastern Heretic&#x27; |</span><br><span class="line">| &#x27;System Design&#x27;    | &#x27;Eastern Heretic&#x27; |</span><br><span class="line">| &#x27;Django&#x27;           | &#x27;Eastern Heretic&#x27; |</span><br><span class="line">| &#x27;Web&#x27;              | &#x27;Eastern Heretic&#x27; |</span><br><span class="line">| &#x27;Senior Algorithm&#x27; | &#x27;Northern Beggar&#x27; |</span><br><span class="line">| &#x27;System Design&#x27;    | &#x27;Northern Beggar&#x27; |</span><br><span class="line">| &#x27;Django&#x27;           | &#x27;Northern Beggar&#x27; |</span><br><span class="line">| &#x27;Web&#x27;              | &#x27;Northern Beggar&#x27; |</span><br><span class="line">| &#x27;Senior Algorithm&#x27; | &#x27;Western Venom&#x27;   |</span><br><span class="line">| &#x27;System Design&#x27;    | &#x27;Western Venom&#x27;   |</span><br><span class="line">| &#x27;...&#x27;              | &#x27;...&#x27;             |</span><br></pre></td></tr></table></figure></p><p>ğŸ””å¢åŠ è”ç»“æ¡ä»¶ï¼Œä½¿ç”¨ WHERE å­å¥å¸®åŠ©ç­›é€‰è¿‡æ»¤æ— æ•ˆçš„æ•°æ®ï¼<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  `c`.`name` <span class="keyword">AS</span> `course_name`, `t`.`name` <span class="keyword">AS</span> `teacher_name`</span><br><span class="line"><span class="keyword">FROM</span> `courses` `c`</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> `teachers` `t`</span><br><span class="line"><span class="keyword">WHERE</span> `c`.`teacher_id` <span class="operator">=</span> `t`.`id`;</span><br></pre></td></tr></table></figure></p><p><strong>Result</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------------------+------------------+</span></span><br><span class="line"><span class="operator">|</span> course_name                <span class="operator">|</span> teacher_name     <span class="operator">|</span>      </span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+------------------+</span></span><br><span class="line"><span class="operator">|</span>Senior Algorithm            <span class="operator">|</span>Southern Emperor  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="keyword">System</span> Design             <span class="operator">|</span>Western Venom     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>Django                     <span class="operator">|</span>Linghu Chong      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>Web                     <span class="operator">|</span>Southern Emperor  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+------------------+</span></span><br></pre></td></tr></table></figure></p><h1 id="çº¦æŸ"><a href="#çº¦æŸ" class="headerlink" title="çº¦æŸ"></a>çº¦æŸ</h1><blockquote><p>åœ¨ SQL ä¸­ï¼Œçº¦æŸæ˜¯è§„å®šè¡¨ä¸­çš„æ•°æ®è§„åˆ™ã€‚è‹¥å­˜åœ¨è¿åçº¦æŸçš„è¡Œä¸ºï¼Œè¡Œä¸ºå°±ä¼šè¢«é˜»æ­¢ã€‚å®ƒèƒ½å¸®åŠ©ç®¡ç†å‘˜æ›´å¥½åœ°ç®¡ç†æ•°æ®åº“ï¼Œ<code>å¹¶ä¸”ç¡®ä¿æ•°æ®åº“ä¸­æ•°æ®çš„æ­£ç¡®æ€§å’Œæœ‰æ•ˆæ€§</code>ã€‚</p></blockquote><h2 id="éç©ºçº¦æŸ-NOT-NULL"><a href="#éç©ºçº¦æŸ-NOT-NULL" class="headerlink" title="éç©ºçº¦æŸ NOT NULL"></a>éç©ºçº¦æŸ NOT NULL</h2><blockquote><p>NOT NULL çº¦æŸå¼ºåˆ¶åˆ—ä¸æ¥å— NULL å€¼ï¼Œå¼ºåˆ¶å­—æ®µå§‹ç»ˆåŒ…å«å€¼ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœä¸å‘å­—æ®µæ·»åŠ å€¼ï¼Œå°±æ— æ³•æ’å…¥æ–°çºªå½•æˆ–è€…æ›´æ–°è®°å½•ã€‚</p></blockquote><p>ä¸‹é¢çš„ SQL å¼ºåˆ¶ <code>ID</code> åˆ—ã€ <code>LastName</code> åˆ—ä»¥åŠ <code>FirstName</code> åˆ—ä¸æ¥å— NULL å€¼ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Persons` (</span><br><span class="line">    `ID` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `LastName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `FirstName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `Age` <span class="type">int</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br> <strong>example</strong><br> åœ¨ä¸€ä¸ªå·²åˆ›å»ºçš„è¡¨çš„ <code>Age</code> å­—æ®µä¸­æ·»åŠ  NOT NULL çº¦æŸå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">MODIFY `Age` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><br>åœ¨ä¸€ä¸ªå·²åˆ›å»ºçš„è¡¨çš„ <code>Age</code> å­—æ®µä¸­åˆ é™¤ NOT NULL çº¦æŸå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">MODIFY `Age` <span class="type">int</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure></p><p><strong>æ³¨æ„</strong></p><blockquote><p>ä¸è¦æŠŠ NULL å€¼ä¸ç©ºä¸²ç›¸æ··æ·†ã€‚NULL å€¼æ˜¯æ²¡æœ‰å€¼ã€‚<br>å®ƒä¸æ˜¯ç©ºä¸²ã€‚å¦‚æœæŒ‡å®šâ€™ â€˜ï¼ˆä¸¤ä¸ªå•å¼•å·ï¼Œå…¶é—´æ²¡æœ‰å­—ç¬¦ï¼‰ï¼Œè¿™åœ¨ NOT NULL åˆ—ä¸­æ˜¯å…è®¸çš„ã€‚ç©ºä¸²æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å€¼ï¼Œå®ƒä¸æ˜¯æ—   å€¼ã€‚NULL å€¼ç”¨å…³é”®å­— NULL è€Œä¸æ˜¯ç©ºä¸²æŒ‡å®šã€‚</p></blockquote><h2 id="å”¯ä¸€çº¦æŸUNIQUE"><a href="#å”¯ä¸€çº¦æŸUNIQUE" class="headerlink" title="å”¯ä¸€çº¦æŸUNIQUE"></a>å”¯ä¸€çº¦æŸUNIQUE</h2><ul><li>UNIQUE çº¦æŸå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„æ¯æ¡è®°å½•</li><li>UNIQUE å’Œ ä¸»é”®çº¦æŸå‡ä¸ºåˆ—æˆ–åˆ—é›†åˆæä¾›äº†å”¯ä¸€æ€§çš„ä¿è¯</li><li>ä¸»é”®çº¦æŸä¼šè‡ªåŠ¨å®šä¹‰ä¸€ä¸ª UNIQUE çº¦æŸï¼Œæˆ–è€…è¯´ä¸»é”®çº¦æŸæ˜¯ä¸€ç§ç‰¹æ®Šçš„ UNIQUE çº¦æŸã€‚ä½†æ˜¯äºŒè€…æœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼šæ¯ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ª UNIQUE çº¦æŸï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®çº¦æŸã€‚<h3 id="CREATE-TABLE-æ—¶çš„-UNIQUE-çº¦æŸ"><a href="#CREATE-TABLE-æ—¶çš„-UNIQUE-çº¦æŸ" class="headerlink" title="CREATE TABLE æ—¶çš„ UNIQUE çº¦æŸ"></a>CREATE TABLE æ—¶çš„ UNIQUE çº¦æŸ</h3>ä¸‹é¢çš„ SQL åœ¨ <code>Persons</code> è¡¨åˆ›å»ºæ—¶åœ¨ <code>P_Id</code> åˆ—ä¸Šåˆ›å»º UNIQUE çº¦æŸï¼š<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Persons`</span><br><span class="line">(</span><br><span class="line">`P_Id` int NOT NULL,</span><br><span class="line">`LastName` varchar(255) NOT NULL,</span><br><span class="line">`FirstName` varchar(255),</span><br><span class="line">`Address` varchar(255),</span><br><span class="line">`City` varchar(255),</span><br><span class="line">UNIQUE (`P_Id`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Persons`</span><br><span class="line">(</span><br><span class="line">`P_Id` int NOT NULL UNIQUE,</span><br><span class="line">`LastName` varchar(255) NOT NULL,</span><br><span class="line">`FirstName` varchar(255),</span><br><span class="line">`Address` varchar(255),</span><br><span class="line">`City` varchar(255)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Persons`</span><br><span class="line">(</span><br><span class="line">`P_Id` int NOT NULL,</span><br><span class="line">`LastName` varchar(255) NOT NULL,</span><br><span class="line">`FirstName` varchar(255),</span><br><span class="line">`Address` varchar(255),</span><br><span class="line">`City` varchar(255),</span><br><span class="line">CONSTRAINT uc_PersonID UNIQUE (`P_Id`,`LastName`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="ALTER-TABLE-æ—¶çš„-UNIQUE-çº¦æŸ"><a href="#ALTER-TABLE-æ—¶çš„-UNIQUE-çº¦æŸ" class="headerlink" title="ALTER TABLE æ—¶çš„ UNIQUE çº¦æŸ"></a>ALTER TABLE æ—¶çš„ UNIQUE çº¦æŸ</h3><p>å½“è¡¨å·²è¢«åˆ›å»ºæ—¶ï¼Œåœ¨ <code>P_Id</code> åˆ—åˆ›å»º UNIQUE çº¦æŸ:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">ADD UNIQUEï¼ˆ`P_Id`ï¼‰</span><br></pre></td></tr></table></figure><br>å½“è¡¨å·²è¢«åˆ›å»ºæ—¶ï¼Œéœ€å‘½å UNIQUE çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ UNIQUE çº¦æŸ:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">ADD CONSTRAINT uc_PersonID UNIQUE (`P_Id`,`LastName`)</span><br></pre></td></tr></table></figure></p><h3 id="æ’¤é”€-UNIQUE-çº¦æŸ"><a href="#æ’¤é”€-UNIQUE-çº¦æŸ" class="headerlink" title="æ’¤é”€ UNIQUE çº¦æŸ"></a>æ’¤é”€ UNIQUE çº¦æŸ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">DROP INDEX uc_PersonID</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">DROP CONSTRAINT uc_PersonID</span><br></pre></td></tr></table></figure><h2 id="ä¸»é”®çº¦æŸ-PRIMARY-KEY"><a href="#ä¸»é”®çº¦æŸ-PRIMARY-KEY" class="headerlink" title="ä¸»é”®çº¦æŸ PRIMARY KEY"></a>ä¸»é”®çº¦æŸ PRIMARY KEY</h2><blockquote><p>PRIMARY KEY çº¦æŸå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„æ¯æ¡è®°å½• ï¼Œç®€å•çš„è¯´ï¼Œ<code>PRIMARY KEY = UNIQUE + NOT NULL</code> ,ä»æŠ€æœ¯çš„è§’åº¦æ¥çœ‹ï¼ŒPRIMARY KEY å’Œ UNIQUE æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚ä½†è¿˜æ˜¯æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š</p><ul><li>NOT NULL UNIQUE å¯ä»¥<code>å°†è¡¨çš„ä¸€åˆ—æˆ–å¤šåˆ—å®šä¹‰ä¸ºå”¯ä¸€æ€§å±æ€§</code>ï¼Œè€Œ PRIMARY KEY è®¾ä¸ºå¤šåˆ—æ—¶ï¼Œ<code>ä»…èƒ½ä¿è¯å¤šåˆ—ä¹‹å’Œæ˜¯å”¯ä¸€çš„</code>ï¼Œå…·ä½“åˆ°æŸä¸€åˆ—å¯èƒ½ä¼šé‡å¤ã€‚</li><li>PRIMARY KEY <code>å¯ä»¥ä¸å¤–é”®é…åˆ</code>ï¼Œä»è€Œå½¢æˆä¸»ä»è¡¨çš„å…³ç³»ï¼Œè€Œ NOT NULL UNIQUE åˆ™åšä¸åˆ°è¿™ä¸€ç‚¹<br>å¦‚ï¼š<br>è¡¨ä¸€ï¼šç”¨æˆ· <code>id</code> (ä¸»é”®)ï¼Œç”¨æˆ·å<br>è¡¨äºŒ: é“¶è¡Œå¡å· <code>id</code> (ä¸»é”®)ï¼Œç”¨æˆ· <code>id</code> (å¤–é”®)<br>åˆ™è¡¨ä¸€ä¸ºä¸»è¡¨ï¼Œè¡¨äºŒä¸ºä»è¡¨ã€‚</li></ul></blockquote><ul><li>æ›´å¤§çš„åŒºåˆ«åœ¨é€»è¾‘è®¾è®¡ä¸Šã€‚ PRIMARY KEY ä¸€èˆ¬åœ¨é€»è¾‘è®¾è®¡ä¸­ç”¨ä½œè®°å½•æ ‡è¯†ï¼Œè¿™ä¹Ÿæ˜¯è®¾ç½® PRIMARY KEY çš„æœ¬æ¥ç”¨æ„ï¼Œè€Œ UNIQUE åªæ˜¯ä¸ºäº†ä¿è¯åŸŸ/åŸŸç»„çš„å”¯ä¸€æ€§ã€‚</li></ul><h3 id="CREATE-TABLE-æ—¶-æ·»åŠ -PRIMARY-KEY-çº¦æŸ"><a href="#CREATE-TABLE-æ—¶-æ·»åŠ -PRIMARY-KEY-çº¦æŸ" class="headerlink" title="CREATE TABLE æ—¶ æ·»åŠ  PRIMARY KEY çº¦æŸ"></a>CREATE TABLE æ—¶ æ·»åŠ  PRIMARY KEY çº¦æŸ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Persons`</span><br><span class="line">(</span><br><span class="line">    `P_Id` int NOT NULL,</span><br><span class="line">    `LastName` varchar(255) NOT NULL,</span><br><span class="line">    `FirstName` varchar(255),</span><br><span class="line">    `Address` varchar(255),</span><br><span class="line">    `City` varchar(255),</span><br><span class="line">    PRIMARY KEY (`P_Id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œç»“æœ</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE `Persons`</span><br><span class="line">    -&gt; (</span><br><span class="line">    -&gt;     `P_Id` int NOT NULL,</span><br><span class="line">    -&gt;     `LastName` varchar(255) NOT NULL,</span><br><span class="line">    -&gt;     `FirstName` varchar(255),</span><br><span class="line">    -&gt;     `Address` varchar(255),</span><br><span class="line">    -&gt;     `City` varchar(255),</span><br><span class="line">    -&gt;     PRIMARY KEY (`P_Id`)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc Persons;</span><br><span class="line">+-----------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field     | Type         | Null | Key | Default | Extra |</span><br><span class="line">+-----------+--------------+------+-----+---------+-------+</span><br><span class="line">| P_Id      | int(11)      | NO   | PRI | NULL    |       |</span><br><span class="line">| LastName  | varchar(255) | NO   |     | NULL    |       |</span><br><span class="line">| FirstName | varchar(255) | YES  |     | NULL    |       |</span><br><span class="line">| Address   | varchar(255) | YES  |     | NULL    |       |</span><br><span class="line">| City      | varchar(255) | YES  |     | NULL    |       |</span><br><span class="line">+-----------+--------------+------+-----+---------+-------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Persons`</span><br><span class="line">(</span><br><span class="line">    `P_Id` int NOT NULL PRIMARY KEY,</span><br><span class="line">    `LastName` varchar(255) NOT NULL,</span><br><span class="line">    `FirstName` varchar(255),</span><br><span class="line">    `Address` varchar(255),</span><br><span class="line">    `City` varchar(255)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>å¦‚éœ€å‘½åå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ PRIMARY KEY çº¦æŸï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ SQL è¯­æ³•ï¼š</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">(</span><br><span class="line">    `P_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `LastName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `FirstName` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    `Address` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    `City` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> pk_PersonID <span class="keyword">PRIMARY</span> KEY (`P_Id`,`LastName`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><br>    æ³¨é‡Šï¼š<br>    åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªä¸»é”® PRIMARY KEYï¼ˆpk_PersonIDï¼‰ã€‚ç„¶è€Œï¼Œpk_PersonID çš„å€¼æ˜¯ç”±ä¸¤ä¸ªåˆ—ï¼ˆ<code>P_Id</code> å’Œ <code>LastName</code>ï¼‰ç»„æˆçš„ã€‚</p><h3 id="ALTER-TABLE-æ—¶æ·»åŠ ä¸»é”®çº¦æŸ"><a href="#ALTER-TABLE-æ—¶æ·»åŠ ä¸»é”®çº¦æŸ" class="headerlink" title="ALTER TABLE æ—¶æ·»åŠ ä¸»é”®çº¦æŸ"></a>ALTER TABLE æ—¶æ·»åŠ ä¸»é”®çº¦æŸ</h3><p>å½“è¡¨å·²è¢«åˆ›å»ºæ—¶ï¼Œå¦‚éœ€åœ¨ <code>P_Id</code> åˆ—åˆ›å»º PRIMARY KEY çº¦æŸï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (`P_Id`)</span><br></pre></td></tr></table></figure><br><strong>æ‰§è¡Œç»“æœ</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `P_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `LastName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `FirstName` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `Address` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `City` <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (P_Id);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.07</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> Persons;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> P_Id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> LastName  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FirstName <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Address   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> City      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><p><strong>å¦‚éœ€å‘½åå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ PRIMARY KEY çº¦æŸï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ SQL è¯­æ³•ï¼š</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_PersonID <span class="keyword">PRIMARY</span> KEY (`P_Id`,`LastName`)</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨é‡Šï¼š<br>å¦‚æœæ‚¨ä½¿ç”¨ ALTER TABLE è¯­å¥æ·»åŠ ä¸»é”®ï¼Œå¿…é¡»æŠŠä¸»é”®åˆ—å£°æ˜ä¸ºä¸åŒ…å« NULL å€¼ï¼ˆåœ¨è¡¨é¦–æ¬¡åˆ›å»ºæ—¶ï¼‰ã€‚</p></blockquote><p><strong>æ‰§è¡Œç»“æœ</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `P_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `LastName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `FirstName` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `Address` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     `City` <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_PersonID <span class="keyword">PRIMARY</span> KEY (`P_Id`,`LastName`);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.08</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> Persons;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> P_Id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> LastName  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FirstName <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Address   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> City      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></p><h3 id="æ’¤é”€-PRIMARY-KEY"><a href="#æ’¤é”€-PRIMARY-KEY" class="headerlink" title="æ’¤é”€ PRIMARY KEY"></a>æ’¤é”€ PRIMARY KEY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">DROP PRIMARY KEY</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">DROP CONSTRAINT pk_PersonID</span><br></pre></td></tr></table></figure><h2 id="å¤–é”®çº¦æŸ-FOREIGN-KEY"><a href="#å¤–é”®çº¦æŸ-FOREIGN-KEY" class="headerlink" title="å¤–é”®çº¦æŸ FOREIGN KEY"></a>å¤–é”®çº¦æŸ FOREIGN KEY</h2><h3 id="ä»€ä¹ˆæ˜¯å¤–é”®"><a href="#ä»€ä¹ˆæ˜¯å¤–é”®" class="headerlink" title="ä»€ä¹ˆæ˜¯å¤–é”®"></a>ä»€ä¹ˆæ˜¯å¤–é”®</h3><blockquote><p>ä¸€ä¸ªè¡¨ä¸­çš„ FOREIGN KEY æŒ‡å‘å¦ä¸€ä¸ªè¡¨ä¸­çš„ UNIQUE KEY ã€‚è®©æˆ‘ä»¬çœ‹äº†ä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªå­—æ®µ X åœ¨ä¸€å¼ è¡¨ï¼ˆè¡¨ 1 ï¼‰ä¸­æ˜¯å…³é”®å­—ï¼Œè€Œåœ¨å¦ä¸€å¼ è¡¨ï¼ˆè¡¨ 2 ï¼‰ä¸­ä¸æ˜¯å…³é”®å­—ï¼Œåˆ™ç§°å­—æ®µ X ä¸ºè¡¨ 2 çš„å¤–é”®ã€‚</p></blockquote><h3 id="å¤–é”®çš„ä½œç”¨"><a href="#å¤–é”®çš„ä½œç”¨" class="headerlink" title="å¤–é”®çš„ä½œç”¨"></a>å¤–é”®çš„ä½œç”¨</h3><blockquote><p>å¤–é”®æœ€æ ¹æœ¬çš„ä½œç”¨ï¼šä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚<br>ç°åœ¨æœ‰ä¸¤å¼ è¡¨â€”â€”å­¦ç”Ÿè¡¨å’Œé™¢ç³»è¡¨ï¼Œè¿™é‡Œçš„é™¢ç³»å°±æ˜¯å­¦ç”Ÿè¡¨çš„å¤–é”®ï¼Œå¤–é”®è¡¨æ˜¯å­¦ç”Ÿè¡¨ï¼Œä¸»é”®è¡¨æ˜¯é™¢ç³»è¡¨ã€‚å‡å¦‚é™¢ç³»è¡¨ä¸­çš„æŸä¸ªé™¢ç³»è¢«åˆ é™¤äº†ï¼Œé‚£ä¹ˆåœ¨å­¦ç”Ÿè¡¨ä¸­è¦æƒ³æŸ¥è¯¢è¿™ä¸ªè¢«åˆ é™¤çš„é™¢ç³»å·æ‰€å¯¹åº”çš„é™¢ä¿¡æ¯å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºå·²ç»ä¸å­˜åœ¨è¿™ä¸ªç³»äº†ï¼Œæ‰€ä»¥ï¼Œåˆ é™¤é™¢ç³»è¡¨ï¼ˆä¸»é”®è¡¨ï¼‰æ—¶å¿…é¡»åˆ é™¤å…¶ä»–ä¸ä¹‹å…³è”çš„è¡¨ï¼Œè¿™é‡Œå°±è¯´æ˜äº†å¤–é”®çš„ä½œç”¨ï¼Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€å®Œæ•´æ€§ã€‚å½“ç„¶åè¿‡æ¥è®²ï¼Œä½ åˆ é™¤å­¦ç”Ÿè¡¨ä¸­çš„è®°å½•ï¼Œå¹¶ä¸å½±å“é™¢ç³»è¡¨ä¸­çš„æ•°æ®ï¼Œä½ æŸ¥è¯¢é™¢ç³»å·ä¹Ÿèƒ½æ­£ç¡®æŸ¥è¯¢ã€‚æ‰€ä»¥åˆ é™¤å¤–é”®è¡¨ä¸­çš„æ•°æ®å¹¶ä¸å½±å“ä¸»é”®è¡¨ã€‚</p></blockquote><h3 id="å¤–é”®çº¦æŸ"><a href="#å¤–é”®çº¦æŸ" class="headerlink" title="å¤–é”®çº¦æŸ"></a>å¤–é”®çº¦æŸ</h3><blockquote><p>å¤–é”®çº¦æŸæ˜¯æŒ‡ç”¨äºåœ¨ä¸¤ä¸ªè¡¨ä¹‹é—´å»ºç«‹å…³ç³»ï¼Œéœ€è¦æŒ‡å®šå¼•ç”¨ä¸»è¡¨çš„å“ªä¸€åˆ—ã€‚æ¥ä¸‹æ¥åœ¨å®é™…æ“åšä¸­è®©æˆ‘ä»¬æ„Ÿå—ä¸€ä¸‹å¤–é”®çº¦æŸçš„ç”¨æ³•ã€‚</p></blockquote><h4 id="CREATE-TABLE-æ—¶çš„-SQL-FOREIGN-KEY-çº¦æŸ"><a href="#CREATE-TABLE-æ—¶çš„-SQL-FOREIGN-KEY-çº¦æŸ" class="headerlink" title="CREATE TABLE æ—¶çš„ SQL FOREIGN KEY çº¦æŸ"></a>CREATE TABLE æ—¶çš„ SQL FOREIGN KEY çº¦æŸ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Orders`</span><br><span class="line">(</span><br><span class="line">`O_Id` int NOT NULL,</span><br><span class="line">`OrderNo` int NOT NULL,</span><br><span class="line">`P_Id` int,</span><br><span class="line">PRIMARY KEY (O_Id),</span><br><span class="line">FOREIGN KEY (P_Id) REFERENCES Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `Orders`</span><br><span class="line">(</span><br><span class="line">`O_Id` int NOT NULL PRIMARY KEY,</span><br><span class="line">`OrderNo` int NOT NULL,</span><br><span class="line">P_Id int FOREIGN KEY REFERENCES Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­<br>NOT NULL è¡¨ç¤ºè¯¥å­—æ®µä¸ä¸ºç©º<br>REFERENCES è¡¨ç¤º å¼•ç”¨ä¸€ä¸ªè¡¨</p></blockquote><p>å¦‚éœ€å‘½å FOREIGN KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ FOREIGN KEY çº¦æŸ:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Orders`</span><br><span class="line">(</span><br><span class="line">`O_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`OrderNo` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`P_Id` <span class="type">int</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (O_Id),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> fk_PerOrders <span class="keyword">FOREIGN</span> KEY (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><blockquote><p>å…¶ä¸­<br>CONSTRAINT è¡¨ç¤ºçº¦æŸï¼Œåé¢æ¥çº¦æŸåç§°ï¼Œå¸¸ç”¨äºåˆ›å»ºçº¦æŸå’Œåˆ é™¤çº¦æŸï¼›</p></blockquote><h4 id="ALTER-TABLE-æ—¶çš„-SQL-FOREIGN-KEY-çº¦æŸ"><a href="#ALTER-TABLE-æ—¶çš„-SQL-FOREIGN-KEY-çº¦æŸ" class="headerlink" title="ALTER TABLE æ—¶çš„ SQL FOREIGN KEY çº¦æŸ"></a>ALTER TABLE æ—¶çš„ SQL FOREIGN KEY çº¦æŸ</h4><p>å½“ â€œOrdersâ€ è¡¨å·²è¢«åˆ›å»ºæ—¶ï¼Œå¦‚éœ€åœ¨ â€œP_Idâ€ åˆ—åˆ›å»º FOREIGN KEY çº¦æŸ:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Orders`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">FOREIGN</span> KEY (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br></pre></td></tr></table></figure><br>å¦‚éœ€å‘½å FOREIGN KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ FOREIGN KEY çº¦æŸ:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Orders`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_PerOrders</span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br></pre></td></tr></table></figure></p><h4 id="æ’¤é”€-FOREIGN-KEY-çº¦æŸ"><a href="#æ’¤é”€-FOREIGN-KEY-çº¦æŸ" class="headerlink" title="æ’¤é”€ FOREIGN KEY çº¦æŸ"></a>æ’¤é”€ FOREIGN KEY çº¦æŸ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Orders`</span><br><span class="line">DROP FOREIGN KEY fk_PerOrders</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Orders`</span><br><span class="line">DROP CONSTRAINT fk_PerOrders</span><br></pre></td></tr></table></figure><h2 id="æ£€æŸ¥çº¦æŸ-CHECK"><a href="#æ£€æŸ¥çº¦æŸ-CHECK" class="headerlink" title="æ£€æŸ¥çº¦æŸ CHECK"></a>æ£€æŸ¥çº¦æŸ CHECK</h2><p>CHECK çº¦æŸç”¨äºé™åˆ¶åˆ—ä¸­çš„å€¼çš„èŒƒå›´ï¼Œè¯„ä¼°æ’å…¥æˆ–ä¿®æ”¹åçš„å€¼ã€‚æ»¡è¶³æ¡ä»¶çš„å€¼å°†ä¼šæ’å…¥è¡¨ä¸­ï¼Œå¦åˆ™å°†æ”¾å¼ƒæ’å…¥æ“ä½œã€‚ å¯ä»¥ä¸ºåŒä¸€åˆ—æŒ‡å®šå¤šä¸ª CHECK çº¦æŸã€‚</p><p><code>CHECK</code> çº¦æŸæ—¢å¯ä»¥ç”¨äºæŸä¸€åˆ—ä¹Ÿå¯ä»¥ç”¨äºæŸå¼ è¡¨ï¼š</p><ul><li>å¦‚æœå¯¹å•ä¸ªåˆ—å®šä¹‰ CHECK çº¦æŸï¼Œé‚£ä¹ˆè¯¥åˆ—åªå…è®¸ç‰¹å®šçš„å€¼ã€‚</li><li>å¦‚æœå¯¹ä¸€ä¸ªè¡¨å®šä¹‰ CHECK çº¦æŸï¼Œé‚£ä¹ˆæ­¤çº¦æŸä¼šåŸºäºè¡Œä¸­å…¶ä»–åˆ—çš„å€¼åœ¨ç‰¹å®šçš„åˆ—ä¸­å¯¹å€¼è¿›è¡Œé™åˆ¶ã€‚</li></ul><p>å®šä¹‰ CHECK çº¦æŸæ¡ä»¶åœ¨æŸç§ç¨‹åº¦ä¸Šç±»ä¼¼äºç¼–å†™æŸ¥è¯¢çš„ WHERE å­å¥ï¼Œä½¿ç”¨ä¸åŒçš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆä¾‹å¦‚ ANDã€ORã€BETWEENã€INã€LIKE å’Œ IS NULLï¼‰ç¼–å†™å…¶å¸ƒå°”è¡¨è¾¾å¼ï¼Œè¯¥å¸ƒå°”è¡¨è¾¾å¼å°†è¿”å› TRUEã€FALSE æˆ– UNKNOWN ã€‚ å½“æ¡ä»¶ä¸­å­˜åœ¨ NULL å€¼æ—¶ï¼ŒCHECKçº¦æŸå°†è¿”å› UNKNOWN å€¼ã€‚<br>CHECK çº¦æŸä¸»è¦ç”¨äºé€šè¿‡å°†æ’å…¥çš„å€¼é™åˆ¶ä¸ºéµå¾ªå®šä¹‰çš„å€¼ã€èŒƒå›´æˆ–æ ¼å¼è§„åˆ™çš„å€¼æ¥å¼ºåˆ¶åŸŸå®Œæ•´æ€§ã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> hardy_db <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8mb4 <span class="keyword">collate</span> utf8mb4_0900_ai_ci;</span><br><span class="line">USE hardy_db;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> lesson;</span><br></pre></td></tr></table></figure><br>åˆ›å»ºè¡¨ç»“æ„æ—¶å¯ä»¥ä½¿ç”¨ CHECK çº¦æŸï¼Œä¹Ÿå¯ä»¥ç»™å·²åˆ›å»ºçš„è¡¨å¢åŠ  CHECK çº¦æŸã€‚<br>ğŸ””ä¸¾ä¸€ä¸ªä¾‹å­ï¼š<br>å‡å¦‚æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªç®€å•çš„è¯¾ç¨‹è¡¨ <code>courses</code> ï¼Œè¡¨ä¸­æ¯ä¸€æ¡æ•°æ®è®°å½•ç€è¯¾ç¨‹ç¼–å· <code>id</code>ã€è¯¾ç¨‹åç§° <code>name</code> ã€å­¦ç”Ÿæ€»æ•° <code>student_count</code> ã€åˆ›å»ºè¯¾ç¨‹æ—¶é—´ <code>created_at</code> ä»¥åŠæˆè¯¾æ•™å¸ˆç¼–å· <code>teacher_id</code>ã€‚å…¶ä¸­è¯¾ç¨‹ç¼–å· <code>id</code> ä¸ºä¸»é”®ã€‚<br>æ ¹æ®åŸºæœ¬å¸¸è¯†ï¼Œå­¦ç”Ÿæ€»æ•° <code>student_count</code> ä¸€å®šæ˜¯éè´Ÿå€¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è®¾ç½®å®ƒå¿…é¡»ä¸ºæ­£æ•´æ•°ï¼Œå¯ä»¥ä½¿ç”¨ CHECK çº¦æŸã€‚</p><h3 id="åˆ›å»ºè¡¨ï¼ˆCREATE-TABLEï¼‰æ—¶æ·»åŠ -CHECKçº¦æŸ"><a href="#åˆ›å»ºè¡¨ï¼ˆCREATE-TABLEï¼‰æ—¶æ·»åŠ -CHECKçº¦æŸ" class="headerlink" title="åˆ›å»ºè¡¨ï¼ˆCREATE TABLEï¼‰æ—¶æ·»åŠ  CHECKçº¦æŸ"></a>åˆ›å»ºè¡¨ï¼ˆCREATE TABLEï¼‰æ—¶æ·»åŠ  CHECKçº¦æŸ</h3><p>åœ¨åˆ›å»ºè¯¾ç¨‹è¡¨ <code>courses</code> æ—¶ï¼Œç»™å­¦ç”Ÿæ€»æ•° <code>student_count</code> å­—æ®µåŠ ä¸Šä¸€ä¸ªå¤§äº 0 çš„çº¦æŸã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `courses`</span><br><span class="line">(</span><br><span class="line">`id` int,</span><br><span class="line">`name` varchar(255),</span><br><span class="line">`student_count` int,</span><br><span class="line">`created_at` date,</span><br><span class="line">`teacher_id` int,</span><br><span class="line">CHECK (`student_count` &gt; 0)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `courses`</span><br><span class="line">(</span><br><span class="line">`id` int</span><br><span class="line">CHECK (`student_count` &gt; 0),</span><br><span class="line">`name` varchar(255),`student_count` int,</span><br><span class="line">`created_at` date,</span><br><span class="line">`teacher_id` int</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä¸ºå¤šä¸ªåˆ—æ·»åŠ  CHECK çº¦æŸ<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `courses`</span><br><span class="line">(</span><br><span class="line">`id` <span class="type">int</span>,</span><br><span class="line">`name` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">`student_count` <span class="type">int</span>,</span><br><span class="line">`created_at` <span class="type">date</span>,</span><br><span class="line">`teacher_id` <span class="type">int</span>,</span><br><span class="line"><span class="keyword">CHECK</span> (`student_count` <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">AND</span> `teacher_id` <span class="operator">&gt;</span> <span class="number">0</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœæƒ³ä¸ºä¸€ä¸ªè¡¨ä¸­å¤šä¸ªå­—æ®µæ·»åŠ çº¦æŸï¼Œç›´æ¥åœ¨ CHECK å…³é”®å­—åçš„æ‹¬å·å†…æ·»åŠ ï¼Œä¸¤ä¸ªçº¦æŸé—´ä½¿ç”¨ AND å…³é”®å­—è¿æ¥ã€‚</p><p>ä¸º CHECK çº¦æŸå‘½å<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `courses`</span><br><span class="line">(</span><br><span class="line">`id` <span class="type">int</span>,</span><br><span class="line">`name` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">`student_count` <span class="type">int</span>,</span><br><span class="line">`created_at` <span class="type">date</span>,</span><br><span class="line">`teacher_id` <span class="type">int</span>,</span><br><span class="line"><span class="keyword">CONSTRAINT</span> chk_courses <span class="keyword">CHECK</span> (`student_count` <span class="operator">&gt;</span> <span class="number">0</span>) ;</span><br></pre></td></tr></table></figure><br>æ ¸å¿ƒéƒ¨åˆ†çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span><span class="keyword">constraint</span> name<span class="operator">&gt;</span>] <span class="keyword">CHECK</span> (<span class="operator">&lt;</span><span class="keyword">condition</span><span class="operator">&gt;</span>)</span><br></pre></td></tr></table></figure></p><blockquote><p>å…¶ä¸­ï¼š</p><ul><li>çº¦æŸå…³é”®å­— CONSTRAINTï¼šè¡¨ç¤ºå…¶åé¢æ¥çš„å†…å®¹ä¸ºçº¦æŸ</li><li>constraint nameï¼šä¸ºçº¦æŸåç§°</li><li>å…³é”®å­— CHECKï¼šè¡¨ç¤ºæ£€æŸ¥çº¦æŸ</li><li>conditionï¼šè¢«çº¦æŸå†…å®¹</li></ul></blockquote><h3 id="è¡¨å·²å­˜åœ¨æ—¶æ·»åŠ -CHECK-çº¦æŸ"><a href="#è¡¨å·²å­˜åœ¨æ—¶æ·»åŠ -CHECK-çº¦æŸ" class="headerlink" title="è¡¨å·²å­˜åœ¨æ—¶æ·»åŠ  CHECK çº¦æŸ"></a>è¡¨å·²å­˜åœ¨æ—¶æ·»åŠ  CHECK çº¦æŸ</h3><p>è¯¾ç¨‹è¡¨ <code>courses</code> å·²å­˜åœ¨çš„æƒ…å†µä¸‹ä¸ºå­¦ç”Ÿæ€»æ•° <code>student_count</code> å­—æ®µæ·»åŠ ä¸€ä¸ªå¤§äº 0 çš„ CHECK çº¦æŸã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `courses` </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CHECK</span> ( `student_count` <span class="operator">&gt;</span> <span class="number">0</span>);</span><br></pre></td></tr></table></figure><br>æˆ–<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `courses`  </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> chk_courses <span class="keyword">CHECK</span> ( `student_count` <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">AND</span> `teacher_id` <span class="operator">&gt;</span> <span class="number">0</span>);</span><br></pre></td></tr></table></figure></p><blockquote><ul><li>ALTER TABLE å…³é”®å­—ï¼šè¡¨ç¤ºä¿®æ”¹è¡¨çš„å®šä¹‰</li><li>ADD å…³é”®å­—ï¼šè¡¨ç¤ºå¢åŠ </li></ul></blockquote><h3 id="æ’¤é”€-CHECK-çº¦æŸ"><a href="#æ’¤é”€-CHECK-çº¦æŸ" class="headerlink" title="æ’¤é”€ CHECK çº¦æŸ"></a>æ’¤é”€ CHECK çº¦æŸ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `courses` </span><br><span class="line">DROP CHECK chk_courses</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `courses` </span><br><span class="line">DROP CONSTRAINT chk_courses</span><br></pre></td></tr></table></figure><h2 id="DEFAULT-çº¦æŸ"><a href="#DEFAULT-çº¦æŸ" class="headerlink" title="DEFAULT çº¦æŸ"></a>DEFAULT çº¦æŸ</h2><p>é»˜è®¤å€¼ï¼ˆDefaultï¼‰â€çš„å®Œæ•´ç§°å‘¼æ˜¯â€œé»˜è®¤å€¼çº¦æŸï¼ˆDefault Constraintï¼‰â€ã€‚MySQL é»˜è®¤å€¼çº¦æŸç”¨æ¥æŒ‡å®šæŸåˆ—çš„é»˜è®¤å€¼ã€‚</p><h3 id="DEFAULT-çº¦æŸç”¨æ³•"><a href="#DEFAULT-çº¦æŸç”¨æ³•" class="headerlink" title="DEFAULT çº¦æŸç”¨æ³•"></a>DEFAULT çº¦æŸç”¨æ³•</h3><ul><li>DEFAULT çº¦æŸç”¨äºå‘åˆ—ä¸­æ’å…¥é»˜è®¤å€¼ã€‚</li><li>å¦‚æœæ²¡æœ‰è§„å®šå…¶ä»–çš„å€¼ï¼Œé‚£ä¹ˆä¼šå°†é»˜è®¤å€¼æ·»åŠ åˆ°æ‰€æœ‰çš„æ–°è®°å½•ã€‚</li><li>ä¾‹å¦‚å¥³åŒå­¦è¾ƒå¤šï¼Œæ€§åˆ«å°±å¯ä»¥é»˜è®¤ä¸ºâ€œå¥³â€ï¼Œå¦‚æœæ’å…¥ä¸€æ¡æ–°çš„è®°å½•æ—¶æ²¡æœ‰ä¸ºè¿™ä¸ªå­—æ®µèµ‹å€¼ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºè¿™ä¸ªå­—æ®µèµ‹å€¼ä¸ºâ€œå¥³â€ã€‚</li></ul><h3 id="CREATE-TABLE-æ—¶çš„-DEFAULT-çº¦æŸ"><a href="#CREATE-TABLE-æ—¶çš„-DEFAULT-çº¦æŸ" class="headerlink" title="CREATE TABLE æ—¶çš„ DEFAULT çº¦æŸ"></a>CREATE TABLE æ—¶çš„ DEFAULT çº¦æŸ</h3><ul><li>ä½¿ç”¨ DEFAULT å…³é”®å­—è®¾ç½®é»˜è®¤å€¼çº¦æŸï¼Œå…·ä½“çš„è¯­æ³•è§„åˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š<br><code>&lt;å­—æ®µå&gt; &lt;æ•°æ®ç±»å‹&gt; DEFAULT &lt;é»˜è®¤å€¼&gt;</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line">(</span><br><span class="line">    `P_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `LastName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `FirstName` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    `Address` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    `City` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;Sandnes&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>é€šè¿‡ä½¿ç”¨ç±»ä¼¼ GETDATE() è¿™æ ·çš„å‡½æ•°, DEFAULT çº¦æŸä¹Ÿå¯ä»¥ç”¨äºæ’å…¥ç³»ç»Ÿå€¼ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `Orders`</span><br><span class="line">(</span><br><span class="line">    `O_Id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `OrderNo` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `P_Id` <span class="type">int</span>,</span><br><span class="line">    `OrderDate` <span class="type">date</span> <span class="keyword">DEFAULT</span> GETDATE()</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul><h3 id="ALTER-TABLE-æ—¶çš„-DEFAULT-çº¦æŸ"><a href="#ALTER-TABLE-æ—¶çš„-DEFAULT-çº¦æŸ" class="headerlink" title="ALTER TABLE æ—¶çš„ DEFAULT çº¦æŸ"></a>ALTER TABLE æ—¶çš„ DEFAULT çº¦æŸ</h3><p>å¦‚æœè¡¨å·²è¢«åˆ›å»ºæ—¶ï¼Œæƒ³è¦åœ¨ <code>City</code> åˆ—åˆ›å»º DEFAULT çº¦æŸ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">ALTER `City` SET DEFAULT &#x27;SANDNES&#x27;</span><br></pre></td></tr></table></figure></p><figure class="highlight sql"><figcaption><span>server</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `Persons`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> ab_c <span class="keyword">DEFAULT</span> <span class="string">&#x27;SANDNES&#x27;</span> <span class="keyword">for</span> `City`</span><br></pre></td></tr></table></figure><h3 id="æ’¤é”€-DEFAULT-çº¦æŸ"><a href="#æ’¤é”€-DEFAULT-çº¦æŸ" class="headerlink" title="æ’¤é”€ DEFAULT çº¦æŸ"></a>æ’¤é”€ DEFAULT çº¦æŸ</h3><p>å¦‚éœ€æ’¤é”€ <code>Persons</code>è¡¨çš„ DEFAULT çº¦æŸ :<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">ALTER `City` DROP DEFAULT</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `Persons`</span><br><span class="line">ALTER COLUMN `City` DROP DEFAULT</span><br></pre></td></tr></table></figure><p><a href="https://www.lintcode.com/problem/?typeId=3">å‚è€ƒ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> sqlåŸºç¡€ </tag>
            
            <tag> mysql </tag>
            
            <tag> æŸ¥è¯¢ </tag>
            
            <tag> è”ç»“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/04/28/hello-world/"/>
      <url>/2022/04/28/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
