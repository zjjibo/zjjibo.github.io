<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF(%E4%B8%80)/"/>
      <url>/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p><p>å¼ ä¸‰æœ€è¿‘å¯¹ <code>MySQL</code> æ•°æ®åº“æ„Ÿå…´è¶£ï¼Œå†³å®šè¦å¥½å¥½å­¦ä¹ æ•°æ®åº“ï¼Œä½†â€¦å­¦ä¹ çš„é“è·¯æ€»æ˜¯å……æ»¡è‰°è¾›çš„ã€‚å¼ ä¸‰ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼Œä»–å·¦æ€å³æƒ³ã€è‹¦æ€å†¥æƒ³ã€èŒ¶ä¸æ€é¥­ä¸æƒ³ä¹Ÿæ²¡èƒ½æƒ³å‡ºè§£å†³åŠæ³•ã€‚æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œç°æœ‰ <code>teachers</code> è¡¨ä¸­è®°å½•ç€ç¦»èŒçš„æ•™å¸ˆä¿¡æ¯ï¼Œ<code>id</code> çš„å€¼å³æ˜¯æ•™å¸ˆç¦»èŒçš„é¡ºåºï¼Œåœ¨ <code>courses</code> è¡¨ä¸­è®°å½•ç€æ¯ä¸ªæ•™å¸ˆæ•™æˆçš„è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” id ä¸º <code>teacher_id</code>ã€‚<strong>ç°åœ¨çŸ¥é“æ•™å¸ˆæ˜¯ä»¥å›½ç±æ¥åˆ†å›¢é˜Ÿçš„ï¼Œä¸”æ¯ä¸ªå›¢é˜Ÿçš„æˆç«‹è‡³å°‘æœ‰ <code>3</code> ä¸ªæ•™å¸ˆï¼Œè‹¥æ˜¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒï¼Œåˆ™åœ¨ <code>teachers</code> è¡¨ä¸­ä¿¡æ¯è®°å½•ä¸ºè¿ç»­ä¸”å›½ç±ç›¸åŒï¼Œç°åœ¨éœ€è¦ç»Ÿè®¡æ¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒä¼šæœ‰å¤šå°‘å­¦ç”Ÿéœ€è¦ç­‰å¾…æ–°çš„æ•™å¸ˆï¼Œç»“æœæŒ‰å›¢é˜Ÿå›½ç±æ’åº</strong>ã€‚ä»–éœ€è¦åˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v_courses_teachers</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒå­¦ä»¬å¿«æ¥å¸®å¸®å¼ ä¸‰å°ä¼™å­å§ ~</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_courses_teachers <span class="keyword">as</span> (</span><br><span class="line">Â  Â  <span class="keyword">select</span> tt.country,<span class="built_in">sum</span>(tt.student_count) student_count</span><br><span class="line">Â  Â  <span class="keyword">from</span> (</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">select</span> <span class="keyword">distinct</span> t1.id,t1.country,c.student_count</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">from</span> teachers t1 <span class="keyword">left</span> <span class="keyword">join</span> teachers t2</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">on</span> t1.id<span class="operator">=</span>t2.id<span class="number">-1</span> <span class="keyword">or</span> t1.id<span class="operator">=</span>t2.id<span class="operator">+</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> courses c <span class="keyword">on</span> t1.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">where</span> t1.country<span class="operator">=</span>t2.country</span><br><span class="line">Â  Â  ) tt</span><br><span class="line">Â  Â  <span class="keyword">group</span> <span class="keyword">by</span> tt.country</span><br><span class="line">Â  Â  <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>joinæ˜¯å°†è¡¨é“¾æ¥åœ¨æºè¡¨åï¼Œ<code>t1.id=t2.id-1 or t1.id=t2.id+1</code>ä¼šå‡ºç°æœ€å¤šä¸‰è¡Œ</li><li>groupé™¤äº†åˆ†ç»„åˆ—ï¼Œå…¶ä»–åˆ—å¯èƒ½åŒ…å«å¤šä¸ªå€¼ï¼Œå®¹æ˜“BUG</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/learn/130/664">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E4%B8%89%EF%BC%89/"/>
      <url>/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p><p>å¼ ä¸‰åœ¨å®¿èˆé‡Œæ‰“æ¸¸æˆï¼Œä»Šå¤©è¿æ°”ä¸å¤ªå¥½ï¼Œæ€»æ˜¯è¢«åŒ¹é…çš„é˜Ÿå‹å‘ï¼Œæ°”å¾—å¼ ä¸‰ç›´æ¥å°±æŠŠæ¸¸æˆç»™å¸è½½äº†ã€‚æ²¡å¿ƒæƒ…å»åƒé¥­çš„å¼ ä¸‰æ‰“å¼€ QQï¼Œå‘ç°æœ‰ 999+ çš„ä¿¡æ¯ï¼ŒåŸæ¥æ˜¯å­¦æ ¡çš„è€å¸ˆç»™ä»–å‘æ¥çš„æ¶ˆæ¯ï¼Œæƒ³è¦ä»–å¸®å¿™åˆ›å»ºä¸€ä¸ª SQL è§†å›¾ <code>v_best_teachers</code>ï¼Œè¦ä»–èµ¶ç´§å†™å¥½å‘è¿‡å»ã€‚å¼ ä¸‰çœ‹äº†çœ‹éœ€æ±‚ï¼Œè¾¹çœ‹è¦æ±‚è¾¹å†™ SQLï¼Œç»“æœå‘ç°â€¦ä¸å¯¹ï¼<strong>å­¦æ ¡çš„è¦æ±‚æ˜¯æŸ¥å‡ºæ¯ä¸ªå›½å®¶æœ€å—æ¬¢è¿çš„è€å¸ˆä¿¡æ¯ï¼ˆå¬è¯¾å­¦ç”Ÿæ•°è¶Šå¤šè¶Šå—æ¬¢è¿ï¼‰ï¼Œå¹¶æŒ‰å›½ç±å‡åºæ’åº</strong>ã€‚ç°åœ¨å¼ ä¸‰åœ¨çŸ¥è¯†åˆ†äº«è¿‡ç¨‹ä¸­ï¼Œæ‹¿è¿™é“é¢˜æ¥è€ƒä½ ï¼Œå¹¶å˜²è®½ä½ ä¸èƒ½åšå‡ºæ¥â€¦â€¦å°ä¼™å­ï¼Œæ‰“è„¸å¼ ä¸‰çš„æ—¶å€™åˆ°äº†ï¼Œè¿˜åœ¨ç­‰ä»€ä¹ˆ ï¼Ÿå†²</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> teacher_id, student_count, country, email</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">    <span class="keyword">from</span> courses c </span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">    <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) a</span><br><span class="line"><span class="keyword">where</span> (student_count, country) <span class="keyword">in</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(student_count), country</span><br><span class="line">    <span class="keyword">from</span>(</span><br><span class="line">        <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">        <span class="keyword">from</span> courses c </span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">        <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">        <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) aa</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> country)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> if <span class="keyword">exists</span> v_best_teachers;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_best_teachers  <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> teacher_id,student_count,country,email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> id <span class="keyword">as</span> teacher_id,<span class="built_in">max</span>(student_count) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country ) <span class="keyword">as</span> student_count_1,country,email</span><br><span class="line">    ,student_count</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> a.id, email,country,<span class="built_in">sum</span>(student_count)</span><br><span class="line">        <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a.id,country) <span class="keyword">as</span> student_count</span><br><span class="line">        <span class="keyword">from</span> teachers a</span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> courses b </span><br><span class="line">        <span class="keyword">on</span> a.id <span class="operator">=</span> b.teacher_id </span><br><span class="line">        ) t </span><br><span class="line">    ) tt </span><br><span class="line"><span class="keyword">where</span> tt.student_count_1 <span class="operator">=</span>tt.student_count</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> ct.teacher_id <span class="keyword">as</span> teacher_id,</span><br><span class="line">ct.s_student_count <span class="keyword">as</span> student_count,</span><br><span class="line">ct.country <span class="keyword">as</span> country,</span><br><span class="line">ct.email <span class="keyword">as</span> email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> c.teacher_id,c.s_student_count,t.country,t.email,</span><br><span class="line"><span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country <span class="keyword">order</span> <span class="keyword">by</span> s_student_count <span class="keyword">desc</span>) <span class="keyword">as</span> orde</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> teacher_id,<span class="built_in">sum</span>(student_count) <span class="keyword">as</span> s_student_count <span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> teacher_id</span><br><span class="line">) <span class="keyword">as</span> c</span><br><span class="line"><span class="keyword">join</span> teachers t </span><br><span class="line"><span class="keyword">on</span> c.teacher_id<span class="operator">=</span>t.id) <span class="keyword">as</span> ct</span><br><span class="line"><span class="keyword">where</span> ct.orde<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>æ³¨æ„<code>join</code>ä¸­æ•°æ®çš„é‡å¤æ¬¡æ•°ï¼Œä¼šé€ æˆæ•°æ®å‡ºç°é‡å¤ã€‚</li><li>èšåˆå‡½æ•°è¦å’Œ<code>group by</code>è”ç”¨ï¼Œmysqlè¦å»byåé¢ä¸ºå…¨selectå…³é”®è¯ï¼Œå³é™¤äº†èšåˆå‡½æ•°ã€‚</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/learn/153/683">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/"/>
      <url>/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>å¼ ä¸‰æ›¾ç»æœ‰ä¸€ä¸ªæ¢¦æƒ³ï¼Œæƒ³è¦å¬éå­¦æ ¡é‡Œçš„æ¯ä¸€ä½æ•™å¸ˆçš„è¯¾ç¨‹ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè§†å›¾ <code>v_mydream</code> å±•ç¤ºäº†æ‰€æœ‰çš„è¯¾ç¨‹ä¸æˆè¯¾æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå¹¶æŒ‰æ•™å¸ˆå§“åå‡åºå»å®ç°ï¼Œä½†æ˜¯å¼ ä¸‰å‘ç°è¯¾ç¨‹å®åœ¨æ˜¯å¤ªå¤šå¤ªå¤šï¼Œæ¢¦æƒ³éœ€è¦æ”¹ä¸€æ”¹ï¼Œäºæ˜¯ä»–æŠŠæ¢¦æƒ³æ”¹æˆäº†å»å¬<strong>æ¯ä¸€ä½æ•™å¸ˆæœ€å—æ¬¢è¿çš„è¯¾ç¨‹ï¼ˆå¬è¯¾å­¦ç”Ÿè¶Šå¤šè¶Šå—æ¬¢è¿ï¼Œå¦‚æœè¯¥æ•™å¸ˆæ²¡æœ‰æ•™æˆè¯¾ç¨‹åˆ™è¯¾ç¨‹ä¸å­¦ç”Ÿæ•°æ˜¾ç¤ºä¸º <code>NULL</code>ï¼‰</strong>ï¼Œå­¦æ ¡ä¹Ÿéå¸¸æ”¯æŒä»–ï¼Œå¬è¯´ä»–æœ€è¿‘åœ¨å­¦ <code>MySQL</code>ï¼Œå°±ç»™äº†ä»– <code>2</code> å¼ è¡¨çš„æ•°æ®è®©ä»–è‡ªå·±å»æ‰¾ï¼Œ<code>teachers</code> è¡¨ä¸­è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œ<code>courses</code> è¡¨ä¸­è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ã€‚å¼ ä¸‰ä¸€çœ‹ï¼Œâ€œ å“‡~ è¿™ä¹Ÿå¤ªç®€å•äº†ï¼Œæ„Ÿè°¢å­¦æ ¡å¤§å¤§æä¾›çš„æ•°æ® â€ï¼Œå¯æ˜¯ä»–æ­£è¦æŠŠåŸæ¥çš„æ¢¦æƒ³è§†å›¾æ”¹å†™ï¼Œå°±å‘ç°æå››ä»æ—è¾¹è¿‡ã€‚æå››è‚šå­é¥¿çš„å‘±å‘±å«ï¼Œçœ‹åˆ°å¼ ä¸‰å°±é—®è¦ä¸è¦ä¸€èµ·å»åƒé¥­ï¼Œå¼ ä¸‰çµå…‰ä¸€é—ªï¼Œâ€œ è¿™ä¹ˆå·§~ æˆ‘ä¹Ÿæ‰“ç®—å»åƒé¥­ï¼Œä½†æ˜¯ç°åœ¨æˆ‘è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œä½ å¸®æˆ‘è§£å†³äº†æˆ‘å°±è¯·ä½ åƒé¥­ â€ï¼Œæå››ä¸€å¬è¿˜æœ‰è¿™ç­‰å¥½äº‹ï¼Œç«‹é©¬ç­”åº”ä¸‹æ¥äº†ï¼Œç»“æœå‘ç°ä¸ä¼šã€‚ä¸ºäº†ä¸æ‰é¢å­å¹¶ä¸”èƒ½åƒä¸Šä¸€é¡¿ï¼Œå°±å·å·è”ç³»äº†ä½ ï¼Œè¯·æ±‚ä½ å¸®ä»–è§£å†³ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_mydream <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> teacher_name,course_name,student_count</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">select</span> t.name teacher_name,c.name course_name,student_count,</span><br><span class="line">Â  Â  Â <span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> t.id <span class="keyword">order</span> <span class="keyword">by</span> student_count <span class="keyword">desc</span>) num</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â <span class="keyword">left</span> <span class="keyword">join</span> courses c</span><br><span class="line">Â  Â  Â <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">) tt</span><br><span class="line"><span class="keyword">where</span> tt.num<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> teacher_name;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ol><li><code>DENSE_RANK()</code> å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span>[&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], [&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</li></ol><ul><li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥å°†<code>FROM</code>å­å¥ç”Ÿæˆçš„ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºæ¯ä¸ªåˆ†åŒºã€‚</li><li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>  å­å¥æŒ‡å®š<code>DENSE_RANK()</code>å‡½æ•°æ“ä½œçš„æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œé¡ºåºã€‚<br>å¦‚æœåˆ†åŒºå…·æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šå…·æœ‰ç›¸åŒæ’åå€¼çš„è¡Œï¼Œåˆ™å°†ä¸ºè¿™äº›è¡Œä¸­çš„æ¯ä¸€è¡Œåˆ†é…ç›¸åŒçš„æ’åã€‚<br>ä¸<a href="https://zhuanlan.zhihu.com/p/133469603#:~:text=%E5%85%88%E4%B8%8A%E7%BB%93%E8%AE%BA%EF%BC%8C%E4%B8%89%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB%E5%A6%82%E4%B8%8B%EF%BC%9A%20rank,%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%B8%8D%E5%8F%98%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%813%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B%20dense_rank%20%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%BC%9A%E5%87%8F%E5%B0%91%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%812%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B">Rank</a><code>å‡½æ•°ä¸åŒï¼Œ</code>DENSE_RANK()`å‡½æ•°å§‹ç»ˆè¿”å›è¿ç»­çš„æ’åå€¼ã€‚<br>eee<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sales;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    sales_employee,</span><br><span class="line">    fiscal_year,</span><br><span class="line">    sale,</span><br><span class="line">    <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span></span><br><span class="line">                     fiscal_year</span><br><span class="line">                 <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">                     sale <span class="keyword">DESC</span></span><br><span class="line">                ) sales_rank</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    sales;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span> sales_rank <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥ä½¿ç”¨ä¼šè®¡å¹´åº¦å°†ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚</li><li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>æ¡æ¬¾æŒ‰é”€å”®é¢çš„é™åºæŒ‡å®šäº†é”€å”®å‘˜å·¥çš„é¡ºåºã€‚</li><li>ç¬¬ä¸‰ï¼Œ<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºå…·æœ‰<code>ORDER BY</code>å­å¥æŒ‡å®šçš„è¡Œé¡ºåºçš„æ¯ä¸ªåˆ†åŒºã€‚</li></ul><p><code>rank()/dense_rank()/row_number()çš„åŒºåˆ«ï¼š</code></p><ul><li>rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¸å˜ï¼Œå³ä¼šå‡ºç°1ã€1ã€3è¿™æ ·çš„æ’åºç»“æœï¼›</li><li>dense_rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¼šå‡å°‘ï¼Œå³ä¼šå‡ºç°1ã€1ã€2è¿™æ ·çš„æ’åºç»“æœï¼›</li><li>row_number()æ’åºç›¸åŒæ—¶ä¸ä¼šé‡å¤ï¼Œä¼šæ ¹æ®é¡ºåºæ’åºã€‚<h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://www.lintcode.com/learn/132/668">source</a><br><a href="https://www.begtut.com/mysql/mysql-dense_rank-function.html">DENSE_RANK</a><br><a href="https://blog.csdn.net/qq_44690947/article/details/109133592">max()ä¸group by()</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84%20MySQL%20%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E5%9B%9B/"/>
      <url>/2022/04/28/%E5%BC%A0%E4%B8%89%E7%9A%84%20MySQL%20%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››"><a href="#å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››" class="headerlink" title="å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››"></a>å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››</h2><p>2022-04-24</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>â€œä»Šæ™šçš„æœˆè‰²çœŸç¾å•Š~ â€ï¼Œå¼ ä¸‰ä¸€ä¸ªäººåœ¨èµæœˆï¼Œè¿™ç¾å¦™çš„æ—¶åˆ»ä¹Ÿåªæœ‰åœ¨å­¦ä¹ ç»“æŸåæ‰èƒ½æ„Ÿå—åˆ°ï¼Œä»Šå¤©å¼ ä¸‰åˆšå¼€å§‹å­¦å­˜å‚¨è¿‡ç¨‹ï¼Œä»–å‘ç°è¿™æ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿å•Šï¼Œå­¦å®Œä¹‹åå†èµä¸ªæœˆçœŸæ˜¯ç¾æ»‹æ»‹ã€‚è¿™æ—¶å€™ï¼ŒæŸæ•™å¸ˆç»™ä»–æ‰“äº†ä¸€ä¸ªç”µè¯ï¼Œç›´æ¥å°±æ¯äº†ä»–è¿™ä¸ªç¾å¦™çš„å¤œæ™šã€‚æŸæ•™å¸ˆè¯´å¸®ä»–æ•´ä¸ªæ´»ï¼Œç³»é‡Œç°åœ¨å‡†å¤‡å¹´è½»åŒ–ã€æ´»åŠ›åŒ–æ•™å¸ˆå›¢é˜Ÿï¼Œ<strong>ä¸Šå¤šé—¨è¯¾ï¼ˆè‡³å°‘ 2 é—¨è¯¾ï¼‰çš„æ•™å¸ˆå°±æ˜¯æ´»è·ƒæ•™å¸ˆ</strong>ï¼Œä½†æ˜¯ç°åœ¨æ•™å¸ˆä¸­æœ‰äº›å¹´è½»äººå•Šå–œæ¬¢å·æ‡’ï¼Œåªä¸Š 1 é—¨è¯¾æˆ–æ˜¯ä¸ä¸Šè¯¾ï¼Œäºæ˜¯è¦<strong>å°†æ´»è·ƒæ•™å¸ˆä¸­å¹´é¾„æœ€å¤§çš„æ•™å¸ˆæ‰€æ•™æˆçš„è¯¾ç¨‹å…¨éƒ¨äº¤ç»™ä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„æ•™å¸ˆï¼ˆå¦‚æœå¹´é¾„ç›¸åŒå°±æŒ‰å§“åé¡ºåºï¼‰ï¼Œç›´åˆ°æ•´ä¸ªæ•™å¸ˆå›¢é˜Ÿæ˜¾å¾—æ›´å¹´è½»åŒ–ã€æ´»åŠ›åŒ–ï¼Œè€Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„è¦æ±‚ä¸èƒ½å¤§äºå…¨ä½“æ•™å¸ˆçš„å¹³å‡å¹´é¾„</strong>ï¼Œè€Œä¸”è¿™ä¸ªå·¥ä½œä¼šå®šæœŸåšçš„ï¼Œç”±äºä¸šåŠ¡ç¹å¿™ï¼Œç„¶åä¸¢ç»™å¼ ä¸‰ 2 å¼ è¡¨è®©å¼ ä¸‰å¸®ä»–åšï¼Œ<code>teachers</code> è¡¨è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå’Œ <code>courses</code> è¡¨è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” <code>id</code> ä¸º <code>teacher_id</code>ã€‚å¼ ä¸‰æœ¬ä¸æƒ³æ¥è¿™ä¸ªæ´»ï¼Œä½†æ˜¯çªç„¶çµå…‰ä¸€é—ªå°±ç­”åº”äº†ï¼Œè°ˆå¦¥æ¡ä»¶ä»¥åï¼Œå¼ ä¸‰å›å¤´å°±ç”¨å­˜å‚¨è¿‡ç¨‹ç»™ä»–å†™å‡ºæ¥äº†å¹¶ä¸”ä¸å‘Šè¯‰æŸæ•™å¸ˆã€‚æ•™å¸ˆå¬è¯´å¼ ä¸‰å¹¶ä¸æ˜¯æ‰‹åŠ¨ç»™ä»–åšçš„ï¼Œäºæ˜¯æƒ³è¦æŒ–å‡ºå¼ ä¸‰æ˜¯æ€ä¹ˆåšçš„ï¼Œé€šè¿‡æ‰“å¬åªçŸ¥é“æ˜¯ç”¨äº†å­˜å‚¨è¿‡ç¨‹ï¼Œä½œä¸ºæ•™å¸ˆï¼Œæˆ‘å½“ç„¶è¦è‡ªå·±å†™äº†ï¼Œæ€ä¹ˆèƒ½è®©å¼ ä¸‰é‚£å°å­æ‹¿å¥½å¤„ï¼Ÿå°ä¼™å­ï¼Œå¿«æ¥å¤ç°ä¸€ä¸‹è¿™ä¸ªå­˜å‚¨è¿‡ç¨‹å§</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> youngTeachers ()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> oldt <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æœ€å¤§å¹´é¾„æ•™å¸ˆ</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> tid <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--ä¸æ´»è·ƒä¸”æœ€å¹´è½»</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> actnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æ´»è·ƒçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> notactnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â loop1:loop</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> actnum <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰€æœ‰è€å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> notactnum <span class="keyword">from</span> teachers;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--åˆ¤æ–­å¹´é¾„æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">Â  Â  Â  Â  Â  if actnum<span class="operator">&lt;=</span>notactnum <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â leave loop1;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">end</span> if;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºå¹´é¾„æœ€å¤§çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> oldt <span class="keyword">from</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> t.age <span class="keyword">desc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> tid</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&lt;=</span><span class="number">1</span> <span class="keyword">or</span> c.num <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>,t.name <span class="keyword">asc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ›´æ–°æ•°æ®</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">update</span> courses</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> teacher_id<span class="operator">=</span>tid <span class="keyword">where</span> teacher_id<span class="operator">=</span>oldt;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> youngTeachers();</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>[[å­˜å‚¨è¿‡ç¨‹]]</li><li>sqlå¾ªç¯è¿‡ç¨‹![[å­˜å‚¨è¿‡ç¨‹#å¾ªç¯è¯­å¥]]</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/2800/description">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E4%BF%AE%E5%A4%8D%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%90%8D%E5%AD%97/"/>
      <url>/2022/04/28/%E4%BF%AE%E5%A4%8D%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%90%8D%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¿®å¤è¡¨ä¸­çš„åå­—"><a href="#ä¿®å¤è¡¨ä¸­çš„åå­—" class="headerlink" title="ä¿®å¤è¡¨ä¸­çš„åå­—"></a>ä¿®å¤è¡¨ä¸­çš„åå­—</h2><p>2022-04-24</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> user_id        <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name           <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">user_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«ç”¨æˆ·çš„ ID å’Œåå­—ã€‚åå­—ä»…ç”±å°å†™å’Œå¤§å†™å­—ç¬¦ç»„æˆã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥ä¿®å¤åå­—ï¼Œä½¿å¾—åªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¤§å†™çš„ï¼Œå…¶ä½™éƒ½æ˜¯å°å†™çš„ã€‚</p><p>è¿”å›æŒ‰ <code>user_id</code> æ’åºçš„ç»“æœè¡¨ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â user_id,concat(<span class="built_in">upper</span>(<span class="keyword">left</span>(name,<span class="number">1</span>)),<span class="built_in">lower</span>(substr(name,<span class="number">2</span>)))Â name</span><br><span class="line"><span class="keyword">from</span>Â Users</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â user_id;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>å­—ç¬¦ä¸²å¤„ç†å‡½æ•°<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;My&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;QL&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;MySQL&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;foobarbar&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;fooba&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;QUADRATICALLY&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;quadratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;Quadratically&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;ratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;Hej&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;HEJ&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/fix-names-in-a-table/">source</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E6%A0%91%E8%8A%82%E7%82%B9/"/>
      <url>/2022/04/28/%E6%A0%91%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="æ ‘èŠ‚ç‚¹"><a href="#æ ‘èŠ‚ç‚¹" class="headerlink" title="æ ‘èŠ‚ç‚¹"></a>æ ‘èŠ‚ç‚¹</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™å®šä¸€ä¸ªè¡¨ <code>tree</code>ï¼Œ<strong>id</strong> æ˜¯æ ‘èŠ‚ç‚¹çš„ç¼–å·ï¼Œ <strong>p_id</strong> æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„ <strong>id ã€‚</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> p_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> <span class="keyword">null</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure><br>æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å±äºä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š</p><pre><code>å¶å­ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä»»ä½•å­©å­èŠ‚ç‚¹ã€‚æ ¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯æ•´æ£µæ ‘çš„æ ¹ï¼Œå³æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚å†…éƒ¨èŠ‚ç‚¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ—¢ä¸æ˜¯å¶å­èŠ‚ç‚¹ä¹Ÿä¸æ˜¯æ ¹èŠ‚ç‚¹ã€‚</code></pre><p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¾“å‡ºæ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·å’ŒèŠ‚ç‚¹çš„ç±»å‹ï¼Œå¹¶å°†ç»“æœæŒ‰ç…§èŠ‚ç‚¹ç¼–å·æ’åºã€‚ä¸Šé¢æ ·ä¾‹çš„ç»“æœä¸ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> Root <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="keyword">Inner</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure></p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â id,TypeÂ <span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Root&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Inner&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>Â <span class="keyword">and</span>Â p_id<span class="operator">!=</span>(<span class="keyword">select</span>Â idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span>))</span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Leaf&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>)</span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â id;</span><br><span class="line"><span class="comment">--answer</span></span><br><span class="line"># æ ¹ç»“ç‚¹: æ²¡æœ‰çˆ¶èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Root&#x27;</span> <span class="keyword">AS</span> TYPE </span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># ä¸­é—´èŠ‚ç‚¹: æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># å¶å­ç»“ç‚¹: ä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"># æ³¨æ„:è¿™é‡Œè¿˜éœ€é™åˆ¶â€œä¸æ˜¯æ ¹èŠ‚ç‚¹â€ æ˜¯å› ä¸ºå½“æ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ æ ¹èŠ‚ç‚¹ä¹Ÿä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ </span><br><span class="line"># æ³¨æ„:ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)é‡Œé¢è¦é™åˆ¶P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"># å¦åˆ™<span class="keyword">SELECT</span>å‡ºæ¥çš„ç»“æœé‡Œé¢æœ‰<span class="keyword">NULL</span> è¿™å¥è¯è¿”å›ç©ºåˆ—è¡¨ (æˆ‘ä¹Ÿä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆ)</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">id,</span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> p_id <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;Root&#x27;</span></span><br><span class="line"> <span class="keyword">WHEN</span> id <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> p_id <span class="keyword">from</span> tree) <span class="keyword">then</span> <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">end</span> <span class="keyword">as</span> type</span><br><span class="line"><span class="keyword">from</span> tree;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1/"/>
      <url>/2022/04/28/%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1/</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"><a href="#åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±" class="headerlink" title="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"></a>åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> email       <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">idæ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶ã€‚ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL <strong>åˆ é™¤è¯­å¥</strong>æ¥ <strong>åˆ é™¤</strong> æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªidæœ€å°çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span>Â p1Â <span class="keyword">from</span>Â PersonÂ p1,PersonÂ p2</span><br><span class="line"><span class="keyword">where</span>Â p1.email<span class="operator">=</span>p2.emailÂ <span class="keyword">and</span>Â p1.id<span class="operator">&gt;</span>p2.id;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>deleteå¯ä»¥å†™æˆ<code>delete table1 from table1,table2 where â€¦â€¦</code>![[SQLåŸºç¡€#DELETE|delete]]</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/delete-duplicate-emails/">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E6%AF%8F%E4%B8%AA%E4%BA%A7%E5%93%81%E5%9C%A8%E4%B8%8D%E5%90%8C%E5%95%86%E5%BA%97%E7%9A%84%E4%BB%B7%E6%A0%BC/"/>
      <url>/2022/04/28/%E6%AF%8F%E4%B8%AA%E4%BA%A7%E5%93%81%E5%9C%A8%E4%B8%8D%E5%90%8C%E5%95%86%E5%BA%97%E7%9A%84%E4%BB%B7%E6%A0%BC/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"><a href="#æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼" class="headerlink" title="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"></a>æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Products</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> product_id  <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store1      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store2      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store3      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">è¿™å¼ è¡¨çš„ä¸»é”®æ˜¯product_idï¼ˆäº§å“Idï¼‰ã€‚</span><br><span class="line">æ¯è¡Œå­˜å‚¨äº†è¿™ä¸€äº§å“åœ¨ä¸åŒå•†åº—store1, store2, store3çš„ä»·æ ¼ã€‚</span><br><span class="line">å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™å€¼å°†ä¸º<span class="keyword">null</span>ã€‚</span><br></pre></td></tr></table></figure><br>è¯·ä½ é‡æ„ Products è¡¨ï¼ŒæŸ¥è¯¢æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼ï¼Œä½¿å¾—è¾“å‡ºçš„æ ¼å¼å˜ä¸º(product_id, store, price) ã€‚å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™ä¸è¾“å‡ºè¿™ä¸€è¡Œã€‚</p><p>è¾“å‡ºç»“æœè¡¨ä¸­çš„ é¡ºåºä¸ä½œè¦æ±‚ ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â product_id,store,priceÂ <span class="keyword">from</span>(</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store1&#x27;</span>Â store,store1Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store1 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store2&#x27;</span>Â store,store2Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store2 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store3&#x27;</span>Â store,store3Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store3 is not null</span></span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">where</span>Â priceÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>è®¾ç½®å¸¸é‡åˆ—<code>select &#39;a&#39; coloum</code></li><li>è¡Œè½¬åˆ—å¸¸ç”¨<code>case when</code>å’Œ<code>union all</code><br><img src="https://pic.leetcode-cn.com/1627441221-KvsJUP-%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87.png" alt="object"></li></ul><p><strong>è¡Œè½¬åˆ—â€”â€”MAX/SUM+CASE WHEN+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è¯­æ–‡&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;æ•°å­¦&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è‹±è¯­&quot;</span><br><span class="line"><span class="keyword">FROM</span> student1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name</span><br></pre></td></tr></table></figure></p><p><strong>åˆ—è½¬è¡Œâ€”â€”MAX+UNION+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è¯­æ–‡&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;æ•°å­¦&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è‹±è¯­&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br></pre></td></tr></table></figure></p><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E8%BF%9B%E5%BA%97%E5%8D%B4%E6%9C%AA%E8%BF%9B%E8%A1%8C%E8%BF%87%E4%BA%A4%E6%98%93%E7%9A%84%E9%A1%BE%E5%AE%A2/"/>
      <url>/2022/04/28/%E8%BF%9B%E5%BA%97%E5%8D%B4%E6%9C%AA%E8%BF%9B%E8%A1%8C%E8%BF%87%E4%BA%A4%E6%98%93%E7%9A%84%E9%A1%BE%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"><a href="#è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢" class="headerlink" title="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"></a>è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢</h2><p>2022-04-26</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Visits</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> visit_id    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> customer_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">visit_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«æœ‰å…³å…‰ä¸´è¿‡è´­ç‰©ä¸­å¿ƒçš„é¡¾å®¢çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>è¡¨ï¼š<code>Transactions</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> transaction_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> visit_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> amount         <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">transaction_id æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨åŒ…å« visit_id æœŸé—´è¿›è¡Œçš„äº¤æ˜“çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>æœ‰ä¸€äº›é¡¾å®¢å¯èƒ½å…‰é¡¾äº†è´­ç‰©ä¸­å¿ƒä½†æ²¡æœ‰è¿›è¡Œäº¤æ˜“ã€‚è¯·ä½ ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾è¿™äº›é¡¾å®¢çš„ ID ï¼Œä»¥åŠä»–ä»¬åªå…‰é¡¾ä¸äº¤æ˜“çš„æ¬¡æ•°ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(visit_id)Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â v.visit_id,v.customer_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â VisitsÂ v</span><br><span class="line">Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ t</span><br><span class="line">Â Â Â Â <span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â t.transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">)Â tt</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_transÂ <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">--second version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(v.visit_id)Â <span class="keyword">as</span>Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â VisitsÂ <span class="keyword">as</span>Â v</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ <span class="keyword">as</span>Â t</span><br><span class="line"><span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line"><span class="keyword">where</span>Â t.Transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_trans;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/customer-who-visited-but-did-not-make-any-transactions/submissions/">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E8%AE%A1%E7%AE%97%E7%89%B9%E6%AE%8A%E5%A5%96%E9%87%91/"/>
      <url>/2022/04/28/%E8%AE%A1%E7%AE%97%E7%89%B9%E6%AE%8A%E5%A5%96%E9%87%91/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"><a href="#è®¡ç®—ç‰¹æ®Šå¥–é‡‘" class="headerlink" title="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"></a>è®¡ç®—ç‰¹æ®Šå¥–é‡‘</h2><p>2022-04-23</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| åˆ—å        | ç±»å‹     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| employee_id | int     |</span><br><span class="line">| name        | varchar |</span><br><span class="line">| salary      | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œç»™å‡ºäº†é›‡å‘˜id ï¼Œåå­—å’Œè–ªæ°´ã€‚</span><br></pre></td></tr></table></figure><p>å†™å‡ºä¸€ä¸ªSQL æŸ¥è¯¢è¯­å¥ï¼Œè®¡ç®—æ¯ä¸ªé›‡å‘˜çš„å¥–é‡‘ã€‚å¦‚æœä¸€ä¸ªé›‡å‘˜çš„idæ˜¯å¥‡æ•°å¹¶ä¸”ä»–çš„åå­—ä¸æ˜¯ä»¥â€™Mâ€™å¼€å¤´ï¼Œé‚£ä¹ˆä»–çš„å¥–é‡‘æ˜¯ä»–å·¥èµ„çš„100%ï¼Œå¦åˆ™å¥–é‡‘ä¸º0ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#######<span class="number">1</span>########<span class="number">611</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">ifÂ (employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>,salary,<span class="number">0</span>)Â bonusÂ </span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line"></span><br><span class="line">#######<span class="number">2</span>#######<span class="number">570</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>Â <span class="keyword">then</span>Â salaryÂ <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line">#########<span class="number">3</span>########<span class="number">619</span>ms</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">=</span><span class="number">1</span>Â <span class="keyword">and</span>Â <span class="keyword">left</span>(name,<span class="number">1</span>)<span class="operator">!=</span><span class="string">&#x27;M&#x27;</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">then</span>Â salaryÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>if:å¯ä»¥æ”¾åœ¨selectä¹‹åä½œä¸ºè¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸ºï¼š<code>if(æ¡ä»¶,Ture:è¾“å‡º1,FALSE:è¾“å‡º2) as name</code>ã€‚</li><li>caseï¼šä½œä¸ºselectçš„è¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸º:<code>case when æ¡ä»¶ then True:è¾“å‡º1 else FALSEï¼šè¾“å‡º2 end name</code>ã€‚</li><li>é™¤äº†å¯ä»¥ç”¨like â€˜M%â€™åˆ¤æ–­å­—ç¬¦ä¸²ä»¥Må¼€å¤´ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>left(å­—ç¬¦ä¸²ï¼Œlocation)</code>åˆ¤æ–­å¯¹åº”ä½ç½®ä¸Šçš„å­—æ¯ï¼Œä¾‹å¦‚<code>left(&#39;Mike&#39;,1)</code>ã€‚</li><li>åŒç†å¯ä»¥ç”¨äºå…¶ä»–æƒ…å†µå¦‚<code>updateâ€¦â€¦set()</code>ç­‰</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://leetcode-cn.com/problems/calculate-special-bonus/">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E6%82%A3%E6%9F%90%E7%A7%8D%E7%96%BE%E7%97%85%E7%9A%84%E6%82%A3%E8%80%85/"/>
      <url>/2022/04/28/%E6%82%A3%E6%9F%90%E7%A7%8D%E7%96%BE%E7%97%85%E7%9A%84%E6%82%A3%E8%80%85/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"><a href="#æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…" class="headerlink" title="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"></a>æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</h2><p>2022-04-24</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> patient_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> patient_name <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> conditions   <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line">patient_id ï¼ˆæ‚£è€… IDï¼‰æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line"><span class="string">&#x27;conditions&#x27;</span> ï¼ˆç–¾ç—…ï¼‰åŒ…å« <span class="number">0</span> ä¸ªæˆ–ä»¥ä¸Šçš„ç–¾ç—…ä»£ç ï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚</span><br><span class="line">è¿™ä¸ªè¡¨åŒ…å«åŒ»é™¢ä¸­æ‚£è€…çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>å†™ä¸€æ¡ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ‚£æœ‰ I ç±»ç³–å°¿ç—…çš„æ‚£è€… ID ï¼ˆpatient_idï¼‰ã€æ‚£è€…å§“åï¼ˆpatient_nameï¼‰ä»¥åŠå…¶æ‚£æœ‰çš„æ‰€æœ‰ç–¾ç—…ä»£ç ï¼ˆconditionsï¼‰ã€‚I ç±»ç³–å°¿ç—…çš„ä»£ç æ€»æ˜¯åŒ…å«å‰ç¼€ DIAB1 ã€‚</p><p>æŒ‰ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â patient_id,patient_name,conditions</span><br><span class="line"><span class="keyword">from</span>Â Patients</span><br><span class="line"><span class="keyword">where</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;DIAB1%&#x27;</span>Â <span class="keyword">or</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;%Â DIAB1%&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>å¤šæ¡ä»¶[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨LIKEæ¨¡ç³ŠæŸ¥è¯¢|like]]:<code>where conditions like &#39;condition1&#39; or/and conditions like &#39;condition2&#39;</code></li><li><code>%</code>åŒ¹é…ï¼š<code>%con</code>ä»¥conå¼€å¤´ï¼Œ<code>% con</code>ä»¥ conå¼€å¤´<h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/patients-with-a-condition/">source</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E6%8C%82%E7%A7%91%E6%9C%80%E5%A4%9A%E7%9A%84%E5%90%8C%E5%AD%A6%20II/"/>
      <url>/2022/04/28/%E6%8C%82%E7%A7%91%E6%9C%80%E5%A4%9A%E7%9A%84%E5%90%8C%E5%AD%A6%20II/</url>
      
        <content type="html"><![CDATA[<h2 id="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II"><a href="#æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II" class="headerlink" title="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II"></a>æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br><code>exams</code> è¡¨ä¸­å­˜æ”¾ç€åŒå­¦ä»¬çš„è€ƒè¯•è®°å½•<br>è¯·ç”¨ SQL è¯­å¥ï¼Œæ‰¾åˆ°æŒ‚ç§‘æ•°æœ€å¤šçš„åŒå­¦æ‰€å¯¹åº”çš„ <code>student_id</code></p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> student_id</span><br><span class="line"><span class="keyword">FROM</span> exams</span><br><span class="line"><span class="keyword">WHERE</span> is_pass <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(bb.a)</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> (</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> a</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">FROM</span> exams <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span> <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) <span class="keyword">as</span> bb</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">SELECT</span> student_id <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">) t</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> num<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(num) <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) tt</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>whereåä¸å¯ä»¥è·Ÿ[[å‡½æ•°#ç®—æ•°å‡½æ•°|èšåˆå‡½æ•°]]</li></ul><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="https://www.lintcode.com/problem/1933/solution/45386">source</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/04/28/%E7%AC%AC%E4%BA%8C%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4/"/>
      <url>/2022/04/28/%E7%AC%AC%E4%BA%8C%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬äºŒé«˜çš„è–ªæ°´"><a href="#ç¬¬äºŒé«˜çš„è–ªæ°´" class="headerlink" title="ç¬¬äºŒé«˜çš„è–ªæ°´"></a>ç¬¬äºŒé«˜çš„è–ªæ°´</h2><p>2022-04-25</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p><code>Employee</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary      <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line">id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å‘˜å·¥çš„å·¥èµ„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å–å¹¶è¿”å› <code>Employee</code> è¡¨ä¸­ç¬¬äºŒé«˜çš„è–ªæ°´ ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ŒæŸ¥è¯¢åº”è¯¥è¿”å› <code>null</code> ã€‚</p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">SELECT</span>Â <span class="built_in">max</span>(Salary)Â SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span>Â EmployeeÂ Â </span><br><span class="line"><span class="keyword">where</span>Â SalaryÂ <span class="operator">!=</span>Â (<span class="keyword">select</span>Â <span class="built_in">max</span>(Salary)Â <span class="keyword">from</span>Â EmployeeÂ );</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="comment">--ä½¿ç”¨selectè¾“å‡ºï¼Œå¦åˆ™å½“ä¸å­˜åœ¨ç¬¬äºŒé«˜æ—¶å€™è¾“å‡ºä¸ºç©ºè€Œä¸æ˜¯null</span></span><br><span class="line"><span class="keyword">SELECT</span> (</span><br><span class="line">       <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">       <span class="keyword">FROM</span> Employee</span><br><span class="line">       <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">       LIMIT <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">) SecondHighestSalary;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li><code>limit m,n</code>ï¼šmä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè¦å–çš„æ•°æ®æ•°é‡ã€‚</li><li><code>limit m</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡</li><li><code>limit m offset n</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡<br>[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨ LIMIT é™åˆ¶è¾“å‡ºè¡Œæ•°|limitåŸºç¡€]]<h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/second-highest-salary/">source</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SQL</title>
      <link href="/2022/04/28/SQL/"/>
      <url>/2022/04/28/SQL/</url>
      
        <content type="html"><![CDATA[<h1 id="SQLåŸºç¡€"><a href="#SQLåŸºç¡€" class="headerlink" title="SQLåŸºç¡€"></a>SQLåŸºç¡€</h1><h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><blockquote><p>åŸºæœ¬è¯­æ³•</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨<code>DISTINCT</code>ä½¿æŸ¥è¯¢ä¸é‡å¤<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> `column_name`</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br></pre></td></tr></table></figure></p><p><code>SELECT WHERE</code> è¯­å¥æ˜¯ç­›é€‰æŸ¥è¯¢å¾ˆé‡è¦çš„æ“ä½œï¼Œ<code>WHERE</code> å…³é”®å­—åé¢åŠ ä¸Šæ¡ä»¶å¯ä»¥è¿‡æ»¤æ‰æˆ‘ä»¬ä¸éœ€è¦çš„ä¿¡æ¯ï¼Œå¯¹æŸ¥è¯¢æ•ˆç‡æœ‰ç€å¾ˆå¤§çš„æé«˜ã€‚<br>åœ¨ä½¿ç”¨ <code>SELECT WHERE</code> è¯­å¥æ£€ç´¢è¡¨æ•°æ®æ—¶ï¼Œéœ€è¦ç»™å‡ºæ£€ç´¢çš„è¡¨å (table_name)ã€æ£€ç´¢çš„åˆ—å (column_name) å’Œæ“ä½œç¬¦ (operator) ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `column_name1`,`column_name2`â€¦</span><br><span class="line"><span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `column_name` operator `<span class="keyword">value</span>`;</span><br></pre></td></tr></table></figure><ul><li>column_name å¯¹åº”æŒ‡å®šåˆ—çš„åç§°ï¼Œæˆ–è€…æ˜¯å¤šåˆ—ï¼Œç”¨é€—å·ï¼ˆ <code>,</code> ï¼‰åˆ†éš”å¼€</li><li>table_name å¯¹åº”æŸ¥è¯¢è¡¨çš„åç§°</li><li><p>operator ä¸ºæ“ä½œç¬¦![[sqlæ¡ä»¶è¿ç®—#æ¯”è¾ƒè¿ç®—ç¬¦]]ï¼Œå¸¸ç”¨çš„æœ‰ç­‰äº <code>=</code> ã€å°äº <code>&lt;</code> ã€å¤§äº <code>&gt;</code> ã€ä¸ç­‰äº<code>&lt;&gt;</code> æˆ– <code>!=</code>ã€‚</p><blockquote><p>selectåé¢è¦è¾“å‡ºçš„ä¿¡æ¯å¦‚æœæ˜¯å…¨éƒ¨ä¿¡æ¯å°±è·Ÿ*å°±å¯ä»¥ï¼Œ fromåéƒ½æ˜¯è·Ÿä¸Šæ¥è‡ªå“ªä¸ªè¡¨ whereå°±æ˜¯åé¢è·Ÿçš„å°±æ˜¯æ¡ä»¶ï¼Œè®°å¾—éæ•°å­—çš„åŠ ä¸Šå•å¼•å·å°±å¯ä»¥äº†ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span><span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;Artificial Intelligence&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><blockquote><p><strong>INSERT INTO</strong> è¯­å¥ç”¨äºå‘è¡¨ä¸­æ’å…¥æ–°è®°å½•ï¼Œè¿™è¾¹ä»‹ç»ä¸¤ç§ç¼–å†™å½¢å¼ï¼Œç¬¬ä¸€ç§å½¢å¼æ— éœ€æŒ‡å®šåˆ—åï¼Œç¬¬äºŒç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—åã€‚</p></blockquote><h3 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h3><blockquote><p>ç¬¬ä¸€ç§å½¢å¼ï¼Œ<code>ä¸éœ€è¦æŒ‡å®šåˆ—å</code>ã€‚åªéœ€æä¾›æ’å…¥çš„æ•°æ®å³å¯ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `table_name`</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3,...);</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` <span class="keyword">VALUES</span> (<span class="number">13</span>,<span class="string">&#x27;Python&#x27;</span>,<span class="string">&#x27;400&#x27;</span>,<span class="string">&#x27;2021-05-23&#x27;</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒç§æ–¹å¼"><a href="#ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼"></a>ç¬¬äºŒç§æ–¹å¼</h3><blockquote><p>è¿™ç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—åï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `table_name`</span><br><span class="line">(`column1`, `column2`, `column3`,...)</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3,...);</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (`name`, `student_count`, `created_at`, `teacher_id`) <span class="keyword">VALUES</span> (<span class="string">&#x27;Flash Sale&#x27;</span>,<span class="string">&#x27;100&#x27;</span>,<span class="string">&#x27;2018-01-01&#x27;</span>,<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><blockquote><p>åŸºæœ¬è¯­æ³•<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `table_name`</span><br><span class="line"><span class="keyword">SET</span> `column1`<span class="operator">=</span>value1,`column2`<span class="operator">=</span>value2,...</span><br><span class="line"><span class="keyword">WHERE</span> `some_column`<span class="operator">=</span>some_value;</span><br></pre></td></tr></table></figure></p></blockquote><h4 id="å®ä¾‹-2"><a href="#å®ä¾‹-2" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> `teachers`</span><br><span class="line"><span class="keyword">SET</span> `email` <span class="operator">=</span> <span class="string">&#x27;LinghuChong@lintcode.com&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;Linghu Chong&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><blockquote><p>åŸºæœ¬è¯­æ³•</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `table_name`</span><br><span class="line"><span class="keyword">WHERE</span> `some_column` <span class="operator">=</span> `some_value`;</span><br></pre></td></tr></table></figure><h4 id="å®ä¾‹-3"><a href="#å®ä¾‹-3" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `courses` <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;Dynamic Programming&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">truncate</span> courses;</span><br></pre></td></tr></table></figure><h4 id="deleteå’Œtruncateçš„åŒºåˆ«"><a href="#deleteå’Œtruncateçš„åŒºåˆ«" class="headerlink" title="deleteå’Œtruncateçš„åŒºåˆ«"></a>deleteå’Œtruncateçš„åŒºåˆ«</h4><p>1ã€åœ¨åŠŸèƒ½ä¸Šï¼Œtruncateæ˜¯æ¸…ç©ºä¸€ä¸ªè¡¨çš„å†…å®¹ï¼Œå®ƒç›¸å½“äºdelete from table_nameã€‚<br>2ã€deleteæ˜¯dmlæ“ä½œï¼Œtruncateæ˜¯ddlæ“ä½œï¼›å› æ­¤ï¼Œç”¨deleteåˆ é™¤æ•´ä¸ªè¡¨çš„æ•°æ®æ—¶ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„roolbackï¼Œå ç”¨å¾ˆå¤šçš„rollback segmentsï¼Œ è€Œtruncateä¸ä¼šã€‚<br>3ã€åœ¨å†…å­˜ä¸­ï¼Œç”¨deleteåˆ é™¤æ•°æ®ï¼Œè¡¨ç©ºé—´ä¸­å…¶è¢«åˆ é™¤æ•°æ®çš„è¡¨å ç”¨çš„ç©ºé—´è¿˜åœ¨ï¼Œä¾¿äºä»¥åçš„ä½¿ç”¨ï¼Œå¦å¤–å®ƒæ˜¯â€œå‡ç›¸â€çš„åˆ é™¤ï¼Œç›¸å½“äºwindowsä¸­ç”¨deleteåˆ é™¤æ•°æ®æ˜¯æŠŠæ•°æ®æ”¾åˆ°å›æ”¶ç«™ä¸­ï¼Œè¿˜å¯ä»¥æ¢å¤ï¼Œå½“ç„¶å¦‚æœè¿™ä¸ªæ—¶å€™é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼ˆOSæˆ–è€…RDBMSï¼‰ï¼Œå®ƒä¹Ÿå°±ä¸èƒ½æ¢å¤äº†ï¼<br>è€Œç”¨truncateæ¸…é™¤æ•°æ®ï¼Œå†…å­˜ä¸­è¡¨ç©ºé—´ä¸­å…¶è¢«åˆ é™¤æ•°æ®çš„è¡¨å ç”¨çš„ç©ºé—´ä¼šè¢«ç«‹å³é‡Šæ”¾ï¼Œç›¸å½“äºwindowsä¸­ç”¨shift+deleteåˆ é™¤æ•°æ®ï¼Œä¸èƒ½å¤Ÿæ¢å¤ï¼<br>4ã€truncate è°ƒæ•´high water mark è€Œdeleteä¸ï¼›truncateä¹‹åï¼ŒTABLEçš„HWMé€€å›åˆ° INITIALå’ŒNEXTçš„ä½ç½®ï¼ˆé»˜è®¤ï¼‰delete åˆ™ä¸å¯ä»¥ã€‚<br>5ã€truncate åªèƒ½å¯¹TABLEï¼Œdelete å¯ä»¥æ˜¯table,view,synonymã€‚<br>6ã€TRUNCATE TABLE çš„å¯¹è±¡å¿…é¡»æ˜¯æœ¬æ¨¡å¼ä¸‹çš„ï¼Œæˆ–è€…æœ‰drop any tableçš„æƒé™ è€Œ DELETE åˆ™æ˜¯å¯¹è±¡å¿…é¡»æ˜¯æœ¬æ¨¡å¼ä¸‹çš„ï¼Œæˆ–è¢«æˆäºˆ DELETE ON SCHEMA.TABLE æˆ–DELETE ANY TABLEçš„æƒé™ã€‚<br>7ã€åœ¨å¤–å±‚ä¸­ï¼Œtruncateæˆ–è€…deleteåï¼Œå…¶å ç”¨çš„ç©ºé—´éƒ½å°†é‡Šæ”¾ã€‚<br>8ã€truncateå’Œdeleteåªåˆ é™¤æ•°æ®ï¼Œè€Œdropåˆ™åˆ é™¤æ•´ä¸ªè¡¨ï¼ˆç»“æ„å’Œæ•°æ®ï¼‰ã€‚</p><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><p>1.TRUNCATE TABLEæ˜¯éå¸¸å¿«çš„<br>2.TRUNCATEä¹‹åçš„è‡ªå¢å­—æ®µä»å¤´å¼€å§‹è®¡æ•°äº†ï¼Œè€ŒDELETEçš„ä»ä¿ç•™åŸæ¥çš„æœ€å¤§æ•°å€¼ </p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/04/28/hello-world/"/>
      <url>/2022/04/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</title>
      <link href="/2022/04/28/%E6%8C%89%E6%97%A5%E6%9C%9F%E5%88%86%E7%BB%84%E9%94%80%E5%94%AE%E4%BA%A7%E5%93%81/"/>
      <url>/2022/04/28/%E6%8C%89%E6%97%A5%E6%9C%9F%E5%88%86%E7%BB%84%E9%94%80%E5%94%AE%E4%BA%A7%E5%93%81/</url>
      
        <content type="html"><![CDATA[<h2 id="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"><a href="#æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“" class="headerlink" title="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"></a>æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</h2><p>2022-04-24</p><h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> åˆ—å         <span class="operator">|</span> ç±»å‹    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> sell_date   <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product     <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">æ­¤è¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«äº§å“åç§°å’Œåœ¨å¸‚åœºä¸Šé”€å”®çš„æ—¥æœŸã€‚</span><br></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥æŸ¥æ‰¾æ¯ä¸ªæ—¥æœŸã€é”€å”®çš„ä¸åŒäº§å“çš„æ•°é‡åŠå…¶åç§°ã€‚<br>æ¯ä¸ªæ—¥æœŸçš„é”€å”®äº§å“åç§°åº”æŒ‰è¯å…¸åºæ’åˆ—ã€‚<br>è¿”å›æŒ‰ sell_date æ’åºçš„ç»“æœè¡¨ã€‚<br>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚<br><span id="more"></span></p><h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â sell_date,<span class="built_in">count</span>(<span class="keyword">distinct</span>Â product)Â num_sold,group_concat(<span class="keyword">distinct</span>Â product)Â products</span><br><span class="line"><span class="keyword">from</span>Â Activities</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â sell_date</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â sell_dateÂ <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul><li>[[å‡½æ•°#ä½¿ç”¨ COUNT å‡½æ•°è®¡æ•°|count()]]èšåˆå‡½æ•°æ­é…<code>group</code>ä½¿ç”¨ï¼Œå®ç°åˆ†ç»„è®¡æ•°ã€‚</li><li><code>group_concat</code>å¯¹åˆ†ç»„å†…å®¹è¿›è¡Œæ‹¼æ¥ï¼Œè‹¥ä¸æ‹¼æ¥ç›´æ¥è¾“å‡ºä¸ºç¬¬ä¸€ä¸ªå€¼ã€‚<br>concatå’Œgroup_concatçš„åŒºåˆ«ï¼š</li></ul><ol><li>concatæ˜¯é’ˆå¯¹ä»¥è¡Œæ•°æ®åšçš„æ‹¼æ¥ï¼Œè€Œgroup_concatæ˜¯é’ˆå¯¹åˆ—åšçš„æ•°æ®æ‹¼æ¥ï¼Œä¸”group_concatè‡ªåŠ¨ç”Ÿæˆé€—å·ã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--concat</span></span><br><span class="line"><span class="keyword">select</span> concat(id, &quot;,&quot;, classId) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="comment">--group_concat</span></span><br><span class="line"><span class="comment">--ä¸€èˆ¬ä¸group byç»“åˆä½¿ç”¨</span></span><br><span class="line"><span class="keyword">select</span> group_concat(username) <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">group</span> <span class="keyword">by</span> classId;</span><br></pre></td></tr></table></figure><h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="https://leetcode-cn.com/problems/group-sold-products-by-the-date/">source</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
