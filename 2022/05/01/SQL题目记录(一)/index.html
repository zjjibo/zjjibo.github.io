<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>SQLé¢˜ç›®è®°å½•(ä¸€) | zZZZ's Blog</title><meta name="keywords" content="SQL,LeetCode,LintCode,è®°å½•"><meta name="author" content="Zj_Jibo"><meta name="copyright" content="Zj_Jibo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±2022-04-23 ğŸ™ˆIntroduction12345678+-------------+---------+| Column Name | Type    |+-------------+---------+| id          | int     || email       | varchar |+-------------+---------+idæ˜¯è¯¥è¡¨çš„ä¸»é”®">
<meta property="og:type" content="article">
<meta property="og:title" content="SQLé¢˜ç›®è®°å½•(ä¸€)">
<meta property="og:url" content="http://example.com/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/index.html">
<meta property="og:site_name" content="zZZZ&#39;s Blog">
<meta property="og:description" content="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±2022-04-23 ğŸ™ˆIntroduction12345678+-------------+---------+| Column Name | Type    |+-------------+---------+| id          | int     || email       | varchar |+-------------+---------+idæ˜¯è¯¥è¡¨çš„ä¸»é”®">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/04/29/XE8p2nWdrub9SOG.png">
<meta property="article:published_time" content="2022-05-01T02:45:10.000Z">
<meta property="article:modified_time" content="2022-05-01T07:16:58.545Z">
<meta property="article:author" content="Zj_Jibo">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="LeetCode">
<meta property="article:tag" content="LintCode">
<meta property="article:tag" content="è®°å½•">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/04/29/XE8p2nWdrub9SOG.png"><link rel="shortcut icon" href="https://s2.loli.net/2022/04/28/xONf6RXakT8oIu1.jpg"><link rel="canonical" href="http://example.com/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQLé¢˜ç›®è®°å½•(ä¸€)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-01 15:16:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macWhite.css"><link rel="stylesheet" href="/css/aplayerdiy.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/badge.css"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="zZZZ's Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/28/xONf6RXakT8oIu1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">16</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> åˆ†äº«</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> å½±è§†</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/04/29/XE8p2nWdrub9SOG.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">zZZZ's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> åšæ–‡</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> ç”Ÿæ´»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> åˆ†äº«</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> å½±è§†</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQLé¢˜ç›®è®°å½•(ä¸€)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-05-01T02:45:10.000Z" title="å‘è¡¨äº 2022-05-01 10:45:10">2022-05-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-05-01T07:16:58.545Z" title="æ›´æ–°äº 2022-05-01 15:16:58">2022-05-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/SQL/">SQL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SQLé¢˜ç›®è®°å½•(ä¸€)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"><a href="#åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±" class="headerlink" title="åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"></a>åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</h2><p>2022-04-23</p>
<h4 id="ğŸ™ˆIntroduction"><a href="#ğŸ™ˆIntroduction" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> email       <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">idæ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶ã€‚ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯ã€‚</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™ä¸€ä¸ª SQL <strong>åˆ é™¤è¯­å¥</strong>æ¥ <strong>åˆ é™¤</strong> æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªidæœ€å°çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚</p>
<h4 id="ğŸ¤”code"><a href="#ğŸ¤”code" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span>Â p1Â <span class="keyword">from</span>Â PersonÂ p1,PersonÂ p2</span><br><span class="line"><span class="keyword">where</span>Â p1.email<span class="operator">=</span>p2.emailÂ <span class="keyword">and</span>Â p1.id<span class="operator">&gt;</span>p2.id;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget"><a href="#ğŸ’ªget" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>deleteå¯ä»¥å†™æˆ<code>delete table1 from table1,table2 where â€¦â€¦</code>![[SQLåŸºç¡€#DELETE|delete]]</li>
</ul>
<h4 id="ğŸ™ƒsource"><a href="#ğŸ™ƒsource" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/delete-duplicate-emails/">source</a></p>
<h2 id="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"><a href="#è®¡ç®—ç‰¹æ®Šå¥–é‡‘" class="headerlink" title="è®¡ç®—ç‰¹æ®Šå¥–é‡‘"></a>è®¡ç®—ç‰¹æ®Šå¥–é‡‘</h2><p>2022-04-23</p>
<h4 id="ğŸ™ˆIntroduction-1"><a href="#ğŸ™ˆIntroduction-1" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| åˆ—å        | ç±»å‹     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| employee_id | int     |</span><br><span class="line">| name        | varchar |</span><br><span class="line">| salary      | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œç»™å‡ºäº†é›‡å‘˜id ï¼Œåå­—å’Œè–ªæ°´ã€‚</span><br></pre></td></tr></table></figure>
<p>å†™å‡ºä¸€ä¸ªSQL æŸ¥è¯¢è¯­å¥ï¼Œè®¡ç®—æ¯ä¸ªé›‡å‘˜çš„å¥–é‡‘ã€‚å¦‚æœä¸€ä¸ªé›‡å‘˜çš„idæ˜¯å¥‡æ•°å¹¶ä¸”ä»–çš„åå­—ä¸æ˜¯ä»¥â€™Mâ€™å¼€å¤´ï¼Œé‚£ä¹ˆä»–çš„å¥–é‡‘æ˜¯ä»–å·¥èµ„çš„100%ï¼Œå¦åˆ™å¥–é‡‘ä¸º0ã€‚</p>
<h4 id="ğŸ¤”code-1"><a href="#ğŸ¤”code-1" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#######<span class="number">1</span>########<span class="number">611</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">ifÂ (employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>,salary,<span class="number">0</span>)Â bonusÂ </span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line"></span><br><span class="line">#######<span class="number">2</span>#######<span class="number">570</span>ms</span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">!=</span><span class="number">0</span>Â <span class="keyword">and</span>Â nameÂ <span class="keyword">not</span>Â <span class="keyword">like</span>Â <span class="string">&#x27;M%&#x27;</span>Â <span class="keyword">then</span>Â salaryÂ <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br><span class="line">#########<span class="number">3</span>########<span class="number">619</span>ms</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span>Â employee_id,</span><br><span class="line">Â Â Â Â <span class="keyword">case</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">when</span>Â employee_id<span class="operator">%</span><span class="number">2</span><span class="operator">=</span><span class="number">1</span>Â <span class="keyword">and</span>Â <span class="keyword">left</span>(name,<span class="number">1</span>)<span class="operator">!=</span><span class="string">&#x27;M&#x27;</span>Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">then</span>Â salaryÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span>Â <span class="number">0</span>Â </span><br><span class="line">Â Â Â Â <span class="keyword">end</span>Â bonus</span><br><span class="line"><span class="keyword">from</span>Â Employees;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-1"><a href="#ğŸ’ªget-1" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>if:å¯ä»¥æ”¾åœ¨selectä¹‹åä½œä¸ºè¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸ºï¼š<code>if(æ¡ä»¶,Ture:è¾“å‡º1,FALSE:è¾“å‡º2) as name</code>ã€‚</li>
<li>caseï¼šä½œä¸ºselectçš„è¾“å‡ºé¡¹ï¼Œå¯¹è¾“å‡ºè¿›è¡Œæ¡ä»¶ç­›é€‰ï¼ŒåŸºæœ¬è¯­æ³•ä¸º:<code>case when æ¡ä»¶ then True:è¾“å‡º1 else FALSEï¼šè¾“å‡º2 end name</code>ã€‚</li>
<li>é™¤äº†å¯ä»¥ç”¨like â€˜M%â€™åˆ¤æ–­å­—ç¬¦ä¸²ä»¥Må¼€å¤´ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>left(å­—ç¬¦ä¸²ï¼Œlocation)</code>åˆ¤æ–­å¯¹åº”ä½ç½®ä¸Šçš„å­—æ¯ï¼Œä¾‹å¦‚<code>left(&#39;Mike&#39;,1)</code>ã€‚</li>
<li>åŒç†å¯ä»¥ç”¨äºå…¶ä»–æƒ…å†µå¦‚<code>updateâ€¦â€¦set()</code>ç­‰</li>
</ul>
<h4 id="ğŸ™ƒsource-1"><a href="#ğŸ™ƒsource-1" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/calculate-special-bonus/">source</a></p>
<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯-ä¸€" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)</h2><p>2022-04-23</p>
<h4 id="ğŸ™ˆIntroduction-2"><a href="#ğŸ™ˆIntroduction-2" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p>
<p>å¼ ä¸‰æœ€è¿‘å¯¹ <code>MySQL</code> æ•°æ®åº“æ„Ÿå…´è¶£ï¼Œå†³å®šè¦å¥½å¥½å­¦ä¹ æ•°æ®åº“ï¼Œä½†â€¦å­¦ä¹ çš„é“è·¯æ€»æ˜¯å……æ»¡è‰°è¾›çš„ã€‚å¼ ä¸‰ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼Œä»–å·¦æ€å³æƒ³ã€è‹¦æ€å†¥æƒ³ã€èŒ¶ä¸æ€é¥­ä¸æƒ³ä¹Ÿæ²¡èƒ½æƒ³å‡ºè§£å†³åŠæ³•ã€‚æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œç°æœ‰ <code>teachers</code> è¡¨ä¸­è®°å½•ç€ç¦»èŒçš„æ•™å¸ˆä¿¡æ¯ï¼Œ<code>id</code> çš„å€¼å³æ˜¯æ•™å¸ˆç¦»èŒçš„é¡ºåºï¼Œåœ¨ <code>courses</code> è¡¨ä¸­è®°å½•ç€æ¯ä¸ªæ•™å¸ˆæ•™æˆçš„è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” id ä¸º <code>teacher_id</code>ã€‚<strong>ç°åœ¨çŸ¥é“æ•™å¸ˆæ˜¯ä»¥å›½ç±æ¥åˆ†å›¢é˜Ÿçš„ï¼Œä¸”æ¯ä¸ªå›¢é˜Ÿçš„æˆç«‹è‡³å°‘æœ‰ <code>3</code> ä¸ªæ•™å¸ˆï¼Œè‹¥æ˜¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒï¼Œåˆ™åœ¨ <code>teachers</code> è¡¨ä¸­ä¿¡æ¯è®°å½•ä¸ºè¿ç»­ä¸”å›½ç±ç›¸åŒï¼Œç°åœ¨éœ€è¦ç»Ÿè®¡æ¯ä¸€ä¸ªæ•™å¸ˆå›¢é˜Ÿé›†ä½“ç¦»èŒä¼šæœ‰å¤šå°‘å­¦ç”Ÿéœ€è¦ç­‰å¾…æ–°çš„æ•™å¸ˆï¼Œç»“æœæŒ‰å›¢é˜Ÿå›½ç±æ’åº</strong>ã€‚ä»–éœ€è¦åˆ›å»ºä¸€ä¸ªè§†å›¾ <code>v_courses_teachers</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŒå­¦ä»¬å¿«æ¥å¸®å¸®å¼ ä¸‰å°ä¼™å­å§ ~</p>
<h4 id="ğŸ¤”code-2"><a href="#ğŸ¤”code-2" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_courses_teachers <span class="keyword">as</span> (</span><br><span class="line">Â  Â  <span class="keyword">select</span> tt.country,<span class="built_in">sum</span>(tt.student_count) student_count</span><br><span class="line">Â  Â  <span class="keyword">from</span> (</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">select</span> <span class="keyword">distinct</span> t1.id,t1.country,c.student_count</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">from</span> teachers t1 <span class="keyword">left</span> <span class="keyword">join</span> teachers t2</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">on</span> t1.id<span class="operator">=</span>t2.id<span class="number">-1</span> <span class="keyword">or</span> t1.id<span class="operator">=</span>t2.id<span class="operator">+</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> courses c <span class="keyword">on</span> t1.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">where</span> t1.country<span class="operator">=</span>t2.country</span><br><span class="line">Â  Â  ) tt</span><br><span class="line">Â  Â  <span class="keyword">group</span> <span class="keyword">by</span> tt.country</span><br><span class="line">Â  Â  <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-2"><a href="#ğŸ’ªget-2" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>joinæ˜¯å°†è¡¨é“¾æ¥åœ¨æºè¡¨åï¼Œ<code>t1.id=t2.id-1 or t1.id=t2.id+1</code>ä¼šå‡ºç°æœ€å¤šä¸‰è¡Œ</li>
<li>groupé™¤äº†åˆ†ç»„åˆ—ï¼Œå…¶ä»–åˆ—å¯èƒ½åŒ…å«å¤šä¸ªå€¼ï¼Œå®¹æ˜“BUG</li>
</ul>
<h4 id="ğŸ™ƒsource-2"><a href="#ğŸ™ƒsource-2" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://www.lintcode.com/learn/130/664">source</a></p>
<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰</h2><p>2022-04-23</p>
<h4 id="ğŸ™ˆIntroduction-3"><a href="#ğŸ™ˆIntroduction-3" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>å¼ ä¸‰æ›¾ç»æœ‰ä¸€ä¸ªæ¢¦æƒ³ï¼Œæƒ³è¦å¬éå­¦æ ¡é‡Œçš„æ¯ä¸€ä½æ•™å¸ˆçš„è¯¾ç¨‹ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè§†å›¾ <code>v_mydream</code> å±•ç¤ºäº†æ‰€æœ‰çš„è¯¾ç¨‹ä¸æˆè¯¾æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå¹¶æŒ‰æ•™å¸ˆå§“åå‡åºå»å®ç°ï¼Œä½†æ˜¯å¼ ä¸‰å‘ç°è¯¾ç¨‹å®åœ¨æ˜¯å¤ªå¤šå¤ªå¤šï¼Œæ¢¦æƒ³éœ€è¦æ”¹ä¸€æ”¹ï¼Œäºæ˜¯ä»–æŠŠæ¢¦æƒ³æ”¹æˆäº†å»å¬<strong>æ¯ä¸€ä½æ•™å¸ˆæœ€å—æ¬¢è¿çš„è¯¾ç¨‹ï¼ˆå¬è¯¾å­¦ç”Ÿè¶Šå¤šè¶Šå—æ¬¢è¿ï¼Œå¦‚æœè¯¥æ•™å¸ˆæ²¡æœ‰æ•™æˆè¯¾ç¨‹åˆ™è¯¾ç¨‹ä¸å­¦ç”Ÿæ•°æ˜¾ç¤ºä¸º <code>NULL</code>ï¼‰</strong>ï¼Œå­¦æ ¡ä¹Ÿéå¸¸æ”¯æŒä»–ï¼Œå¬è¯´ä»–æœ€è¿‘åœ¨å­¦ <code>MySQL</code>ï¼Œå°±ç»™äº†ä»– <code>2</code> å¼ è¡¨çš„æ•°æ®è®©ä»–è‡ªå·±å»æ‰¾ï¼Œ<code>teachers</code> è¡¨ä¸­è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œ<code>courses</code> è¡¨ä¸­è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ã€‚å¼ ä¸‰ä¸€çœ‹ï¼Œâ€œ å“‡~ è¿™ä¹Ÿå¤ªç®€å•äº†ï¼Œæ„Ÿè°¢å­¦æ ¡å¤§å¤§æä¾›çš„æ•°æ® â€ï¼Œå¯æ˜¯ä»–æ­£è¦æŠŠåŸæ¥çš„æ¢¦æƒ³è§†å›¾æ”¹å†™ï¼Œå°±å‘ç°æå››ä»æ—è¾¹è¿‡ã€‚æå››è‚šå­é¥¿çš„å‘±å‘±å«ï¼Œçœ‹åˆ°å¼ ä¸‰å°±é—®è¦ä¸è¦ä¸€èµ·å»åƒé¥­ï¼Œå¼ ä¸‰çµå…‰ä¸€é—ªï¼Œâ€œ è¿™ä¹ˆå·§~ æˆ‘ä¹Ÿæ‰“ç®—å»åƒé¥­ï¼Œä½†æ˜¯ç°åœ¨æˆ‘è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œä½ å¸®æˆ‘è§£å†³äº†æˆ‘å°±è¯·ä½ åƒé¥­ â€ï¼Œæå››ä¸€å¬è¿˜æœ‰è¿™ç­‰å¥½äº‹ï¼Œç«‹é©¬ç­”åº”ä¸‹æ¥äº†ï¼Œç»“æœå‘ç°ä¸ä¼šã€‚ä¸ºäº†ä¸æ‰é¢å­å¹¶ä¸”èƒ½åƒä¸Šä¸€é¡¿ï¼Œå°±å·å·è”ç³»äº†ä½ ï¼Œè¯·æ±‚ä½ å¸®ä»–è§£å†³ã€‚</p>
<h4 id="ğŸ¤”code-3"><a href="#ğŸ¤”code-3" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_mydream <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> teacher_name,course_name,student_count</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">select</span> t.name teacher_name,c.name course_name,student_count,</span><br><span class="line">Â  Â  Â <span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> t.id <span class="keyword">order</span> <span class="keyword">by</span> student_count <span class="keyword">desc</span>) num</span><br><span class="line">Â  Â  Â <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â <span class="keyword">left</span> <span class="keyword">join</span> courses c</span><br><span class="line">Â  Â  Â <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">) tt</span><br><span class="line"><span class="keyword">where</span> tt.num<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> teacher_name;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-3"><a href="#ğŸ’ªget-3" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ol>
<li><code>DENSE_RANK()</code> å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span>[&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], [&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
åœ¨è¿™ä¸ªè¯­æ³•ä¸­ï¼š</li>
</ol>
<ul>
<li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥å°†<code>FROM</code>å­å¥ç”Ÿæˆçš„ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºæ¯ä¸ªåˆ†åŒºã€‚</li>
<li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>  å­å¥æŒ‡å®š<code>DENSE_RANK()</code>å‡½æ•°æ“ä½œçš„æ¯ä¸ªåˆ†åŒºä¸­çš„è¡Œé¡ºåºã€‚<br>å¦‚æœåˆ†åŒºå…·æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šå…·æœ‰ç›¸åŒæ’åå€¼çš„è¡Œï¼Œåˆ™å°†ä¸ºè¿™äº›è¡Œä¸­çš„æ¯ä¸€è¡Œåˆ†é…ç›¸åŒçš„æ’åã€‚<br>ä¸<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/133469603#:~:text=%E5%85%88%E4%B8%8A%E7%BB%93%E8%AE%BA%EF%BC%8C%E4%B8%89%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB%E5%A6%82%E4%B8%8B%EF%BC%9A%20rank,%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%B8%8D%E5%8F%98%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%813%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B%20dense_rank%20%28%29%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%90%8C%E6%97%B6%E4%BC%9A%E9%87%8D%E5%A4%8D%EF%BC%8C%E6%80%BB%E6%95%B0%E4%BC%9A%E5%87%8F%E5%B0%91%EF%BC%8C%E5%8D%B3%E4%BC%9A%E5%87%BA%E7%8E%B01%E3%80%811%E3%80%812%E8%BF%99%E6%A0%B7%E7%9A%84%E6%8E%92%E5%BA%8F%E7%BB%93%E6%9E%9C%EF%BC%9B">Rank</a><code>å‡½æ•°ä¸åŒï¼Œ</code>DENSE_RANK()`å‡½æ•°å§‹ç»ˆè¿”å›è¿ç»­çš„æ’åå€¼ã€‚<br>eee<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sales;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    sales_employee,</span><br><span class="line">    fiscal_year,</span><br><span class="line">    sale,</span><br><span class="line">    <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span></span><br><span class="line">                     fiscal_year</span><br><span class="line">                 <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">                     sale <span class="keyword">DESC</span></span><br><span class="line">                ) sales_rank</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    sales;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> sales_employee <span class="operator">|</span> fiscal_year <span class="operator">|</span> sale   <span class="operator">|</span> sales_rank <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2016</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">150.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2017</span> <span class="operator">|</span> <span class="number">100.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> John           <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">250.00</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Alice          <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Bob            <span class="operator">|</span>        <span class="number">2018</span> <span class="operator">|</span> <span class="number">200.00</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------------+--------+------------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li>é¦–å…ˆï¼Œ<code>PARTITION BY</code>å­å¥ä½¿ç”¨ä¼šè®¡å¹´åº¦å°†ç»“æœé›†åˆ’åˆ†ä¸ºåˆ†åŒºã€‚</li>
<li>å…¶æ¬¡ï¼Œ<code>ORDER BY</code>æ¡æ¬¾æŒ‰é”€å”®é¢çš„é™åºæŒ‡å®šäº†é”€å”®å‘˜å·¥çš„é¡ºåºã€‚</li>
<li>ç¬¬ä¸‰ï¼Œ<code>DENSE_RANK()</code>å‡½æ•°åº”ç”¨äºå…·æœ‰<code>ORDER BY</code>å­å¥æŒ‡å®šçš„è¡Œé¡ºåºçš„æ¯ä¸ªåˆ†åŒºã€‚</li>
</ul>
<p><code>rank()/dense_rank()/row_number()çš„åŒºåˆ«ï¼š</code></p>
<ul>
<li>rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¸å˜ï¼Œå³ä¼šå‡ºç°1ã€1ã€3è¿™æ ·çš„æ’åºç»“æœï¼›</li>
<li>dense_rank()æ’åºç›¸åŒæ—¶ä¼šé‡å¤ï¼Œæ€»æ•°ä¼šå‡å°‘ï¼Œå³ä¼šå‡ºç°1ã€1ã€2è¿™æ ·çš„æ’åºç»“æœï¼›</li>
<li>row_number()æ’åºç›¸åŒæ—¶ä¸ä¼šé‡å¤ï¼Œä¼šæ ¹æ®é¡ºåºæ’åºã€‚<h4 id="ğŸ™ƒsource-3"><a href="#ğŸ™ƒsource-3" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://www.lintcode.com/learn/132/668">source</a><br><a target="_blank" rel="noopener" href="https://www.begtut.com/mysql/mysql-dense_rank-function.html">DENSE_RANK</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44690947/article/details/109133592">max()ä¸group by()</a></li>
</ul>
<h2 id="ä¿®å¤è¡¨ä¸­çš„åå­—"><a href="#ä¿®å¤è¡¨ä¸­çš„åå­—" class="headerlink" title="ä¿®å¤è¡¨ä¸­çš„åå­—"></a>ä¿®å¤è¡¨ä¸­çš„åå­—</h2><p>2022-04-24</p>
<h4 id="ğŸ™ˆIntroduction-4"><a href="#ğŸ™ˆIntroduction-4" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> user_id        <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name           <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">user_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«ç”¨æˆ·çš„ ID å’Œåå­—ã€‚åå­—ä»…ç”±å°å†™å’Œå¤§å†™å­—ç¬¦ç»„æˆã€‚</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥ä¿®å¤åå­—ï¼Œä½¿å¾—åªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¤§å†™çš„ï¼Œå…¶ä½™éƒ½æ˜¯å°å†™çš„ã€‚</p>
<p>è¿”å›æŒ‰ <code>user_id</code> æ’åºçš„ç»“æœè¡¨ã€‚</p>
<h4 id="ğŸ¤”code-4"><a href="#ğŸ¤”code-4" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â user_id,concat(<span class="built_in">upper</span>(<span class="keyword">left</span>(name,<span class="number">1</span>)),<span class="built_in">lower</span>(substr(name,<span class="number">2</span>)))Â name</span><br><span class="line"><span class="keyword">from</span>Â Users</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â user_id;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-4"><a href="#ğŸ’ªget-4" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>å­—ç¬¦ä¸²å¤„ç†å‡½æ•°<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;My&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;QL&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;MySQL&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;foobarbar&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;fooba&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;QUADRATICALLY&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;quadratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;Quadratically&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--&#x27;ratically&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;Hej&#x27;</span>)</span><br><span class="line"><span class="comment">--&#x27;HEJ&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="ğŸ™ƒsource-4"><a href="#ğŸ™ƒsource-4" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/fix-names-in-a-table/">source</a><h2 id="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"><a href="#æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…" class="headerlink" title="æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…"></a>æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</h2>2022-04-24</li>
</ul>
<h4 id="ğŸ™ˆIntroduction-5"><a href="#ğŸ™ˆIntroduction-5" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> patient_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> patient_name <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> conditions   <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line">patient_id ï¼ˆæ‚£è€… IDï¼‰æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line"><span class="string">&#x27;conditions&#x27;</span> ï¼ˆç–¾ç—…ï¼‰åŒ…å« <span class="number">0</span> ä¸ªæˆ–ä»¥ä¸Šçš„ç–¾ç—…ä»£ç ï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚</span><br><span class="line">è¿™ä¸ªè¡¨åŒ…å«åŒ»é™¢ä¸­æ‚£è€…çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure>
<p>å†™ä¸€æ¡ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ‚£æœ‰ I ç±»ç³–å°¿ç—…çš„æ‚£è€… ID ï¼ˆpatient_idï¼‰ã€æ‚£è€…å§“åï¼ˆpatient_nameï¼‰ä»¥åŠå…¶æ‚£æœ‰çš„æ‰€æœ‰ç–¾ç—…ä»£ç ï¼ˆconditionsï¼‰ã€‚I ç±»ç³–å°¿ç—…çš„ä»£ç æ€»æ˜¯åŒ…å«å‰ç¼€ DIAB1 ã€‚</p>
<p>æŒ‰ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p>
<h4 id="ğŸ¤”code-5"><a href="#ğŸ¤”code-5" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â patient_id,patient_name,conditions</span><br><span class="line"><span class="keyword">from</span>Â Patients</span><br><span class="line"><span class="keyword">where</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;DIAB1%&#x27;</span>Â <span class="keyword">or</span>Â conditionsÂ <span class="keyword">like</span>Â <span class="string">&#x27;%Â DIAB1%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-5"><a href="#ğŸ’ªget-5" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>å¤šæ¡ä»¶[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨LIKEæ¨¡ç³ŠæŸ¥è¯¢|like]]:<code>where conditions like &#39;condition1&#39; or/and conditions like &#39;condition2&#39;</code></li>
<li><code>%</code>åŒ¹é…ï¼š<code>%con</code>ä»¥conå¼€å¤´ï¼Œ<code>% con</code>ä»¥ conå¼€å¤´<h4 id="ğŸ™ƒsource-5"><a href="#ğŸ™ƒsource-5" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/patients-with-a-condition/">source</a><h2 id="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"><a href="#æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“" class="headerlink" title="æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“"></a>æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</h2>2022-04-24</li>
</ul>
<h4 id="ğŸ™ˆIntroduction-6"><a href="#ğŸ™ˆIntroduction-6" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> åˆ—å         <span class="operator">|</span> ç±»å‹    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> sell_date   <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product     <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">æ­¤è¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚</span><br><span class="line">æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«äº§å“åç§°å’Œåœ¨å¸‚åœºä¸Šé”€å”®çš„æ—¥æœŸã€‚</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥æŸ¥æ‰¾æ¯ä¸ªæ—¥æœŸã€é”€å”®çš„ä¸åŒäº§å“çš„æ•°é‡åŠå…¶åç§°ã€‚<br>æ¯ä¸ªæ—¥æœŸçš„é”€å”®äº§å“åç§°åº”æŒ‰è¯å…¸åºæ’åˆ—ã€‚<br>è¿”å›æŒ‰ sell_date æ’åºçš„ç»“æœè¡¨ã€‚<br>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>
<h4 id="ğŸ¤”code-6"><a href="#ğŸ¤”code-6" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â sell_date,<span class="built_in">count</span>(<span class="keyword">distinct</span>Â product)Â num_sold,group_concat(<span class="keyword">distinct</span>Â product)Â products</span><br><span class="line"><span class="keyword">from</span>Â Activities</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â sell_date</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â sell_dateÂ <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-6"><a href="#ğŸ’ªget-6" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>[[å‡½æ•°#ä½¿ç”¨ COUNT å‡½æ•°è®¡æ•°|count()]]èšåˆå‡½æ•°æ­é…<code>group</code>ä½¿ç”¨ï¼Œå®ç°åˆ†ç»„è®¡æ•°ã€‚</li>
<li><code>group_concat</code>å¯¹åˆ†ç»„å†…å®¹è¿›è¡Œæ‹¼æ¥ï¼Œè‹¥ä¸æ‹¼æ¥ç›´æ¥è¾“å‡ºä¸ºç¬¬ä¸€ä¸ªå€¼ã€‚<br>concatå’Œgroup_concatçš„åŒºåˆ«ï¼š</li>
</ul>
<ol>
<li>concatæ˜¯é’ˆå¯¹ä»¥è¡Œæ•°æ®åšçš„æ‹¼æ¥ï¼Œè€Œgroup_concatæ˜¯é’ˆå¯¹åˆ—åšçš„æ•°æ®æ‹¼æ¥ï¼Œä¸”group_concatè‡ªåŠ¨ç”Ÿæˆé€—å·ã€‚<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--concat</span></span><br><span class="line"><span class="keyword">select</span> concat(id, &quot;,&quot;, classId) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="comment">--group_concat</span></span><br><span class="line"><span class="comment">--ä¸€èˆ¬ä¸group byç»“åˆä½¿ç”¨</span></span><br><span class="line"><span class="keyword">select</span> group_concat(username) <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">group</span> <span class="keyword">by</span> classId;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ™ƒsource-6"><a href="#ğŸ™ƒsource-6" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/group-sold-products-by-the-date/">source</a><h2 id="å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››"><a href="#å¼ ä¸‰çš„-MySQL-å­¦ä¹ ä¹‹è·¯ï¼ˆå››" class="headerlink" title="å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››"></a>å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››</h2>2022-04-24</li>
</ol>
<h4 id="ğŸ™ˆIntroduction-7"><a href="#ğŸ™ˆIntroduction-7" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br>â€œä»Šæ™šçš„æœˆè‰²çœŸç¾å•Š~ â€ï¼Œå¼ ä¸‰ä¸€ä¸ªäººåœ¨èµæœˆï¼Œè¿™ç¾å¦™çš„æ—¶åˆ»ä¹Ÿåªæœ‰åœ¨å­¦ä¹ ç»“æŸåæ‰èƒ½æ„Ÿå—åˆ°ï¼Œä»Šå¤©å¼ ä¸‰åˆšå¼€å§‹å­¦å­˜å‚¨è¿‡ç¨‹ï¼Œä»–å‘ç°è¿™æ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿å•Šï¼Œå­¦å®Œä¹‹åå†èµä¸ªæœˆçœŸæ˜¯ç¾æ»‹æ»‹ã€‚è¿™æ—¶å€™ï¼ŒæŸæ•™å¸ˆç»™ä»–æ‰“äº†ä¸€ä¸ªç”µè¯ï¼Œç›´æ¥å°±æ¯äº†ä»–è¿™ä¸ªç¾å¦™çš„å¤œæ™šã€‚æŸæ•™å¸ˆè¯´å¸®ä»–æ•´ä¸ªæ´»ï¼Œç³»é‡Œç°åœ¨å‡†å¤‡å¹´è½»åŒ–ã€æ´»åŠ›åŒ–æ•™å¸ˆå›¢é˜Ÿï¼Œ<strong>ä¸Šå¤šé—¨è¯¾ï¼ˆè‡³å°‘ 2 é—¨è¯¾ï¼‰çš„æ•™å¸ˆå°±æ˜¯æ´»è·ƒæ•™å¸ˆ</strong>ï¼Œä½†æ˜¯ç°åœ¨æ•™å¸ˆä¸­æœ‰äº›å¹´è½»äººå•Šå–œæ¬¢å·æ‡’ï¼Œåªä¸Š 1 é—¨è¯¾æˆ–æ˜¯ä¸ä¸Šè¯¾ï¼Œäºæ˜¯è¦<strong>å°†æ´»è·ƒæ•™å¸ˆä¸­å¹´é¾„æœ€å¤§çš„æ•™å¸ˆæ‰€æ•™æˆçš„è¯¾ç¨‹å…¨éƒ¨äº¤ç»™ä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„æ•™å¸ˆï¼ˆå¦‚æœå¹´é¾„ç›¸åŒå°±æŒ‰å§“åé¡ºåºï¼‰ï¼Œç›´åˆ°æ•´ä¸ªæ•™å¸ˆå›¢é˜Ÿæ˜¾å¾—æ›´å¹´è½»åŒ–ã€æ´»åŠ›åŒ–ï¼Œè€Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„è¦æ±‚ä¸èƒ½å¤§äºå…¨ä½“æ•™å¸ˆçš„å¹³å‡å¹´é¾„</strong>ï¼Œè€Œä¸”è¿™ä¸ªå·¥ä½œä¼šå®šæœŸåšçš„ï¼Œç”±äºä¸šåŠ¡ç¹å¿™ï¼Œç„¶åä¸¢ç»™å¼ ä¸‰ 2 å¼ è¡¨è®©å¼ ä¸‰å¸®ä»–åšï¼Œ<code>teachers</code> è¡¨è®°å½•ç€æ•™å¸ˆçš„ä¿¡æ¯ï¼Œå’Œ <code>courses</code> è¡¨è®°å½•ç€è¯¾ç¨‹ä¿¡æ¯ï¼Œå…³è” <code>id</code> ä¸º <code>teacher_id</code>ã€‚å¼ ä¸‰æœ¬ä¸æƒ³æ¥è¿™ä¸ªæ´»ï¼Œä½†æ˜¯çªç„¶çµå…‰ä¸€é—ªå°±ç­”åº”äº†ï¼Œè°ˆå¦¥æ¡ä»¶ä»¥åï¼Œå¼ ä¸‰å›å¤´å°±ç”¨å­˜å‚¨è¿‡ç¨‹ç»™ä»–å†™å‡ºæ¥äº†å¹¶ä¸”ä¸å‘Šè¯‰æŸæ•™å¸ˆã€‚æ•™å¸ˆå¬è¯´å¼ ä¸‰å¹¶ä¸æ˜¯æ‰‹åŠ¨ç»™ä»–åšçš„ï¼Œäºæ˜¯æƒ³è¦æŒ–å‡ºå¼ ä¸‰æ˜¯æ€ä¹ˆåšçš„ï¼Œé€šè¿‡æ‰“å¬åªçŸ¥é“æ˜¯ç”¨äº†å­˜å‚¨è¿‡ç¨‹ï¼Œä½œä¸ºæ•™å¸ˆï¼Œæˆ‘å½“ç„¶è¦è‡ªå·±å†™äº†ï¼Œæ€ä¹ˆèƒ½è®©å¼ ä¸‰é‚£å°å­æ‹¿å¥½å¤„ï¼Ÿå°ä¼™å­ï¼Œå¿«æ¥å¤ç°ä¸€ä¸‹è¿™ä¸ªå­˜å‚¨è¿‡ç¨‹å§</p>
<h4 id="ğŸ¤”code-7"><a href="#ğŸ¤”code-7" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> youngTeachers ()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> oldt <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æœ€å¤§å¹´é¾„æ•™å¸ˆ</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> tid <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--ä¸æ´»è·ƒä¸”æœ€å¹´è½»</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> actnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--æ´»è·ƒçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â <span class="keyword">declare</span> notactnum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;<span class="comment">--å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â loop1:loop</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ´»è·ƒæ•™å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> actnum <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰€æœ‰è€å¸ˆçš„å¹³å‡å¹´é¾„</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">into</span> notactnum <span class="keyword">from</span> teachers;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--åˆ¤æ–­å¹´é¾„æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">Â  Â  Â  Â  Â  if actnum<span class="operator">&lt;=</span>notactnum <span class="keyword">then</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â leave loop1;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">end</span> if;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºå¹´é¾„æœ€å¤§çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> oldt <span class="keyword">from</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&gt;</span><span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> t.age <span class="keyword">desc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ‰¾å‡ºä¸æ´»è·ƒæ•™å¸ˆä¸­æœ€å¹´è½»çš„è€å¸ˆ</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">select</span> t.id <span class="keyword">into</span> tid</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">from</span> teachers t</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> teacher_id,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> num <span class="keyword">from</span> courses <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) <span class="keyword">as</span> c</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">on</span> t.id<span class="operator">=</span>c.teacher_id</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">where</span> c.num<span class="operator">&lt;=</span><span class="number">1</span> <span class="keyword">or</span> c.num <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>,t.name <span class="keyword">asc</span></span><br><span class="line">Â  Â  Â  Â  Â  limit <span class="number">1</span>;</span><br><span class="line">Â  Â  Â  Â  Â  <span class="comment">--æ›´æ–°æ•°æ®</span></span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">update</span> courses</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">set</span> teacher_id<span class="operator">=</span>tid <span class="keyword">where</span> teacher_id<span class="operator">=</span>oldt;</span><br><span class="line">Â  Â  Â <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> youngTeachers();</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-7"><a href="#ğŸ’ªget-7" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>[[å­˜å‚¨è¿‡ç¨‹]]</li>
<li>sqlå¾ªç¯è¿‡ç¨‹![[å­˜å‚¨è¿‡ç¨‹#å¾ªç¯è¯­å¥]]</li>
</ul>
<h4 id="ğŸ™ƒsource-7"><a href="#ğŸ™ƒsource-7" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://www.lintcode.com/problem/2800/description">source</a></p>
<h2 id="ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜"><a href="#ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜" class="headerlink" title="ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜"></a>ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜</h2><p>2022-04-25</p>
<h4 id="ğŸ™ˆIntroduction-8"><a href="#ğŸ™ˆIntroduction-8" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨: <code>Employees</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> employee_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name        <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ¯ä¸€è¡Œè¡¨ç¤ºé›‡å‘˜çš„id å’Œä»–çš„å§“åã€‚</span><br></pre></td></tr></table></figure><br>è¡¨: <code>Salaries</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> employee_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">employee_id <span class="keyword">is</span> è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ¯ä¸€è¡Œè¡¨ç¤ºé›‡å‘˜çš„id å’Œä»–çš„è–ªæ°´ã€‚</span><br></pre></td></tr></table></figure></p>
<p>å†™å‡ºä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œæ‰¾åˆ°æ‰€æœ‰ ä¸¢å¤±ä¿¡æ¯ çš„é›‡å‘˜idã€‚å½“æ»¡è¶³ä¸‹é¢ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œå°±è¢«è®¤ä¸ºæ˜¯é›‡å‘˜çš„ä¿¡æ¯ä¸¢å¤±ï¼š</p>
<pre><code>é›‡å‘˜çš„ å§“å ä¸¢å¤±äº†ï¼Œæˆ–è€…
é›‡å‘˜çš„ è–ªæ°´ä¿¡æ¯ ä¸¢å¤±äº†ï¼Œæˆ–è€…
</code></pre><p>è¿”å›è¿™äº›é›‡å‘˜çš„id  employee_id ï¼Œ ä»å°åˆ°å¤§æ’åº ã€‚</p>
<h4 id="ğŸ¤”code-8"><a href="#ğŸ¤”code-8" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â ee.employee_idÂ <span class="keyword">from</span>(</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â e.employee_idÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">from</span>Â EmployeesÂ eÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â SalariesÂ sÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">on</span>Â e.employee_id<span class="operator">=</span>s.employee_id</span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â s.employee_idÂ </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">from</span>Â EmployeesÂ eÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">right</span>Â <span class="keyword">join</span>Â SalariesÂ sÂ </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">on</span>Â e.employee_id<span class="operator">=</span>s.employee_id</span><br><span class="line"></span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">where</span>Â ee.employee_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>(<span class="keyword">select</span>Â employee_idÂ <span class="keyword">from</span>Â Employees)Â <span class="keyword">or</span>Â ee.employee_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (<span class="keyword">select</span>Â employee_idÂ <span class="keyword">from</span>Â Salaries)Â </span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â ee.employee_id;</span><br><span class="line"><span class="comment">------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> employee_id <span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> employee_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> employee_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> employee_id <span class="keyword">from</span> employees)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> employee_id</span><br><span class="line"></span><br><span class="line"><span class="comment">--second version</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    employee_id </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    (</span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> employees</span><br><span class="line">    <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">    employee_id</span><br><span class="line"><span class="keyword">having</span> </span><br><span class="line">    <span class="built_in">count</span>(employee_id) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">    employee_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tmp <span class="keyword">as</span>(</span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> employees </span><br><span class="line">    <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> employee_id <span class="keyword">from</span> salaries</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">employee_id</span><br><span class="line"><span class="keyword">from</span> tmp t <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">having</span> <span class="built_in">count</span>(<span class="number">1</span>)<span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-8"><a href="#ğŸ’ªget-8" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li><code>unionå’Œunion all</code>:<blockquote>
<p><strong>Union:å¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œä¸åŒ…æ‹¬é‡å¤è¡Œï¼ŒåŒæ—¶è¿›è¡Œé»˜è®¤è§„åˆ™çš„æ’åºï¼›</strong><br> UNIONåœ¨è¿›è¡Œè¡¨é“¾æ¥åä¼š<code>ç­›é€‰æ‰é‡å¤çš„è®°å½•</code>ï¼Œæ‰€ä»¥åœ¨è¡¨é“¾æ¥åä¼šå¯¹æ‰€äº§ç”Ÿçš„ç»“æœé›†è¿›è¡Œæ’åºè¿ç®—ï¼Œåˆ é™¤é‡å¤çš„è®°å½•å†è¿”å›ç»“æœã€‚<br> <strong>Union Allï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œ<code>åŒ…æ‹¬é‡å¤è¡Œï¼Œä¸è¿›è¡Œæ’åº</code>ï¼›</strong></p>
</blockquote>
</li>
<li>[[è”ç»“#å¤–è¿æ¥ OUTER JOIN|å…¨å¤–è¿æ¥]]ï¼š<code>a left join b union a right join b on â€¦â€¦</code>ã€‚å·¦ä¾§ä¸ºaè¡¨ï¼Œå³ä¾§ä¸ºbè¡¨ï¼Œbä¸­æœ‰aä¸­æ²¡æœ‰çš„å¡«å……nullã€‚<h4 id="ğŸ™ƒsource-8"><a href="#ğŸ™ƒsource-8" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a href="">source</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010931123/article/details/82425580">union/union all</a><h2 id="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"><a href="#æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼" class="headerlink" title="æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼"></a>æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</h2>2022-04-25</li>
</ul>
<h4 id="ğŸ™ˆIntroduction-9"><a href="#ğŸ™ˆIntroduction-9" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Products</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> product_id  <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store1      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store2      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> store3      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">è¿™å¼ è¡¨çš„ä¸»é”®æ˜¯product_idï¼ˆäº§å“Idï¼‰ã€‚</span><br><span class="line">æ¯è¡Œå­˜å‚¨äº†è¿™ä¸€äº§å“åœ¨ä¸åŒå•†åº—store1, store2, store3çš„ä»·æ ¼ã€‚</span><br><span class="line">å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™å€¼å°†ä¸º<span class="keyword">null</span>ã€‚</span><br></pre></td></tr></table></figure><br>è¯·ä½ é‡æ„ Products è¡¨ï¼ŒæŸ¥è¯¢æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼ï¼Œä½¿å¾—è¾“å‡ºçš„æ ¼å¼å˜ä¸º(product_id, store, price) ã€‚å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™ä¸è¾“å‡ºè¿™ä¸€è¡Œã€‚</p>
<p>è¾“å‡ºç»“æœè¡¨ä¸­çš„ é¡ºåºä¸ä½œè¦æ±‚ ã€‚</p>
<h4 id="ğŸ¤”code-9"><a href="#ğŸ¤”code-9" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â product_id,store,priceÂ <span class="keyword">from</span>(</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store1&#x27;</span>Â store,store1Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store1 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store2&#x27;</span>Â store,store2Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store2 is not null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span>Â <span class="keyword">all</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â product_id,<span class="string">&#x27;store3&#x27;</span>Â store,store3Â priceÂ <span class="keyword">from</span>Â Products</span><br><span class="line">Â Â Â Â <span class="comment">--where store3 is not null</span></span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">where</span>Â priceÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-9"><a href="#ğŸ’ªget-9" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>è®¾ç½®å¸¸é‡åˆ—<code>select &#39;a&#39; coloum</code></li>
<li>è¡Œè½¬åˆ—å¸¸ç”¨<code>case when</code>å’Œ<code>union all</code><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://pic.leetcode-cn.com/1627441221-KvsJUP-%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87.png" alt="object"></li>
</ul>
<p><strong>è¡Œè½¬åˆ—â€”â€”MAX/SUM+CASE WHEN+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è¯­æ–‡&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;æ•°å­¦&quot;,</span><br><span class="line">  <span class="built_in">MAX</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> subject<span class="operator">=</span><span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">THEN</span> score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> &quot;è‹±è¯­&quot;</span><br><span class="line"><span class="keyword">FROM</span> student1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name</span><br></pre></td></tr></table></figure></p>
<p><strong>åˆ—è½¬è¡Œâ€”â€”MAX+UNION+GROUP BY</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è¯­æ–‡&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è¯­æ–‡&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;æ•°å­¦&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;æ•°å­¦&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,<span class="string">&#x27;è‹±è¯­&#x27;</span> <span class="keyword">AS</span> subject,<span class="built_in">MAX</span>(&quot;è‹±è¯­&quot;) <span class="keyword">AS</span> score</span><br><span class="line"><span class="keyword">FROM</span> student2 <span class="keyword">GROUP</span> <span class="keyword">BY</span> NAME</span><br></pre></td></tr></table></figure></p>
<h4 id="ğŸ™ƒsource-9"><a href="#ğŸ™ƒsource-9" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p>
<h2 id="æ ‘èŠ‚ç‚¹"><a href="#æ ‘èŠ‚ç‚¹" class="headerlink" title="æ ‘èŠ‚ç‚¹"></a>æ ‘èŠ‚ç‚¹</h2><p>2022-04-25</p>
<h4 id="ğŸ™ˆIntroduction-10"><a href="#ğŸ™ˆIntroduction-10" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>ç»™å®šä¸€ä¸ªè¡¨ <code>tree</code>ï¼Œ<strong>id</strong> æ˜¯æ ‘èŠ‚ç‚¹çš„ç¼–å·ï¼Œ <strong>p_id</strong> æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„ <strong>id ã€‚</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> p_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> <span class="keyword">null</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure><br>æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å±äºä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š</p>
<pre><code>å¶å­ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä»»ä½•å­©å­èŠ‚ç‚¹ã€‚
æ ¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯æ•´æ£µæ ‘çš„æ ¹ï¼Œå³æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚
å†…éƒ¨èŠ‚ç‚¹ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ—¢ä¸æ˜¯å¶å­èŠ‚ç‚¹ä¹Ÿä¸æ˜¯æ ¹èŠ‚ç‚¹ã€‚
</code></pre><p>å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œè¾“å‡ºæ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·å’ŒèŠ‚ç‚¹çš„ç±»å‹ï¼Œå¹¶å°†ç»“æœæŒ‰ç…§èŠ‚ç‚¹ç¼–å·æ’åºã€‚ä¸Šé¢æ ·ä¾‹çš„ç»“æœä¸ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> Root <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="keyword">Inner</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> Leaf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br></pre></td></tr></table></figure></p>
<h4 id="ğŸ¤”code-10"><a href="#ğŸ¤”code-10" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â id,TypeÂ <span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Root&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Inner&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>Â <span class="keyword">and</span>Â p_id<span class="operator">!=</span>(<span class="keyword">select</span>Â idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span>))</span><br><span class="line">Â Â Â Â <span class="keyword">union</span></span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â id,<span class="string">&#x27;Leaf&#x27;</span>Â typeÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (<span class="keyword">select</span>Â p_idÂ <span class="keyword">from</span>Â treeÂ <span class="keyword">where</span>Â p_idÂ <span class="keyword">is</span>Â <span class="keyword">not</span>Â <span class="keyword">null</span>)</span><br><span class="line">)Â ee</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â id;</span><br><span class="line"><span class="comment">--answer</span></span><br><span class="line"># æ ¹ç»“ç‚¹: æ²¡æœ‰çˆ¶èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Root&#x27;</span> <span class="keyword">AS</span> TYPE </span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># ä¸­é—´èŠ‚ç‚¹: æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"># å¶å­ç»“ç‚¹: ä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ å¹¶ä¸” ä¸æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="line"># æ³¨æ„:è¿™é‡Œè¿˜éœ€é™åˆ¶â€œä¸æ˜¯æ ¹èŠ‚ç‚¹â€ æ˜¯å› ä¸ºå½“æ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ æ ¹èŠ‚ç‚¹ä¹Ÿä¸æ‹…ä»»çˆ¶èŠ‚ç‚¹ </span><br><span class="line"># æ³¨æ„:ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)é‡Œé¢è¦é™åˆ¶P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"># å¦åˆ™<span class="keyword">SELECT</span>å‡ºæ¥çš„ç»“æœé‡Œé¢æœ‰<span class="keyword">NULL</span> è¿™å¥è¯è¿”å›ç©ºåˆ—è¡¨ (æˆ‘ä¹Ÿä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆ)</span><br><span class="line"><span class="keyword">SELECT</span> ID, <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">AS</span> TYPE</span><br><span class="line"><span class="keyword">FROM</span> TREE <span class="keyword">AS</span> T </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> P_ID <span class="keyword">FROM</span> TREE <span class="keyword">WHERE</span> P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">(P_ID <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	id,</span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> p_id <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;Root&#x27;</span></span><br><span class="line">	 <span class="keyword">WHEN</span> id <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> p_id <span class="keyword">from</span> tree) <span class="keyword">then</span> <span class="string">&#x27;Inner&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;Leaf&#x27;</span> <span class="keyword">end</span> <span class="keyword">as</span> type</span><br><span class="line"><span class="keyword">from</span> tree;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-10"><a href="#ğŸ’ªget-10" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource-10"><a href="#ğŸ™ƒsource-10" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a href="">source</a></p>
<h2 id="ç¬¬äºŒé«˜çš„è–ªæ°´"><a href="#ç¬¬äºŒé«˜çš„è–ªæ°´" class="headerlink" title="ç¬¬äºŒé«˜çš„è–ªæ°´"></a>ç¬¬äºŒé«˜çš„è–ªæ°´</h2><p>2022-04-25</p>
<h4 id="ğŸ™ˆIntroduction-11"><a href="#ğŸ™ˆIntroduction-11" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p><code>Employee</code> è¡¨ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> id          <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary      <span class="operator">|</span> <span class="type">int</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line">id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å‘˜å·¥çš„å·¥èµ„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å–å¹¶è¿”å› <code>Employee</code> è¡¨ä¸­ç¬¬äºŒé«˜çš„è–ªæ°´ ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ŒæŸ¥è¯¢åº”è¯¥è¿”å› <code>null</code> ã€‚</p>
<h4 id="ğŸ¤”code-11"><a href="#ğŸ¤”code-11" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">SELECT</span>Â <span class="built_in">max</span>(Salary)Â SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span>Â EmployeeÂ Â </span><br><span class="line"><span class="keyword">where</span>Â SalaryÂ <span class="operator">!=</span>Â (<span class="keyword">select</span>Â <span class="built_in">max</span>(Salary)Â <span class="keyword">from</span>Â EmployeeÂ );</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="comment">--ä½¿ç”¨selectè¾“å‡ºï¼Œå¦åˆ™å½“ä¸å­˜åœ¨ç¬¬äºŒé«˜æ—¶å€™è¾“å‡ºä¸ºç©ºè€Œä¸æ˜¯null</span></span><br><span class="line"><span class="keyword">SELECT</span> (</span><br><span class="line">       <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">       <span class="keyword">FROM</span> Employee</span><br><span class="line">       <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">       LIMIT <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">) SecondHighestSalary;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-11"><a href="#ğŸ’ªget-11" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li><code>limit m,n</code>ï¼šmä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè¦å–çš„æ•°æ®æ•°é‡ã€‚</li>
<li><code>limit m</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡</li>
<li><code>limit m offset n</code>ï¼šmä¸ºè¦å–çš„æ•°æ®æ•°é‡ï¼Œnä¸ºè·³è¿‡çš„æ•°æ®æ•°é‡<br>[[sqlæ¡ä»¶è¿ç®—#ä½¿ç”¨ LIMIT é™åˆ¶è¾“å‡ºè¡Œæ•°|limitåŸºç¡€]]<h4 id="ğŸ™ƒsource-11"><a href="#ğŸ™ƒsource-11" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/second-highest-salary/">source</a></li>
</ul>
<h2 id="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"><a href="#å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰" class="headerlink" title="å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰"></a>å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰</h2><p>2022-04-23</p>
<h4 id="ğŸ™ˆIntroduction-12"><a href="#ğŸ™ˆIntroduction-12" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°</p>
<p>å¼ ä¸‰åœ¨å®¿èˆé‡Œæ‰“æ¸¸æˆï¼Œä»Šå¤©è¿æ°”ä¸å¤ªå¥½ï¼Œæ€»æ˜¯è¢«åŒ¹é…çš„é˜Ÿå‹å‘ï¼Œæ°”å¾—å¼ ä¸‰ç›´æ¥å°±æŠŠæ¸¸æˆç»™å¸è½½äº†ã€‚æ²¡å¿ƒæƒ…å»åƒé¥­çš„å¼ ä¸‰æ‰“å¼€ QQï¼Œå‘ç°æœ‰ 999+ çš„ä¿¡æ¯ï¼ŒåŸæ¥æ˜¯å­¦æ ¡çš„è€å¸ˆç»™ä»–å‘æ¥çš„æ¶ˆæ¯ï¼Œæƒ³è¦ä»–å¸®å¿™åˆ›å»ºä¸€ä¸ª SQL è§†å›¾ <code>v_best_teachers</code>ï¼Œè¦ä»–èµ¶ç´§å†™å¥½å‘è¿‡å»ã€‚å¼ ä¸‰çœ‹äº†çœ‹éœ€æ±‚ï¼Œè¾¹çœ‹è¦æ±‚è¾¹å†™ SQLï¼Œç»“æœå‘ç°â€¦ä¸å¯¹ï¼<strong>å­¦æ ¡çš„è¦æ±‚æ˜¯æŸ¥å‡ºæ¯ä¸ªå›½å®¶æœ€å—æ¬¢è¿çš„è€å¸ˆä¿¡æ¯ï¼ˆå¬è¯¾å­¦ç”Ÿæ•°è¶Šå¤šè¶Šå—æ¬¢è¿ï¼‰ï¼Œå¹¶æŒ‰å›½ç±å‡åºæ’åº</strong>ã€‚ç°åœ¨å¼ ä¸‰åœ¨çŸ¥è¯†åˆ†äº«è¿‡ç¨‹ä¸­ï¼Œæ‹¿è¿™é“é¢˜æ¥è€ƒä½ ï¼Œå¹¶å˜²è®½ä½ ä¸èƒ½åšå‡ºæ¥â€¦â€¦å°ä¼™å­ï¼Œæ‰“è„¸å¼ ä¸‰çš„æ—¶å€™åˆ°äº†ï¼Œè¿˜åœ¨ç­‰ä»€ä¹ˆ ï¼Ÿå†²</p>
<h4 id="ğŸ¤”code-12"><a href="#ğŸ¤”code-12" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> teacher_id, student_count, country, email</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">    <span class="keyword">from</span> courses c </span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">    <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) a</span><br><span class="line"><span class="keyword">where</span> (student_count, country) <span class="keyword">in</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">max</span>(student_count), country</span><br><span class="line">    <span class="keyword">from</span>(</span><br><span class="line">        <span class="keyword">select</span> teacher_id, <span class="built_in">sum</span>(student_count) student_count, country, email</span><br><span class="line">        <span class="keyword">from</span> courses c </span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> teachers t </span><br><span class="line">        <span class="keyword">on</span> c.teacher_id <span class="operator">=</span> t.id</span><br><span class="line">        <span class="keyword">group</span> <span class="keyword">by</span> teacher_id, country, email) aa</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> country)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> if <span class="keyword">exists</span> v_best_teachers;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_best_teachers  <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> teacher_id,student_count,country,email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> id <span class="keyword">as</span> teacher_id,<span class="built_in">max</span>(student_count) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country ) <span class="keyword">as</span> student_count_1,country,email</span><br><span class="line">    ,student_count</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> a.id, email,country,<span class="built_in">sum</span>(student_count)</span><br><span class="line">        <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a.id,country) <span class="keyword">as</span> student_count</span><br><span class="line">        <span class="keyword">from</span> teachers a</span><br><span class="line">        <span class="keyword">inner</span> <span class="keyword">join</span> courses b </span><br><span class="line">        <span class="keyword">on</span> a.id <span class="operator">=</span> b.teacher_id </span><br><span class="line">        ) t </span><br><span class="line">    ) tt </span><br><span class="line"><span class="keyword">where</span> tt.student_count_1 <span class="operator">=</span>tt.student_count</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_best_teachers <span class="keyword">as</span>(</span><br><span class="line"><span class="keyword">select</span> ct.teacher_id <span class="keyword">as</span> teacher_id,</span><br><span class="line">ct.s_student_count <span class="keyword">as</span> student_count,</span><br><span class="line">ct.country <span class="keyword">as</span> country,</span><br><span class="line">ct.email <span class="keyword">as</span> email</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> c.teacher_id,c.s_student_count,t.country,t.email,</span><br><span class="line"><span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> country <span class="keyword">order</span> <span class="keyword">by</span> s_student_count <span class="keyword">desc</span>) <span class="keyword">as</span> orde</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> teacher_id,<span class="built_in">sum</span>(student_count) <span class="keyword">as</span> s_student_count <span class="keyword">from</span> courses</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> teacher_id</span><br><span class="line">) <span class="keyword">as</span> c</span><br><span class="line"><span class="keyword">join</span> teachers t </span><br><span class="line"><span class="keyword">on</span> c.teacher_id<span class="operator">=</span>t.id) <span class="keyword">as</span> ct</span><br><span class="line"><span class="keyword">where</span> ct.orde<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-12"><a href="#ğŸ’ªget-12" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>æ³¨æ„<code>join</code>ä¸­æ•°æ®çš„é‡å¤æ¬¡æ•°ï¼Œä¼šé€ æˆæ•°æ®å‡ºç°é‡å¤ã€‚</li>
<li>èšåˆå‡½æ•°è¦å’Œ<code>group by</code>è”ç”¨ï¼Œmysqlè¦å»byåé¢ä¸ºå…¨selectå…³é”®è¯ï¼Œå³é™¤äº†èšåˆå‡½æ•°ã€‚</li>
</ul>
<h4 id="ğŸ™ƒsource-12"><a href="#ğŸ™ƒsource-12" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://www.lintcode.com/learn/153/683">source</a></p>
<h2 id="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II"><a href="#æŒ‚ç§‘æœ€å¤šçš„åŒå­¦-II" class="headerlink" title="æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II"></a>æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II</h2><p>2022-04-25</p>
<h4 id="ğŸ™ˆIntroduction-13"><a href="#ğŸ™ˆIntroduction-13" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>æè¿°<br><code>exams</code> è¡¨ä¸­å­˜æ”¾ç€åŒå­¦ä»¬çš„è€ƒè¯•è®°å½•<br>è¯·ç”¨ SQL è¯­å¥ï¼Œæ‰¾åˆ°æŒ‚ç§‘æ•°æœ€å¤šçš„åŒå­¦æ‰€å¯¹åº”çš„ <code>student_id</code></p>
<h4 id="ğŸ¤”code-13"><a href="#ğŸ¤”code-13" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> student_id</span><br><span class="line"><span class="keyword">FROM</span> exams</span><br><span class="line"><span class="keyword">WHERE</span> is_pass <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(bb.a)</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> (</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> a</span><br><span class="line">Â  Â  Â  Â  Â  <span class="keyword">FROM</span> exams <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span> <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) <span class="keyword">as</span> bb</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="keyword">SELECT</span> student_id <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">) t</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> num<span class="operator">=</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> <span class="built_in">max</span>(num) <span class="keyword">FROM</span>(</span><br><span class="line">Â  Â  Â <span class="keyword">SELECT</span> student_id,is_pass,<span class="built_in">count</span>(is_pass) num</span><br><span class="line">Â  Â  Â <span class="keyword">FROM</span> exams</span><br><span class="line">Â  Â  Â <span class="keyword">WHERE</span> is_pass<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Â  Â  Â <span class="keyword">group</span> <span class="keyword">by</span> student_id</span><br><span class="line">Â  Â  Â ) tt</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-13"><a href="#ğŸ’ªget-13" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>whereåä¸å¯ä»¥è·Ÿ[[å‡½æ•°#ç®—æ•°å‡½æ•°|èšåˆå‡½æ•°]]</li>
</ul>
<h4 id="ğŸ™ƒsource-13"><a href="#ğŸ™ƒsource-13" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://www.lintcode.com/problem/1933/solution/45386">source</a></p>
<h2 id="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"><a href="#è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢" class="headerlink" title="è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢"></a>è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢</h2><p>2022-04-26</p>
<h4 id="ğŸ™ˆIntroduction-14"><a href="#ğŸ™ˆIntroduction-14" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Visits</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> visit_id    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> customer_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line">visit_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨åŒ…å«æœ‰å…³å…‰ä¸´è¿‡è´­ç‰©ä¸­å¿ƒçš„é¡¾å®¢çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>è¡¨ï¼š<code>Transactions</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> transaction_id <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> visit_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> amount         <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">transaction_id æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨åŒ…å« visit_id æœŸé—´è¿›è¡Œçš„äº¤æ˜“çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>æœ‰ä¸€äº›é¡¾å®¢å¯èƒ½å…‰é¡¾äº†è´­ç‰©ä¸­å¿ƒä½†æ²¡æœ‰è¿›è¡Œäº¤æ˜“ã€‚è¯·ä½ ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾è¿™äº›é¡¾å®¢çš„ ID ï¼Œä»¥åŠä»–ä»¬åªå…‰é¡¾ä¸äº¤æ˜“çš„æ¬¡æ•°ã€‚</p>
<h4 id="ğŸ¤”code-14"><a href="#ğŸ¤”code-14" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(visit_id)Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â v.visit_id,v.customer_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â VisitsÂ v</span><br><span class="line">Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ t</span><br><span class="line">Â Â Â Â <span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â t.transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line">)Â tt</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_transÂ <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">--second version</span></span><br><span class="line"><span class="keyword">select</span>Â customer_id,<span class="built_in">count</span>(v.visit_id)Â <span class="keyword">as</span>Â count_no_trans</span><br><span class="line"><span class="keyword">from</span>Â VisitsÂ <span class="keyword">as</span>Â v</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â TransactionsÂ <span class="keyword">as</span>Â t</span><br><span class="line"><span class="keyword">on</span>Â v.visit_id<span class="operator">=</span>t.visit_id</span><br><span class="line"><span class="keyword">where</span>Â t.Transaction_idÂ <span class="keyword">is</span>Â <span class="keyword">null</span></span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â count_no_trans;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-14"><a href="#ğŸ’ªget-14" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><h4 id="ğŸ™ƒsource-14"><a href="#ğŸ™ƒsource-14" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/customer-who-visited-but-did-not-make-any-transactions/submissions/">source</a></p>
<h2 id="ä¸Šå‡æ¸©åº¦"><a href="#ä¸Šå‡æ¸©åº¦" class="headerlink" title="ä¸Šå‡æ¸©åº¦"></a>ä¸Šå‡æ¸©åº¦</h2><p>2022-04-27</p>
<h4 id="ğŸ™ˆIntroduction-15"><a href="#ğŸ™ˆIntroduction-15" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š <code>Weather</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> recordDate    <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> temperature   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®</span><br><span class="line">è¯¥è¡¨åŒ…å«ç‰¹å®šæ—¥æœŸçš„æ¸©åº¦ä¿¡æ¯</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾ä¸ä¹‹å‰ï¼ˆæ˜¨å¤©çš„ï¼‰æ—¥æœŸç›¸æ¯”æ¸©åº¦æ›´é«˜çš„æ‰€æœ‰æ—¥æœŸçš„ <code>id</code> ã€‚</p>
<h4 id="ğŸ¤”code-15"><a href="#ğŸ¤”code-15" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--first version</span></span><br><span class="line"><span class="keyword">select</span>Â w1.idÂ <span class="keyword">from</span>Â WeatherÂ w1</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â WeatherÂ w2</span><br><span class="line"><span class="keyword">on</span>Â w1.recordDate<span class="operator">=</span>date_add(w2.recordDate,<span class="type">interval</span>Â <span class="number">1</span>Â <span class="keyword">day</span>)</span><br><span class="line"><span class="keyword">where</span>Â w1.Temperature<span class="operator">&gt;</span>w2.Temperature;</span><br><span class="line"><span class="comment">--sencond version</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    b.Id </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    weather a </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> </span><br><span class="line">    weather b </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    DATEDIFF(b.recordDate,a.recordDate)<span class="operator">=</span><span class="number">1</span> </span><br><span class="line"><span class="keyword">and</span> b.Temperature <span class="operator">&gt;</span> a.Temperature;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-15"><a href="#ğŸ’ªget-15" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li><code>inner join()</code>å½“ä¸å­˜åœ¨onæ—¶ç›¸å½“äºç¬›å¡å°”ç§¯</li>
<li><code>DATEDIFF(date1,date2)</code>:è¿”å›ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°</li>
</ul>
<h4 id="ğŸ™ƒsource-15"><a href="#ğŸ™ƒsource-15" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/rising-temperature/solution/by-jam007-658v/">source</a></p>
<h2 id="è®¢å•æœ€å¤šçš„å®¢æˆ·"><a href="#è®¢å•æœ€å¤šçš„å®¢æˆ·" class="headerlink" title="è®¢å•æœ€å¤šçš„å®¢æˆ·"></a>è®¢å•æœ€å¤šçš„å®¢æˆ·</h2><p>2022-04-29</p>
<h4 id="ğŸ™ˆIntroduction-16"><a href="#ğŸ™ˆIntroduction-16" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨: <code>Orders</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name     <span class="operator">|</span> Type     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line"><span class="operator">|</span> order_number    <span class="operator">|</span> <span class="type">int</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> customer_number <span class="operator">|</span> <span class="type">int</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+----------+</span></span><br><span class="line">Order_numberæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">æ­¤è¡¨åŒ…å«å…³äºè®¢å•IDå’Œå®¢æˆ·IDçš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢ï¼Œä¸ºä¸‹äº† <strong>æœ€å¤šè®¢å•</strong> çš„å®¢æˆ·æŸ¥æ‰¾ <code>customer_number</code> ã€‚<br>æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆåï¼Œ <strong>æ°å¥½æœ‰ä¸€ä¸ªå®¢æˆ·</strong> æ¯”ä»»ä½•å…¶ä»–å®¢æˆ·ä¸‹äº†æ›´å¤šçš„è®¢å•ã€‚</p>
<h4 id="ğŸ¤”code-16"><a href="#ğŸ¤”code-16" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version 482ms</span></span><br><span class="line"><span class="keyword">select</span>Â customer_number</span><br><span class="line"><span class="keyword">from</span>Â Orders</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_number</span><br><span class="line"><span class="keyword">having</span>Â <span class="built_in">count</span>(customer_number)<span class="operator">=</span>(</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â <span class="built_in">count</span>(customer_number)Â <span class="keyword">as</span>Â countÂ </span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â OrdersÂ </span><br><span class="line">Â Â Â Â <span class="keyword">group</span>Â <span class="keyword">by</span>Â customer_numberÂ </span><br><span class="line">Â Â Â Â <span class="keyword">order</span>Â <span class="keyword">by</span>Â countÂ <span class="keyword">desc</span></span><br><span class="line">Â Â Â Â limitÂ <span class="number">1</span>);</span><br><span class="line"><span class="comment">--other version</span></span><br><span class="line"><span class="keyword">select</span> customer_number</span><br><span class="line"><span class="keyword">from</span> orders</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(order_number)<span class="operator">&gt;=</span><span class="keyword">all</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(order_number)</span><br><span class="line">    <span class="keyword">from</span> orders</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line">)</span><br><span class="line"><span class="comment">--order 479msä¸ä¸¥è°¨</span></span><br><span class="line"><span class="keyword">select</span> customer_number</span><br><span class="line"><span class="keyword">from</span> orders </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">count</span>(order_number)  <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">1</span></span><br><span class="line"><span class="comment">--rank() 503ms</span></span><br><span class="line"><span class="keyword">select</span> t.customer_number</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> customer_number, <span class="built_in">rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">count</span>(order_number) <span class="keyword">desc</span>) <span class="keyword">as</span> ranking</span><br><span class="line"><span class="keyword">from</span> orders</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> customer_number) t</span><br><span class="line"><span class="keyword">where</span> t.ranking <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-16"><a href="#ğŸ’ªget-16" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li><code>order by()</code>ï¼šå¯ç”¨èšåˆå‡½æ•°è¿›è¡Œæ’åº</li>
<li><code>ALL</code>è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªé€»è¾‘è¿ç®—ç¬¦ï¼Œå®ƒå°†å•ä¸ªå€¼ä¸å­æŸ¥è¯¢è¿”å›çš„å•åˆ—å€¼é›†è¿›è¡Œæ¯”è¾ƒã€‚SQL <code>ALL</code>è¿ç®—ç¬¦å¿…é¡»ä»¥æ¯”è¾ƒè¿ç®—ç¬¦å¼€å¤´ï¼Œä¾‹å¦‚ï¼š<code>&gt;</code>ï¼Œ<code>&gt;=</code>ï¼Œ<code>&lt;</code>ï¼Œ<code>&lt;=</code>ï¼Œ<code>&lt;&gt;</code>ï¼Œ<code>=</code>ï¼Œåè·Ÿå­æŸ¥è¯¢ã€‚ æŸäº›æ•°æ®åº“ç³»ç»Ÿ(å¦‚Oracle)å…è®¸ä½¿ç”¨æ–‡å­—å€¼åˆ—è¡¨è€Œä¸æ˜¯å­æŸ¥è¯¢ã€‚<h4 id="ğŸ™ƒsource-16"><a href="#ğŸ™ƒsource-16" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/customer-placing-the-largest-number-of-orders/">source</a><h2 id="æ’åé å‰çš„æ—…è¡Œè€…"><a href="#æ’åé å‰çš„æ—…è¡Œè€…" class="headerlink" title="æ’åé å‰çš„æ—…è¡Œè€…"></a>æ’åé å‰çš„æ—…è¡Œè€…</h2>2022-04-30</li>
</ul>
<h4 id="ğŸ™ˆIntroduction-17"><a href="#ğŸ™ˆIntroduction-17" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>è¡¨ï¼š<code>Users</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name          <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¯¥è¡¨å•ä¸»é”®ã€‚</span><br><span class="line">name æ˜¯ç”¨æˆ·åå­—ã€‚</span><br></pre></td></tr></table></figure><br>è¡¨ï¼š<code>Rides</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id            <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> user_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> distance      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">id æ˜¯è¯¥è¡¨å•ä¸»é”®ã€‚</span><br><span class="line">user_id æ˜¯æœ¬æ¬¡è¡Œç¨‹çš„ç”¨æˆ·çš„ id, è€Œè¯¥ç”¨æˆ·æ­¤æ¬¡è¡Œç¨‹è·ç¦»ä¸º distance ã€‚</span><br></pre></td></tr></table></figure><br>å†™ä¸€æ®µ SQL , æŠ¥å‘Šæ¯ä¸ªç”¨æˆ·çš„æ—…è¡Œè·ç¦»ã€‚</p>
<p>è¿”å›çš„ç»“æœè¡¨å•ï¼Œä»¥ travelled_distance é™åºæ’åˆ— ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæˆ–è€…æ›´å¤šçš„ç”¨æˆ·æ—…è¡Œäº†ç›¸åŒçš„è·ç¦», é‚£ä¹ˆå†ä»¥ name å‡åºæ’åˆ— ã€‚</p>
<h4 id="ğŸ¤”code-17"><a href="#ğŸ¤”code-17" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">select</span>Â u.name,if(<span class="built_in">sum</span>(r.distance)Â <span class="keyword">is</span>Â <span class="keyword">null</span>,Â <span class="number">0</span>,<span class="built_in">sum</span>(r.distance))Â <span class="keyword">as</span>Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â UsersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â RidesÂ r</span><br><span class="line"><span class="keyword">on</span>Â r.user_id<span class="operator">=</span>u.id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â r.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,nameÂ <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">--ifnull</span></span><br><span class="line"><span class="keyword">select</span>Â u.name,ifnull(<span class="built_in">sum</span>(r.distance),Â <span class="number">0</span>)Â <span class="keyword">as</span>Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â UsersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â RidesÂ r</span><br><span class="line"><span class="keyword">on</span>Â r.user_id<span class="operator">=</span>u.id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â r.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,nameÂ <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">--coalesce  </span></span><br><span class="line"><span class="keyword">select</span>Â </span><br><span class="line">Â Â Â Â name,Â <span class="built_in">coalesce</span>(<span class="built_in">sum</span>(distance),Â <span class="number">0</span>)Â travelled_distance</span><br><span class="line"><span class="keyword">from</span>Â </span><br><span class="line">Â Â Â Â usersÂ u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â ridesÂ rÂ <span class="keyword">on</span>Â u.id<span class="operator">=</span>r.user_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â name</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â travelled_distanceÂ <span class="keyword">desc</span>,Â name;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-17"><a href="#ğŸ’ªget-17" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li><code>ifnulll</code>:MySQL <code>IFNULL(expression_1,expression_2)</code>å‡½æ•°æ˜¯MySQLæ§åˆ¶æµå‡½æ•°ä¹‹ä¸€ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœä¸æ˜¯<code>NULL</code>ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ å¦åˆ™ï¼Œ<code>IFNULL</code>å‡½æ•°è¿”å›ç¬¬äºŒä¸ªå‚æ•°ã€‚ä¸¤ä¸ªå‚æ•°å¯ä»¥æ˜¯æ–‡å­—å€¼æˆ–è¡¨è¾¾å¼ã€‚</li>
<li><code>COALESCE</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ <code>(expression_1, expression_2, ...,expression_n)</code>ä¾æ¬¡å‚è€ƒå„å‚æ•°è¡¨è¾¾å¼ï¼Œé‡åˆ°énullå€¼å³åœæ­¢å¹¶è¿”å›è¯¥å€¼ã€‚å¦‚æœæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½æ˜¯ç©ºå€¼ï¼Œæœ€ç»ˆå°†è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚ä½¿ç”¨COALESCEåœ¨äºå¤§éƒ¨åˆ†åŒ…å«ç©ºå€¼çš„è¡¨è¾¾å¼æœ€ç»ˆå°†è¿”å›ç©ºå€¼ã€‚</li>
</ul>
<h4 id="ğŸ™ƒsource-17"><a href="#ğŸ™ƒsource-17" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><p><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/top-travellers/">source</a><br><a target="_blank" rel="noopener" href="https://www.yiibai.com/mysql/ifnull.html">ifnull</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/yilulvxing/article/details/86595725">coalesce</a></p>
<h2 id="å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰"><a href="#å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰" class="headerlink" title="å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰"></a>å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰</h2><p>2022-04-30</p>
<h4 id="ğŸ™ˆIntroduction-18"><a href="#ğŸ™ˆIntroduction-18" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>Table: <code>Users</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name    <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> user_id        <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> join_date      <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> favorite_brand <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ user_idã€‚</span><br><span class="line">è¡¨ä¸­æè¿°äº†è´­ç‰©ç½‘ç«™çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ­¤ç½‘ç«™ä¸Šè¿›è¡Œå•†å“ä¹°å–ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Orders</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> order_id      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> order_date    <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> item_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> buyer_id      <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> seller_id     <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ order_idã€‚</span><br><span class="line">å¤–é”®æ˜¯ item_id å’Œï¼ˆbuyer_idï¼Œseller_idï¼‰ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Items</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name   <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line"><span class="operator">|</span> item_id       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> item_brand    <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+---------+</span></span><br><span class="line">æ­¤è¡¨ä¸»é”®æ˜¯ item_idã€‚</span><br></pre></td></tr></table></figure><br>è¯·å†™å‡ºä¸€æ¡SQLè¯­å¥ä»¥æŸ¥è¯¢æ¯ä¸ªç”¨æˆ·çš„æ³¨å†Œæ—¥æœŸå’Œåœ¨ <strong><code>2019</code></strong> å¹´ä½œä¸ºä¹°å®¶çš„è®¢å•æ€»æ•°ã€‚<br>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>
<h4 id="ğŸ¤”code-18"><a href="#ğŸ¤”code-18" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version</span></span><br><span class="line"><span class="keyword">select</span>Â u.user_idÂ <span class="keyword">as</span>Â buyer_id,u.join_date,<span class="built_in">count</span>(ee.order_date)Â <span class="keyword">as</span>Â <span class="string">&#x27;orders_in_2019&#x27;</span></span><br><span class="line"><span class="keyword">from</span>Â UsersÂ <span class="keyword">as</span>Â u</span><br><span class="line"><span class="keyword">left</span>Â <span class="keyword">join</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â order_date,buyer_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â Orders</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â <span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="number">2019</span></span><br><span class="line">)Â <span class="keyword">as</span>Â eeÂ </span><br><span class="line"><span class="keyword">on</span>Â ee.buyer_id<span class="operator">=</span>u.user_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â u.user_id</span><br><span class="line"><span class="keyword">order</span>Â <span class="keyword">by</span>Â buyer_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å°†æ—¶é—´åˆ¤æ–­æ”¾åœ¨onä¸­é¿å…whereç›´æ¥ç­›é€‰æ‰IDä¸º3å’Œ4çš„æƒ…å†µï¼Œæ”¾åœ¨onè¿˜ä¼šä¿ç•™IDä¸º3å’Œ4çš„æƒ…å†µä¸”å€¼ä¸ºnull</span></span><br><span class="line"><span class="keyword">select</span>Â user_idÂ buyer_id,Â join_date,Â <span class="built_in">count</span>(order_id)Â orders_in_2019</span><br><span class="line"><span class="keyword">from</span>Â usersÂ <span class="keyword">left</span>Â <span class="keyword">join</span>Â orders</span><br><span class="line"><span class="keyword">on</span>Â user_idÂ <span class="operator">=</span>Â buyer_idÂ <span class="keyword">and</span>Â <span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="string">&#x27;2019&#x27;</span></span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â user_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--å…ˆç»™é2019çš„èµ‹å€¼ï¼Œä½¿ç”¨sum()è®¡ç®—</span></span><br><span class="line"><span class="keyword">select</span>Â user_idÂ buyer_id,Â join_date,</span><br><span class="line"><span class="built_in">sum</span>(if(<span class="keyword">year</span>(order_date)<span class="operator">=</span><span class="string">&#x27;2019&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>))Â orders_in_2019</span><br><span class="line"><span class="keyword">from</span>Â usersÂ <span class="keyword">left</span>Â <span class="keyword">join</span>Â orders</span><br><span class="line"><span class="keyword">on</span>Â user_idÂ <span class="operator">=</span>Â buyer_id</span><br><span class="line"><span class="keyword">group</span>Â <span class="keyword">by</span>Â user_id</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-18"><a href="#ğŸ’ªget-18" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>onåé¢å¯ä»¥æ¥ç­›é€‰æ¡ä»¶ï¼Œä¸whereåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œä»…åœ¨outer joinå­˜åœ¨åŒºåˆ«ã€‚outer joinæ­¥éª¤å¦‚ä¸‹ï¼š</li>
</ul>
<ol>
<li>å¯¹ä¸¤ä¸ªè¡¨è¿›è¡Œç¬›å¡å°”ç§¯</li>
<li>åº”ç”¨onç­›é€‰æ¡ä»¶</li>
<li><code>æ·»åŠ å¤–éƒ¨è¡Œ</code>(è¿™ä¸€æ­¥ä¼šæ·»åŠ ä¾èµ–åˆ—è¡¨åœ¨ç­›é€‰åä¸å­˜åœ¨çš„è¡Œ)</li>
<li>åº”ç”¨whereç­›é€‰å™¨<h4 id="ğŸ™ƒsource-18"><a href="#ğŸ™ƒsource-18" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/market-analysis-i/comments/">source</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42434318/article/details/112819267">onä¸whereç­›é€‰çš„åŒºåˆ«</a></li>
</ol>
<h2 id="é”€å”®åˆ†æ"><a href="#é”€å”®åˆ†æ" class="headerlink" title="é”€å”®åˆ†æ"></a>é”€å”®åˆ†æ</h2><p>2022-05-01</p>
<h4 id="ğŸ™ˆIntroduction-19"><a href="#ğŸ™ˆIntroduction-19" class="headerlink" title="ğŸ™ˆIntroduction"></a>ğŸ™ˆIntroduction</h4><p>Table: <code>Product</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line"><span class="operator">|</span> product_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product_name <span class="operator">|</span> <span class="type">varchar</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> unit_price   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+---------+</span></span><br><span class="line">Product_idæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡Œæ˜¾ç¤ºæ¯ä¸ªäº§å“çš„åç§°å’Œä»·æ ¼ã€‚</span><br></pre></td></tr></table></figure><br>Table: <code>Sales</code><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span> Name <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> seller_id   <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product_id  <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> buyer_id    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sale_date   <span class="operator">|</span> <span class="type">date</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> quantity    <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> price       <span class="operator">|</span> <span class="type">int</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------ ------+---------+</span></span><br><span class="line">è¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯ä»¥æœ‰é‡å¤çš„è¡Œã€‚</span><br><span class="line">product_id æ˜¯ Product è¡¨çš„å¤–é”®ã€‚</span><br><span class="line">è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å…³äºä¸€ä¸ªé”€å”®çš„ä¸€äº›ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><br>ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢ï¼ŒæŠ¥å‘Š<code>2019å¹´æ˜¥å­£</code>æ‰å”®å‡ºçš„äº§å“ã€‚å³<strong>ä»…</strong>åœ¨<code>**2019-01-01**</code>è‡³<code>**2019-03-31**</code>ï¼ˆå«ï¼‰ä¹‹é—´å‡ºå”®çš„å•†å“ã€‚</p>
<h4 id="ğŸ¤”code-19"><a href="#ğŸ¤”code-19" class="headerlink" title="ğŸ¤”code"></a>ğŸ¤”code</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--my version 622ms</span></span><br><span class="line"><span class="keyword">select</span>Â product_id,product_name</span><br><span class="line"><span class="keyword">from</span>Â Product</span><br><span class="line"><span class="keyword">where</span>Â product_idÂ <span class="keyword">not</span>Â <span class="keyword">in</span>Â (</span><br><span class="line">Â Â Â Â <span class="keyword">select</span>Â p.product_id</span><br><span class="line">Â Â Â Â <span class="keyword">from</span>Â ProductÂ <span class="keyword">as</span>Â p</span><br><span class="line">Â Â Â Â <span class="keyword">left</span>Â <span class="keyword">join</span>Â SalesÂ <span class="keyword">as</span>Â s</span><br><span class="line">Â Â Â Â <span class="keyword">on</span>Â p.product_id<span class="operator">=</span>s.product_id</span><br><span class="line">Â Â Â Â <span class="keyword">where</span>Â s.sale_dateÂ <span class="keyword">not</span>Â <span class="keyword">between</span>Â <span class="string">&#x27;2019-01-01&#x27;</span>Â <span class="keyword">and</span>Â <span class="string">&#x27;2019-03-31&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--sumè®¡æ•°æ’é™¤ 634ms</span></span><br><span class="line"><span class="keyword">SELECT</span>Â p.product_id,product_nameÂ <span class="keyword">FROM</span>Â salesÂ s,productÂ pÂ </span><br><span class="line"><span class="keyword">WHERE</span>Â s.product_id<span class="operator">=</span>p.product_id</span><br><span class="line"><span class="keyword">GROUP</span>Â <span class="keyword">BY</span>Â p.product_id</span><br><span class="line"><span class="keyword">HAVING</span>Â <span class="built_in">SUM</span>(sale_dateÂ <span class="operator">&lt;</span>Â <span class="string">&#x27;2019-01-01&#x27;</span>)<span class="operator">=</span><span class="number">0</span></span><br><span class="line"><span class="keyword">AND</span>Â <span class="built_in">SUM</span>(sale_date<span class="operator">&gt;</span><span class="string">&#x27;2019-03-31&#x27;</span>)<span class="operator">=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ğŸ’ªget-19"><a href="#ğŸ’ªget-19" class="headerlink" title="ğŸ’ªget"></a>ğŸ’ªget</h4><ul>
<li>é‡‡ç”¨èšåˆå‡½æ•°è¿›è¡Œè®¡æ•°ï¼Œå®ç°è¦æ±‚ï¼Œä½†æ•ˆç‡ä¸é«˜ã€‚<h4 id="ğŸ™ƒsource-19"><a href="#ğŸ™ƒsource-19" class="headerlink" title="ğŸ™ƒsource"></a>ğŸ™ƒsource</h4><a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/sales-analysis-iii/">source</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Zj_Jibo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/">http://example.com/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">zZZZ's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SQL/">SQL</a><a class="post-meta__tags" href="/tags/LeetCode/">LeetCode</a><a class="post-meta__tags" href="/tags/LintCode/">LintCode</a><a class="post-meta__tags" href="/tags/%E8%AE%B0%E5%BD%95/">è®°å½•</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/04/29/XE8p2nWdrub9SOG.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/04/29/python-%E8%A3%85%E9%A5%B0%E5%99%A8/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/9ZuPDNUYzShvdXf.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">python_è£…é¥°å™¨</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/28/xONf6RXakT8oIu1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zj_Jibo</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">16</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zjiibo"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zjjibo" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zjjibo@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">è®°å½•å­¦ä¹ è¿‡ç¨‹</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1"><span class="toc-number">1.</span> <span class="toc-text">åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction"><span class="toc-number">1.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code"><span class="toc-number">1.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget"><span class="toc-number">1.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source"><span class="toc-number">1.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E7%89%B9%E6%AE%8A%E5%A5%96%E9%87%91"><span class="toc-number">2.</span> <span class="toc-text">è®¡ç®—ç‰¹æ®Šå¥–é‡‘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-1"><span class="toc-number">2.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-1"><span class="toc-number">2.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-1"><span class="toc-number">2.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-1"><span class="toc-number">2.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-%E4%B8%80"><span class="toc-number">3.</span> <span class="toc-text">å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯(ä¸€)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-2"><span class="toc-number">3.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-2"><span class="toc-number">3.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-2"><span class="toc-number">3.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-2"><span class="toc-number">3.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-3"><span class="toc-number">4.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-3"><span class="toc-number">4.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-3"><span class="toc-number">4.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-3"><span class="toc-number">4.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%90%8D%E5%AD%97"><span class="toc-number">5.</span> <span class="toc-text">ä¿®å¤è¡¨ä¸­çš„åå­—</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-4"><span class="toc-number">5.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-4"><span class="toc-number">5.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-4"><span class="toc-number">5.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-4"><span class="toc-number">5.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%82%A3%E6%9F%90%E7%A7%8D%E7%96%BE%E7%97%85%E7%9A%84%E6%82%A3%E8%80%85"><span class="toc-number">6.</span> <span class="toc-text">æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-5"><span class="toc-number">6.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-5"><span class="toc-number">6.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-5"><span class="toc-number">6.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-5"><span class="toc-number">6.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E6%97%A5%E6%9C%9F%E5%88%86%E7%BB%84%E9%94%80%E5%94%AE%E4%BA%A7%E5%93%81"><span class="toc-number">7.</span> <span class="toc-text">æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-6"><span class="toc-number">7.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-6"><span class="toc-number">7.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-6"><span class="toc-number">7.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-6"><span class="toc-number">7.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%A0%E4%B8%89%E7%9A%84-MySQL-%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E5%9B%9B"><span class="toc-number">8.</span> <span class="toc-text">å¼ ä¸‰çš„ MySQL å­¦ä¹ ä¹‹è·¯ï¼ˆå››</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-7"><span class="toc-number">8.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-7"><span class="toc-number">8.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-7"><span class="toc-number">8.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-7"><span class="toc-number">8.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A2%E5%A4%B1%E4%BF%A1%E6%81%AF%E7%9A%84%E9%9B%87%E5%91%98"><span class="toc-number">9.</span> <span class="toc-text">ä¸¢å¤±ä¿¡æ¯çš„é›‡å‘˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-8"><span class="toc-number">9.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-8"><span class="toc-number">9.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-8"><span class="toc-number">9.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-8"><span class="toc-number">9.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%8F%E4%B8%AA%E4%BA%A7%E5%93%81%E5%9C%A8%E4%B8%8D%E5%90%8C%E5%95%86%E5%BA%97%E7%9A%84%E4%BB%B7%E6%A0%BC"><span class="toc-number">10.</span> <span class="toc-text">æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-9"><span class="toc-number">10.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-9"><span class="toc-number">10.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-9"><span class="toc-number">10.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-9"><span class="toc-number">10.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%91%E8%8A%82%E7%82%B9"><span class="toc-number">11.</span> <span class="toc-text">æ ‘èŠ‚ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-10"><span class="toc-number">11.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-10"><span class="toc-number">11.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-10"><span class="toc-number">11.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-10"><span class="toc-number">11.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4"><span class="toc-number">12.</span> <span class="toc-text">ç¬¬äºŒé«˜çš„è–ªæ°´</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-11"><span class="toc-number">12.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-11"><span class="toc-number">12.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-11"><span class="toc-number">12.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-11"><span class="toc-number">12.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%A0%E4%B8%89%E7%9A%84MySQL%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%EF%BC%88%E4%B8%89%EF%BC%89"><span class="toc-number">13.</span> <span class="toc-text">å¼ ä¸‰çš„MySQLå­¦ä¹ ä¹‹è·¯ï¼ˆä¸‰ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-12"><span class="toc-number">13.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-12"><span class="toc-number">13.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-12"><span class="toc-number">13.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-12"><span class="toc-number">13.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%82%E7%A7%91%E6%9C%80%E5%A4%9A%E7%9A%84%E5%90%8C%E5%AD%A6-II"><span class="toc-number">14.</span> <span class="toc-text">æŒ‚ç§‘æœ€å¤šçš„åŒå­¦ II</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-13"><span class="toc-number">14.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-13"><span class="toc-number">14.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-13"><span class="toc-number">14.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-13"><span class="toc-number">14.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%BA%97%E5%8D%B4%E6%9C%AA%E8%BF%9B%E8%A1%8C%E8%BF%87%E4%BA%A4%E6%98%93%E7%9A%84%E9%A1%BE%E5%AE%A2"><span class="toc-number">15.</span> <span class="toc-text">è¿›åº—å´æœªè¿›è¡Œè¿‡äº¤æ˜“çš„é¡¾å®¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-14"><span class="toc-number">15.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-14"><span class="toc-number">15.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-14"><span class="toc-number">15.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-14"><span class="toc-number">15.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E5%8D%87%E6%B8%A9%E5%BA%A6"><span class="toc-number">16.</span> <span class="toc-text">ä¸Šå‡æ¸©åº¦</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-15"><span class="toc-number">16.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-15"><span class="toc-number">16.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-15"><span class="toc-number">16.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-15"><span class="toc-number">16.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%A2%E6%88%B7"><span class="toc-number">17.</span> <span class="toc-text">è®¢å•æœ€å¤šçš„å®¢æˆ·</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-16"><span class="toc-number">17.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-16"><span class="toc-number">17.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-16"><span class="toc-number">17.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-16"><span class="toc-number">17.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%90%8D%E9%9D%A0%E5%89%8D%E7%9A%84%E6%97%85%E8%A1%8C%E8%80%85"><span class="toc-number">18.</span> <span class="toc-text">æ’åé å‰çš„æ—…è¡Œè€…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-17"><span class="toc-number">18.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-17"><span class="toc-number">18.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-17"><span class="toc-number">18.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-17"><span class="toc-number">18.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%82%E5%9C%BA%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">19.</span> <span class="toc-text">å¸‚åœºåˆ†æï¼ˆä¸€ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-18"><span class="toc-number">19.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-18"><span class="toc-number">19.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-18"><span class="toc-number">19.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-18"><span class="toc-number">19.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%80%E5%94%AE%E5%88%86%E6%9E%90"><span class="toc-number">20.</span> <span class="toc-text">é”€å”®åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%88Introduction-19"><span class="toc-number">20.0.1.</span> <span class="toc-text">ğŸ™ˆIntroduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A4%94code-19"><span class="toc-number">20.0.2.</span> <span class="toc-text">ğŸ¤”code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%92%AAget-19"><span class="toc-number">20.0.3.</span> <span class="toc-text">ğŸ’ªget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%99%83source-19"><span class="toc-number">20.0.4.</span> <span class="toc-text">ğŸ™ƒsource</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/" title="SQLé¢˜ç›®è®°å½•(ä¸€)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/XE8p2nWdrub9SOG.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQLé¢˜ç›®è®°å½•(ä¸€)"/></a><div class="content"><a class="title" href="/2022/05/01/SQL%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95(%E4%B8%80)/" title="SQLé¢˜ç›®è®°å½•(ä¸€)">SQLé¢˜ç›®è®°å½•(ä¸€)</a><time datetime="2022-05-01T02:45:10.000Z" title="å‘è¡¨äº 2022-05-01 10:45:10">2022-05-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/29/python-%E8%A3%85%E9%A5%B0%E5%99%A8/" title="python_è£…é¥°å™¨"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/9ZuPDNUYzShvdXf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python_è£…é¥°å™¨"/></a><div class="content"><a class="title" href="/2022/04/29/python-%E8%A3%85%E9%A5%B0%E5%99%A8/" title="python_è£…é¥°å™¨">python_è£…é¥°å™¨</a><time datetime="2022-04-29T08:56:37.000Z" title="å‘è¡¨äº 2022-04-29 16:56:37">2022-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/29/python-%E5%AF%B9%E8%B1%A1/" title="python_å¯¹è±¡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/8KH4XORbCrozgyW.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python_å¯¹è±¡"/></a><div class="content"><a class="title" href="/2022/04/29/python-%E5%AF%B9%E8%B1%A1/" title="python_å¯¹è±¡">python_å¯¹è±¡</a><time datetime="2022-04-29T08:54:15.000Z" title="å‘è¡¨äº 2022-04-29 16:54:15">2022-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/29/sql%E8%BF%9B%E9%98%B6/" title="sqlè¿›é˜¶"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/8KH4XORbCrozgyW.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sqlè¿›é˜¶"/></a><div class="content"><a class="title" href="/2022/04/29/sql%E8%BF%9B%E9%98%B6/" title="sqlè¿›é˜¶">sqlè¿›é˜¶</a><time datetime="2022-04-29T08:41:16.000Z" title="å‘è¡¨äº 2022-04-29 16:41:16">2022-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/28/SQL/" title="SQLåŸºç¡€"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2022/04/29/edb23T1po8VhxsO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQLåŸºç¡€"/></a><div class="content"><a class="title" href="/2022/04/28/SQL/" title="SQLåŸºç¡€">SQLåŸºç¡€</a><time datetime="2022-04-28T10:00:14.000Z" title="å‘è¡¨äº 2022-04-28 18:00:14">2022-04-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Zj_Jibo</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="github-badge"><a style="color: #fff" rel="license" href="https://hexo.io/" target="_blank" title="ç”± Hexo å¼ºåŠ›é©±åŠ¨"><span class="badge-subject">Powered</span><span class="badge-value bg-blue">Hexo</span></a><a style="color: #fff" rel="license" href="https://gitee.com/" target="_blank" title="é™æ€ç½‘é¡µæ‰˜ç®¡äº GitHub Pages å’Œ Coding Pages å’Œ Gitee Pages"><span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen">GitHub & Coding & Gitee</span></a><a style="color: #fff" rel="license" href="https://www.jsdelivr.com/" target="_blank" title="jsDelivr æä¾› CDN åŠ é€ŸæœåŠ¡"><span class="badge-subject">CDN</span><span class="badge-value bg-orange">jsDelivr</span></a><a style="color: #fff" rel="license" href="https://jerryc.me" target="_blank" title="ç«™ç‚¹ä½¿ç”¨ Butterflyä¸»é¢˜"><span class="badge-subject">Theme</span><span class="badge-value bg-blue">Butterfly</span></a><a style="color: #fff" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="æœ¬ç«™ç‚¹é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"><span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-lightgrey">BY-NC-SA 4.0</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœ¬åœ°æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/gh/zjwo/zjwo.github.io/js/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/zjwo/zjwo.github.io/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/gh/zjwo/zjwo.github.io/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="000PeZCQ1i4XVs" data-server="tencent" data-type="artist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer src="https://cdn.jsdelivr.net/combine/npm/jquery@latest/dist/jquery.min.js,gh/weilining/jsdelivr/jquery/circlemagic/circlemagic.min.js,gh/weilining/jsdelivr@latest/jquery/circlemagic/butterflycirclemagic.js"></script><div class="aplayer no-destroy" data-id="607367759" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="å¯Œå¼º,æ°‘ä¸»,æ–‡æ˜,å’Œè°,å¹³ç­‰,å…¬æ­£,æ³•æ²»,çˆ±å›½,æ•¬ä¸š,è¯šä¿¡,å‹å–„" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>